!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Eventics=e()}}(function(){return function a(o,s,d){function c(n,e){if(!s[n]){if(!o[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(l)return l(n,!0);var i=new Error("Cannot find module '"+n+"'");throw i.code="MODULE_NOT_FOUND",i}var r=s[n]={exports:{}};o[n][0].call(r.exports,function(e){return c(o[n][1][e]||e)},r,r.exports,a,o,s,d)}return s[n].exports}for(var l="function"==typeof require&&require,e=0;e<d.length;e++)c(d[e]);return c}({1:[function(e,n,t){n.exports=function(t){var r,a=["ironBeastEventicsProvider"],o=[],s={},d={},i=this,c=[],e=(t=t||1,"undefined"!=typeof jQuery?jQuery:{}),n=void 0!==window.angular?window.angular:{};function l(e){for(var n=o.length,t=0;t<n;t++)e(o[t])}function u(e){i.extend(d||{},e)}return i.extend=e.extend||n.extend||function(){for(var e,n,t=arguments.length,i=1,r=arguments[0]||{};i<t;i++)if(null!=(e=arguments[i]))for(n in e)void 0!==e[n]&&(r[n]=e[n]);return r},i.trackEvent=function(n,t,i){n&&(i=extend(i||{},d),r?l(function(e){e.trackEvent(n,t,i)}):c.push({eName:n,label:t,data:i,eType:"event"}))},i.trackTiming=function(n,t,i){n&&0<=parseInt(t)&&(i=extend(i||{},d),r?l(function(e){e.trackTiming(n,t,i)}):c.push({eName:n,time:t,data:i,eType:"timing"}))},{setProvidersHandlers:function(e){if(e){"string"==typeof e&&(e=[e]),a=[];for(var n=e.length,t=0;t<n;t++)a.push(e[t])}},setProvidersConfig:function(e){s=e},init:function(e){r||(e&&u(e),function(){o=[];for(var e=a.length,n=0;n<e;n++){var t=a[n];if("function"==typeof window[t]){var i=new window[t];i.init(s),o.push(i)}}}(),r=!0,function(){for(var e in c){var n=c[e]||{};"event"===n.eType?i.trackEvent(n.eName,n.label,n.data):"timing"===n.eType&&i.trackTiming(n.eName,n.time,n.data)}c=[]}())},updateBaseData:u,createEventic:function(e,n){return(e=e||{}).userChance=t,new f(i,e,n)},updateUserChance:function(e){t=e}}};var f=e("./eventicsHelper.js");window.ironBeastEventicsProvider=e("./providers/ironBeastEventicsProvider.js"),window.QAEventicsProvider=e("./providers/QAEventicsProvider.js"),window.KuduEventicsProvider=e("./providers/KuduEventicsProvider.js")},{"./eventicsHelper.js":2,"./providers/KuduEventicsProvider.js":3,"./providers/QAEventicsProvider.js":4,"./providers/ironBeastEventicsProvider.js":5}],2:[function(e,n,t){n.exports=function(e,n,a){var t=void 0!==(n=n||{}).productChance?n.productChance:1,i=void 0!==n.userChance?n.userChance:1,s=e||{},d=n.baseData||{},c={},l=s.extend,r={};function u(e){return e&&e.name&&e.id}return r.trackEvent=function(e,n,t){if(!u(e)||a.isEventDisabled(e))return!1;var i=e.name,r=e.id;t||(t={}),t.eventId=r,t=l({},d,t||{}),s.trackEvent(i,n,t)},r.trackTimingStart=function(e,n){if(!u(e))return!1;var t=e.name;return n=n||Date.now(),c[t]=n,!0},r.trackTimingStop=function(e,n){if(!u(e))return!1;var t,i,r=e.name;if(n||(n={}),n.eventId=e.id,n&&n.timeStamp?(i=n.timeStamp,delete n.timeStamp):i=Date.now(),n&&n.eNameStart&&n.eNameStart.name?(t=c[n.eNameStart.name],delete n.eNameStart):c[r]&&(t=c[r],c[r]=null),t){var a=i-t,o=l({},d);return n=l(o,n||{}),s.trackTiming(r,a,n),!0}},r.updateBaseData=function(e){for(var n in e)d[n]=e[n];return!0},r.resetBaseData=function(e){for(var n=0;n<e.length;n++)r.unsetParamFromBaseData(e[n])},r.unsetParamFromBaseData=function(e){d.hasOwnProperty(e)&&delete d[e]},r.incrementSessionNumber=function(){return d.sessionDepth?d.sessionDepth++:d.sessionDepth=1,!0},0<i&&i<=t?r:function(){var e={};for(var n in r)"function"==typeof r[n]&&(e[n]=function(){});return e}()}},{}],3:[function(e,n,t){n.exports=function(){var t,i,r="https://logs.ironsrc.mobi/logs",a={table:"supersonic.adunitanalytics.ad_unit_events"},o=["generalmessage","emptyowreason","landingid","callfailreason","rvnomoreoffersreason"];function s(e,n){switch(e){case"landingid":n=parseInt(n);break;case"generalmessage":case"emptyowreason":n=t=void 0===(t=n)?"undefined":null===t?"null":t.toString()}var t;return n}function d(e){if(e){e=function(e){if(!e)return e;for(var n=Object.keys(e),t=n.length;t--;){var i=n[t],r=i.toLowerCase(),a=e[i];-1!==o.indexOf(r)&&(a=s(r,a)),e[r]=a,i!==r&&delete e[i]}return e}(e);var n={table:a.table,data:e};i(n)}}function n(e){var n=new XMLHttpRequest;n.open("POST",t,!0),n.onerror=function(){e&&0<=e.retry&&e.retry<2&&(e.retry++,i(e))},n.send(JSON.stringify(e))}function c(n){var t;try{t=btoa(JSON.stringify(n))}catch(e){n.data.applicationUserId="badName",n.data.userId="badName",n.data.eventName="errorEvent",t=btoa(JSON.stringify(n))}var e=r+"?data="+t,i=new XMLHttpRequest;i.open("GET",e,!0),i.send()}return{init:function(e){i=e&&"POST"===e.method?(t="https://postlog.supersonic.com/logs",n):(t=r,c)},trackEvent:function(e,n,t){if(e){if(n&&"object"==typeof n){var i=Object.keys(n)[0];i&&(t[i]=n[i])}t.eventName=e,d(t)}},trackTiming:function(e,n,t){e&&0<=parseInt(n)&&(t.eventName=e,t.timingValue=n,d(t))}}}},{}],4:[function(e,n,t){n.exports=function(){var i,r={};function a(e){if(e){r.data=e;var n=function e(n,t){var i=[];for(var r in n)if(n.hasOwnProperty(r)){var a=t?t+"["+r+"]":r,o=n[r];i.push("object"==typeof o?e(o,a):encodeURIComponent(a)+"="+encodeURIComponent(o))}return i.join("&")}(r);delete r.data,(t=i+"?"+n)&&((new Image).src=t)}var t}return{init:function(e){i="http://qa.eventics.qa"},trackEvent:function(e,n,t){if(e){if(n&&"object"==typeof n){var i=Object.keys(n)[0];i&&(t[i]=n[i])}t.eventName=e,a(t)}},trackTiming:function(e,n,t){e&&0<=parseInt(n)&&(t.eventName=e,t.timingValue=n,a(t))}}}},{}],5:[function(e,n,t){n.exports=function(){var i,r={table:"supersonic.adunitanalytics.ad_unit_events"};function a(e){if(e){var n;r.data=e;try{n=btoa(JSON.stringify(r))}catch(e){r.data.applicationUserId="badName",r.data.userId="badName",r.data.eventName="errorEvent",n=btoa(JSON.stringify(r))}delete r.data,(t=i+"?data="+n)&&((new Image).src=t)}var t}return{init:function(e){i=e.isSecured?"https://secure.ironbeast.io":"http://supersonic.ironbeast.io"},trackEvent:function(e,n,t){if(e){if(n&&"object"==typeof n){var i=Object.keys(n)[0];i&&(t[i]=n[i])}t.eventName=e,a(t)}},trackTiming:function(e,n,t){e&&0<=parseInt(n)&&(t.eventName=e,t.timingValue=n,a(t))}}}},{}]},{},[1])(1)}),function a(o,s,d){function c(n,e){if(!s[n]){if(!o[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(l)return l(n,!0);var i=new Error("Cannot find module '"+n+"'");throw i.code="MODULE_NOT_FOUND",i}var r=s[n]={exports:{}};o[n][0].call(r.exports,function(e){return c(o[n][1][e]||e)},r,r.exports,a,o,s,d)}return s[n].exports}for(var l="function"==typeof require&&require,e=0;e<d.length;e++)c(d[e]);return c}({1:[function(e,n,t){n.exports=function(e){var n={v:1,controllerId:1,applicationKey:1,applicationUserId:0,debug:0,language:0,disableCache:0,applicationUserGender:0,applicationUserAgeGroup:0,demoCampaigns:0,appOrientation:1,mobileCarrier:0,connectionType:1,iphoneAppOnIpadDevice:0,deviceOs:1,SDKVersion:1,deviceOSVersion:1,deviceOEM:0,deviceVolume:0,immersiveMode:0,att:0,"deviceIds[IFA]":0,"deviceIds[IDFV]":0,"deviceIds[SERIAL]":0,"deviceIds[AndroidID]":0,"deviceIds[IMEI]":0,"deviceIds[AID]":0,displaySizeWidth:0,displaySizeHeight:0,deviceWidthDP:0,deviceHeightDP:0,deviceScreenScale:0,deviceLanguage:0,deviceModel:0,diskFreeSize:1,country:0,campaignId:0,customParams:0,isLimitAdTrackingEnabled:0,SDKPluginType:0,bundleId:0,jb:0,gpi:0,allowArbitraryLoads:0,allowArbitraryLoadsInWebContent:0,mcc:0,mnc:0,appVersion:0,batteryLevel:0,maxVideoLength:0,itemName:0,itemCount:0,timestamp:0,localTime:0,timezoneOffset:0,itemSignature:0,showDeliveryLimitationsLog:0,minimumOfferCommission:0,minimumOfferCommissionSignature:0,applicationUserCreationDate:0,applicationUserCreationDateSignature:0,mraid:0,numOfCampaigns:0,cdnCn:0,sdkAbName:0,segmentId:0,segmentName:0,consent:0,moatSupported:0,omidSupported:0,omidVersion:0,omidPartnerVersion:0,mediationType:0};return{init:function(){"android"===e.getConfig().mobileSDKSettings.deviceOs&&(n.deviceApiLevel=0)},getCommonRequiredData:function(){return n}}}},{}],2:[function(e,n,t){"use strict";t.__esModule=!0,n.exports=function(d,c,l){var u=c.appInfo.orientation.portrait,f=c.appInfo.orientation.landscape,g={android:function(e,n,t){return e.ext.forceOrientation.toLowerCase()},ios:function(e,n,t){return i=e,r=n.getABTestConfiguration(i.productType,i.ext.landingId).ignoreAppOrientationInForceCampaigns||!1,d.log("shouldIgnoreAppOrientationInForcedCampaign: "+Boolean(r),d.LogLevels.verbose),!r&&l.getOrientation()&&l.isAppOrientation(e.ext.forceOrientation.toLowerCase())?(d.log("forced campaign | application is locked on the same orientation - sending  default: "+t,d.LogLevels.verbose),t):e.ext.forceOrientation.toLowerCase();var i,r}};function p(n){return n&&n.controllerConfig&&["499b4845","406ff65d"].some(function(e){return e===n.controllerConfig.applicationKey})}return{getAdDisplayOrientation:function(e,n,t){if(t){var i,r,a,o="undefined",s=c.defaultOrientation[t.productType];return p(e)&&t.settings&&(t.settings.orientation=u),r=e,(a=t).ext&&a.ext.forceOrientation&&(!p(r)||p(r)&&a.ext.forceOrientation.toLowerCase()===f)?o=s=g[e.mobileSDKSettings.deviceOs](t,n,s):s=(i=t).settings&&i.settings.orientation?t.settings.orientation:l.getOrientation(),"string"==typeof s&&s.toLowerCase()===c.appInfo.orientation.none&&(s=c.defaultOrientation[t.productType]),d.log("adOrientation | forceByCampaign:"+o+" , forceBySession:"+t.settings.orientation+" ,forceByNative:"+l.getOrientation()+" , ChosenOrientation:"+s,d.LogLevels.info),s?s.toLowerCase():""}}}}},{}],3:[function(e,n,t){"use strict";t.__esModule=!0;var F=e("./Constants");n.exports=function(o,s,r){var d="MRAID",c="VAST",l="EXTERNAL",u="INTERNAL",f="PLAYABLE",g="HYBRID",p="IMAGE_INTERSTITIAL",v="STATIC_BANNER",m="OTHER",i={};function a(e){if(e)return e.id||t(e,b(e)||"",h(e)||""),e.id&&e.id.toString()}function b(e){if(e){var n=e.crid||e.bannerId||e.bannerID;return n&&n.toString()}}function h(e){if(e)return(e.creativeId||"0").toString()}function t(e,n,t){e.id=n+"_"+t}function S(e,n){if(!e)return"";var t=y(e,n);return i[t]||i.other}i[d]="MR",i[c]="VA",i[l]="EX",i[u]="AT",i[f]="PL",i[g]="HY",i[p]="IM",i[v]="SB",i[m]="OT";var y=function(e,n){var t,i,r=e&&e.ext,a="";return r?a=(i=r)&&i.type&&"imageInterstitial"===i.type?p:o.VastUtils.isVastCampaign(e)?c:s.HybridService.isHybridCampaign(e,n)?g:A(r)?f:C(r)?d:D(r)?l:I(r)?u:(t=r)&&t.type&&"staticBanner"===t.type?v:m:a};function A(e){return e&&e.type&&"playableAd"===e.type}function C(e){return e&&e.type&&"MRAID"===e.type}function D(e){return e&&e.videoData&&e.videoData.videoType&&"ssa-external-video-player"===e.videoData.videoType}function I(e){return e&&e.videoData&&e.videoData.videoType&&"ssa-internal-video-player"===e.videoData.videoType}function w(e){var n={};return n.id=a(e),n.title="",n.credits=e.credits,n.staticContent=o.AdAssets.extractStaticFiles(e,P(e)),n.lastUpdateTime=e.lastUpdateTime,n.inventoryIndex=e.inventoryIndex,n.isCacheable=e.isCacheable=0<n.staticContent.length,n}function P(e){var n=e.ext;return A(n)&&n.videoData&&n.videoData.videoSource&&n.videoData.videoSource.html&&-1<n.videoData.videoSource.html.indexOf(o.AdAssets.getPlayableCacheFlag())}function T(e){var n=s.getApiData({deviceOs:1}).deviceOs;e.standaloneView=n===F.deviceOs.ios,e.translucentView=n===F.deviceOs.android}function O(e,n){var t={};return n&&n.ext&&n.ext.opportunityID&&(t.opportunityId=n.ext.opportunityID),e&&e.requestID&&(t.requestId=e.requestID),t}return{getAdId:a,getAdIdsOfAds:function(e){if(!e||!Array.isArray(e))return[];for(var n=[],t=0;t<e.length;t++)n.push(a(e[t]));return n},generateUniqueAdId:function(e){return e.productType+"."+e.demandSourceName+"."+a(e)+"."+Date.now()},getBannerId:b,getCreativeId:h,getAdType:S,formatParamsToAdId:function(e){if(e){if(!e.id){var n=b(e);n&&t(e,n,F.legacyCreativeId.toString())}return e}},formatAdsForPrecache:function(e){return e.map(function(e,n){return w(e)}).filter(function(e){return e.isCacheable})},isCacheableAd:function(e){return e&&e.hasOwnProperty("isCacheable")},getStoreAppId:function(e){if(e.ext.clickTags.storeAppId)return e.ext.clickTags.storeAppId;var n,t,i="",r=e.ext.clickTags.clickURL;return r&&(n=r.match(/id\d+/g),t="",n&&(n=(n=n[n.length-1]).match(/\d+/g),t=Array.isArray(n)?n[0]:""),i=t||"")&&(e.ext.clickTags.storeAppId=i),i},formatVastAdForPrecache:function(e,n){var t;return(t=w(e)).preProcessing=n,t.isCacheable=e.isCacheable=!0,t},setViewType:function(e,n,t){var i;n&&n.ext&&(i=n.ext)&&i.layoutData&&(i.layoutData.portrait&&i.layoutData.portrait.frameUrl&&i.layoutData.portrait.closeButtonUrl||i.layoutData.landscape&&i.layoutData.landscape.frameUrl&&i.layoutData.landscape.closeButtonUrl)&&T(e),t&&(e.viewType=t)},removeViewTypeFromSetting:function(e){e.viewType&&delete e.viewType},getViewType:function(e){return e&&e.settings?e.settings.viewType:null},getRequestOppParams:O,updateEventWithAdParams:function(e,n,t){return n&&(r.extend(t,O(e,n)),t.bannerId=b(n),t.creativeId=h(n),t.campaignType=S(n,e)),t},isPlayableCampaign:A,isPlayablePrecachedAd:P,isInternalCampaign:I,isMRAIDCampaign:C,isExternalCampaign:D,isCampaignShouldStartMuted:function(e,n){return!(!e||!e[F.sspProductNames[n]]||!0!==e[F.sspProductNames[n]].startVideoOnMute)},extendAdObjectWithConfig:function(e,n,t,i){n.settings=r.extend(!0,n.settings,i),n.ext&&n.ext.forceOrientation&&(n.settings.orientation=n.ext.forceOrientation.toLowerCase()),r.extend(!0,n,t,{url:e})},extendSettingsWithStandaloneViewSupport:T,getIntegrationType:function(e){if(e&&e.productType){var n=s[e.productType];if(e.demandSourceName&&n)return n[e.demandSourceName].getIntegrationType()}return null},extractEventData:function(e){return e&&e.ext?{requestId:e.requestID,opportunityId:e.ext.opportunityID,bannerId:b(e),creativeId:h(e),campaignType:S(e,e.ext),rvPlayMethod:e.displayMode,displayStrategy:e.displayStrategy,dynamicDemandSource:e.ext.dynamicDemandSource,auctionId:e.ext.auctionId,adunitVersion:e.adunitVersion,adunitbn:e.adunitbn,integrationType:e.integrationType,isBiddingInstance:e.isInAppBidding,productType:e.productType,demandSourceName:e.originalDemandSourceName,sessionDepth:e.settings&&e.settings.sessionDepth,strategyId:e.settings&&e.settings.strategyId,landingId:e.settings&&e.settings.landingId}:{}}}}},{"./Constants":12}],4:[function(e,n,t){n.exports=function(i,r,a){return{decideOnAdvertisingId:function(e,n){var t;r.isIOS()&&(-1===i.Utils.versionCompare(e.deviceOSVersion,"10")||(t=e)["deviceIds[IFA]"]&&t["deviceIds[IFA]"]!==a.advertisingId.invalidAdvertisingId)&&(void 0===n.sid||n.sid||(e["deviceIds[IDFV]"]=null))}}}},{}],5:[function(n,e,t){e.exports=function(t,r,e){var a=n("./NativeLifeCycleEventsConstants.js"),o=r.jQuery(),s={};function d(e){r.log("AndroidLifeCycleEventHandlers | handleOnDestroy:",r.LogLevels.verbose);var n={};e&&(n.eventParams=e),t.PubSub.publish(a.serviceCallback+"."+a.AndroidEvents.onDestroy,[n])}return{publishEvent:function(e,n){var t,i;r.log("AndroidLifeCycleEventHandlers | _handleEvent:",r.LogLevels.verbose),s[a.AndroidEvents.onDestroy]=d,t=e,i=Object.keys(s),r.log("AndroidLifeCycleEventHandlers | _isEventSupported: "+t+" supportedEvents: "+i,r.LogLevels.verbose),t&&-1<o.inArray(t,i)&&s[e](n)}}}},{"./NativeLifeCycleEventsConstants.js":38}],6:[function(e,n,t){n.exports={eventicsCategories:{nomediaFileDownloadFail:{name:"nomediaFileDownloadFail",id:210},nomediaFileDownloadSuccess:{name:"nomediaFileDownloadSuccess",id:211}},noMediaFileUrl:"/users/android/.nomedia",logMessage:{tag:"AndroidNomediaFileHandler | ",fileInCache:"nomedia file already in cache",saveFileToCache:"save nomedia file to cache"},errorMessage:{fileAlreadyExist:"file_already_exist"}}},{}],7:[function(e,n,t){n.exports=function(r){var a,o=e("./AndroidNomediaFileConstants.js"),s=o.noMediaFileUrl;return{init:function(e){a=e},updateNomediaFileToCache:function(){var e,n=r.getConfig(),t=r.Cache.getRootCacheStructure(),i=(e=n).mobileSDKSettings.protocol+"//"+e.mobileSDKSettings.cdn+s;t&&-1!==r.Cache.getFileIndexInCache(t.cache,i)?r.log(o.logMessage.tag+o.logMessage.fileInCache):(r.log(o.logMessage.tag+o.logMessage.saveFileToCache),r.saveFileToCache("./",i).then(function(){a.trackEvent(o.eventicsCategories.nomediaFileDownloadSuccess)},function(e){e!==o.errorMessage.fileAlreadyExist&&a.trackEvent(o.eventicsCategories.nomediaFileDownloadFail,{generalMessage:e})}))}}}},{"./AndroidNomediaFileConstants.js":6}],8:[function(e,n,t){n.exports={NativeAPI:{getAUIDFailed:"getAUIDFailed",getAUIDSuccess:"getAUIDSuccess",setAUIDFailed:"setAUIDFailed",setAUIDSuccess:"setAUIDSuccess"}}},{}],9:[function(e,n,t){n.exports=function(u,f,g){var t,c,p="AppUserIdService | ",l=!1,n=e("../modules/SDKController/EventCategories")(),v=e("./AppUserIdConstants");function m(e){var n,t,i,r,a,o,s,d,c,l=new jQuery.Deferred;return(n=e)&&!jQuery.isEmptyObject(n)&&"{}"!==n?l.resolve(e):(t=u.Utils.generateIdentifier(1),i=l,s=[],d=v.NativeAPI.setAUIDSuccess,c=v.NativeAPI.setAUIDFailed,t&&i&&(s.push(u.PubSub.subscribe(g.CB+"."+d,function(e){if(clearTimeout(o),!(r=f.isIOS()?e&&e.key&&e.key===S()&&e.value&&decodeURIComponent(e.value):e&&e[S()]&&decodeURIComponent(e[S()]))||jQuery.isEmptyObject(r)||"{}"===r)return i.reject("Invalid set AUID response."),void u.PubSub.clearHandlers(s);f.log(p+"_setAUIDKeyInNative succeeded, response: "+r,f.LogLevels.info),i.resolve(r),u.PubSub.clearHandlers(s)})),s.push(u.PubSub.subscribe(g.CB+"."+c,function(e){clearTimeout(o),a=e&&!f.checkRequiredCallbackParams(["errMsg"],e,c).didSucceed?f.checkRequiredCallbackParams(["errMsg"],e,c).errMsg:e&&e.errMsg,f.log(p+"_setAUIDKeyInNative failed, errorMsg: "+a,f.LogLevels.info),i.reject(c+": "+a),u.PubSub.clearHandlers(s)})),o=setTimeout(function(){f.log(p+"_setAUIDFromNative failed, errorMsg: timeout",f.LogLevels.info),i.reject(c+": timeout"),u.PubSub.clearHandlers(s)},4e3),f.callSDKFunction("setUserData",{key:S(),value:t},d,c))),l.promise()}function b(e,n){t=e,u.Eventics.updateBaseData({auid:t}),n||f.getTokenService().updateToken({auid:t})}function h(e){c.trackEvent(n.auidFail,{},{callfailreason:e})}function S(){var e=f.SupplyConfigurations.getNetworkConfigValueByKey("auid_key");return e||"auid"}return{init:function(e){var n,t,i,r,a,o,s,d;l||(c=e,(n=f.SupplyConfigurations.getValueByKey("auid"))?b(n,!0):(a=[],o=new jQuery.Deferred,s=v.NativeAPI.getAUIDSuccess,d=v.NativeAPI.getAUIDFailed,a.push(u.PubSub.subscribe(g.CB+"."+s,function(e){if(clearTimeout(r),!(t=e&&e[S()]&&decodeURIComponent(e[S()])))return o.reject("Invalid get AUID response"),void u.PubSub.clearHandlers(a);f.log(p+"_getAUIDFromNative succeeded, response: "+t,f.LogLevels.info),o.resolve(t),u.PubSub.clearHandlers(a)})),a.push(u.PubSub.subscribe(g.CB+"."+d,function(e){clearTimeout(r),i=e&&!f.checkRequiredCallbackParams(["errMsg"],e,d).didSucceed?f.checkRequiredCallbackParams(["errMsg"],e,d).errMsg:e&&e.errMsg,f.log(p+"_getAUIDFromNative failed, errorMsg: "+i,f.LogLevels.info),o.reject(d+": "+i),u.PubSub.clearHandlers(a)})),r=setTimeout(function(){f.log(p+"_getAUIDFromNative failed, errorMsg: timeout",f.LogLevels.info),o.reject(d+": timeout"),u.PubSub.clearHandlers(a)},4e3),f.callSDKFunction("getUserData",{key:S()},s,d),o.promise()).then(m).then(b).fail(h),l=!0)},getAUID:function(){return t}}}},{"../modules/SDKController/EventCategories":143,"./AppUserIdConstants":8}],10:[function(e,n,t){n.exports=function(n){var r={},t=!1;function a(e,n){var t=r[e],i=[];return t&&t[n]?i=t[n]:t[n]=i,i}return{init:function(e){t||(r[n.RV]={},r[n.IS]={},r[n.BN]={},t=!0)},addToBlacklistedCampaigns:function(e,n,t){if(e&&n&&t){var i=a(e,n);i&&-1===i.indexOf(t)&&i.push(t)}},getBlacklistedCampaigns:function(e,n){var t=[];return e&&n&&(t=a(e,n)),t},isEmpty:function(e,n){var t=a(e,n);return!t||0===t.length}}}},{}],11:[function(e,n,t){n.exports=function(c,u,l){var t,f,g="FilterCampaigns | ",i={deviceOs:1,"deviceIds[IFA]":0,"deviceIds[AID]":0},p=1500,v=c.Utils,a={};function o(e){var n,t,i,r=new jQuery.Deferred,a="checkInstalledAppsSuccess",o="checkInstalledAppsFailed",s={appIds:e,requestId:Date.now().toString()},d=function(){c.PubSub.unsubscribe(n),c.PubSub.unsubscribe(t)};return n=c.PubSub.subscribe(l.CB+"."+a,function(e){e.requestId===s.requestId&&(clearTimeout(i),d(),u.log(g+"successfully check apps installed "+JSON.stringify(e.result)),r.resolve(e.result))}),t=c.PubSub.subscribe(l.CB+"."+o,function(e){clearTimeout(i),d(),u.log(g+"failed to check apps installed"+JSON.stringify(e)),r.reject()}),i=setTimeout(function(){d(),r.reject("SDK check apps installed timeout request")},p),u.callSDKFunction("checkInstalledApps",s,a,o),r.promise()}function s(e){var a={deviceId:"ios"===(t=u.getApiData(i)).deviceOs?t["deviceIds[IFA]"]:t["deviceIds[AID]"],os:t.deviceOs,campaignIds:{}},n=f.urlPaths&&f.urlPaths.campaignsStatus;n?(jQuery.each(e,function(e,n){var t,i,r;a.campaignIds[n.campaignId]=(t=n.isInstalled,r=t?(i=50,100):(i=0,50),Math.floor(Math.random()*(r-i))+i)}),jQuery.ajax({url:n,data:a,type:"GET",dataType:"jsonp",success:function(e){u.log("Success update campaigns status to server",u.LogLevels.verbose)},error:function(e,n){u.log("Success update campaigns status to server: response:"+e+".status: "+n,u.LogLevels.verbose)}})):u.log("No url in settings to update server on campaigns status",u.LogLevels.verbose)}function m(e,n){var t=!0;return e||(u.log("filter apps installed flag is false",u.LogLevels.verbose),t=!1),n&&0!==n.length||(u.log("get 0 campaigns to filter",u.LogLevels.verbose),t=!1),u.isLegacy({ios:"5.14",android:"5.16"})&&(u.log("NewController: Old controller version. filter campaigns by app installed is not supported in this version of SDK.",u.LogLevels.verbose),t=!1),t}function b(e,n,t){var i,r=new jQuery.Deferred;return jQuery.isEmptyObject(n)?r.resolve():(i=t,u.isAppsInstalledInfoRestricted()?c.Utils.returnResolvedPromise(a):o(i)).then(function(e,i,n,t){jQuery.each(t,function(e,n){var t=i[e];t&&(n.bannerIds=t)});var o,r,s,a=(o=e,r=t,s=[],jQuery.each(r,function(e,n){if(n.isInstalled){for(var t=[],i=0;i<o.length;i++){var r=u.AdUtils.getAdId(o[i]);n.bannerIds&&-1===n.bannerIds.indexOf(r)?t.push(o[i]):s.push(o[i])}for(var a=o.length=0;a<t.length;a++)o.push(t[a])}}),u.log(g+"after ads filtering"),{newCampaigns:o,installedCampaigns:s});return e=a.newCampaigns,n.resolve(a.installedCampaigns),t}.bind(null,e,n,r)).then(s).fail(function(e){u.log("failed filter campaigns by app installed. "+e,u.LogLevels.verbose),r.resolve()}),r.promise()}return{filterByAppInstalled:function(e,n,t){if(t=t||[],!m((f=n).filterAppsInstalled,e))return v.returnResolvedPromise();for(var i={},r=e.length,a=[],o=0;o<r;o++){var s=e[o],d=u.AdUtils.getAdId(s),c=s&&s.ext,l=c&&c.appData;c&&l&&l.appId&&(0===t.length||-1===t.indexOf(c.type))&&(i[l.appId]||(i[l.appId]=[]),i[l.appId].push(d),-1===a.indexOf(l.appId)&&a.push(l.appId))}return b(e,i,a)},filterByAppInstalledOW:function(e,n){if(f=n,!m(!0,e))return v.returnResolvedPromise();for(var t={},i=e.length,r=[],a=0;a<i;a++){var o=e[a],s=u.AdUtils.getAdId(o),d=o.appData;d&&d.filterIfInstalled&&d.appId&&(t[d.appId]||(t[d.appId]=[]),t[d.appId].push(s),-1===r.indexOf(d.appId)&&r.push(d.appId))}return b(e,t,r)},checkIfAppInstallOnDevice:o}}},{}],12:[function(e,n,t){var i=e("../constants/featureCompatibilityMap");n.exports={CB:"NativeCallback",WebControls:"WebControls",BC:"BrandConnect",RV:"RewardedVideo",OW:"OfferWall",IS:"Interstitial",BN:"Banner",RIS:"RIS",taskManager:"TaskManagerDS",libs:"libs",fakeOWLoader:"fakeOWLoader",timeunit:6e4,closeAndBackDisabledTimer:1e4,closeAndBackDisabledTimerOW:8e3,vastResponseTimeout:8e3,vastMinimumResponseTimeout:500,legacyCreativeId:0,domainUrls:{local:"local.ssacdn.com",prod:"www.supersonicads.com"},environment:{develop:"dev",production:"prod",stage:"stage"},errors:{missing:"Missing required parameter: ",invalid:"Invalid parameter: ",unknown:"Unknown parameter: ",appInfo:"Failed to retrieve application info",device:"Failed to retrieve device status",filemap:"Failed to retrieve file map",showAdFailedReasons:{preloadNoAd:"No ad on preload function",showNoAd:"No ad on show function",taskManagerPreload:"taskManager failed to preload",taskManagerEngage:"taskManager failed to engage"},noFill:"We did not receive any campaigns in inventory"},noMoreOffersReason:{refreshFeedAfterClosingAd:"Refresh Feed after closing ad",noMoreOffersToShowInFeed:"Finish view all campaigns (engageEnd)"},DebugLevels:{0:"NONE",1:"ERROR",2:"INFO",3:"VERBOSE"},videoStates:{none:0,play:1,stop:2},confirmCloseMsg:{close:"Are you sure you want to quit the offer?",yes:"OK",no:"Cancel"},confirmCloseMsgMap:{0:"during",1:"after"},protocol:{http:"http:",https:"https:",file:"file:"},styleAccordingToProtocol:{secured:"secured",unsecured:"unsecured"},labels:{noInternet:"No internet connection. Please connect and try again.",noOffers:"Sorry, There are no offers at the moment"},closeButtonStates:{close:"close",confirm:"confirm",back:"back",confirmNextFrame:"confirmNextFrame",nextFrame:"nextFrame",ignore:"ignore",closeBanner:"closeBanner"},openUrlMethods:{storeKit:"storeKit",external_browser:"external_browser",store:"store",webview:"webview"},deviceOs:{android:"android",ios:"ios"},deviceOEM:{amazon:"amazon"},nativeInterfaceMethod:{displayWebView:"displayWebView"},nativeCallBacks:{hideSuccess:"onHideSuccess",hideFailed:"onHideFailed",displayWebviewSuccess:"onDisplayWebviewSuccess",displayWebviewFailed:"onDisplayWebviewFailed:"},offerWallSetting:{immersive:"immersive",OLXD:"OLXD",OWVersion:"OWVersion",defaultOWVersion:"1.10.0"},appInfo:{orientation:{landscape:"landscape",portrait:"portrait",none:"none"}},sspProductNames:{RewardedVideo:"rewardedVideo",Interstitial:"interstitial",OfferWall:"offerWall",Banner:"banner"},demandSourceType:{demandSource:"demandSource",instance:"instance"},demandSourceStates:{notInitiated:0,initFail:1,initiated:2,available:3,notAvailable:4,exhausted:5,cappedPerSession:6,initPending:7,loadPending:8},templateStyle:{template4:{minDialogBtnWidth:187,baseDialogBtnWidth:187,maxDialogBtnWidth:187,maxDialogBtnTextWidth:165},defaultTemplate:{minDialogBtnWidth:75,baseDialogBtnWidth:100,maxDialogBtnWidth:133,maxDialogBtnTextWidth:115}},viewsStates:{hybrid:2,normal:0},hybridViews:[{viewType:"controller",screenRatio:.999},{viewType:"store",screenRatio:.001}],baseDataKeys:["bannerId","creativeId","campaignType","opportunityId","requestId"],keysToResetOnAdClosed:["rvPlayMethod","dynamicDemandSource","sessionDepth","adunitbn","adunitVersion","feedCampaignOrder","feedSize","strategyId"],iphoneXDeviceModels:["iPhone10,3","iPhone10,6","iPhone11,6","iPhone11,4","iPhone11,2","iPhone11,8","iPhone12,1","iPhone12,3","iPhone12,5","iPhone13,1","iPhone13,2","iPhone13,3","iPhone13,4"],iphoneXDeviceResolution:{type1:{width:375,height:812},type2:{width:414,height:896},type3:{width:390,height:844},type4:{width:428,height:926}},notchSettings:{safeAreaInsetsMin:24,viewportCounter:10},requiredDeviceInfo:["appOrientation","connectionType","deviceOs","SDKVersion","deviceOSVersion","deviceModel","diskFreeSize"],requiredAppInfo:["applicationKey","applicationUserId"],optionalAppInfo:["campaignId","showDeliveryLimitationsLog","numOfCampaigns","disableCache","disableSession","country","language","itemName","itemCount","itemSignature","timestamp","demoCampaigns","mraid","admin","page","pageSize","landingId","maxVideoLength","minimumOfferCommission","minimumOfferCommissionSignature","useClientSideCallbacks","applicationUserGender","applicationUserAgeGroup","applicationUserCreationDate","applicationUserCreationDateSignature","placementId","SDKPluginType","skd"],abTests:{CnCcCdn:"CC2",CnNonCcCdn:"NCC2",CnUser:"CN",NonCnUser:"NCN",WithoutCC:"WOCC",abt:"abt",controllerConfigGroup:"controllerConfigGroup"},xCodeVersion:"xCodeVersion",abtParamByProductType:{RewardedVideo:"rewardedVideo",Interstitial:"interstitial",Banner:"banner",OfferWall:"offerwall"},deviceLimitations:["iPod5,1","iPad2,1","iPad4,8","iPad3,5","iPad3,6","iPad4,5","iPhone4,1","iPhone7,1","iPad4,4","iPad4,2","iPad2,2","iPad2,5","iPad4,1","iPad3,4","iPad3,3","iPad4,7","iPad3,1","iPad2,4"],applicationsLimitations:["49726195"],moat:{disabled:"off"},MOAT_PC:"ironsourceinappvideo555077879249",testAppBundleIds:["com.supersonic.mediation.test","com.ironsrcmobile.UltraApp","com.ironsrcmobile.UltraApp-enterprise","com.supersonic.automationapp","com.ironsrcmobile.Bridge","com.ironsource.othermediationtester","com.ironsrc.ISMedAdapters"],defaultOrientation:{BrandConnect:"application",RewardedVideo:"application",Interstitial:"application",OfferWall:"application",Banner:"application",general:"device",undefined:"application"},vastRequestPlaceholders:{moatEnabled:"{MT_ENABLED}",requestId:"{REQ_ID}",opportunityId:"{OPP_ID}"},featureCompatibilityMap:i,blockedProductsPerApiLevel:{BrandConnect:{android:/^10/,ios:/^7/},RewardedVideo:{android:/^10/,ios:/^7/},OfferWall:{android:/^10/,ios:/^7/},Interstitial:{android:/^10/,ios:/^7/},Banner:{android:/^10/,ios:/^7|8|9/}},storeSearchKeys:{ios:["itunes.apple.com"],android:["market://","play.google.com"]},gatewayDestinationMap:{RV:{production:"//rv-gateway.supersonicads.com/gateway/sdk/request",staging:"//staging-rv-gateway.sonic-us.supersonicads.com/gateway/sdk/request"},IS:{production:"//is-gateway.supersonicads.com/gateway/sdk/request/",staging:"//staging-is-gateway.sonic-us.supersonicads.com/gateway/sdk/request/"},OW:{production:"//ow-gateway.supersonicads.com/gateway/offerwall/request",staging:"//staging-ow-gateway.sonic-us.supersonicads.com/gateway/offerwall/request"},BN:{production:"//banner-gateway.supersonicads.com/gateway/sdk/request",staging:"//staging-banner-gateway.sonic-us.supersonicads.com/gateway/sdk/admin/request"}},appExtConfigPath:"/users/microjob/sdkconfig.json",appExtConfigPathStaging:"/users/microjob/sdkconfig_staging.json",requiredSDKDataKeys:{applicationKey:"applicationKey",applicationUserId:"applicationUserId",appOrientation:"appOrientation",deviceLanguage:"deviceLanguage",bundleId:"bundleId",sdkAbName:"sdkAbName"},HTTPMethods:{GET:"GET",POST:"POST"},adClosedErrorReason:{unexpectedCloseActivityDestroy:"unexpectedClose_ActivityDestroy"},viewTypes:{externalView:"external"},integrationType:{manual:"M",automatic:"A"},assetType:{adunitAsset:"adunitAsset",adAsset:"adAsset"},adViewIdString:"adViewId",bannerAdViewId:"Banner.SupersonicAds",DEFAULT_AMOUNT_OF_INVENTORIES:1,iOS_UIModalPresentationFullScreen:0,adTypes:{CPVI:"CPVI",customEndCard:"customEndCard",imageInterstitial:"imageInterstitial",MRAID:"MRAID",playableAd:"playableAd"},extraOffers:{minimalAndroidApiLevel:21,fetchTimeout:1e4,minimumAdsForExtraOffersInventory:2},viewableChangeReasons:{storeKitOpen:"storeKitOpen",storeKitClose:"storeKitClose"},storeKit:{minimalSupportedOSVersion:11,loadFailuresToPreventRetry:["Invalid Parameters","Unsupported Orientation"],loadingTimeoutMessage:"StoreKit load timeout"},authorizationStatus:"att",advertisingId:{invalidAdvertisingId:"00000000-0000-0000-0000-000000000000"},advertiserIdParamsToUpdate:["deviceIds[IFA]","deviceIds[IDFV]","isLimitAdTrackingEnabled","att"],cacheAdsDirectory:"ads",numOfBannersToInitSuccess:"numOfBannersToInitSuccess",numOfBannersToCache:"numOfBannersToCache",cacheConfiguration:"cacheConfig",defaultTimeoutForCachingAds:3e4}},{"../constants/featureCompatibilityMap":90}],13:[function(e,n,t){n.exports=function(i,r,t){function a(e){var n=e?e.productType:null;return!n||r.isLegacy(r.featureMap.MDS[n])}function o(e,n){return n=n||{},e&&e.demandSourceName&&!r.isLegacy(r.featureMap.MDS[t.RV])&&(n.demandSourceName=e.demandSourceName,n.demandSourceId=e.demandSourceId,n.isInAppBidding=e.isInAppBidding,n.integrationType=e.integrationType),n}return{isLegacy:a,extendCallbackParamsWithDemandConfig:o,extendCallbackParamsWithProductConfig:function(e,n){return n=o(e,n),e&&e.productType&&(n.productType=e.productType),n},extendCallbackParamsWithParentProductConfig:function(e,n){if(n=o(e,n),e&&e.productType){var t=r[e.productType];t&&(n.productType=i.Utils.isFunction(t.getProductType)?t.getProductType():e.productType)}return n},shouldReceiveMessage:function(e,n){return!(!e||!n)&&!(!e.productType||!e.demandSourceName)&&n.productType===e.productType&&(a(e)||n.demandSourceName===e.demandSourceName)},isManualRewardedVideoIntegration:function(){return r.RewardedVideo&&!0===r.RewardedVideo.isManualIntegration},setManualRewardedVideoTypeForNative:function(e){return e&&e.productType&&e.productType===t.RV&&(e.productType=t.IS),e}}}},{}],14:[function(e,n,t){n.exports={CB:"NativeCallback",deviceDataNativeFunction:"deviceDataAPI",getDeviceData:"getDeviceData",failCallback:"handleDeviceDataFailed",successCallback:"handleDeviceDataSuccess",sdkNotSupportedErrMsg:"DeviceDataService | module not supported by SDK",notInitiatedErrMsg:"DeviceDataService | module not initiated or not supported by SDK",alreadyInitiatedErrMsg:"DeviceDataService | init | module is already initiated",intervalAlreadySet:"DeviceDataService | _startPullingDataWithInterval | interval already set",notValidInterval:"DeviceDataService | _startPullingDataWithInterval | interval is not valid, must be higher than 15 seconds",minimumIntervalAllow:5}},{}],15:[function(e,n,t){n.exports=function(t,i){var r,a,o=e("./DeviceDataConstants"),s=e("../constants/featureCompatibilityMap"),d=!1,n={},c=!1;function l(){i.callSDKFunction(o.deviceDataNativeFunction,{deviceDataFunction:o.getDeviceData},o.successCallback,o.failCallback)}function u(e){var n=e&&e.errMsg?e.errMsg:"";i.log("DeviceDataService |  getDeviceData fail, params : "+JSON.stringify(e)+"with errorMessage: "+n)}function f(e){i.log("DeviceDataService |  getDeviceData success, params :"+JSON.stringify(e)),e&&(n=e)}function g(){d?(clearInterval(r),r=void 0):i.log(o.notInitiatedErrMsg)}function p(e){if(i.log("DeviceDataService | _startPullingDataWithInterval | interval:"+e),d){var n=(t=parseInt(e),isNaN(t)?-1:t);n<o.minimumIntervalAllow?i.log(o.notValidInterval):r?i.log(o.intervalAlreadySet):r=setInterval(l,1e3*(a=n))}else i.log(o.notInitiatedErrMsg);var t}return{init:function(e){if(i.isLegacy(s.pullingNativeDeviceData))i.log(o.sdkNotSupportedErrMsg);else if(d)i.log(o.alreadyInitiatedErrMsg);else{var n=i.getConfig().controllerConfig||{};t.PubSub.subscribe(o.CB+"."+o.successCallback,f),t.PubSub.subscribe(o.CB+"."+o.failCallback,u),t.PubSub.subscribe(o.CB+".enterBackground",function(e){i.log("DeviceDataService | entered BG | should pause interval"),g()}),t.PubSub.subscribe(o.CB+".enterForeground",function(e){i.log("DeviceDataService | entered FG | should resume interval"),p(a)}),l(),d=!0,p(n.pullingDeviceDataInterval)}},getDeviceData:function(){return d||i.log(o.notInitiatedErrMsg),n},pullData:l,startPullingDataWithInterval:p,stopPullingData:g,setPullDataOnLoadAd:function(e){e&&!c&&(c=!0)},shouldPullDataOnLoadAd:function(){return c}}}},{"../constants/featureCompatibilityMap":90,"./DeviceDataConstants":14}],16:[function(e,n,t){n.exports=function(n){var t=null;return{set:function(e){t=e},get:function(){return t||null},reset:function(){t=null},getDisplayedAdType:function(){return t?t.productType:null},getDisplayedAdDemandName:function(){return t?t.demandSourceName:null},getDisplayedAdSettings:function(){return t?t.settings:null},isDisplayed:function(){return null!==t},isAdDisplayed:function(e){return t&&e&&n.getAdId(t)===n.getAdId(e)}}}},{}],17:[function(e,n,t){n.exports=function(t){return{isEventDisabled:function(e){if(t.SupplyConfigurations.isNetworkConfigEmpty())return"noFill"===e.name;var n=t.SupplyConfigurations.getNetworkConfigValueByKey("events");return!(!n||!n.disabledEvents)&&-1!==n.disabledEvents.indexOf(e.name)}}}},{}],18:[function(e,n,t){n.exports=function(){var a={};return{getABTestConfiguration:function(e,n){var t=a[e]&&a[e].abtest&&a[e].abtest.default,i=a[e]&&a[e].abtest&&a[e].abtest[t]||{},r=a[e]&&a[e].abtest&&a[e].abtest[n]||{};return jQuery.extend(i,r)},setConfig:function(e){a=e||{}},getExtConfig:function(){return a},getGeneralConfig:function(){return a.general},reset:function(){a={}}}}},{}],19:[function(require,module,exports){function ExtraOffers(constants,fetcherService,environmentConfiguration){var minimumAdsForExtraOffersInventory=constants.extraOffers.minimumAdsForExtraOffersInventory,supportedProductTypes=[constants.RV,constants.IS],supportedAdTypes=[constants.adTypes.CPVI,constants.adTypes.customEndCard,constants.adTypes.imageInterstitial];function _isEnabled(e){return!!(e&&e.extraOffers&&e.extraOffers.enabled)}function _isProductTypeSupported(e){return-1!==supportedProductTypes.indexOf(e)}function _isAdTypeSupported(e){return-1!==supportedAdTypes.indexOf(e)}function _isSupported(e,n,t,i){return!(e===constants.deviceOs.android&&n<constants.extraOffers.minimalAndroidApiLevel)&&(_isEnabled(i)&&_isProductTypeSupported(t.productType)&&_isAdTypeSupported(t.ext.type))}function _fetchExtraOffersInventory(e,n,t,i,r){var a=_buildRequiredDataForExtraOffersRequest(n,t,i,r);e=jQuery.extend({},e,a);var o=new jQuery.Deferred;return fetcherService.fetchFeed(environmentConfiguration().getConfig().schema+constants.gatewayDestinationMap.BN.production,e,constants.extraOffers.fetchTimeout).done(function(e){if(_isInvalidExtraOffersResponse(e))o.reject(e.errorCode.toString());else if(_isInventoryEligible(e))o.resolve(e);else{var n="Invalid extra offers inventory, length: "+e.seatbid.bid.length;o.reject(n)}}).fail(function(e,n){o.reject(n)}),o.promise()}function _isInvalidExtraOffersResponse(e){return!(!e||!e.hasOwnProperty("errorCode"))}function _buildRequiredDataForExtraOffersRequest(e,n,t,i){return{extraOffers:!0,currProductType:e||"",blacklistedCampaigns:n||"",currReqId:t||"",currOppId:i||""}}function _isInventoryEligible(e){return!!(e&&e.seatbid&&e.seatbid.bid&&e.seatbid.bid.length>=minimumAdsForExtraOffersInventory)}function _test(){var re=/(\(\))$/,args=[].slice.call(arguments),name=args.shift(),is_method=re.test(name),target;return name=name.replace(re,""),target=eval(name),is_method?target.apply(this,args):target}return{isSupported:_isSupported,fetchExtraOffersInventory:_fetchExtraOffersInventory,test:_test}}module.exports=ExtraOffers},{}],20:[function(e,n,t){n.exports=function(t){return{isFeatureSupportedInNativeSDK:function(e){var n=!1;return e&&t&&t.nativeFeatures&&(n=Array.isArray(t.nativeFeatures)&&-1<t.nativeFeatures.indexOf(e)),n}}}},{}],21:[function(e,n,t){n.exports=function(e,i,n){var r,a=e||"",o=n||6e4,s="Invalid API response",d=function(n){var t=!0;return jQuery.each(i,function(e){t=t&&void 0!==n[e]}),t};return{getInventory:function(e,n,t){r=new jQuery.Deferred;var i=n||a;return jQuery.ajax({url:i,data:e,type:"GET",dataType:t||"jsonp",timeout:o}).then(function(e){e&&e.errorCode&&e.errorMessage?r.reject({errorMessage:e.errorMessage,errorCode:e.errorCode}):d(e)?r.resolve(e):r.reject({errorMessage:s})},function(e,n,t){var i={errorMessage:"Error fetching inventory. Error data: "+n};r.reject(i)}),r.promise()},isValidResponseStructure:d}}},{}],22:[function(e,n,t){n.exports=function(o,s){var d,i={hit:1,miss:2,eventResult:"eventResult",resultReason:"resultReason"};function n(e){function a(e,n){var t;return e&&e.url&&(t={url:function(e,n){if(!e)return"";if(n)for(var t=n.length,i=0;i<t;i++)e=e.replace("{{"+n[i].key+"}}",encodeURIComponent(n[i].value));return e=e.replace(/\{\{[\w\d\s]*\}\}/g,"ok")}(e.url,n),type:e.type}),t}function t(e,n){var t,i,r=d[e];"object"==typeof r&&(0<r.length&&(r=r[0]),(t=a(r,n))&&(i=t,s.firePixel(i),o.log("Callback: "+JSON.stringify(i),o.LogLevels.info)))}return d=e,{track:function(e){var n;if(e&&d)switch(e.trackingType){case"request":t("requestTracking",null);break;case"responseHit":t("responseTracking",[{key:i.eventResult,value:i.hit}]);break;case"responseMiss":n=e.data,t("responseTracking",[{key:i.eventResult,value:i.miss},{key:i.resultReason,value:n}])}}}}return{init:function(e){return new n(e)}}}},{}],23:[function(e,n,t){n.exports=function(){var n=[];return{addToFilteredListCampaigns:function(e){e&&-1===n.indexOf(e)&&n.push(e)},getFilteredListCampaigns:function(){return n}}}},{}],24:[function(e,n,t){n.exports=function(i,n){function t(){var e=n("#displayedFrame");return e&&0<e.length?e:null}return{getDisplayedAdFrame:t,isFrameDisplayed:function(e){var n=t();return e&&n&&e[0]===n[0]},getAdUnitClassObj:function(e){var n="ssaAdUnit",t={class:n+" ",selector:"."+n};return e&&e.productType?(t.class+=e.productType+" ",t.selector+="."+e.productType,e.demandSourceName&&(t.class+=e.demandSourceName+" ",t.selector+="."+e.demandSourceName)):i.log("In getAdUnitClass with no ad",i.LogLevels.error),t},hideFrame:function(){var e=t();e&&e.addClass("hidden")},displayFrame:function(){var e=t();e&&e.removeClass("hidden")}}}},{}],25:[function(e,n,t){n.exports={NativeAPI:{updateConsentInfo:".updateConsentInfo"}}},{}],26:[function(s,e,n){e.exports=function(n,t,e){var i=s("./GDPRConstants.js"),r=!1,a=e.CB;function o(e){"string"!=typeof e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(t.getConfig().applicationSettings.consent=e)}return{init:function(e){e&&!r&&(n.PubSub.subscribe(a+i.NativeAPI.updateConsentInfo,function(e){if(e&&e.gdprConsentStatus)return t.log("updateConsentInfo | controller | params: "+JSON.stringify(e),t.LogLevels.info),void o(e.gdprConsentStatus);t.log("updateConsentInfo | controller | without params or gdprConsentStatus key",t.LogLevels.info)}),r=!0)},setConsent:o,getConsent:function(){return t.getConfig().applicationSettings.consent}}}},{"./GDPRConstants.js":25}],27:[function(e,n,t){function i(r,o){var e="NativeCallback",n=!1,a=[],t={GET:"GET",POST:"POST"},s={requestUnknown:"requestUnknown",requestStarted:"requestStarted",responseReceived:"responseReceived",requestError:"requestError"};function i(){r.PubSub.subscribe(e+".httpRequestStatusChanged",function(e){o.checkRequiredCallbackParams(["identifier","status"],e,"httpRequestStatusChanged").didSucceed&&d(e)})}function d(e){o.log("HTTPService - request status changed",o.LogLevels.verbose);var n=g(e.identifier,a);if(n)if(e.status===s.requestStarted)c(n);else if(e.status===s.responseReceived){var t={headers:e.responseParams.headers,statusCode:e.responseParams.statusCode,ranOnNative:!0},i=e.data;e.data&&(i=decodeURIComponent(i)),l(n,i,t)}else u(n,e.errMsg)}function c(e){o.log("onRequestStarted "+e.identifier,o.LogLevels.verbose),r.Utils.isFunction(e.onRequestStarted)&&e.onRequestStarted()}function l(e,n,t){o.log("_onResponseReceived "+e.identifier,o.LogLevels.verbose),f(e),r.Utils.isFunction(e.onResponseReceived)&&e.onResponseReceived(n,t)}function u(e,n){o.log("onRequestError "+n,o.LogLevels.verbose),f(e),r.Utils.isFunction(e.onRequestError)&&e.onRequestError(n)}function f(e){if(e){var n=a.indexOf(e);-1<n&&a.splice(n,1)}}function g(n,e){var t=jQuery.grep(e,function(e){return e.identifier===n});return 1!==t.length?null:t[0]}function p(){return+new Date+""+Math.random()}function v(e){return(!r.Utils.isDefined(e.allowNative)||e.allowNative)&&n}function m(e,n){return jQuery.extend(n,{url:e},{identifier:p()}),r.Utils.isDefined(n.background)||(n.background=!1),n}function b(e){o.log("_sendNativeEngineRequest",o.LogLevels.verbose);var i={};jQuery.each(e,function(e,n){if(!r.Utils.isFunction(n)){var t={};t[e]=n,jQuery.extend(i,t)}}),o.callSDKFunction("sendHttpRequest",i,"httpRequestStatusChanged","httpRequestStatusChanged")}function h(i){var r;o.log("_sendWebEngineRequest",o.LogLevels.verbose);var e=i;c(i);var a=function(e,n){var t={headers:e.getAllResponseHeaders(),statusCode:e.status,ranOnNative:!1};l(i,n,t)},n=jQuery.ajax(e);n.done(function(e,n,t){var i=t.responseText;a(t,i)}),n.fail(function(e,n,t){r=t,0===e.status?u(i,r&&""!==r?r:"unknown error"):a(e)})}function S(e){a.push(e),v(e)?b(e):h(e)}function y(e,n){n||(n={}),n.type=t.GET,S(m(e,n))}function A(e,n){n||(n={}),n.type=t.POST,S(m(e,n))}function C(){return a}function D(){return n}function I(e){n=e,i()}var w={GETRequest:y,POSTRequest:A,getPendingRequests:C,getIsNativeEngineExist:D,init:I};return w}n.exports=i},{}],28:[function(e,n,t){n.exports=function(l,u){var f="NativeCallback",g=!1;return{isHybridCampaign:function(e,n){return!u.isLegacy(u.featureMap.hybrid)&&"ios"===u.getApiData({deviceOs:1}).deviceOs&&e&&e.ext&&l.Utils.isDefined(e.ext.features)&&(n&&n.hybridOnClick&&!e.ext.forceOrientation||e.ext.features.allowHybrid&&!e.ext.forceOrientation||e.ext.isHybridFlow&&e.ext.forceOrientation)&&e.ext.clickTags&&u.AdUtils.getStoreAppId(e)&&e.ext.clickTags.pixelURL&&"CPVI"===e.ext.type},clearAppPage:function(e){e&&u.callSDKFunction("clearAppPage",{viewUniqueId:e})},loadHybridCampaign:function(e,s){var d=new jQuery.Deferred;if(u.isLegacy(u.featureMap.hybrid))d.reject();else{u.callSDKFunction("preLoadAppPage",{appId:e,viewUniqueId:s});var c=l.PubSub.subscribe(f+".appStoreInsideLoaded",function(e){var i,t,r,n,a,o;e&&"object"==typeof e&&e.viewUniqueId&&e.viewUniqueId===s&&(l.PubSub.unsubscribe(c),e.isLoaded?(i=s,t=l.PubSub.subscribe(f+".appStoreInsideClosed",function(e){if(e.viewUniqueId===i){var n=jQuery.extend({name:"appStoreInsideClosed"},e);l.PubSub.unsubscribe(t),g&&l.PubSub.publish("ViewsManager.viewClosed"),u.postAdUnitEvent(n)}}),r=l.PubSub.subscribe(f+".appStoreInsideDisplayHybrid",function(e){if(e.viewUniqueId===i){var n=jQuery.extend({name:"appStoreInsideDisplayHybrid"},e);l.PubSub.unsubscribe(r),u.postAdUnitEvent(n)}}),n=l.PubSub.subscribe(f+".appStoreInsideHideHybrid",function(){l.PubSub.publish("SDKController.HybridAdDidClosed"),l.PubSub.unsubscribe(n)}),a=l.PubSub.subscribe("SDKController.HybridChangeRatio",function(e){var n=e.hybridJson,t=e.viewUniqueId;t===i&&(0===n[0].screenRatio?(l.PubSub.unsubscribe(a),g=!0):1===n[0].screenRatio&&(l.PubSub.unsubscribe(a),l.PubSub.publish("ViewsManager.viewClosed")),u.callSDKFunction("hybridChangeRatio",{hybridJson:JSON.stringify(n),viewUniqueId:t}))}),o=l.PubSub.subscribe("HybridService.closeHybridFlow",function(e){e.viewUniqueId!==i&&(l.PubSub.unsubscribe(o),l.PubSub.unsubscribe(t),l.PubSub.unsubscribe(r),l.PubSub.unsubscribe(a),l.PubSub.unsubscribe(n))}),d.resolve()):d.reject())})}return d.promise()},createHybridId:function(e,n){var t="";return void 0!==n.demandSourceName&&(t=n.demandSourceName),t+=n.productType+u.AdUtils.getAdId(e)+u.AdUtils.getStoreAppId(e)}}}},{}],29:[function(e,n,t){var S=e("./containers/ContainerCreationStateHandler");n.exports=function(a,o,s,d){var c="IframeManager | ",l=a.jQuery(),u=a.AdUtils;function f(e,n,t,i){u.extendAdObjectWithConfig(n,e,t,i),a.getNotchService().onSetConfig(e)&&(h("Extend ad object isTransparentLayout=true"),e.settings.isTransparentLayout=!0),a.RingerSwitchService.isInitiated()&&(h("Extend ad object ringerMuteOnStart=true"),e.settings.ringerMuteOnStart=!0)}function g(e){var n,t=e.adViewId,i=null;return n=s.getAdUnitClassObj(e).selector,l.each(l(n),function(){return l(this).data("id")!=t||(i=l(this),!1)}),i}function p(e,n,t,i){var r,a;h("createAndLoadAdFrame"),f(e,n,t,i),a=(r=e).productType===o.OW?u.getAdId(r):u.generateUniqueAdId(r),r.adViewId=a,g(e)||function(e,n){var t=e.adViewId;h("loading ad to frame: "+t+" "+e.productType);var i=s.getAdUnitClassObj(e).class;n&&(i+="hidden "),l("<iframe />",{class:i,src:e.url}).data("id",t).data("close",!0).appendTo("body")}(e,i.preload)}function r(e){var n=!!g(e);return h("isContainerLoaded: "+n),n}function v(e){var n=l(".loaderOW");n.addClass("loaderOWFadeOut"),setTimeout(function(){h("hideLoader - enter timeOut"),l(".loaderOW").addClass("hidden"),n[0].offsetWidth=n[0].offsetWidth},600),l("#ssaLoaderWrap").addClass("hidden")}function m(e,n,t,i){v(),t(!1),d.set(n),e.removeClass("hidden").attr("id","displayedFrame"),i()}function b(e,n){e===o.OW?l(".loaderOW").removeClass("loaderOWFadeOut hidden"):l("#ssaLoaderWrap").removeClass("hidden")}function t(e,n,t){n&&(t=t||parent).postMessage(e,n.replace(/([^:]+:\/\/[^\/]+).*/,"$1"))}function h(e){a.log(c+e)}return{createAndLoadAdFrame:p,updateAdUnitUrl:function(e,n,t,i){var r;f(e,n,t,i),(r=g(e))?(h("updated iframe url for product "+t.productType),r[0].src=e.url):i.forceCreation?(h("cannot find iframe to update, creating new one"),p(e,n,t,i)):a.log(c+"cannot find iframe to update url")},displayAdView:function(e,n,t,i){var r=g(e);r.data("loaded")?(h("display frame"),l.when(i(e,!1)).done(function(){m(r,e,n,t)})):(h("display frame with loader"),d.set(e),l.when(i(e,!0)).done(function(){!function(e,n,t,i){if(e.data("loaded"))return m(e,n,t,i);t(!0),a.log(c+"display with loader, frame "+e.data("id")),n&&n.productType&&(b(n.productType),e.attr("id","displayedFrame"))}(r,e,n,t)}))},handleScreenVisible:function(e,n){e&&b(n.productType);var t=s.getDisplayedAdFrame();t&&(h("ad unit open error"),t.addClass("hidden").attr("id",""))},unloadAdView:function(t){var i=t.adViewId;h("unloading ad from frame | id:"+i+" pt: "+t.productType),l.each(l(s.getAdUnitClassObj(t).selector),function(e,n){return l(n).data("id")!==i||(t.engaged&&n.removeAttribute("id"),t.productType===o.OW?setTimeout(function(){n&&n.parentNode&&n.parentNode.removeChild(n)},0):n&&n.parentNode&&n.parentNode.removeChild(n),!1)})},displayLoader:b,hideLoader:v,hideView:s.hideFrame,displayView:s.displayFrame,isContainerLoaded:r,onAdUnitLoaded:function(e,n,t){var i=g(e);if(i)if(i.data("loaded"))h("already received the loaded event for frame");else{i.data("loaded",!0);var r=s.isFrameDisplayed(i);h("ad loaded: "+a.AdUtils.getAdId(e)+" | "+r?"frame Displayed: true":"frame Displayed: false|"+s.getAdUnitClassObj(e).selector),r&&m(i,e,n,t)}},getAdViewByAd:g,sendMessageToDisplayedAdView:function(e){var n=s.getDisplayedAdFrame();n&&t(JSON.stringify(e),"*",n[0].contentWindow)},sendMessageToAllAdViews:function(e){l.each(l(".ssaAdUnit"),function(){t(JSON.stringify(e),"*",this.contentWindow)})},getDisplayedAdView:s.getDisplayedAdFrame,isViewDisplayed:s.isFrameDisplayed,getContainerID:function(){return"1"},getContainerCreationHandler:function(e){h("_getContainerCreationHandler: ");var n=new S(l,a.log),t=n.getCreationStates(),i=r(e)?t.createdSuccessfully:t.notCreated;return n.setState(i),n}}}},{"./containers/ContainerCreationStateHandler":69}],30:[function(e,n,t){n.exports=function(r){var e=[];function a(n){return function(e){return e.demandSourceName===s(n)&&e.productType===n.productType}}function t(e){for(var n=0,t=0;t<e.length;t++)n+=e[t].counter;return n}function o(e){var n;return t(d().filter((n=e,function(e){return e&&e.productType===n})))}function n(e){var n;return t(d().filter((n=e,function(e){return e&&e.productType===n&&!0===e.isBiddingInstance})))}function s(e){return e.originalDemandSourceName||e.demandSourceName}function i(e){var n,t,i=d().filter(a(e));return 0<i.length?i[0]:(t={demandSourceName:s(n=e),productType:n.productType,isBiddingInstance:n.isInAppBidding,counter:0},d().push(t),t)}function d(){return e}return{getCountersByProduct:function(e){return{bidding:n(e),totalSessionImpressions:o(e)}},getTokenCounters:function(){return{biddingRVImpressions:n(r.RV),biddingISImpressions:n(r.IS),totalRVSessionImpressions:o(r.RV),totalISSessionImpressions:o(r.IS)}},getPayloadCounters:function(e){return{instanceImpressions:(n=e,t=0,i=d().filter(a(n)),0<i.length&&(t=i[0].counter),t),totalRVSessionImpressions:o(r.RV),totalISSessionImpressions:o(r.IS)};var n,t,i},setInstanceImpressionsCounter:function(e){var n=i(e);n&&n.counter++}}}},{}],31:[function(e,n,t){function i(e){var n=e,r=[],i=-1,t;function a(){return r.length}function o(){return r}function s(e){Array.isArray(e)&&(i=0,r=e)}function d(){return r[i]}function c(){return t}function l(e){t=e}function u(e){var n,t=p(e);return-1<t&&(n=r.splice(t,1)[0])&&(m()?i=-1:i<t?i=(i+1)%a():t<i&&i--),n}function f(e){var n=p(e);if(-1<n)return r[n]}function g(e,n){var t=p(n);if(-1<t)return r[t]=e,r[t]}function p(e){if(void 0===e)return-1;for(var n=0,t=a(),i=e.toString();n<t&&e;n++)if(r[n].id===i)return n;return-1}function v(){return!m()&&(i+1)%a()!==i}function m(){return 0===a()}function b(){r=[],i=-1,t=null}var h={getOffers:o,getCurrentOffer:d,getOfferById:f,getBackfillOffer:c,setOffers:s,setBackfillOffer:l,removeOfferById:u,replaceOfferById:g,isNextOfferAvailable:v,isEmpty:m,size:a,reset:b};return h}n.exports=i},{}],32:[function(e,n,t){n.exports=function(i,r){var a=0,o=0;function n(){return a}return{setLastDisplayedAdCampaignId:function(e,n,t){i.getApplicationExternalConfig().getABTestConfiguration(t,n).sendLastCampaignId&&t===r.IS&&(a=e,o=n)},getLastDisplayedAdCampaignId:n,shouldAddLastDisplayedAdCampaignIdToPayload:function(e){return i.getApplicationExternalConfig().getABTestConfiguration(e,o).sendLastCampaignId&&e===r.IS&&0!==n()}}}},{}],33:[function(e,n,t){function i(a){var o,s,d,c,l,u,r={none:0,error:1,info:2,verbose:3},f={0:"NONE",1:"ERROR",2:"INFO",3:"VERBOSE"};function g(e,n){var t=a.isDefined(e)?e:"Controller",i=a.isDefined(n)?f[n]:f[d];return d?"SupersonicAds "+t+" ["+i+"] :":""}return{init:function(e,n,t,i){l=window.console||{},o=e,c=n,u=i,(d=t)?(s=l.log,l.log=function(e){this.log(e,r.verbose)}):l.log=function(){}},log:function(e,n,t){var i,r;(window.productionDebug&&u&&u({url:"http://iron-debug-controller.com?log="+e,type:"pixel"}),n&&d<n)||(a.isString(e)||(e=JSON.stringify(e)),a.isFunction(s)&&"android"===o?s.call(l,g(t,n)+e):"android"!==o&&(i=g(t,n)+e,(r={eventName:"log",prefix:"logmessage"}).parameters={message:i,acknowledgeWith:"acknowledgeMessage",declineWith:"errorTest"},c&&c.postMessage(r)))},debugMsg:g,LogLevels:r,DebugLevels:f}}var r;n.exports=function(e){return r||(r=new i(e)),r}},{}],34:[function(f,e,n){e.exports=function(e,t){var i=f("./Constants.js"),r="moatAPI",n="moatStartTrackingSuccess",a="moatStartTrackingFail",o="moatStopTrackingSuccess",s=!1,d=!1,c=!1;function l(){return s}function u(){return d}return{initWithOptions:function(e){u()&&t.log("MOATService - initWithOptions MOAT is already initialized",t.LogLevels.verbose),c||(t.setAllowFileAccessFromFileURLs(!0),c=!0);var n=e||{};n.loggingEnabled="prod"!==t.getEnv()&&(t.getConfig().mobileSDKSettings.deviceOs!==i.deviceOs.ios||"true"),t.getConfig().mobileSDKSettings.deviceOs===i.deviceOs.android&&(n.disableAdIdCollection=!0),t.callSDKFunction(r,{moatFunction:"initWithOptions",moatParams:n}),d=!0},containsMOATData:function(e){return!!(e.ext&&e.ext.ivt&&e.ext.ivt.mt)},vastContainsMOATData:function(e){return e.ext&&e.ext.videoData&&e.ext.videoData.videoSource&&e.ext.videoData.videoSource.vast&&-1!==e.ext.videoData.videoSource.vast.indexOf("mt=")},createAdTracker:function(){l()&&t.callSDKFunction(r,{moatFunction:"createAdTracker"})},startTracking:function(){l()&&(e.PubSub.subscribe(i.CB+"."+n,function(e){t.log(r+" Start tracking success: "+JSON.stringify(e),t.LogLevels.verbose)}),e.PubSub.subscribe(i.CB+"."+a,function(e){t.log(r+" Start tracking fail: "+JSON.stringify(e),t.LogLevels.verbose)}),t.callSDKFunction(r,{moatFunction:"startTracking"},n,a))},stopTracking:function(){l()&&(e.PubSub.subscribe(i.CB+"."+o,function(e){t.log(r+"Stop tracking success: "+JSON.stringify(e),t.LogLevels.verbose)}),t.callSDKFunction(r,{moatFunction:"stopTracking"},o))},isTrackingEnabled:l,isInitialized:u,enableTracking:function(){s=d},disableTracking:function(){s=!1},extractMoatDataFromAd:function(e){var n={};return n.ids=e.ext.ivt.mt||{},n.publisherCode=e.ext.ivt&&e.ext.ivt.mtpcode?e.ext.ivt.mtpcode:i.MOAT_PC,n}}}},{"./Constants.js":12}],35:[function(e,n,t){function i(){var e,n={init:function(n,t,e){return this.receiveMessage(function(e){t.call(n,e)},e),this},postMessage:function(e,n,t){n&&(t=t||parent).postMessage(e,n.replace(/([^:]+:\/\/[^\/]+).*/,"$1"))},receiveMessage:function(n,t){n&&(e=function(e){"string"==typeof t&&e.origin!==t||"[object Function]"===Object.prototype.toString.call(t)&&!1===t(e.origin)||("function"!=typeof t||t(e.data))&&n(e)}),window.addEventListener?window[n?"addEventListener":"removeEventListener"]("message",e,!1):window[n?"attachEvent":"detachEvent"]("onmessage",e)}};return n}n.exports=i},{}],36:[function(F,e,n){function t(){var e=F("./Inventory.js"),r={},n=[],t,i;function a(){i=4}function o(){if(I())return Math.max(1,t-1)}function s(){if(0!==Object.keys(r).length)return r[o()]}function d(e){return I()&&w()?e?r[e].size():r[o()].size():0}function c(e){return I()&&w()?e?r[e].getOffers():r[o()].getOffers():[]}function l(){Array.isArray(n)&&n.length>i&&delete r[n.shift()]}function u(e,n){if(Array.isArray(e)&&0!==e.length){var t=void 0!==n?n:D();void 0===r[t]&&(t=D());for(var i=0;i<e.length;i++)e[i].inventoryId=t;return r[t].setOffers(e),t}}function f(e,n){if(e){var t=void 0!==n?n:D();return void 0===r[t]&&(t=D()),e.inventoryId=t,r[t].setBackfillOffer(e),t}}function g(e){if(I()&&w())return e?r[e].getCurrentOffer():r[o()].getCurrentOffer()}function p(e){if(I()&&w())return e?r[e].getBackfillOffer():r[o()].getBackfillOffer()}function v(e,n){if(I()&&w())return n?r[n].removeOfferById(e):r[o()].removeOfferById(e)}function m(e,n){if(I()&&w())return n?r[n].getOfferById(e):r[o()].getOfferById(e)}function b(e,n,t){if(I()&&w())return t?r[t].replaceOfferById(e,n):r[o()].replaceOfferById(e,n)}function h(e){return!(!I()||!w())&&(e?r[e].isNextOfferAvailable():r[o()].isNextOfferAvailable())}function S(e){return!I()||!w()||(e?r[e].isEmpty():r[o()].isEmpty())}function y(){n=[],r={},t=void 0}function A(e){var n=void 0!==e?e:o();n&&r[n]&&delete r[n]}function C(){return r}function D(){return r[t=t||1]=new e(t),n.push(t),t++,l(),t-1}function I(){return 0!==n.length&&void 0!==t}function w(){return void 0!==r[o()]}function P(){return i}function T(){return t}a();var O={getOffers:c,getCurrentOffer:g,getOfferById:m,getBackfillOffer:p,setOffers:u,setBackfillOffer:f,removeOfferById:v,replaceOfferById:b,isNextOfferAvailable:h,isEmpty:S,size:d,reset:y,getActiveInventoryId:o,getActiveInventory:s,removeInventory:A,getInventories:C,getAmountOfInventoriesAllowed:P,getAvailableInventoryId:T};return O}e.exports=t},{"./Inventory.js":31}],37:[function(e,n,t){n.exports=function(c,l,u,f){var g={successCallbackPrefix:"scallback_",failureCallbackPrefix:"fcallback_",ssaSchemePrefix:"supersonicads",acknowledgeMessage:"acknowledgeMessage",CB:"NativeCallback"};function d(e,n,t,i){if(l.Utils.isString(e)&&""!==e&&c){c.DemandUtils&&c.DemandUtils.isManualRewardedVideoIntegration()&&n&&(n=c.DemandUtils.setManualRewardedVideoTypeForNative(n));var r=l.Utils.isDefined(t)&&l.Utils.isString(t)?t:"",a=l.Utils.isDefined(i)&&l.Utils.isString(i)?i:"";(o={eventName:e,parameters:f.extend({success:r,fail:a},n)}).prefix=g.ssaSchemePrefix,l.Utils.isDefined(o.parameters)||(o.parameters={}),f.extend(o.parameters,{acknowledgeWith:l.Utils.isDefined(s)?s:g.acknowledgeMessage,declineWith:l.Utils.isDefined(d)?d:"errorTest"}),u.postMessage(o)}var o,s,d}function p(){return Date.now()+""+Math.random()}return{callSDKFunction:d,callSDKService:function(e,n,t,i,r){t&&(t.functionName=n),d(e,t,i,r)},callSDKFunctionWithCallback:function(n,e,t,i){if(c.log("NativeAPIAdapter | _callSDKFunctionWithCallback | Native API: "+n),l.Utils.isFunction(t)||l.Utils.isFunction(i)){var r=g.successCallbackPrefix+p(),a=g.failureCallbackPrefix+p(),o=l.PubSub.subscribe(g.CB+"."+r,function(e){l.PubSub.unsubscribe(o),l.PubSub.unsubscribe(s),t(e)}),s=l.PubSub.subscribe(g.CB+"."+a,function(e){c.log("NativeAPIAdapter | callSDKFunctionWithCallback | received failure callback for function: "+a),e&&e.errMsg&&c.log("Error calling "+n,c.LogLevels.error),l.PubSub.unsubscribe(s),l.PubSub.unsubscribe(o),i(e)});d(n,e,r,a)}else c.log("NativeAPIAdapter | failed to call sdk function - no callbacks parameters")},acknowledgeMessage:function(e){u.acknowledgeMessage(e)}}}},{}],38:[function(e,n,t){n.exports={CB:"NativeCallback",serviceCallback:"serviceCallback",NativeAPI:{onNativeLifeCycleEvent:"onNativeLifeCycleEvent"},AndroidEvents:{onStart:"onStart",onPause:"onPause",onResume:"onResume",onDestroy:"onDestroy"}}},{}],39:[function(c,e,n){e.exports=function(e,i,n){var t=c("./NativeLifeCycleEventsConstants.js"),r=i.jQuery(),a=[],o=new(c("./AndroidLifeCycleEventHandlers.js"))(e,i,n);function s(){e.PubSub.subscribe(t.CB+"."+t.NativeAPI.onNativeLifeCycleEvent,function(e){var n,t;i.log("LifeCycleEventsService | received new event: "+JSON.stringify(e),i.LogLevels.info),e&&(n=e.lifeCycleEvent,t=e,d(n)&&o.publishEvent(n,t))})}function d(e){return e&&-1<r.inArray(e,a)}return{init:function(){s()},startNotify:function(e){i.log("LifeCycleEventsService | startNotify | event: "+e,i.LogLevels.info),d(e)||a.push(e)},stopNotify:function(e){i.log("LifeCycleEventsService | stopNotify | event: "+e,i.LogLevels.info),d(e)&&a.splice(r.inArray(e,a),1)}}}},{"./AndroidLifeCycleEventHandlers.js":5,"./NativeLifeCycleEventsConstants.js":38}],40:[function(r,e,n){e.exports=function(t,i){return{create:function(e){var n=e.deviceOs;return n===i.deviceOs.ios&&null===e.safeAreaInsets?new(r("../patches/PatchesIphoneX.js"))(t,e,i):new(r("./NotchService.js"))(t,e.safeAreaInsets,i,n)}}}},{"../patches/PatchesIphoneX.js":171,"./NotchService.js":41}],41:[function(e,n,t){n.exports=function(e,n,t,i){var r=!1;function a(){return i!==t.deviceOs.android&&r}return function(){if(i!==t.deviceOs.android){var e=t.notchSettings.safeAreaInsetsMin;r=n.top>e||n.bottom>e||n.right>e||n.left>e}}(),{hasNotch:a,onEngageEnd:function(){i!==t.deviceOs.android&&a()},onSetConfig:function(e){return i!==t.deviceOs.android&&a()&&(n=e).settings&&n.settings.standaloneView;var n},className:"NotchService"}}},{}],42:[function(e,n,t){n.exports={omidNativeFunction:"omidAPI",activateSuccessKey:"omidActivateSuccess",activateFailKey:"omidActivateFail",startSessionSuccessKey:"omidStartSessionSuccess",startSessionFailKey:"omidStartSessionFail",finishSessionSuccessKey:"omidFinishSessionSuccess",finishSessionFailKey:"omidFinishSessionFail",impressionOccurredSuccessKey:"omidimpressionOccurredSuccess",impressionOccurredFailKey:"omidimpressionOccurredFail",omidFailedToLoadBundleMessage:"Failed to load OMID JS Bundle",omidFailedToDownloadMessage:"Failed to download and cache OMID JS Bundle",omidFailureInStartSession:"Failure in starting session",omidFailureInFinishSession:"Failure in finishing session",omidFailureInImpressionOccurred:"Failure in impression occurred",omidBundleFilePrefix:"omid-daemon-",omidBundleFileType:".js",stopOMIDServiceDelay:1e3,omidPartnerName:"Ironsrc",omidPartnerVersion:"6",omidServiceName:"omid",omidBundleDefaultVersionKey:"default",omidVersionMapping:{"1.2.22-Ironsrc":"1.0.0","1.3.12-Ironsrc":"1.3.12",default:"1.0.0"},omidVersionRequiresWebviewPerAd:{"1.2.22-Ironsrc":!1,"1.3.12-Ironsrc":!0,default:!1},omidVersionIsControllerDownloadOMSDK:{"1.2.22-Ironsrc":!0,"1.3.12-Ironsrc":!1,default:!1}}},{}],43:[function(e,n,t){n.exports=function(r,a,o){var s,d=e("./Constants.js"),c=e("./OMIDConstants"),l=!1,u=!1,f="",g=d.omidPartnerVersion,p="",n=null,v=null,m=null,b=null,h=null;function t(){if(!l){if(v&&"pending"===v.state())return v;v=new o.Deferred,a.log("OMIDService - activate",a.LogLevels.verbose);var t=r.PubSub.subscribe(d.CB+"."+c.activateSuccessKey,function(e){var n;f=e&&e.omidVersion?e.omidVersion:"",g=e&&e.omidPartnerVersion?e.omidPartnerVersion:d.omidPartnerVersion,l=!0,r.PubSub.clearHandlers([t,i]),r.PubSub.subscribe("SDKController.OMIDStartSession",function(e){S(e)}),r.PubSub.subscribe("SDKController.OMIDFinishSession",function(){y()}),r.PubSub.subscribe("SDKController.OMIDImpressionOccurred",function(e){!function(e){if(!A()||!l||!u){var n=c.omidFailureInImpressionOccurred+" didLoadOMSDKService "+A()+" omidServiceActivated "+l+" isSessionStarted "+u;return r.PubSub.publish("SDKController.onOmidServiceFailure",[n])}if(!h||"pending"!==h.state()){h=new o.Deferred;var t=r.PubSub.subscribe(d.CB+"."+c.impressionOccurredSuccessKey,function(e){r.PubSub.clearHandlers([t,i]),a.log(c.omidNativeFunction+" Impression Occurred success: "+JSON.stringify(e),a.LogLevels.verbose),h.resolve()}),i=r.PubSub.subscribe(d.CB+"."+c.impressionOccurredFailKey,function(e){r.PubSub.clearHandlers([t,i]);var n=e&&e.errMsg?e.errMsg:"";a.log(c.omidNativeFunction+" Impression Occurred fail: "+JSON.stringify(e),a.LogLevels.verbose),r.PubSub.publish("SDKController.onOmidServiceFailure",[n]),h.reject()});a.callSDKFunction(c.omidNativeFunction,{omidFunction:"impressionOccurred",omidParams:e},c.impressionOccurredSuccessKey,c.impressionOccurredFailKey),h.promise()}}(e)}),n=C(f),p=s.getExternalLibrariesUrl()+c.omidServiceName+"/"+n+"/"+c.omidServiceName+c.omidBundleFileType,a.log(c.omidNativeFunction+" activate success: "+JSON.stringify(e),a.LogLevels.verbose),v.resolve()}),i=r.PubSub.subscribe(d.CB+"."+c.activateFailKey,function(e){r.PubSub.clearHandlers([t,i]);var n=e&&e.errMsg?e.errMsg:"";a.log(c.omidNativeFunction+" activate session fail: "+JSON.stringify(e),a.LogLevels.verbose),r.PubSub.publish("SDKController.onOmidServiceFailure",[n]),v.reject()});return a.callSDKFunction(c.omidNativeFunction,{omidFunction:"activate",omidParams:{}},c.activateSuccessKey,c.activateFailKey),v.promise()}a.log("OMIDService - activate OMID is already initialized",a.LogLevels.verbose)}function S(e){if(A()&&l){if(m&&"pending"===m.state())return m;m=new o.Deferred,a.log("OMIDService - startSession",a.LogLevels.verbose);var t=r.PubSub.subscribe(d.CB+"."+c.startSessionSuccessKey,function(e){r.PubSub.clearHandlers([t,i]),u=!0,a.log(c.omidNativeFunction+" Start session success: ",a.LogLevels.verbose),m.resolve()}),i=r.PubSub.subscribe(d.CB+"."+c.startSessionFailKey,function(e){r.PubSub.clearHandlers([t,i]),u=!1,P();var n=e&&e.errMsg?e.errMsg:"";a.log(c.omidNativeFunction+" Start session fail: "+JSON.stringify(e),a.LogLevels.verbose),r.PubSub.publish("SDKController.onOmidServiceFailure",[n]),m.reject()});return a.callSDKFunction(c.omidNativeFunction,{omidFunction:"startSession",omidParams:e},c.startSessionSuccessKey,c.startSessionFailKey),m.promise()}var n=c.omidFailureInStartSession+" didLoadOMSDKService "+A()+" omidServiceActivated "+l;r.PubSub.publish("SDKController.onOmidServiceFailure",[n])}function y(){if(A()&&l&&u){if(b&&"pending"===b.state())return b;b=new o.Deferred,a.log("OMIDService - finishSession",a.LogLevels.verbose);var t=r.PubSub.subscribe(d.CB+"."+c.finishSessionSuccessKey,function(e){r.PubSub.clearHandlers([t,i]),u=!1,a.log(c.omidNativeFunction+" Finish session success: "+JSON.stringify(e),a.LogLevels.verbose),b.resolve()}),i=r.PubSub.subscribe(d.CB+"."+c.finishSessionFailKey,function(e){r.PubSub.clearHandlers([t,i]),u=!1,P();var n=e&&e.errMsg?e.errMsg:"";a.log(c.omidNativeFunction+" Finish session fail: "+JSON.stringify(e),a.LogLevels.verbose),r.PubSub.publish("SDKController.onOmidServiceFailure",[n]),b.reject()});return a.callSDKFunction(c.omidNativeFunction,{omidFunction:"finishSession"},c.finishSessionSuccessKey,c.finishSessionFailKey),b.promise()}var e=c.omidFailureInFinishSession+" didLoadOMSDKService "+A()+" omidServiceActivated "+l+" isSessionStarted "+u;r.PubSub.publish("SDKController.onOmidServiceFailure",[e])}function i(){return c.omidVersionIsControllerDownloadOMSDK[f]?c.omidVersionIsControllerDownloadOMSDK[f]:c.omidVersionIsControllerDownloadOMSDK[c.omidBundleDefaultVersionKey]}function A(){return!i()||window.OmidDaemon&&"function"==typeof window.OmidDaemon.start&&"function"==typeof window.OmidDaemon.stop}function C(e){var n=c.omidVersionMapping[e];return n||(n=c.omidVersionMapping[c.omidBundleDefaultVersionKey],a.log("OMID.Service.Warnnig: version from mapping not found .choose.default - "+n)),n}function D(){return l?p:""}function I(){a.log("SDKController.onLoadSuccessOmidBundle"),window.OmidDaemon&&window.OmidDaemon.start({partnerName:c.omidPartnerName,partnerVersion:g})}function w(){a.log("SDKController.onLoadFailureOmidBundle"),r.PubSub.publish("SDKController.onOmidServiceFailure",[c.omidFailedToLoadBundleMessage])}function P(){window.OmidDaemon&&window.OmidDaemon.reset()}return{isSupported:function(e,n){return!a.isLegacy(a.featureMap.OMID)&&(t=e)&&t.omidEnabled;var t},isNativeServiceActivated:function(){return l},getVersionData:function(){return{omidVersion:f,omidPartnerVersion:g}},startSession:S,finishSession:y,isAdOmidSupported:function(e){return e&&e.ext&&e.ext.ivt&&e.ext.ivt.omid},downloadOmidJsBundle:function(){if(!l)return r.Utils.returnResolvedPromise();if(i()&&A())return r.Utils.returnResolvedPromise();if(n&&"rejected"!==n.state())return n;n=new o.Deferred;var e=D();return a.libsManager.updateFileVersionByFilePathForThirdPartyLibraries(c.omidServiceName,e,C(f)).then(a.libsManager.manageDownloadLibsFileByFiletype.bind(null,c.omidServiceName)).then(function(){!function(){var e=s.getCacheLibsPath()+c.omidServiceName+c.omidBundleFileType,n=i();if(A()||!g||!n)return r.Utils.returnResolvedPromise();r.Utils.getScript(e,I,w)}(),n.resolve()},function(){r.PubSub.publish("SDKController.onOmidServiceFailure",[c.omidFailedToDownloadMessage]),n.reject()}),r.Utils.returnResolvedPromise()},init:function(e){s=e,t()},getOmidBundleUrl:D}}},{"./Constants.js":12,"./OMIDConstants":42}],44:[function(e,n,t){n.exports=function(){var i,r={iframe:"#adSandbox",url:"",adData:"",templateClass:"obfuscationIframe",src:"{{url}}",frameBorder:"0",scrolling:"no",style:{},id:""},a={};return{init:function(e,n){if((a=jQuery.extend(r,e)).adData&&""!==a.adData){var t=a.src.replace("{{url}}",a.url);(i=jQuery("<iframe />",{id:a.id,class:a.templateClass,src:t,scrolling:a.scrolling,frameborder:a.frameBorder}).css(a.style)).on("load",function(){n(i)}),document.documentElement.appendChild(i[0])}},removeIframe:function(e){if(e){var n=document.getElementById(e);n&&n.parentNode.removeChild(n)}}}}},{}],45:[function(e,n,t){n.exports=function(o){var s=e("./Constants.js");return{open:function(e){if(e&&e.type){if("openUrl"!==e.type)return!1;var n,t=e.callback;e.method||(o.getApiData({deviceOs:1}).deviceOs===s.deviceOs.ios?!e.appId||!o.isLegacy(o.featureMap.hybrid)&&o.isLegacy({ios:"5.38",android:"99"})?e.method=s.openUrlMethods.external_browser:e.method=s.openUrlMethods.storeKit:e.method=s.openUrlMethods.store);var i=(r=e,(a={default:{}})[s.openUrlMethods.storeKit]={appId:r.appId,viewUniqueId:o.StoreKitService.getViewUniqueId(r)},a[s.openUrlMethods.external_browser]={},a[s.openUrlMethods.store]={},a[s.openUrlMethods.webview]={controls:!0},a[r.method]||a.default);return n=jQuery.extend({url:e.url,method:e.method},i),o.openUrl(n,t),!0}var r,a;return!1},openForOW:function(e){if(e&&e.type&&"openUrl"===e.type){var n={},t=e.callback;return n=e.externalBrowser?{url:e.url,controls:!0,method:"external_browser"}:e.method===s.openUrlMethods.external_browser?{url:e.url,method:"external_browser"}:e.install?"ios"===o.getApiData({deviceOs:1}).deviceOs?{url:e.url,controls:!0,method:"external_browser"}:{url:e.url,controls:!0,method:"store"}:{url:e.url,controls:!0,method:"webview"},o.openUrl(n,t),!0}return!1}}}},{"./Constants.js":12}],46:[function(e,n,t){n.exports={NativeAPI:{failCallback:"handleAppOrientationDataFailed",successCallback:"handleAppOrientationDataSuccess",oldApiSuccessCallback:"getOrientationSuccess"},ControllerNativeAPI:{getAppOrientationData:"getAppOrientationData",oldSetOrientation:"setOrientation",oldGetOrientation:"getOrientation",setAppOrientation:"setAppOrientation"},eventicsCategories:{failCallback:{name:"AppOrientationFailed",id:263},successCallback:{name:"AppOrientationSuccess",id:264}},iosOrientationsMap:{UIInterfaceOrientationPortrait:2,UIInterfaceOrientationPortraitUpsideDown:4,UIInterfaceOrientationLandscapeLeft:16,UIInterfaceOrientationLandscapeRight:8},iosOrientations:{2:"Portrait",4:"PortraitUpsideDown",16:"LandscapeLeft",8:"LandscapeRight"},appOrientationAPI:"appOrientationAPI"}},{}],47:[function(e,n,t){n.exports=function(a,o,s){var t,d=e("./OrientationConstants.js"),i=!1,c=s.CB;function r(e){o.log("_setAppOrientation | send orientation: "+e,o.LogLevels.info),o.callSDKFunction(d.ControllerNativeAPI.setAppOrientation,{appOrientation:e})}return{init:function(e,n){e&&!i&&(a.PubSub.subscribe(c+"."+d.NativeAPI.successCallback,function(e){t.trackEvent(d.eventicsCategories.successCallback),e||(o.log("getAppOrientationData | Orientation data structure not exist.",o.LogLevels.info),t.trackEvent(d.eventicsCategories.failCallback))}),a.PubSub.subscribe(c+"."+d.NativeAPI.failCallback,function(e){o.log("getAppOrientationData failed, errorMsg:"+e.errMsg,o.LogLevels.info),t.trackEvent(d.eventicsCategories.failCallback)}),a.PubSub.subscribe("AppOrientationManager.appOrientationChanged",function(e){e&&e.appOrientation&&(o.log("appOrientationChanged | updating native with orientation: "+e.appOrientation,o.LogLevels.info),r(e.appOrientation))}),t=n,i=!0)},getAppOrientationData:function(){o.callSDKFunction(d.ControllerNativeAPI.getAppOrientationData,{},d.NativeAPI.successCallback,d.NativeAPI.failCallback)},setOrientation:function(e){o.callSDKFunction(d.ControllerNativeAPI.oldSetOrientation,{orientation:e})},oldGetOrientation:function(){var t=new jQuery.Deferred,i=a.PubSub.subscribe(c+"."+d.NativeAPI.oldApiSuccessCallback,function(e){if(a.PubSub.unsubscribe(i),"resolved"!==t.state()){clearTimeout(r);var n=e&&e.orientation||s.appInfo.orientation.portrait;t.resolve(n)}}),r=setTimeout(function(){t.resolve(s.appInfo.orientation.portrait)},2e3);return o.callSDKFunction(d.ControllerNativeAPI.oldGetOrientation,null,d.NativeAPI.oldApiSuccessCallback,d.NativeAPI.oldApiSuccessCallback),t.promise()},setAppOrientation:r}}},{"./OrientationConstants.js":46}],48:[function(e,n,t){n.exports=function(){var a=e("./OrientationConstants.js");function o(e){var n=parseInt(e.replace(/^"|"$/g,"")),t=[],i=n.toString(2);if(i.length>Object.keys(a.iosOrientations).length+1||"0"!==i.substr(i.length-1,1))return[];for(var r in a.iosOrientations)(n|r)===n&&t.push(a.iosOrientations[r]);return t}var n=function(n,e){return e.some(function(e){return 0<=n.indexOf(e)})};return{convertOrientationsArrayToNumber:function(e){var i=0;return e.forEach(function(e){var n,t;i+=Number((n=a.iosOrientations,t=e,Object.keys(n).filter(function(e){return n[e]===t})))}),i},convertNumberToOrientations:o,isContainPortrait:function(e){return n(o(e),[a.iosOrientations[2],a.iosOrientations[4]])},isContainLandscape:function(e){return n(o(e),[a.iosOrientations[8],a.iosOrientations[16]])},sharedOrientationBetweenOrientations:function(e,n){var t=o(e),i=o(n),r=t.filter(function(e){return-1<i.indexOf(e)});return r||(r=[]),r}}}},{"./OrientationConstants.js":46}],49:[function(e,n,t){n.exports=function(r,a){var i,o=e("./Constants.js"),s=e("./PermissionsConstants.js"),d=s.nativeFunction,c={};return{getPermissions:function(){if(i&&"pending"===i.status)return i;i=new jQuery.Deferred;var e,n=r.PubSub.subscribe(o.CB+"."+s.handleGetPermissionsSuccess,function(e){a.log(s.handleGetPermissionsSuccess+": "+JSON.stringify(e)),r.PubSub.unsubscribe(n),r.PubSub.unsubscribe(t),i.resolve(e)}),t=r.PubSub.subscribe(o.CB+"."+s.handleGetPermissionsFailure,function(e){a.log(s.handleGetPermissionsFailure+": "+JSON.stringify(e)),r.PubSub.unsubscribe(t),r.PubSub.unsubscribe(n),i.reject(e)});return a.callSDKFunction(s.nativeFunction,{functionName:s.NativeAPI.getPermissions,functionParams:(e=a.getConfig().mobileSDKSettings.deviceOs===o.deviceOs.ios?o.deviceOs.ios:o.deviceOs.android,{permissions:s.supportedPermissions[e]})},s.handleGetPermissionsSuccess,s.handleGetPermissionsFailure),i.promise()},isPermissionGranted:function(e){if(!e)return!1;if(c[e]&&"pending"===c[e].status)return c[e];c[e]=new jQuery.Deferred;var t=r.PubSub.subscribe(o.CB+"."+s.handleIsPermissionGrantedSuccess,function(e){if(e&&e.permission){var n=e.permission;c[n]?(a.log(s.handleIsPermissionGrantedSuccess+": "+JSON.stringify(e)),r.PubSub.unsubscribe(t),r.PubSub.unsubscribe(i),c[n].resolve(e)):a.log("Unrecognised permission name "+n,a.LogLevels.error)}}),i=r.PubSub.subscribe(o.CB+"."+s.handleIsPermissionGrantedFailure,function(e){if(e&&e.permission){a.log(d+s.NativeAPI.isPermissionGranted+JSON.stringify(e),a.LogLevels.verbose);var n=e.permission;c[n]?(r.PubSub.unsubscribe(i),r.PubSub.unsubscribe(t),c[n].reject(e)):a.log("Unrecognised permission name "+n,a.LogLevels.error)}else e&&e.errMsg&&a.log("Error calling isPermissionGranted "+e.errMsg,a.LogLevels.error)});return a.callSDKFunction(s.nativeFunction,{functionName:s.NativeAPI.isPermissionGranted,functionParams:{permission:e}},s.handleIsPermissionGrantedSuccess,s.handleIsPermissionGrantedFailure),c[e].promise()}}}},{"./Constants.js":12,"./PermissionsConstants.js":50}],50:[function(e,n,t){n.exports={CB:"NativeCallback",NativeAPI:{getPermissions:"getPermissions",isPermissionGranted:"isPermissionGranted"},nativeFunction:"permissionsAPI",supportedPermissions:{ios:["NSCameraUsageDescription","NSLocationAlwaysUsageDescription","NSLocationWhenInUseUsageDescription","NSLocationAlwaysAndWhenInUseUsageDescription","NSMicrophoneUsageDescription"],android:[]},handleGetPermissionsSuccess:"handleGetPermissionsSuccess",handleGetPermissionsFailure:"handleGetPermissionsFailure",handleIsPermissionGrantedSuccess:"handleIsPermissionGrantedSuccess",handleIsPermissionGrantedFailure:"handleIsPermissionGrantedFailure"}},{}],51:[function(e,n,t){n.exports=function(t){return{firePixel:function(e){if(void 0!==e.url&&""!==e.url){if("pixel"===e.type){var n=new Image;""===e.at||isNaN(parseInt(e.at))?n.src=e.url:(n.src=e.url,n.time=e.at)}}else t.log("Missing callback data. At: directive ssaPixel"+(new Date).getTime(),t.LogLevels.info)}}}},{}],52:[function(e,n,t){function i(r){var a={},t,o,e={init:function(){o=jQuery,t=this},publish:function(n,e){o=o||jQuery;try{var t=o.extend(!0,[],a[n]);o.each(t,function(){this.apply(o,e||[])})}catch(e){if(r.Utils.isDefined(e)){r.log({type:"in PubSub "+n,data:e.message,trace:e.stack});var i={name:e.name,message:e.stack};window.onerror(e.name+": "+e.message,null,null,null,i)}}},subscribe:function(e,n){return a[e]||(a[e]=[]),a[e].push(n),[e,n]},unsubscribe:function(n){if(n){var t=n[0];a[t]&&o.each(a[t],function(e){a[t][e]===n[1]&&a[t].splice(e,1)})}},subscribeOnce:function(e,n){var t=this,i=this.subscribe(e,function(){n(),t.unsubscribe(i)})},clearHandlers:function(e){jQuery.each(e,function(e,n){t.unsubscribe(n)})}};return e}n.exports=i},{}],53:[function(e,n,t){n.exports={CB:"NativeCallback",NativeAPI:{startListenerSuccessKey:"startListenerSuccess",startListenerFailKey:"startListenerFailed",stopListenerSuccessKey:"stopListenerSuccess",stopListenerFailKey:"stopListenerFailed",initSuccessKey:"initSuccess",initFailKey:"initFailed",statusChanged:"ringerSwitchStatusChanged"},ControllerNativeAPI:{startListener:"startListener",stopListener:"stopListener",init:"init"},eventicsCategories:{startListenerFail:{name:"startListenerFail",id:263},stopListenerFail:{name:"stopListenerFail",id:264},initFail:{name:"initRingerFail",id:265}},notifyAdunitOnState:"ringerSwitchState",ringerNativeFunction:"ringerSwitchAPI"}},{}],54:[function(e,n,t){n.exports=function(n,t){var i,r,a,o=e("./RingerSwitchConstants.js"),s=!0,d=!1,c=1e3,l=!1;function u(e){t.postAdUnitEvent({name:o.notifyAdunitOnState,isRingerSwitchSilent:e})}return{init:function(){var e;d||(n.PubSub.subscribe(o.CB+"."+o.NativeAPI.statusChanged,function(e){e&&(s=e.ringerSwitchSilent,l&&!s?r=setTimeout(function(){u(s)},i):(r&&clearTimeout(r),u(s)))}),n.PubSub.subscribe(o.CB+"."+o.NativeAPI.startListenerSuccessKey,function(e){t.log("Ringer | start detecting function performed successfully.",t.LogLevels.info)}),n.PubSub.subscribe(o.CB+"."+o.NativeAPI.startListenerFailKey,function(e){a.trackEvent(o.eventicsCategories.startListenerFail),e&&t.log("Ringer start detecting failed to perform, errorMsg:"+e.errMsg,t.LogLevels.info)}),n.PubSub.subscribe(o.CB+"."+o.NativeAPI.stopListenerSuccessKey,function(e){t.log("Ringer stop detecting successfully.",t.LogLevels.info)}),n.PubSub.subscribe(o.CB+"."+o.NativeAPI.stopListenerFailKey,function(e){a.trackEvent(o.eventicsCategories.stopListenerFail),e&&t.log("Ringer stop detecting failed to perform, errorMsg:"+e.errMsg,t.LogLevels.info)}),n.PubSub.subscribe(o.CB+"."+o.NativeAPI.initSuccessKey,function(e){t.log("Ringer prepare detector successfully.",t.LogLevels.info)}),n.PubSub.subscribe(o.CB+"."+o.NativeAPI.initFailKey,function(e){a.trackEvent(o.eventicsCategories.initFail),e&&t.log("Ringer prepare detector failed to perform, errorMsg:"+e.errMsg,t.LogLevels.info)}),t.log("Ringer | calling init native function",t.LogLevels.info),t.callSDKFunction(o.ringerNativeFunction,{functionName:o.ControllerNativeAPI.init},o.NativeAPI.initSuccessKey,o.NativeAPI.initFailKey),e={productChance:(t.getEnv(),1),baseData:{}},a=n.Eventics.createEventic(e,t.EventsManager),d=!0)},startListener:function(e){t.postAdUnitEvent({name:o.notifyAdunitOnState,isRingerSwitchSilent:s}),l=e&&e.shouldSetRingerUpdateDelay,i=e&&e.ringerUpdateDelay||c,t.log("Ringer | Set listener config to should delay?"+l+", with delay "+i,t.LogLevels.verbose),t.callSDKFunction(o.ringerNativeFunction,{functionName:o.ControllerNativeAPI.startListener},o.NativeAPI.startListenerSuccessKey,o.NativeAPI.startListenerFailKey)},stopListener:function(){l=!1,i=c,t.callSDKFunction(o.ringerNativeFunction,{functionName:o.ControllerNativeAPI.stopListener},o.NativeAPI.stopListenerSuccessKey,o.NativeAPI.stopListenerFailKey)},isInitiated:function(){return d}}}},{"./RingerSwitchConstants.js":53}],55:[function(e,n,t){n.exports=function(s,r,d){var a=e("../storeKit/SKANModel")(),c=e("../storeKit/SKANConstants"),o=e("../../constants/SDKFeatureNames");function l(e){if(!r.isIOS())return!1;var n,t=parseFloat(r.getConfig().mobileSDKSettings.deviceOSVersion)>=c.SKAdImpression.minimalSupportedIOSVersion,i=r.CompatibilityService.isFeatureSupportedInNativeSDK(o.SKAdImpression);return!!(t&&i&&(n=e).ext&&n.ext.SKANData&&n.ext.SKANData.VTA)}function u(e,n,t,i){r.callSDKService(c.SKAdImpression.jsInterface,e,{impressionData:a.extractDataForSKAdImpression(n)},t,i)}return{startImpression:function(e,n,t){if(e&&l(e)){var i=e.adViewId||Date.now(),r=c.SKAdImpression.startImpressionSuccess+"."+i,a=c.SKAdImpression.startImpressionFailed+"."+i,o=[];o.push(s.PubSub.subscribe(d.CB+"."+r,function(){s.PubSub.clearHandlers(o),s.Utils.isFunction(n)&&n()})),o.push(s.PubSub.subscribe(d.CB+"."+a,function(e){s.PubSub.clearHandlers(o),s.Utils.isFunction(t)&&t(e)})),u(c.SKAdImpression.startImpression,e,r,a)}},endImpression:function(e,n,t){if(e&&l(e)){var i=e.adViewId||Date.now(),r=c.SKAdImpression.endImpressionSuccess+"."+i,a=c.SKAdImpression.endImpressionFailed+"."+i,o=[];o.push(s.PubSub.subscribe(d.CB+"."+r,function(){s.PubSub.clearHandlers(o),s.Utils.isFunction(n)&&n()})),o.push(s.PubSub.subscribe(d.CB+"."+a,function(e){s.PubSub.clearHandlers(o),s.Utils.isFunction(t)&&t(e)})),u(c.SKAdImpression.endImpression,e,r,a)}}}}},{"../../constants/SDKFeatureNames":89,"../storeKit/SKANConstants":83,"../storeKit/SKANModel":84}],56:[function(e,n,t){var b=e("./SKOverlayConstants"),h=b.configKeys;n.exports=function(e,n,t,i,r,a,o){if(e&&n){var s,d=e,c=n,l=t||b.position.bottom,u=r||{},f=!!i,g=a||((s={})[b.delayConfigKeys.initialDelay]=0,s[b.delayConfigKeys.subsequentDelay]=0,s),p=o||b.flow.presentOnSKClose,v=null,m=null;return{getOverlayId:function(){return d},getAdvertisedAppId:function(){return c},getConfigObjectForSDK:function(){var e={};return e[h.overlayId]=d,e[h.advertisedAppId]=c,e[h.position]=l,e[h.userDismissible]=f,e[h.SKANData]=u,e},isQualityClickTriggered:function(){return v},setQualityClickTriggered:function(){v=!0},getDismissInitiatedSource:function(){return m},setDismissInitiatedSource:function(e){m=e},getPresentationDelay:function(e){return e?g[b.delayConfigKeys.initialDelay]:g[b.delayConfigKeys.subsequentDelay]},getFlow:function(){return p}}}}},{"./SKOverlayConstants":57}],57:[function(e,n,t){var i=e("../../components/Constants");n.exports={minimalSupportedIOSVersion:14,supportedProductTypes:[i.RV,i.IS],configKeys:{overlayId:"overlayId",advertisedAppId:"advertisedAppId",position:"position",userDismissible:"userDismissible",SKANData:"SKANData"},position:{bottom:0,bottomRaised:1},flow:{presentOnSKClose:0,presentOnSKCloseAndQC:1,presentOnAdVisible:2},externalConfigKeys:{enableSKOverlay:"enableSKOverlay",SKOverlayPosition:"SKOverlayPosition",SKOverlayUserDismissible:"SKOverlayUserDismissible",delayInSecToPresentSKOverlay:"delayInSecToPresentSKOverlay",SKOverlayFlow:"SKOverlayFlow"},delayConfigKeys:{initialDelay:"initialDelay",subsequentDelay:"subsequentDelay"},overlayDismissInitiatedType:{user:0,SKOpen:1,adClose:2},messages:{SDK:{incoming:{overlayCreated:"overlayCreated",overlayCreateFailed:"overlayCreateFailed",overlayLoadFailed:"overlayLoadFailed",overlayDidFinishPresentation:"overlayDidFinishPresentation",overlayDidFinishDismissal:"overlayDidFinishDismissal",overlayRemoved:"overlayRemoved"},outgoing:{jsInterface:"SKOverlayAPI",createOverlay:"createOverlay",presentOverlay:"presentOverlay",dismissOverlay:"dismissOverlay",removeOverlay:"removeOverlay"}},adunit:{outgoing:{overlayCreateCalled:"overlayCreateCalled",overlayCreateSuccess:"overlayCreateSuccess",overlayCreateFailed:"overlayCreateFailed",overlayVisibleCalled:"overlayVisibleCalled",overlayVisibleSuccess:"overlayVisibleSuccess",overlayVisibleFailed:"overlayVisibleFailed",overlayDismissed:"overlayDismissed"}}}}},{"../../components/Constants":12}],58:[function(N,e,n){e.exports=function(f,g,p){var v="SKOverlayManager | ",m=N("../../components/SKOverlay/SKOverlay"),b=N("./SKOverlayConstants"),s=N("../../components/storeKit/SKANModel")(),e=N("../../constants/SDKFeatureNames"),o=new(N("../../modules/DemandSource/EventCategories.js")),n=!1,h=[],t=null,d=null,i=null,r=null,c=null,S=null,y=!1;function A(e,n){return n&&n.overlayId===e}function a(){return g.isIOS()&&g.getConfigurationHelper().getDeviceApiLevel()>=b.minimalSupportedIOSVersion&&g.CompatibilityService.isFeatureSupportedInNativeSDK(e.SKOverlay)}function l(e){return!(!(e&&e.settings&&e.settings.hasOwnProperty(b.externalConfigKeys.enableSKOverlay))||e.productType&&-1===b.supportedProductTypes.indexOf(e.productType)||!(e.ext&&e.ext.clickTags&&e.ext.clickTags.storeAppId)||!0!==e.settings[b.externalConfigKeys.enableSKOverlay]&&"true"!==e.settings[b.externalConfigKeys.enableSKOverlay])}function u(e,n,t,i,r,a,o){var s=[],d=e,c=new m(d,n,t,i,r,a,o);if(c){var l=b.messages.SDK.incoming.overlayCreated,u=b.messages.SDK.incoming.overlayCreateFailed;return s.push(f.PubSub.subscribe(p.CB+"."+l,function(e){var n;A(d,e)&&(g.log(v+"_createOverlay | "+l+"   "+JSON.stringify(e)),function(e){if(!e)return g.log(v+"Failed to add overlay to overlays array");h.push(e)}(c),O(b.messages.adunit.outgoing.overlayCreateSuccess,e),c.getFlow()===b.flow.presentOnSKCloseAndQC&&(n=d,S=f.PubSub.subscribe("SDKController.qcTriggered",function(){var e=P(n);e&&e.setQualityClickTriggered()})),c.getFlow()===b.flow.presentOnAdVisible&&T(c,!0),y=!1,f.PubSub.clearHandlers(s))})),O(b.messages.adunit.outgoing.overlayCreateCalled,c.getConfigObjectForSDK()),F(b.messages.SDK.outgoing.createOverlay,c.getConfigObjectForSDK(),l,u),c}g.log(v+"_createOverlay | Failed to create an overlay - missing overlayId")}function C(){F(b.messages.SDK.outgoing.dismissOverlay)}function D(e){return e?P(e.adViewId):null}function I(e){t=e}function w(){return t}function P(e){if(!e)return null;for(var n in Object.keys(h))if(h[n].getOverlayId()===e)return h[n];return null}function T(e,n){var t=e.getPresentationDelay(n);r=setTimeout(function(){!function(n){if(n){var t=[],i=b.messages.SDK.incoming.overlayDidFinishPresentation,r=b.messages.SDK.incoming.overlayLoadFailed;t.push(f.PubSub.subscribe(p.CB+"."+i,function(e){g.log(v+"_presentOverlay |"+i+"   "+JSON.stringify(e)),A(n.getOverlayId(),e)&&(g.getCurrentDisplayedAd()&&g.getCurrentDisplayedAdType()!==p.BN?(I(n),f.PubSub.clearHandlers(t),O(b.messages.adunit.outgoing.overlayVisibleSuccess,e)):x(P(e.overlayId)))})),t.push(f.PubSub.subscribe(p.CB+"."+r,function(e){g.log(v+"_presentOverlay | "+r+"   "+JSON.stringify(e)),A(n.getOverlayId(),e)&&(f.PubSub.clearHandlers(t),O(b.messages.adunit.outgoing.overlayVisibleFailed,e))})),O(b.messages.adunit.outgoing.overlayVisibleCalled,{advertisedAppId:n.getAdvertisedAppId()});var e={};e[b.configKeys.overlayId]=n.getOverlayId(),F(b.messages.SDK.outgoing.presentOverlay,e,i,r)}else g.log(v+"_presentOverlay | Failed to present an overlay")}(e)},1e3*t)}function O(e,n){g.postAdUnitEvent(g.jQuery().extend({name:e},n))}function F(e,n,t,i){var r={};n&&0!==Object.keys(n).length&&(r={functionParams:n}),g.callSDKService(b.messages.SDK.outgoing.jsInterface,e,r,t,i)}function L(){r&&clearTimeout(r),r=void 0}function x(e){C(),function(t){if(t){var i=b.messages.SDK.incoming.overlayRemoved,r=f.PubSub.subscribe(p.CB+"."+i,function(e){if(A(t.getOverlayId(),e)){g.log(v+"_removeOverlay | "+i+"   "+JSON.stringify(e));var n=h.indexOf(t);-1!==n&&h.splice(n,1),f.PubSub.unsubscribe(r)}}),e={};e[b.configKeys.overlayId]=t.getOverlayId(),F(b.messages.SDK.outgoing.removeOverlay,e,i)}else g.log(v+"_removeOverlay | Failed to remove an overlay with missing overlayId")}(e)}return{init:function(){a()&&!n&&(n=!0,c=f.Eventics.createEventic({productChance:1,baseData:{}},g.EventsManager),f.PubSub.subscribe("SDKController.AdVisible",function(e){l(e)&&(function(e){if(e&&e.settings&&e.ext){var n=e.ext.clickTags&&e.ext.clickTags.storeAppId,t=e.settings[b.externalConfigKeys.SKOverlayPosition],i=e.settings[b.externalConfigKeys.SKOverlayUserDismissible],r=e.settings[b.externalConfigKeys.delayInSecToPresentSKOverlay],a=e.settings[b.externalConfigKeys.SKOverlayFlow],o=s.extractDataForSKOverlay(e);g.log(v+"_createOverlay : "+JSON.stringify(o)),u(e.adViewId,n,t,i,o,r,a)}}(e),d=e)}),f.PubSub.subscribe("SDKController.adClosed",function(e){d&&l(d)&&(L(),S&&(f.PubSub.unsubscribe(S),S=null),x(D(d)))}),f.PubSub.subscribe(p.CB+"."+b.messages.SDK.incoming.overlayDidFinishDismissal,function(e){g.log(v+b.messages.SDK.incoming.overlayDidFinishDismissal+"   "+JSON.stringify(e));var n,t,i,r,a=g.getCurrentDisplayedAd();a?(n=e,t=D(a),n.dismissInitiatedSource=t&&t.getDismissInitiatedSource()||b.overlayDismissInitiatedType.user,O(b.messages.adunit.outgoing.overlayDismissed,n),t.setDismissInitiatedSource(null)):(i=e,r=g.AdUtils.extractEventData(d),i&&(r.generalmessage=i.advertisedAppId,r.custom_b=i.userDismissible),r.custom_c=b.overlayDismissInitiatedType.adClose,c.trackEvent(o.overlayDismissed,{},r)),I(null)}),f.PubSub.subscribe(p.CB+"."+b.messages.SDK.incoming.overlayCreateFailed,function(e){g.log(v+b.messages.SDK.incoming.overlayCreateFailed+"   "+JSON.stringify(e));var n={};if(e&&e.overlayId){var t=P(e.overlayId);n=t&&t.getConfigObjectForSDK()}O(b.messages.adunit.outgoing.overlayCreateFailed,n)}),f.PubSub.subscribe("SDKController.aecskTriggered",function(e){y=!0}))},isSKOverlaySupported:a,onSKClose:function(){if(a()&&!y){var e=D(d);if(e){if(i)return T(i,!1),void(i=null);e.getFlow()===b.flow.presentOnAdVisible&&T(e,!1),e.getFlow()===b.flow.presentOnSKClose&&T(e,!0),e.getFlow()===b.flow.presentOnSKCloseAndQC&&e.isQualityClickTriggered()&&T(e,!0)}}else y=!1},onSKOpen:function(){a()&&(w()?((i=w()).setDismissInitiatedSource(b.overlayDismissInitiatedType.SKOpen),C()):L())}}}},{"../../components/SKOverlay/SKOverlay":56,"../../components/storeKit/SKANModel":84,"../../constants/SDKFeatureNames":89,"../../modules/DemandSource/EventCategories.js":112,"./SKOverlayConstants":57}],59:[function(e,n,t){n.exports=function(i,r,a){var o={getInventoryOnInit:!1,refreshInterval:30,precache:!0};function s(e){return null!=e&&("boolean"==typeof e||"true"===e||"false"===e)}return{shouldFetchNewFeedOnAdCloseFlag:function(e){var n=i.getConfig().controllerConfig;return(n&&n[r.sspProductNames[e]]||{}).shouldFetchNewFeedOnAdClose},getValueByKey:function(e){return(i.getConfig().controllerConfig||{})[e]},getValueByKeyAndProductType:function(e,n){var t=i.getConfig().controllerConfig;return(t&&t[r.sspProductNames[n]]||{})[e]},getNetworkConfigValueByKey:function(e){var n=i.getConfig().controllerConfig;return(n&&n.networkConfig||{})[e]},getOfferWallConfig:function(){var e,n=i.getConfig().controllerConfig,t={precache:s(n.precacheMobileOfferWall)?n.precacheMobileOfferWall:o.precache,getInventoryOnInit:s(n.getInventoryOnInit)?n.getInventoryOnInit:o.getInventoryOnInit,refreshInterval:(e=n.owRefreshInterval,null==e||isNaN(parseInt(e))||0===n.owRefreshInterval?o.refreshInterval:n.owRefreshInterval)};return a.extend(!0,o,t)},isNetworkConfigEmpty:function(){var e=i.getConfig().controllerConfig;return!e||!e.networkConfig}}}},{}],60:[function(e,n,t){function i(o,r,s,d){function i(e,n){return e[0]&&n[0]?(e=new Date(e[0]))<(n=new Date(n[0]))?-1:n<e?1:0:0}function e(e,n){return void 0===e&&(e=1),e=parseInt(e),n=parseInt(n),isNaN(e)||isNaN(n)?-1:e===n?0:n<e?1:-1}function n(e){try{return e()}catch(e){return!1}}function t(e){return"object"==typeof e&&e.hasOwnProperty("length")?Array.prototype.slice.call(e):[]}function a(e){if(l())return f(c(),e)}function c(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)})}function l(){return crypto&&crypto.getRandomValues&&"function"==typeof crypto.getRandomValues}function u(e,n){if(e.length<=n||n<=0)return"";for(var t=0,i=0;i<e.length;i++){t+=e.charCodeAt(i)}return t%Math.pow(16,n).toString(16).padStart(n,"0")}function f(e,n){if(e.length<=n||n<=0)return e;var t=e.slice(0,-n);return t+u(t,n)}var g={extend:function(e,n){jQuery.extend(e,n)},getScript:function(e,n,t){var i=s.createElement("script");i.src=e;var r=s.getElementsByTagName("head")[0],a=!1;i.onload=i.onreadystatechange=function(e){a||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(a=!0,n(e),i.onload=i.onreadystatechange=null,r.removeChild(i))},i.onerror=function(e){o.log(["script load error",e]),t&&t()},r.appendChild(i)},getQueryString:function(e,n,t){t=this.isDefined(t)?t:r.location.href,null===n&&(n=""),e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t);return null===i?n:i[1]},getUrlInfo:function(e){var n=s.createElement("a");return n.href=e,{host:n.hostname,port:n.port,path:n.pathname,protocol:n.protocol}},changeUrlProtocol:function(e,n){var t=s.createElement("a");return t.href=e,t.protocol=n,t.href},serialize:function(e){var n=[];for(var t in e)e.hasOwnProperty(t)&&n.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return n.join("&")},isDefined:function(e){return typeof e!==d},isFunction:function(e){return"function"==typeof e},isString:function(e){return"string"==typeof e},parseJSON:function(e){var n={};if(!this.isString(e))return null;try{n=jQuery.parseJSON(e)}catch(e){}return n},getParams:function(e){var n,t=[],i=e.split("/"),r=i.length;if(-1===e.indexOf("JSON:")){if(2<=r&&r%2==0)for(n=0;n<r;n+=2)t[i[n]]=i.length>=n+1?decodeURIComponent(i[n+1]):null}else{var a=e.split("JSON:");typeof a[1]!==d&&(t=jQuery.parseJSON(a[1]))}return t},decodeValues:function(n){jQuery.each(n,function(e){n.hasOwnProperty(e)&&("string"==typeof n[e]&&(n[e]=decodeURIComponent(n[e])),"object"==typeof n[e]&&n[e]&&o.Utils.decodeValues(n[e]))})},renderTemplate:function(i,e){return e&&jQuery.each(e,function(e,n){var t=new RegExp("{{"+e+"}}","g");i=i.replace(t,n)}),i},isVisible:function(e){return"none"!==e.css("display")&&"hidden"!==e.css("visibility")},versionCompare:function(e,n){var t=function(e){1===e.length&&e.push("0"),2===e.length&&e.push("0")},i=function(n){jQuery.each(n,function(e){n[e]=parseInt(n[e])})};"5.02"===e&&(e="5.0.2");var r=e.split("."),a=n.split(".");t(r),t(a);try{i(r),i(a)}catch(e){throw"parse error"}return r[0]===a[0]?r[1]===a[1]?r[2]===a[2]?0:r[2]>a[2]?1:-1:r[1]>a[1]?1:-1:r[0]>a[0]?1:-1},returnResolvedPromise:function(){var e,n=new jQuery.Deferred;return 0<arguments.length&&(e=[].slice.call(arguments)),n.resolve.apply(n.resolve,e),n.promise()},returnRejectedPromise:function(){var e,n=new jQuery.Deferred;return 0<arguments.length&&(e=[].slice.call(arguments)),n.reject.apply(n.reject,e),n.promise()},replacePlaceHolder:function(e,n){var t;for(var i in n){t=n[i];var r=new RegExp(i+"|"+encodeURIComponent(i),"i");e=e.replace(r,"function"==typeof t?t():t)}return e},fileArrayIncludes:function(e,n){if(e||0===e.length)return!1;for(var t=0;t<e.length;t++)if(n===e[t])return!0;return!1},isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},isEmptyObject:function(e){if(!e)return!0;if(this.isString(e)||this.isArray(e))return 0===e.length;for(var n in e)if(e.hasOwnProperty(n))return!1;return!0},sortDataByDateKey:function(e){var n=[];for(var t in e)n.push([t,e[t]]);return n.sort(i)},apiVersionCompareTo:e,isNestedObjectExists:n,convertArrayLikeObjectToArray:t,generateIdentifier:a,replaceEndingWithCheckSum:f};return g}n.exports=i},{}],61:[function(e,n,t){n.exports=function(g,p){var v=e("../components/PixelTrackingService.js")(p),m=e("../components/FillRateTrackingService.js")(p,v),b=e("../components/ObfuscationService.js")(),h=e("../modules/DemandSource/EventCategories")(),S=e("./Constants"),y=p.DemandUtils,A={url:1,xmlResponse:2};function C(e){return e.ext.vastData?e.ext.vastData.xmlResponse:null}return{parseVast:function(e,n,t){var i,r,a=new jQuery.Deferred;r="prod"!==p.getEnv()?(i=e.settings.urltocdn+"/common/sdk/1.0.9/vastObfuscator.html",e.settings.urltocdn+"/common/sdk/1.0.9/vast-vmap.js"):(i=e.settings.urltocdn+"/common/sdk/1.0.9/vastObfuscator.4f4eb4fb.min.html",e.settings.urltocdn+"/common/sdk/1.0.9/vast-vmap.4f4eb4fb.min.js");var o,s,d,c=(d=C(o=e)?(s=C(o),A.xmlResponse):(s=o.ext.videoData.videoSource.vast,A.url),{adData:s,adSource:d});c.adSource===A.url&&(c.adData=function(e,n,t){if(e&&void 0!==e){var i;e=e.replace(S.vastRequestPlaceholders.moatEnabled,(i=n,p.MOATService.isInitialized()&&i?1:0));var r=t.requestID;r&&(e=e.replace(S.vastRequestPlaceholders.requestId,r));var a=function(e){var n=e.ext.opportunityID;if(e.ext.squeezeOpportunityIds&&"[object Array]"===Object.prototype.toString.call(e.ext.squeezeOpportunityIds)){var t=e.controllerSpace&&e.controllerSpace.viewCount||0;n=e.ext.squeezeOpportunityIds[t]}return n}(t);return a&&(e=e.replace(S.vastRequestPlaceholders.opportunityId,a)),e}}(c.adData,n,e));var l,u={adData:c.adData,style:"height:100%;",adUnitData:e,vastParserUrl:r,isAdDataTypeURL:(l=c,l.adSource===A.url)},f={adData:c.adData,url:i,templateClass:"obfuscationIframe",style:{width:"1px",height:"1px",border:"0"},id:e.vastIframeId};return function(t,n,e){var i,r;if("[object Array]"===Object.prototype.toString.call(t.ext.callbacks)){var a=t.controllerSpace&&t.controllerSpace.viewCount||0;i=t.ext.callbacks[a]}else i=t.ext.callbacks;var o=m.init(i),s=t.vastIframeId,d=g.PubSub.subscribe("SDKController.VastRequest",function(e){e.vastIframeId&&e.vastIframeId===s&&(o.track({trackingType:"request"}),g.PubSub.unsubscribe(d))}),c=g.PubSub.subscribe("SDKController.VastResponse",function(e){e.vastIframeId&&e.vastIframeId===s&&(clearTimeout(r),"hit"===e.result?(o.track({trackingType:"responseHit"}),b.removeIframe(s),g.PubSub.unsubscribe(c),n.resolve(e.data)):(o.track({trackingType:"responseMiss",data:e.data}),b.removeIframe(s),g.PubSub.unsubscribe(c),n.reject({errMsg:e.data})))}),l=e&&e>S.vastMinimumResponseTimeout?e:S.vastResponseTimeout;r=setTimeout(function(){g.PubSub.unsubscribe(c),g.PubSub.unsubscribe(d),g.PubSub.unsubscribe(u),clearTimeout(r),n.reject({isTimeLimitReached:!0,errMsg:"timeout"})},l);var u=g.PubSub.subscribe("SDKController.VastErrorPixel",function(e){e.vastIframeId&&e.vastIframeId===s&&(v.firePixel(e),b.removeIframe(s),g.PubSub.unsubscribe(u))}),f=g.PubSub.subscribe("SDKController.parseVastInfo",function(e){if(e.vastIframeId&&e.vastIframeId===s){g.PubSub.unsubscribe(f);var n=y.extendCallbackParamsWithParentProductConfig(t,{action:"fireEvent",eventParam:{eName:h.parseVastInfo,label:{},data:{generalMessage:e.data}}});g.PubSub.publish("SDKController.Analytics",[n])}})}(e,a,t.vastTimeOut),b.init(f,function(e){g.Msg.postMessage("$$JSON:"+JSON.stringify(u),i,e[0].contentWindow)}),a.promise()},removeIframe:function(e){b.removeIframe(e)}}}},{"../components/FillRateTrackingService.js":22,"../components/ObfuscationService.js":44,"../components/PixelTrackingService.js":51,"../modules/DemandSource/EventCategories":112,"./Constants":12}],62:[function(e,n,t){n.exports=function(a){var o,s,d,c,l=e("../components/Constants.js"),u=null;return{init:function(e,n){var t;u=new jQuery.Deferred,o=(t=e).settings&&t.settings.standaloneView,(s=e.ext&&e.ext.isHybridFlow||!1)?l.viewsStates.hybrid:l.viewsStates.normal,d=e.ext&&e.ext.viewUniqueId||"";var i,r=JSON.stringify(l.hybridViews);c={standaloneView:o,viewUniqueId:d,adViewId:n},s?(c.hybridView=s,c.hybridJson=r,i=a.PubSub.subscribe("ViewsManager.viewClosed",function(e){u.resolve(),a.PubSub.unsubscribe(i)})):u.resolve({})},waitForAllViews:function(){return u.promise()},isHybridFlow:function(){return isHybrid},getDisplayWebViewParams:function(e){return c=jQuery.extend(c,{display:e})}}}},{"../components/Constants.js":12}],63:[function(e,n,t){n.exports=function(e){var i=[],n=e.controller;function t(n){var e=i.filter(function(e){return e.getContainerID()===n});return 0<e.length?e[0]:void 0}return{add:function(e){e&&i.push(e)},getAdViewById:t,isExist:function(e){return void 0!==t(e)},removeAdViewById:function(n){var t={};return i=i.filter(function(e){return e.getContainerID()!==n||(t=e,!1)}),t},toArray:function(){return i.slice()},size:function(){return i.length},printAll:function(){i.forEach(function(e){n.log("container  "+e.getContainerID())})}}}},{}],64:[function(e,n,t){n.exports=function(f,g,p,t,i){var v="AdViewsManager | ";function r(e){return f.log(v+"_getAdViewByAd"),a(e).getAdViewByAd(e)}function a(e){if(m("_getManager"),e)return e.isWPAD?p:g;m("_getManager without ad")}function m(e){f.log(v+e)}return{createAndLoadView:function(e,n,t,i){var r,a,o,s,d,c,l,u;e.isWPAD?(d=e,c=n,l=t,u=i,m("_createAndLoadAdWebView"),p.loadAdUnitUrlToView(d,c,l,u)):(r=e,a=n,o=t,s=i,f.log(v+"_createAndLoadFrameView"),g.createAndLoadAdFrame(r,a,o,s))},displayAdView:function(e,n,t,i){f.log(v+"_displayAdView"),a(e).displayAdView(e,n,t,i)},unloadAdView:function(e){m("_unloadAdView"),e?a(e).unloadAdView(e):m("_unloadAdView | no ad")},updateFrameUrl:function(e,n,t,i){m("_updateFrameUrl"),a(e).updateAdUnitUrl(e,n,t,i)},getContainerState:function(){return m("_getContainerState"),t.getState()},displayContainer:function(e){if(m("_displayContainer"),a(e)===g)return t.display(e);var n=r(e).getContainerID();return t.display(e,n)},hideContainer:function(e){m("_hideContainer"),t.hide(e)},setContainerVisibility:function(e){m("_setContainerVisibility"),t.setVisibility(e)},changeContainerMode:function(e,n){m("_changeContainerMode"),t.changeMode(e,n)},unloadProductFromContainer:function(){m("_unloadProductFromContainer"),t.unloadProduct()},setContainerBGColorTransparent:function(){m("_setContainerBGColorTransparent"),t.setWebviewBGColorTransparent()},handleScreenVisible:function(e,n){m("_handleScreenVisible"),a(n).handleScreenVisible(e,n)},displayLoader:function(e){if(m("_displayLoader"),i.isDisplayed()){var n=i.get();a(n).displayLoader(e,n)}else g.displayLoader(e)},hideLoader:function(){if(m("_hideLoader"),i.isDisplayed()){var e=i.get();a(e).hideLoader(e)}else g.hideLoader()},isContainerLoaded:function(e){return m("_isContainerLoaded"),a(e).isContainerLoaded(e)},getContainerCreationHandler:function(e){return m("_getContainerCreationHandler"),a(e).getContainerCreationHandler(e)},onAdUnitLoaded:function(e,n,t){f.log(v+"_onAdUnitLoaded"),a(e).onAdUnitLoaded(e,n,t)},getAdViewByAd:r,triggerRedraw:function(){m("_triggerRedraw"),t.redraw()},sendMessageToAdView:function(e,n){return m("_sendMessageToAdView"),n?a(n).sendMessageToDisplayedAdView(e):(m("_sendMessage | ad undefined"),!1)},sendMessageToAllAdViews:function(e){m("_sendMessageToAllAdViews"),p.sendMessageToAllAdViews(e),g.sendMessageToAllAdViews(e)},getDisplayedAdView:function(e){return m("_getDisplayedAdView"),a(e).getDisplayedAdView(e)},hideView:function(){var e=i.get();a(e).hideView(e)},displayView:function(){var e=i.get();a(e).displayView(e)},isViewDisplayed:function(e,n){a(n).isViewDisplayed(e)}}}},{}],65:[function(e,n,t){n.exports=function(t,n,e){var i=t.jQuery(),r=e.style.backgroundColors;return{setSDKWebviewBGColor:function(e,n){e&&(t.log("ContainerManager | setSDKWebviewBGColor | color: "+e),t.callSDKFunction("setWebviewBackgroundColor",i.extend(n||{},{color:e})))},setControllerBGColor:function(e){e&&(t.log("ContainerManager | setControllerBGColor | color: "+e),i("body").css("background",e))},getSDKWebviewBGColorByProductType:function(e){switch(e){case n.IS:case n.WebControls:return r.transparent;case n.OW:case n.RV:case n.BC:default:return r.black}},getControllerBGColorByProductType:function(e){switch(e){case n.IS:case n.WebControls:return r.transparent;case n.OW:case n.RV:case n.BC:default:return r.darkGrey}},backgroundColors:r}}},{}],66:[function(e,n,t){n.exports=function(c,l,u,n){var i,r,t,a="BannerExternalAdViewService | ",f=e("./ExternalAdViewConstants.js"),o=e("./WPADUtils")(l),s=[],d=[],g=f.nativeFunction,p=l.jQuery();function v(){var e=n.get();e&&e.productType&&e.productType===u.BN&&n.reset()}function m(e){return!!e&&e.isViewVisible}function b(e){return e&&e.adViewId}function h(e){var n,t;return t=e,n=!(C()!==f.nativeFunction||b(t)&&!o.isBannerAdViewId(t.adViewId))||b(e)&&function(e){l.log("BannerExternalAdViewService | isIdentifierExistInIdsCollection | "+e);for(var n=!1,t=0;!n&&t<d.length;t++)d[t].id===e&&(n=!0);return n}(e.adViewId),l.log("BannerExternalAdViewService | "+C()+" | handling message? "+n+"  message:"+JSON.stringify(e)),n}function S(e){D("sendMessage | "+JSON.stringify(e));var n,t,i,r,a,o,s=c.PubSub.subscribe(u.CB+"."+f.handleSendMessageFailure,function(e){h(e)&&(e&&e.errMsg&&l.log("Error calling "+f.handleSendMessageFailure+" with error "+e.errMsg,l.LogLevels.error),c.PubSub.unsubscribe(s))});if("string"==typeof e){var d=e.indexOf("$$");-1!==d&&(t=d,i={},r=(n=e).substr(t+2),a=r.indexOf("="),o=r.substr(0,a),i.name=n.substr(0,t),i[o]=r.substr(a+1),e=i)}l.callSDKFunction(C(),{functionName:f.NativeAPI.sendMessage,functionParams:{params:JSON.stringify(e)}},f.handleSendMessageSuccess,f.handleSendMessageFailure)}var y=function(e,n){S(e)};function A(){t=!(d=[])}function C(){return g}function D(e){l.log(a+e)}return{init:function(e){var n;t=!0,D("_setNativeServiceApi | "+(n=e)),n&&(D("_setNativeServiceApi | "+n),g=n),l.log("rony BannerExternalAdViewService | _init nativeservice : "+g),s.push(c.PubSub.subscribe(u.CB+"."+f.handleContainerIsVisible,function(e){h(e)?!e.configs&&e.configs.productType&&e.configs.visibilityParams||(l.log("rony BannerExternalAdViewService | handeling isVisible"),l.log("BannerExternalAdViewService | "+f.handleContainerIsVisible),m(e.configs.visibilityParams)&&c.PubSub.publish(e.configs.productType+".isVisible",[e.configs])):l.log("rony BannerExternalAdViewService | not handeling isVisible")})),s.push(c.PubSub.subscribe(u.CB+"."+f.handleContainerWasRemoved,function(e){if(h(e)){l.log("BannerExternalAdViewService | "+f.handleContainerWasRemoved,l.LogLevels.error);for(var n=!1,t=0;!n&&t<d.length;t++)d[t].id===e.configs.externalAdViewId&&(n=!0,d.splice(t,1));n||l.log("BannerExternalAdViewService | "+f.handleContainerWasRemoved+"trying to remove container "+e.configs.externalAdViewId+" that does not exist",l.LogLevels.error),v(),c.PubSub.publish(e.configs.productType+".reset",[e.configs])}})),s.push(c.PubSub.subscribe(u.CB+"."+f.NativeAPI.linkActivation,function(e){h(e)&&(l.log("BannerExternalAdViewService |  "+f.NativeAPI.linkActivation+" params: "+JSON.stringify(e)),e.url&&c.Utils.decodeValues(e),c.PubSub.publish(u.CB+".linkActivationOnAd",[e]))})),s.push(c.PubSub.subscribe(u.CB+"."+f.handleMessage,function(e){h(e)&&function(n){try{var e=n.adViewId?n.adViewId:void 0,t=(i=n.id,r=e,function(e){var n={data:e,id:i};r&&p.extend(n,{adViewId:r}),y(n,!0)});l.isAndroid()||c.Utils.decodeValues(n.arguments),e&&p.extend(n.arguments,{adViewId:e}),p.extend(n.arguments,{callback:t}),c.PubSub.publish("SDKController."+n.method,[n.arguments])}catch(e){l.log("BannerExternalAdViewService | unable to parse message: "+n,l.LogLevels.error)}var i,r}(e)}))},destroy:function(){c.PubSub.clearHandlers(s)},loadWithUrl:function(n,t,e,i,r){D("_loadWithUrl | "+n),l.AdUtils.extendAdObjectWithConfig(n,t,e,i);var a=c.PubSub.subscribe(u.CB+"."+f.handleLoadWithUrlFailure,function(e){h(e)&&(l.isAdDisplayed(t)?D("_loadWithUrl | isAdDisplayed=true"):(e&&e.errMsg&&(l.log("Error calling "+f.handleLoadWithUrlFailure+" with error "+e.errMsg+" url "+n,l.LogLevels.error),v(),c.PubSub.publish("SDKController.AdLoadError",[e])),c.PubSub.unsubscribe(a),r&&r(!1)))}),o=c.PubSub.subscribe(u.CB+"."+f.handleLoadWithUrlSuccess,function(e){h(e)&&(r&&r(!0),D(f.handleLoadWithUrlSuccess),c.PubSub.unsubscribe(a),c.PubSub.unsubscribe(o))});l.callSDKFunction(C(),{functionName:f.NativeAPI.loadWithUrl,functionParams:p.extend({urlForWebView:n},i)},f.handleLoadWithUrlSuccess,f.handleLoadWithUrlFailure)},updateAd:function(e,n,t,i){l.log("BannerExternalAdViewService | _updateAd | "+JSON.stringify(n));var r={name:"updateAd",param:n};l.AdUtils.extendAdObjectWithConfig(e,n,t,i);var a=c.PubSub.subscribe(u.CB+"."+f.handleUpdateAdFailure,function(e){h(e)&&(e&&e.errMsg&&l.log("Error calling "+f.handleUpdateAdFailure+" with error "+e.errMsg,l.LogLevels.error),c.PubSub.unsubscribe(a))});l.callSDKFunction(C(),{functionName:f.NativeAPI.updateAd,functionParams:{params:JSON.stringify(r)}},f.handleUpdateAdSuccess,f.handleUpdateAdFailure)},sendMessage:S,isContainerVisible:m,isExternalAdViewInitiated:function(){if(l.log("BannerExternalAdViewService | isExternalAdViewInitiated |"),i&&"pending"===i.status)return i;i=new p.Deferred;var n=c.PubSub.subscribe(u.CB+"."+f.handleIsInitiated,function(e){h(e)&&(l.log("BannerExternalAdViewService | "+f.handleIsInitiated+" "+JSON.stringify(e)),c.PubSub.unsubscribe(n),c.PubSub.unsubscribe(t),i.resolve(e))}),t=c.PubSub.subscribe(u.CB+"."+f.handleIsInitiatedFailure,function(e){h(e)&&(e&&e.errMsg&&l.log("Error calling "+f.handleIsInitiatedFailure+" with error "+e.errMsg,l.LogLevels.error),c.PubSub.unsubscribe(t),c.PubSub.unsubscribe(n),i.reject(e))});return l.callSDKFunction(C(),{functionName:f.NativeAPI.isExternalAdViewInitiated},f.handleIsInitiated,f.handleIsInitiatedFailure),i.promise()},addExternalAdViewIdAndSetStatus:function(e){D("_addExternalAdViewIdAndSetStatus");for(var n=e.externalAdViewId,t=e.isInReload,i=!1,r=0;r<d.length;r++){var a=d[r];a.id===n&&(i=!0,D("_addExternalAdViewIdAndSetStatus | changed isInReload to "+(a.isInReload=t)))}i?l.log("BannerExternalAdViewService | _addExternalAdViewIdAndSetStatus | "+n+" has been previously added",l.LogLevels.error):(0!==d.length&&(d=[]),d.push({id:n,isInReload:t}))},getViewVisibility:function(){if(D("_getViewVisibility | banner"),r&&"pending"===r.status)return r;r=new p.Deferred;var n=c.PubSub.subscribe(u.CB+"."+f.handleGetViewVisibilitySuccess,function(e){h(e)&&(D(f.handleGetViewVisibilitySuccess+" "+JSON.stringify(e)),c.PubSub.unsubscribe(n),c.PubSub.unsubscribe(t),r.resolve(e))}),t=c.PubSub.subscribe(u.CB+"."+f.handleGetViewVisibilityFailure,function(e){h(e)&&(e&&e.errMsg&&l.log("BannerExternalAdViewService | Error calling "+f.handleGetViewVisibilityFailure+" with error "+e.errMsg,l.LogLevels.error),c.PubSub.unsubscribe(t),c.PubSub.unsubscribe(n),r.reject(e))});return l.callSDKFunction(C(),{functionName:f.NativeAPI.getViewVisibility},f.handleGetViewVisibilitySuccess,f.handleGetViewVisibilityFailure),r.promise()},resetExternalAdViewsIdentifiers:A,removeExternalAdView:function(e,n,t){A(),l.callSDKFunctionWithCallback(C(),{functionName:f.NativeAPI.removeAdView,functionParams:{adViewId:e}},n,t)},getIsServiceInitiated:function(){return D("rony _getIsServiceInitiated: "+t),t}}}},{"./ExternalAdViewConstants.js":70,"./WPADUtils":74}],67:[function(h,e,n){e.exports=function(n,t,r,e){var i="BannerExternalContainer | ",a=h("./WPADUtils")(t),o=!1,s=!1,d=!1,c=!1,l=e,u=[];function f(e){s=e}function g(e){b("_setAdIsVisibleInContainer = "+e),o=e}function p(){return o}function v(){b("_resetReportAdVisibilityFlags"),f(!1),g(!1)}function m(){return b("_shouldReportAdVisible | containerID: "+l+" isAdLoadedInContainer: "+s+" | isAdVisibleInContainer "+o),s&&!o}function b(e){t.log(i+e)}return{setAdIsVisibleInContainer:g,resetReportAdVisibilityFlags:v,shouldReportAdVisibleForBanners:m,checkStatusOfAdView:function(){if(r.getIsServiceInitiated)return r.isExternalAdViewInitiated()},createAdUrlInAdView:function(e,n,t,i){b("_createAdUrlInAdView "+n.productType),v(),c=!0,r.getIsServiceInitiated&&r.loadWithUrl(e,n,t,i,function(e){d=e,c=!1})},updateAdInAdView:function(e,n,t,i){b("_updateAdInAdView "+n.productType),v(),r.getIsServiceInitiated&&r.updateAd(e,n,t,i)},sendMessageToExternalAdView:function(e){e&&l&&(e.adViewId||(e.adViewId=l)),r.getIsServiceInitiated&&r.sendMessage(e)},addExternalAdViewIdAndSetStatus:function(e){r.getIsServiceInitiated&&r.addExternalAdViewIdAndSetStatus(e)},onExternalViewLoaded:function(){b("_onExternalViewLoaded isAdVisibleInContainer="+p()),f(!0)},isAdInExternalViewLoaded:function(){return b("isAdInExternalViewLoaded "+s),s},onBannerViewLoaded:function(n,t){f(!0),r.getIsServiceInitiated&&r.getViewVisibility().then(function(e){r.isContainerVisible(e)&&(n(),m()&&t())})},resetExternalAdViewsIdentifiers:function(){r.getIsServiceInitiated&&r.resetExternalAdViewsIdentifiers()},getContainerID:function(){return b("_getContainerID: "+l),l},removeContainer:function(e,n){r.getIsServiceInitiated&&r.removeExternalAdView(l,e,n)},isVisible:p,isContainerLoaded:function(e){return!0===c&&n.PubSub.publish("BannerExternalContainer.duringCreation",[e]),d},init:function(){u.push(n.PubSub.subscribe("SDKController.AdVisible",function(e){var n;b("inside adVisibleHandler"),b("_shouldRecieveMessage containerID: "+l+" adViewId: "+(n=e).adViewId),(a.isBannerAd(n)&&a.isBannerAdViewId(l)||n.adViewId===l)&&(b("got SDKController.AdVisible | setting visibility to true"),g(!0))}))},clean:function(){b("_clean"),n.PubSub.clearHandlers(u),r.getIsServiceInitiated&&r.destroy(),r=null}}}},{"./WPADUtils":74}],68:[function(f,e,n){e.exports=function(i,r,a,t,e){f("./ExternalAdViewConstants.js");var n="BannerHandlerDelegate | ",o=e,s=a.BN,d=[],c="";function l(e){e.productType=s,e.demandSourceName=o}function u(e){r.log(n+e)}return{assignAdViewAndStartHandle:function(e){u("_assignAdViewAndStartHandle: "+e),e&&(c=e,d.push(i.PubSub.subscribe("removed."+c,function(e){var n;l(e),u("handle banner removed with id: "+e.adViewId+"for instance id: "+e.demandSourceId),(n=t.get())&&n.productType&&n.productType===a.BN&&t.reset()})),d.push(i.PubSub.subscribe("isVisible."+c,function(e){var n;l(e),!e.configs&&e.configs.productType&&e.configs.visibilityParams||(u("handle banner visible with id: "+e.adViewId+"for instance id: "+e.demandSourceId),(n=e.configs.visibilityParams)&&n.isViewVisible&&e.productType===a.BN&&i.PubSub.publish("Banner.isVisible",[e]))})),d.push(i.PubSub.subscribe("destroy."+c,function(e){var n,t;l(e),u("handle banner destroy with id: "+e.adViewId+"for instance id: "+e.demandSourceId),e.isBannerDisplay?(n=e,i.PubSub.publish("Banner.reset",[n]),i.PubSub.publish("SDKController.AdClose",[n])):(l(t=e),t[a.isBNAutoRemove]&&!1===r.getSDKDataByKey(a.bnAutoDestroy)||(u("handle banner replace with id: "+t.adViewId+"for instance id: "+t.demandSourceId),r.unloadAdViewsByProductExceptDisplayedView({productType:t.productType})))})))},stopHandle:function(){u("stopHandle: "+c),i.PubSub.clearHandlers(d)}}}},{"./ExternalAdViewConstants.js":70}],69:[function(e,n,t){n.exports=function(e,n){var t,i={notCreated:0,duringCreation:1,createdSuccessfully:2,failedToCreate:3},r=i.notCreated,a=new e.Deferred,o="failed to create native webview";function s(e){e!==r?(d("setState - new state: "+e),function(e){if(d("updatePromiseOnStateChange: "+e),"pending"!==a.state())return d("updatePromiseOnStateChange - not in pending state - ignoring");e===i.createdSuccessfully?a.resolve():e===i.failedToCreate&&a.reject(o)}(r=e)):d("setState - already in state: "+e)}function d(e){n("ContainerCreationStateHandler | "+e)}return{getState:function(){return r},setState:s,getCreationStates:function(){return i},getCreationResultPromise:function(){return a.promise()},creationStarted:function(e){d("creationStarted"),s(i.duringCreation),t=setTimeout(function(){d("creation ended because of timeout"),s(i.failedToCreate)},e||3e3)},creationEnded:function(e){d("creationEnded with result: "+e),clearTimeout(t),s(e?i.createdSuccessfully:i.failedToCreate)}}}},{}],70:[function(e,n,t){n.exports={CB:"NativeCallback",NativeAPI:{loadWithUrl:"loadWithUrl",updateAd:"updateAd",isExternalAdViewInitiated:"isExternalAdViewInitiated",sendMessage:"sendMessage",getViewVisibility:"handleGetViewVisibility",removeAdView:"removeAdView",linkActivation:"linkActivation"},nativeFunction:"bannerViewAPI",nativeFunctionAdViewAPI:"adViewAPI",handleContainerIsVisible:"containerIsVisible",handleContainerWasRemoved:"containerWasRemoved",performDestroyDisplayBanner:"performDestroyDisplayBanner",destroyBanner:"destroyBanner",cleanUpNonDisplayBanners:"cleanUpNonDisplayBanners",isBNAutoRemove:"isBNAutoRemove",bnAutoDestroy:"bnAutoDestroy",handleIsInitiated:"containerAdViewStatus",handleIsInitiatedFailure:"containerAdViewStatusFailure",handleAdReplaced:"containerAdReplaced",handleMessage:"containerSendMessage",handleLoadWithUrlSuccess:"handleLoadWithUrlSuccess",handleLoadWithUrlFailure:"handleLoadWithUrlFailure",handleUpdateAdSuccess:"handleUpdateAdSuccess",handleUpdateAdFailure:"handleUpdateAdFailure",handleSendMessageSuccess:"handleSendMessageSuccess",handleSendMessageFailure:"handleSendMessageFailure",handleGetViewVisibilitySuccess:"handleGetViewVisibility",handleGetViewVisibilityFailure:"handleGetViewVisibilityFailure"}},{}],71:[function(P,e,n){e.exports=function(c,l,u,n){var i,r,a,t="ExternalAdViewService | ",e=P("../../constants/SDKFeatureNames"),f=P("./ExternalAdViewConstants.js"),o=P("./bannerLoadWhileShowHandler"),s=P("./WPADUtils")(l),d=[],g=f.nativeFunction,p=l.jQuery();function v(){var e=n.get();e&&e.productType&&e.productType===u.BN&&n.reset()}function m(e){return!!e&&e.isViewVisible}function b(e){return e&&e.adViewId}var h={handleVisible:function(e){var n;!(n=e.configs)&&n.productType&&n.visibilityParams||(l.log("ExternalAdViewService | "+f.handleContainerIsVisible),m(n.visibilityParams)&&n.productType===u.BN&&c.PubSub.publish(n.productType+".isVisible",[n]))},handleRemoved:function(e){l.log("ExternalAdViewService | bannerSingleInstancesHandler | "+f.handleContainerWasRemoved,l.LogLevels.error),v(),c.PubSub.publish(e.configs.productType+".reset",[e.configs])},handlePerformDestroy:function(e){l.log("ExternalAdViewService | bannerSingleInstancesHandler | handlePerformDestroy")}};function S(){return l.CompatibilityService.isFeatureSupportedInNativeSDK(e.bannerMultipleInstances)?o(c,l):h}function y(e){if(n=e,D()===f.nativeFunction&&(!b(n)||s.isBannerAdViewId(n.adViewId)))return!0;var n,t=b(e)&&I()===e.adViewId;return l.log("ExternalAdViewService | "+D()+" | handling message? "+t+"  message:"+JSON.stringify(e)),t}function A(e){w("sendMessage | "+JSON.stringify(e));var n,t,i,r,a,o,s=c.PubSub.subscribe(u.CB+"."+f.handleSendMessageFailure,function(e){y(e)&&(e&&e.errMsg&&l.log("Error calling "+f.handleSendMessageFailure+" with error "+e.errMsg,l.LogLevels.error),c.PubSub.unsubscribe(s))});if("string"==typeof e){var d=e.indexOf("$$");-1!==d&&(t=d,i={},r=(n=e).substr(t+2),a=r.indexOf("="),o=r.substr(0,a),i.name=n.substr(0,t),i[o]=r.substr(a+1),e=i)}l.callSDKFunction(D(),{functionName:f.NativeAPI.sendMessage,functionParams:{params:JSON.stringify(e)}},f.handleSendMessageSuccess,f.handleSendMessageFailure)}var C=function(e,n){A(e)};function D(){return g}function I(){return a}function w(e){l.log(t+e)}return{init:function(e,n){var t,i;w("_setNativeServiceApi | "+(i=e)),i&&(g=i),w("_setAdViewId | "+(t=n)),t&&(a=t),d.push(c.PubSub.subscribe(u.CB+"."+f.handleContainerIsVisible,function(e){y(e)&&S().handleVisible(e)})),d.push(c.PubSub.subscribe(u.CB+"."+f.handleContainerWasRemoved,function(e){y(e)&&S().handleRemoved(e)})),d.push(c.PubSub.subscribe(u.CB+"."+f.destroyBanner,function(e){y(e)&&S().handlePerformDestroy(e)})),d.push(c.PubSub.subscribe(u.CB+"."+f.NativeAPI.linkActivation,function(e){y(e)&&(l.log("ExternalAdViewService |  "+f.NativeAPI.linkActivation+" params: "+JSON.stringify(e)),e.url&&c.Utils.decodeValues(e),c.PubSub.publish(u.CB+".linkActivationOnAd",[e]))})),d.push(c.PubSub.subscribe(u.CB+"."+f.handleMessage,function(e){y(e)&&function(n){try{var e=n.adViewId?n.adViewId:void 0,t=(i=n.id,r=e,function(e){var n={data:e,id:i};r&&p.extend(n,{adViewId:r}),C(n,!0)});l.isAndroid()||c.Utils.decodeValues(n.arguments),p.extend(n.arguments,{callback:t}),e&&p.extend(n.arguments,{adViewId:e}),c.PubSub.publish("SDKController."+n.method,[n.arguments])}catch(e){l.log("ExternalAdViewService | unable to parse message: "+n,l.LogLevels.error)}var i,r}(e)}))},destroy:function(){c.PubSub.clearHandlers(d)},loadWithUrl:function(n,t,e,i,r){w("_loadWithUrl | "+n),l.AdUtils.extendAdObjectWithConfig(n,t,e,i);var a=c.PubSub.subscribe(u.CB+"."+f.handleLoadWithUrlFailure,function(e){y(e)&&(l.isAdDisplayed(t)?w("_loadWithUrl | isAdDisplayed=true"):(e&&e.errMsg&&(l.log("Error calling "+f.handleLoadWithUrlFailure+" with error "+e.errMsg+" url "+n,l.LogLevels.error),v(),c.PubSub.publish("SDKController.AdLoadError",[e])),c.PubSub.unsubscribe(a),r&&r(!1)))}),o=c.PubSub.subscribe(u.CB+"."+f.handleLoadWithUrlSuccess,function(e){y(e)&&(r&&r(!0),w(f.handleLoadWithUrlSuccess),c.PubSub.unsubscribe(a),c.PubSub.unsubscribe(o))});l.callSDKFunction(D(),{functionName:f.NativeAPI.loadWithUrl,functionParams:p.extend({urlForWebView:n},i)},f.handleLoadWithUrlSuccess,f.handleLoadWithUrlFailure)},updateAd:function(e,n,t,i){l.log("ExternalAdViewService | _updateAd | "+JSON.stringify(n));var r={name:"updateAd",param:n};l.AdUtils.extendAdObjectWithConfig(e,n,t,i);var a=c.PubSub.subscribe(u.CB+"."+f.handleUpdateAdFailure,function(e){y(e)&&(e&&e.errMsg&&l.log("Error calling "+f.handleUpdateAdFailure+" with error "+e.errMsg,l.LogLevels.error),c.PubSub.unsubscribe(a))});l.callSDKFunction(D(),{functionName:f.NativeAPI.updateAd,functionParams:{params:JSON.stringify(r)}},f.handleUpdateAdSuccess,f.handleUpdateAdFailure)},sendMessage:A,isContainerVisible:m,isExternalAdViewInitiated:function(){if(l.log("ExternalAdViewService | isExternalAdViewInitiated |"),i&&"pending"===i.status)return i;i=new p.Deferred;var n=c.PubSub.subscribe(u.CB+"."+f.handleIsInitiated,function(e){y(e)&&(l.log("ExternalAdViewService | "+f.handleIsInitiated+" "+JSON.stringify(e)),c.PubSub.unsubscribe(n),c.PubSub.unsubscribe(t),i.resolve(e))}),t=c.PubSub.subscribe(u.CB+"."+f.handleIsInitiatedFailure,function(e){y(e)&&(e&&e.errMsg&&l.log("Error calling "+f.handleIsInitiatedFailure+" with error "+e.errMsg,l.LogLevels.error),c.PubSub.unsubscribe(t),c.PubSub.unsubscribe(n),i.reject(e))});return l.callSDKFunction(D(),{functionName:f.NativeAPI.isExternalAdViewInitiated},f.handleIsInitiated,f.handleIsInitiatedFailure),i.promise()},getViewVisibility:function(){if(w("_getViewVisibility | external container"),r&&"pending"===r.status)return r;if(r=new p.Deferred,I()){var n=c.PubSub.subscribe(u.CB+"."+f.handleGetViewVisibilitySuccess,function(e){y(e)&&(w(f.handleGetViewVisibilitySuccess+" "+JSON.stringify(e)),c.PubSub.unsubscribe(n),c.PubSub.unsubscribe(t),r.resolve(e))}),t=c.PubSub.subscribe(u.CB+"."+f.handleGetViewVisibilityFailure,function(e){y(e)&&(e&&e.errMsg&&l.log("ExternalAdViewService | Error calling "+f.handleGetViewVisibilityFailure+" with error "+e.errMsg,l.LogLevels.error),c.PubSub.unsubscribe(t),c.PubSub.unsubscribe(n),r.reject(e))});return l.callSDKFunction(D(),{functionName:f.NativeAPI.getViewVisibility,functionParams:{adViewId:I()}},f.handleGetViewVisibilitySuccess,f.handleGetViewVisibilityFailure),r.promise()}r.reject({errMsg:"adViewId is missing"})},removeExternalAdView:function(e,n,t){l.callSDKFunctionWithCallback(D(),{functionName:f.NativeAPI.removeAdView,functionParams:{adViewId:e}},n,t)},setBannerHandlerDelegate:function(e){}}}},{"../../constants/SDKFeatureNames":89,"./ExternalAdViewConstants.js":70,"./WPADUtils":74,"./bannerLoadWhileShowHandler":77}],72:[function(e,n,t){var h=e("./ContainerCreationStateHandler"),S=e("./WPADUtils");n.exports=function(o,n,s,e){var t="ExternalContainer | ",i=new S(n),d=new h(n.jQuery(),n.log),r=!1,a=!1,c=e,l=null,u=[];function f(e){a=e}function g(e){b("_setAdIsVisibleInContainer = "+e),r=e}function p(){return r}function v(){b("_resetReportAdVisibilityFlags"),f(!1),g(!1)}function m(){return b("_getContainerID: "+c),c}function b(e){n.log(t+e)}return u.push(o.PubSub.subscribe("SDKController.AdVisible",function(e){var n;b("inside adVisibleHandler"),b("_shouldReceiveMessage containerID: "+c+" adViewId: "+(n=e).adViewId),(i.isBannerAd(n)&&i.isBannerAdViewId(c)||n.adViewId===c)&&(b("got SDKController.AdVisible | setting visibility to true"),g(!0))})),{setAdIsVisibleInContainer:g,resetReportAdVisibilityFlags:v,createAdUrlInAdView:function(e,n,t,i){var r,a;b("_createAdUrlInAdView "+n.productType),v(),(r=i).shouldCreateContainer=(a=r,!!o.Utils.isDefined(a.adSize)&&!(!o.Utils.isDefined(a.adSize.width)||!o.Utils.isDefined(a.adSize.height))&&0<a.adSize.width&&0<a.adSize.height),l&&l.assignAdViewAndStartHandle(m()),function(e){if(e||!e.productType)var n=o.PubSub.subscribe(e.productType+".GetConfig",function(e){e.adViewId&&e.adViewId===c&&(o.PubSub.unsubscribe(n),d.creationEnded(!0))})}(n),d.creationStarted(),s.loadWithUrl(e,n,t,i,function(){b("native reported on webview creation")})},sendMessageToExternalAdView:function(e){e&&c&&(e.adViewId||(e.adViewId=c)),s.sendMessage(e)},onExternalViewLoaded:function(e,n,t){f(!0),b("_onExternalViewLoaded"),e.displayOnAdReady&&s.getViewVisibility().then(function(e){s.isContainerVisible(e)&&(p()||t())})},isAdInExternalViewLoaded:function(){return b("isAdInExternalViewLoaded "+a),a},getContainerID:m,removeContainer:function(e,n){s.removeExternalAdView(c,e,n)},isVisible:p,isContainerLoaded:function(){return d.getState()===d.getCreationStates().createdSuccessfully},clean:function(){b("_clean"),o.PubSub.clearHandlers(u),l&&(l.stopHandle(),l=null),s.destroy(),s=null},getContainerCreationHandler:function(){return d},shouldReportAdVisible:function(){return a&&!r},setAdInstanceHandler:function(e){l=e}}}},{"./ContainerCreationStateHandler":69,"./WPADUtils":74}],73:[function(e,n,t){n.exports=function(c,l,u){var f=c.jQuery(),g={none:0,device:1,controller:2};function p(e,n,t,i){c.isIOS()&&f("body").css("height",n.scrollHeight),u.setBackgroundColorByMode("Neutral",t),l.displayView(),c.callSDKFunction("setBackButtonState",{state:g.controller}),e(!1,!1,null),u.changeMode("Neutral"),i(),f("#ssaNavigator").removeClass("webNavigation").addClass("defaultNavigation"),c.isIOS()&&setTimeout(function(){c.callSDKFunction("navigationModeChange",{state:!1})},70)}return{changeToNavigationMode:function(e,n,t,i,r){var a,o,s,d;f("body").css("height",""),u.setBackgroundColorByMode("Navigation","WebControls"),u.changeMode("Navigation"),l.hideView(),l.hideLoader(),c.callSDKFunction("setBackButtonState",{state:g.device}),e(!1,null),a=e,o=t,s=i,d=r,n.unbind("touchend").bind("touchend",function(e){e.stopPropagation(),e.preventDefault(),f("#ssaNavigatorBackButton").unbind("touchend"),c.callSDKFunction("controlSecondaryWebView",{action:"close"}),c.callSDKFunction("removeCloseEventHandler"),p(a,o,s,d)}),f("#ssaNavigatorBackButton").unbind("touchend").bind("touchend",function(e){e.stopPropagation(),e.preventDefault(),c.callSDKFunction("removeCloseEventHandler"),c.callSDKFunction("controlSecondaryWebView",{action:"back"})}),f("#ssaNavigator").removeClass("defaultNavigation").addClass("webNavigation"),c.callSDKFunction("navigationModeChange",{state:!0})},returnFromNavigationMode:p}}},{}],74:[function(e,n,t){n.exports=function(o){var s=e("../../constants/SDKFeatureNames"),d=e("../../components/Constants.js"),c=e("../../components/OMIDConstants"),n="bannerAdView";function l(e){return e.productType===d.BN}return{generateAdViewId:function(e){return o.isBannerNoneLWS(e.productType)?n:o.AdUtils.generateUniqueAdId(e)},generateBannerAdViewId:function(){return d.bannerAdViewId},isBannerAdViewId:function(e){return-1!==e.indexOf(d.bannerAdViewId)},shouldDisplayAdOnExternalWebView:function(e,n,t){if(o.log("_shouldDisplayAdOnExternalWebView"),l(e))return!0;if(o.OMIDService.isAdOmidSupported(e)){var i=(r=o.OMIDService.getVersionData().omidVersion)&&c.omidVersionRequiresWebviewPerAd[r];return o.log("_shouldDisplayAdOnExternalWebView - OMID Ad - requires WPAD: "+i),i}var r,a;return(a=n)&&!0===a.webviewPerAd?o.CompatibilityService.isFeatureSupportedInNativeSDK(s.webviewPerAdV1)?t===d.integrationType.automatic?(o.log("_shouldDisplayAdOnExternalWebView - not supported for auto instances"),!1):!n||0!==n.numOfBannersToInitSuccess||0!==n.numOfBannersToCache||(o.log("_shouldDisplayAdOnExternalWebView - numOfBannersToInitSuccess 0 , numOfBannersToCache 0"),!1):(o.log("_shouldDisplayAdOnExternalWebView - not supported for sdk version"),!1):(o.log("_shouldDisplayAdOnExternalWebView - wpad flag is off"),!1)},isBannerAd:l,getBannerAdViewId:function(){return n}}}},{"../../components/Constants.js":12,"../../components/OMIDConstants":42,"../../constants/SDKFeatureNames":89}],75:[function(e,n,t){n.exports=function(a,d,r,c,l,u,f){var n="Webview | ",g=!1,p=!1,v=!1,o=null,i={on:!1,productConfig:null},m=d.jQuery();function b(){A("state- open: "+g+", viewable: "+p+"engaged "+v+" , productConfig: "+JSON.stringify(o))}function e(e,n){if(A("received event: "+e+" sendCloseRequest: "+JSON.stringify(i)),"close"===e&&s(n)){var t=d.DemandUtils.extendCallbackParamsWithParentProductConfig(n);a.PubSub.publish("SDKController.onAdWindowsClosed",[t]),d.callSDKFunction("onAdWindowsClosed",t)}}function h(e,n){var t=r[d.getDeviceOs()+e]?e:"Neutral",i=m.extend({},r[d.getDeviceOs()+t]);n&&(i.position=n),d.callSDKFunction("setForceClose",i)}function t(){d.callSDKFunction("setForceClose",r.disable)}function s(e){return i.on&&i.productConfig===e?(i.on=!1,i.productConfig=null,b(),!0):(b(),!1)}function S(e){o=d.DemandUtils.extendCallbackParamsWithParentProductConfig(e,{integrationType:d.AdUtils.getIntegrationType(e)}),v=!0,b()}function y(e,n){h(e,n)}function A(e){d.log(n+e)}return a.PubSub.subscribe("SDKController.SetForceClose",function(e){var n;n=e,!a.Utils.isDefined(n.isEnable)||n.isEnable?y("Neutral",n.position):t()}),{setBackgroundColorByMode:function(e,n){"Navigation"===e?(u.setSDKWebviewBGColor(u.getSDKWebviewBGColorByProductType(n)),u.setControllerBGColor(u.getControllerBGColorByProductType(n))):"Neutral"===e&&(u.setControllerBGColor(u.getControllerBGColorByProductType(n)),u.setSDKWebviewBGColor(u.getSDKWebviewBGColorByProductType(n)))},display:function(e,n){if(e){if(d.isAndroid()||!g&&!p||!l.supportOrientation){var t=f.getAdDisplayOrientation(d.getConfig(),d.getApplicationExternalConfig(),e);d.OrientationService.setOrientation(t)}else A("avoiding setOrientation for new displayed ad");if(g||p)return A("be might here because of next offer, engaged is "+v),void(v=!0);var i,r;r={adViewId:n},(i=e)&&i.productType?d.getNotchService().onSetConfig(i)?(u.setSDKWebviewBGColor(u.backgroundColors.semiTransparent,r),u.setControllerBGColor(u.backgroundColors.semiTransparent)):i.settings.setContainerBGColorBlack?u.setControllerBGColor(u.backgroundColors.black):(u.setSDKWebviewBGColor(u.getSDKWebviewBGColorByProductType(i.productType),r),u.setControllerBGColor(u.getControllerBGColorByProductType(i.productType))):u.setControllerBGColor(u.backgroundColors.darkGrey),h(i.productType),S(e),d.ViewsManager.init(e,n);var a=d.DemandUtils.extendCallbackParamsWithParentProductConfig(e,d.ViewsManager.getDisplayWebViewParams(!0)),o=function(e){var n={};if(d.isAndroid()&&!l.supportImmersive){var t=e.settings&&e.settings.immersive;m.extend(n,{immersive:t})}return d.isAndroid()&&e.settings.galaxyFix&&(A("removeViewOnDestroy"),n.removeViewOnDestroy=!0),l.translucent||(n.activityThemeTranslucent=!!e.settings.translucentView),d.isIOS()&&m.extend(n,{appOrientation:d.AppOrientationManager.getOrientation(),ModalPresentationStyle:c.iOS_UIModalPresentationFullScreen}),n}(e);A("display platformParams: "+JSON.stringify(o)),A("display displayParams: "+JSON.stringify(a));var s=m.extend(o,a,{integrationType:d.AdUtils.getIntegrationType(e)});d.callSDKFunction(c.nativeInterfaceMethod.displayWebView,s),g=!0,b()}},hide:function(){g&&function(){var e,n,t=new m.Deferred,i=function(){a.PubSub.unsubscribe(e),a.PubSub.unsubscribe(n),t.resolve()};d.log("webview | hide | "+JSON.stringify(o),d.LogLevels.verbose);var r=d.DemandUtils.extendCallbackParamsWithParentProductConfig(o,d.ViewsManager.getDisplayWebViewParams(!1));return r.integrationType=o.integrationType,l.supportAdCloseCB?(e=a.PubSub.subscribe(c.CB+"."+c.nativeCallBacks.hideSuccess,i),n=a.PubSub.subscribe("SDKController.HybridAdDidClosed",i)):t.resolve(),d.callSDKFunction(c.nativeInterfaceMethod.displayWebView,r,c.nativeCallBacks.hideSuccess,c.nativeCallBacks.hideFailed),window.timerService.stopTimer(window.lastWebviewClosedTimer),window.lastWebviewClosedTimer=window.timerService.startTimer(),t.promise()}().then(function(){g=!1,i.productConfig=o,i.on=!0,b(),v||e("close",o)})},setVisibility:function(e){p=e,b()},shouldNotifyClose:s,loadProduct:S,unloadProduct:function(){v=!1,b(),i.on&&e("close",o)},changeMode:y,disableForceClose:t,setWebviewBGColorTransparent:function(){u.setControllerBGColor(u.backgroundColors.transparent)},setControllerBGColor:function(e){u.setControllerBGColor(u.getControllerBGColorByProductType(e))},getState:function(){return{engaged:v,opened:g,productConfig:o,viewable:p,standalone:!1}},redraw:function(){d.isAndroid()&&20<=d.getConfigurationHelper().getDeviceApiLevel()&&(u.setSDKWebviewBGColor(u.backgroundColors.black),u.setSDKWebviewBGColor(u.backgroundColors.transparent))}}}},{}],76:[function(e,n,t){var T=e("./ExternalContainer"),O=e("./ExternalAdViewService"),F=e("./ExternalAdViewConstants"),i=e("./AdViewsCollections"),L=(e("../../constants/SDKFeatureNames"),e("./BannerHandlerDelegate"));n.exports=function(h,S,y,A){var C="WebViewManager | ",D=e("./WPADUtils")(S),I=S.jQuery(),w=new i({controller:S});function r(e){if(e)return P("_getAdViewByAd "+e.adViewId),w.getAdViewById(e.adViewId)}function P(e){S.log(C+e)}return{loadAdUnitUrlToView:function(e,n,t,i){var r,a,o,s,d;if(r=e,h.PubSub.subscribe(r.productType+".reset",function(e){P("webViewManager | reset"),w.toArray().forEach(function(e){e.getContainerID()===D.getBannerAdViewId()&&(w.removeAdViewById(e.getContainerID()),e.clean())})}),S.log(C+"_loadAdUnitUrlToView"),n&&e){var c,l,u=(s=e,d=new O(h,S,y,A),s.adViewId=D.generateAdViewId(s),S.isBannerNoneLWS(s.productType)?d.init(F.nativeFunction,s.adViewId):d.init(F.nativeFunctionAdViewAPI,s.adViewId),new T(h,S,d,s.adViewId));c=e,l=u.getContainerID(),e=I.extend(c,{adViewId:l}),w.add(u);var f,g,p=(f=i,g=u.getContainerID(),I.extend(f,{adViewId:g}));a=p,p=(o=e).adSize?I.extend(a,{adSize:o.adSize}):a;var v,m,b=(v=n,m=u.getContainerID(),v+"&"+y.adViewIdString+"="+m);!function(e,n,t){if(P("assignAdInstanceHandlerToExternalContainer | id: "+t.getContainerID()),t&&S.isBannerAndLoadWhileShowSupported(e)){var i=new L(h,S,y,A,n);t.setAdInstanceHandler(i)}}(e.productType,e.demandSourceId,u),u.createAdUrlInAdView(b,e,t,p)}else P("_loadAdUnitUrlToView without ad/url")},updateAdUnitUrl:function(e,n,t,i){},displayAdView:function(e,n,t,i){P("_displayAdView"),A.set(e),I.when(i(e)).then(function(){P("_displayView after adunitOpenCallback"),n(!1),t()})},handleScreenVisible:function(e,n){P("_handleScreenVisible");var t=r(n);t.sendMessageToExternalAdView({message:"handleScreenVisible",adViewId:t.getContainerID()})},unloadAdView:function(e){P("_unloadAdView "+e.adViewId);var n=r(e);n?n.removeContainer(function(e){e&&e.adViewId===n.getContainerID()&&(P("_unloadAdView | successCallback | removed id"+e.adViewId),w.removeAdViewById(n.getContainerID()).clean())},function(e){e&&e.adViewId===n.getContainerID()&&(h.PubSub.publish("SDKController.removeContainerError",[e]),P("_unloadAdView | failCallback | id"+e.adViewId),w.removeAdViewById(n.getContainerID()).clean())}):P("_unloadAdView | ad is not engaged / no external container")},displayLoader:function(e){P("_displayLoader");var n=r(e);n&&n.sendMessageToExternalAdView({message:"displayLoader",adViewId:n.getContainerID()})},hideLoader:function(e){P("_hideLoader");var n=r(e);n&&n.sendMessageToExternalAdView({message:"hideLoader",adViewId:n.getContainerID()})},hideView:function(e){P("_hideView ad: "+JSON.stringify(e));var n=r(e);n&&n.sendMessageToExternalAdView({message:"hideFrame",adViewId:n.getContainerID()})},displayView:function(e){P("_displayView ad: "+JSON.stringify(e));var n=r(e);n&&n.sendMessageToExternalAdView({message:"displayFrame",adViewId:n.getContainerID()})},isContainerLoaded:function(e){var n=r(e),t=!!n&&n.isContainerLoaded();return P("_isContainerLoaded: "+t),t},onAdUnitLoaded:function(e,n,t){P("_onAdUnitLoaded");var i=r(e);i&&(i.isAdInExternalViewLoaded()?P("already received the loaded event for container"):(i.onExternalViewLoaded(e,n,t),P("ad loaded:"+e.id)))},isAdViewExistForAd:function(e){return P("_isAdViewExistForAd"),!!e&&w.isExist(e.adViewId)},getAdViewByAd:r,sendMessageToDisplayedAdView:function(e){P("_sendMessageToDisplayedAdView");var n=r(A.get());n&&n.sendMessageToExternalAdView(e)},sendMessageToAllAdViews:function(n){P("_sendMessageToAllAdViews"),w.toArray().forEach(function(e){e.sendMessageToExternalAdView(n)})},getDisplayedAdView:function(e){P("_getDisplayedAdView ad: "+JSON.stringify(e));var n=r(e);return n&&(P("external container visible="+n.isVisible()),n.isVisible())?n:null},isViewDisplayed:function(e){return e.isVisible()},getContainerCreationHandler:function(e){var n=r(e);return n?n.getContainerCreationHandler():null}}}},{"../../constants/SDKFeatureNames":89,"./AdViewsCollections":63,"./BannerHandlerDelegate":68,"./ExternalAdViewConstants":70,"./ExternalAdViewService":71,"./ExternalContainer":72,"./WPADUtils":74}],77:[function(e,n,t){var i=e("./ExternalAdViewConstants.js");n.exports=function(n,t){return{handleVisible:function(e){e.adViewId&&(t.log("ExternalAdViewService | bannerMultipleInstancesHandler| handleVisible: isVisible."+e.adViewId,t.LogLevels.error),n.PubSub.publish("Banner.isVisible",[e]),n.PubSub.publish("isVisible."+e.adViewId,[e]))},handleRemoved:function(e){e.adViewId&&(t.log(" ExternalAdViewService | bannerMultipleInstancesHandler | "+i.handleContainerWasRemoved,t.LogLevels.error),n.PubSub.publish("removed."+e.adViewId,[e]))},handlePerformDestroy:function(e){e.adViewId&&(t.log(" ExternalAdViewService | bannerMultipleInstancesHandler | handlePerformDestroy"),n.PubSub.publish("destroy."+e.adViewId,[e]))}}}},{"./ExternalAdViewConstants.js":70}],78:[function(t,e,n){e.exports=function(i,e,n){var r,a,s=t("../OrientationUtils.js")(),o=n.appInfo.orientation.none,d=!1,c={free:n.appInfo.orientation.none,portrait:n.appInfo.orientation.portrait,landscape:n.appInfo.orientation.landscape};function l(e,n,t){d=!1;var i=c[(e||"").toLowerCase()];if(i)return d=!0,i;if(!t)return n;var r,a=s.sharedOrientationBetweenOrientations(t.viewControllerToPresentFrom||t.topMostViewControllerOrientation,t.windowOrientation),o=(r=(a&&0<a.length?s.convertOrientationsArrayToNumber(a):t.windowOrientation).toString(),s.isContainPortrait(r)&&s.isContainLandscape(r)?c.free:s.isContainPortrait(r)?c.portrait:c.landscape);return o!==n&&(d=!0),o}return{init:function(e,n){r=e,a=n.appOrientation,o=l(r,a,n.orientationRestriction)},getOrientation:function(){return o},isAppOrientation:function(e){return o===e},isChangedExternally:function(){return d},updateAppOrientationByNewRestriction:function(e){if(e){var n,t=o;o=l(r,a,e),t!==(n=o)&&i.PubSub.publish("AppOrientationManager.appOrientationChanged",[{appOrientation:n}])}}}}},{"../OrientationUtils.js":48}],79:[function(e,n,t){function i(r,a,e){var o=e||{},n,s,d=!1,c=a.Cache,l={campaignsOnly:"campaignsOnly",globalsOnly:"globalsOnly",globalsAndCampaigns:"globalsAndCampaigns"},t=!1,i=!1,u=a.jQuery();function f(e){t=e}function g(e,n,t){return c.cacheAds(o,e,n,t)}function p(e,n,t){return setTimeout(function(){!0,a.log("Time out in update cache. Fallback to non-precache.",a.LogLevels.error),r.PubSub.publish("PrecacheManager.fallbackToNonPrecache",[{demandSourceName:o.demandSourceName,productType:o.productType}]),v(!1),r.PubSub.publish("Cache.StopCacheUpdate",[{demandSourceName:o.demandSourceName,productType:o.productType}]),f(!1),c.clearCacheByType(o,[]).then(function(){n()}).fail(function(){var e="Error deleting globals in fallback to NPC";a.log(e,a.LogLevels.error),t(e)})},o.nonPrecacheFallback)}function v(e){n=e}function m(i){s=p(d,i.cacheTimeoutSuccessCallback,i.cacheTimeoutFailCallback),f(!0),g(i.applicationKey,i.newAdsToEnterCache,i.adAssetsCacheConfig).then(function(){a.log("PM | success",a.LogLevels.verbose),clearTimeout(s),d||(a.log("cache update completed",a.LogLevels.verbose),f(!1),r.PubSub.publish("PrecacheManager.cacheAdsSuccessCallback",[o]))},function(e,n,t){if(clearTimeout(s),!d){f(!1),r.PubSub.publish("PrecacheManager.cacheAdsFailedCallback",[{productType:o.productType,demandSourceName:o.demandSourceName,deletedOffers:n,deletedAdsData:t,errorLog:"Error adding new ads from queue, some campaigns were deleted.",cacheParam:e,inventoryId:i.inventoryId}])}})}function b(e){a.log("PrecacheManager | updateConfig"),u.extend(o,e)}function h(e){var n=e.numOfCampaigns||0,t=e.settings||{};return b({settings:t}),0<=t.numOfBannersToInitSuccess&&0<n&&0<t.numOfBannersToCache?(t.numOfBannersToCache<t.numOfBannersToInitSuccess&&(t.numOfBannersToInitSuccess=t.numOfBannersToCache),n<t.numOfBannersToInitSuccess&&(t.numOfBannersToInitSuccess=n),n<t.numOfBannersToCache&&(t.numOfBannersToCache=n),v(!0),t.maxCachedCampaigns=o.maxCachedCampaigns,c.setSettings(o,t)):(t.numOfBannersToInitSuccess=t.numOfBannersToCache=0,v(!1)),r.Utils.returnResolvedPromise()}function S(e){return e&&e.cacheBase===o.cacheBase}function y(){r.PubSub.subscribe("Cache.cacheUpdated",function(e){S(e)&&(u.extend(e,o),r.PubSub.publish("PrecacheManager.cacheUpdatedCallback",[e]))}),r.PubSub.subscribe("Cache.campaignDeleted",function(e){S(e)&&(u.extend(e,o),r.PubSub.publish("PrecacheManager.campaignDeletedCallback",[e]))}),r.PubSub.subscribe("Cache.campaignSaved",function(e){if(S(e)){var n=u.extend({},e,o);r.PubSub.publish("PrecacheManager.campaignSavedCallback",[n])}}),r.PubSub.subscribe("Cache.campaignDownloadStarted",function(e){S(e)&&(u.extend(e,o),r.PubSub.publish("PrecacheManager.campaignDownloadStartedCallback",[e]))}),r.PubSub.subscribe("Cache.preProcessingFailed",function(e){S(e)&&(u.extend(e,o),r.PubSub.publish("PrecacheManager.preProcessingFailedCallback",[e]))})}function A(){return n}function C(){var e,n,t=new u.Deferred,i=A();function r(e){t.resolve(e)}return o.settings.purgeCacheOnInit?(n="purge cache on init (settings)",e=!0):i||(n="purge cache on non-precache",e=!0),e?(a.log("handleCacheClear purge reason: "+n,a.LogLevels.verbose),c.clearCacheByType(o,[]).then(r.bind(null,l.campaignsOnly),function(){t.reject("Error in clearing cache")})):r(),t.promise()}function D(e){A()&&(f(!0),c.cacheNext(o,e).always(function(){f(!1)}).fail(function(e,n,t){a.log("line[451]: failed updating cache on cache next with deletedAds: "+n,a.LogLevels.verbose),n&&0<n.length&&r.PubSub.publish("PrecacheManager.cacheNextFail",[{productType:o.productType,demandSourceName:o.demandSourceName,deletedAds:n,deletedAdsData:t,inventoryId:n[0].inventoryId}])}))}function I(){return l}function w(){return c.getNextAvailableAd(o)}function P(e){return c.clearCacheByType(o,e)}function T(e,n){return n=r.Utils.isDefined(n)?n:o.settings.numOfBannersToCache,c.mergeCampaigns(e,n,o.settings.maxCachedCampaigns,o)}function O(e,n){return c.areCampaignsAvailable(e,n,o)}function F(){return c.getCacheSizeByType(o)}function L(){return c.incrementNextCampaign(o)}function x(e){return c.getCurrentAd(o,e)}function N(e){return c.isNextAvailable(o,e)}function U(){return c.cacheNext(o)}function M(e,n){return c.setAdInventoryIndex(o,e,n)}function V(e){return c.isAdInCache(o,e)}function E(e){return c.setSettings(o,e)}function k(){i||(i=!0,y(),c.initCacheBase(o.cacheBase))}function B(e){return c.getAdStatusInQueue(o,e)}function R(e){return c.deleteCachedCampaign(o,e)}function K(e,n){return c.cacheSingleAd(o,e,n)}var j={updateConfig:b,init:k,decidePrecacheStatus:h,isPrecache:A,handleCacheClear:C,mergeCampaigns:T,handleCacheAds:m,updateCache:D,clearCacheByType:P,areCampaignsAvailable:O,getCacheSizeByType:F,setAdInventoryIndex:M,incrementNextCampaign:L,getCurrentAd:x,isAdInCache:V,getAdStatusInQueue:B,setCacheSettings:E,getNextAvailableAd:w,isNextAvailable:N,getCacheClearMessages:I,cachingStatus:c.cachingStatus,deleteCachedCampaign:R,cacheSingleAd:K,getConfig:function(){return o}};return j}n.exports=i},{}],80:[function(e,n,t){n.exports=function(i){var r=e("./SDKPluginTypeConstants.js");return{shouldShowInStandAloneView:function(e){var n=e.getApplicationExternalConfig().getGeneralConfig()[r.microJobFlags.showStandaloneViewInAdobe];null!==n&&i.isDefined(n)||(n=!0);var t=!e.isLegacy(e.featureMap.showStandaloneViewInAdobe)&&n;return e.log("AdobeAirPluginHandler | shouldShowInStandAloneView | useStandAloneView: "+t),t}}}},{"./SDKPluginTypeConstants.js":81}],81:[function(e,n,t){n.exports={supportedPluginNames:{adobeAir:"AdobeAir"},microJobFlags:{showStandaloneViewInAdobe:"showStandaloneViewInAdobe"}}},{}],82:[function(o,e,n){e.exports=function(t,i){var r=o("./SDKPluginTypeConstants.js");function a(e){return(n=e).applicationSettings&&n.applicationSettings.SDKPluginType&&n.applicationSettings.SDKPluginType===r.supportedPluginNames.adobeAir?(t.log("SDKPluginTypeHandler | createPluginHandler | creating adobe handler"),new(o("./AdobeAirPluginHandler.js"))(i)):(t.log("SDKPluginTypeHandler | createPluginHandler | plugin handler is not required"),null);var n}return{shouldShowInStandAloneView:function(e){t.log("SDKPluginTypeHandler | shouldShowInStandAloneView");var n=a(e);return n&&"function"==typeof n.shouldShowInStandAloneView?n.shouldShowInStandAloneView(t):(t.log("SDKPluginTypeHandler | shouldShowInStandAloneView | "+(n?"function not supported in handler":"no plugin handler")),!1)}}}},{"./AdobeAirPluginHandler.js":80,"./SDKPluginTypeConstants.js":81}],83:[function(e,n,t){n.exports={versions:{SKAN1:1,SKAN2:2},applicationSettingsKeys:{skd:"skd",skanv:"skanv",atid:"atid",providers:"providers",skanIds:"skanIds"},controllerConfigKeys:{SKANData:"SKANData",version:"version",sourceAppTrackID:"sourceAppTrackID",adNetworkIDs:"adNetworkIDs"},nativeParamsKeys:{adNetworkId:"adNetworkId",adNetworkCampaignId:"adNetworkCampaignId",id:"id",adNetworkNonce:"adNetworkNonce",adNetworkImpressionTimestamp:"adNetworkImpressionTimestamp",adNetworkAttributionSignature:"adNetworkAttributionSignature",adNetworkPayloadVersion:"adNetworkPayloadVersion",adNetworkSourceAppStoreIdentifier:"adNetworkSourceAppStoreIdentifier"},SKAdImpression:{minimalSupportedIOSVersion:14.5,jsInterface:"SKAdImpressionAPI",startImpression:"startImpression",startImpressionSuccess:"startImpressionSuccess",startImpressionFailed:"startImpressionFailed",endImpression:"endImpression",endImpressionSuccess:"endImpressionSuccess",endImpressionFailed:"endImpressionFailed"}}},{}],84:[function(e,n,t){n.exports=function(){var l=e("./SKANConstants");function u(e,n,t){var i={};return e&&(i.SKANVersion=e),n&&(i.SKANSourceAppTrackID=n),t&&Array.isArray(t)&&0<t.length&&(i.SKANAdNetworkIDs=t.toString()),i}function t(e){if(!e)return{};var n=parseFloat(e.version);return n?n<l.versions.SKAN2?r(e):a(e):i(e)}function i(e){var n={};return n[l.nativeParamsKeys.id]=e.advertisedAppTrackID||e.appId,n}function r(e){var n=i(e);return n[l.nativeParamsKeys.adNetworkId]=e.adNetworkID,n[l.nativeParamsKeys.adNetworkImpressionTimestamp]=e.timestamp,n[l.nativeParamsKeys.adNetworkNonce]=e.nonce&&e.nonce.toLowerCase(),n[l.nativeParamsKeys.adNetworkAttributionSignature]=e.signature,n[l.nativeParamsKeys.adNetworkCampaignId]=e.SKANCampaignID,n}function a(e){var n=r(e);return n[l.nativeParamsKeys.adNetworkPayloadVersion]=e.version,n[l.nativeParamsKeys.adNetworkSourceAppStoreIdentifier]=e.sourceAppTrackID,n}function n(e,n){return jQuery.extend({},e.settings&&e.settings.SKANData,e.ext&&e.ext.SKANData,e.ext&&e.ext.SKANData&&e.ext.SKANData[n])}return{extractDataForPayload:function(e,n){var t=function(e){var n=!!e&&e[l.applicationSettingsKeys.skd];if(!n)return{};var t=n[l.applicationSettingsKeys.skanv],i=n[l.applicationSettingsKeys.atid],r=n[l.applicationSettingsKeys.providers],a=[];if(r)for(var o=0,s=Object.keys(r);o<s.length;o++){var d=s[o];if(r[d]){var c=r[d][l.applicationSettingsKeys.skanIds];c&&Array.isArray(c)&&0<c.length&&(a=a.concat(c))}}return u(t,i,a)}(n);return 0===Object.keys(t).length&&(t=function(e){if(!e)return{};var n=e[l.controllerConfigKeys.SKANData];if(!n)return{};var t=n[l.controllerConfigKeys.version],i=n[l.controllerConfigKeys.sourceAppTrackID],r=n[l.controllerConfigKeys.adNetworkIDs];return u(t,i,r)}(e)),t},extractDataForSKAdImpression:function(e){return a(n(e,"VTA"))},buildStoreKitLoadDataForSDK:function(e,n){return e?{appId:e.appId,viewUniqueId:n,storeKitLoadParams:t(e)}:{}},extractDataForSKOverlay:function(e){return e?t(n(e,"StoreKit")):{}}}}},{"./SKANConstants":83}],85:[function(e,n,t){n.exports=function(e,n,t,i){var r=parseInt(e),a=0,o=function(e){return!!r&&(-1!==t.storeKit.loadFailuresToPreventRetry.indexOf(e)?(i("StoreKitLoadingRetryExecutor | _shouldPerformRetry | stop executing retries for reason: "+e),!1):(r<=a&&i("StoreKitLoadingRetryExecutor | _shouldPerformRetry | All retries attempts exhausted"),a<r))};return{shouldPerformRetry:o,performRetry:function(){a++,"function"==typeof n&&(i("StoreKitLoadingRetryExecutor | _performRetry | Performing retry attempt #"+a),n())},getCurrentAttempt:function(){return a},cancelAdditionalRetryAttempts:function(){o=function(){return!1}}}}},{}],86:[function(e,n,t){n.exports=function(b,h,S){var n=e("../../patches/PatchStoreKitOsVersion"),y=e("./SKANModel")(),A=e("../../constants/SDKFeatureNames"),C=e("./StoreKitLoadingRetryExecutor"),D="NativeCallback",t=!1;function I(e){return e.viewIdentifier?e.viewIdentifier:e.viewUniqueId}function w(e,n){var t={isViewable:e,changeReason:n};b.PubSub.publish(D+".viewableChange",[t])}function P(e){t=e}function T(){return!h.CompatibilityService.isFeatureSupportedInNativeSDK(A.loadStoreKitOncePerAd)}function O(e){if(F()){if(!e)return;h.callSDKFunction("clearAppPage",{viewUniqueId:e})}}function F(e){if(!h.isIOS())return!1;try{if(parseInt(h.getConfig().mobileSDKSettings.deviceApiLevel)<S.storeKit.minimalSupportedOSVersion)return!1}catch(e){h.log("StoreKitService | isStoreKitSupported | failed to parse deviceApiLevel as integer")}return!(n(b.Utils,h.CompatibilityService).shouldBlock(h.getApiData({deviceOSVersion:1}).deviceOSVersion)||e&&!0===e.standaloneView||h.isLegacy(h.featureMap.hybrid))}return b.PubSub.subscribe("SDKController.PreloadAppInstallPage",function(e){h.log("SDKController.PreloadAppInstallPage"),h.checkRequiredCallbackParams(["appId"],e,"preloadAppInstallPage").didSucceed?function e(t,n){var i,r,a=I(t),o=(r=t.productType)&&h.getApplicationExternalConfig().getABTestConfiguration(r).storeKitLoadingTimeout||3e4,s=n||C(t.loadRetryAttempts,m,S,h.log);if(F(t)){var d=y.buildStoreKitLoadDataForSDK(t,a);h.callSDKFunction("preLoadAppPage",d,"preloadAppInstallPageSuccess","preloadAppInstallPageFailure");var c=b.PubSub.subscribe(D+".appStoreInsideLoaded",function(e){if(e&&"object"==typeof e&&e.viewUniqueId&&e.viewUniqueId===a){clearTimeout(i),b.PubSub.unsubscribe(c),t.callback&&(e.isLoaded||(e.currentLoadRetryAttempt=s.getCurrentAttempt()),t.callback.call(null,e));var n=e.errMsg&&decodeURIComponent(e.errMsg);!e.isLoaded&&s.shouldPerformRetry(n)&&s.performRetry()}}),l=b.PubSub.subscribe(D+".appStoreInsideDisplayStoreKit",function(e){if(e.viewUniqueId=I(e),h.log("appStoreInsideDisplayStoreKit "+e.viewUniqueId,h.LogLevels.verbose),e.viewUniqueId===a){P(!0);var n=jQuery.extend({name:"appStoreInsideVisible",shouldPreloadStoreKitOnStoreKitClose:T()},e);h.postAdUnitEvent(n),w(!1,"storeKitOpen"),h.SKOverlayManager.onSKOpen()}}),u=b.PubSub.subscribe(D+".appStoreInsideClosed",function(e){e.viewUniqueId===a&&(!1!==e.didStoreKitPresent&&!1!==e.isClosed?(p(e),h.SKOverlayManager.onSKClose()):g(e))}),f=b.PubSub.subscribe("SDKController.ClearAppPage",function(e){e.viewUniqueId===a&&(h.checkRequiredCallbackParams(["viewUniqueId"],e,"ClearAppPage").didSucceed?(b.PubSub.unsubscribe(f),v()):h.log("error calling clear App install page with "+JSON.stringify(e),h.LogLevels.error))}),g=function(e){s.cancelAdditionalRetryAttempts(),h.CompatibilityService.isFeatureSupportedInNativeSDK(A.loadStoreKitOncePerAd)&&O(e.viewUniqueId),h.log("storeKit Failed to Load ",h.LogLevels.verbose),v()},p=function(e){P(!1);var n=jQuery.extend({name:"appStoreInsideClosed",shouldPreloadStoreKitOnStoreKitClose:T()},e);h.postAdUnitEvent(n),w(!0,"storeKitClose"),T()&&(b.PubSub.unsubscribe(l),b.PubSub.unsubscribe(u))},v=function(){b.PubSub.unsubscribe(c),b.PubSub.unsubscribe(u),b.PubSub.unsubscribe(l)};i=setTimeout(function(){h.log("reach appstoreinside loading timeout",h.LogLevels.verbose),h.postAdUnitEvent({name:"appStoreLoadingTimeout",viewUniqueId:a,currentLoadRetryAttempt:s.getCurrentAttempt(),errMsg:S.storeKit.loadingTimeoutMessage},!0),s.shouldPerformRetry(S.storeKit.loadingTimeoutMessage)?s.performRetry():(v(),O(a))},o)}function m(){clearTimeout(i),O(a),e(t,s)}}(e,null):h.log("error calling preload App install page with "+JSON.stringify(e),h.LogLevels.error)}),b.PubSub.subscribe("SDKController.ClearAppPage",function(e){e.viewUniqueId=I(e),h.checkRequiredCallbackParams(["viewUniqueId"],e,"ClearAppPage").didSucceed?e&&e.viewUniqueId&&O(e.viewUniqueId):h.log("error calling clear App install page with "+JSON.stringify(e),h.LogLevels.error)}),{updateAdWithStoreAppId:function(e,n){if(e&&e.ext&&e.ext.clickTags&&e.ext.clickTags.storeAppId&&!F(n)&&delete e.ext.clickTags.storeAppId,n&&!1!==n.extractAppIdForStoreKit&&F(n)&&e&&e.ext&&e.ext.clickTags&&!e.ext.clickTags.storeAppId&&e.ext.clickTags.pixelURL){var t=h.AdUtils.getStoreAppId(e);t&&(e.ext.clickTags.storeAppId=t)}return e},getViewUniqueId:I,isStoreKitVisible:function(){return t}}}},{"../../constants/SDKFeatureNames":89,"../../patches/PatchStoreKitOsVersion":170,"./SKANModel":84,"./StoreKitLoadingRetryExecutor":85}],87:[function(e,n,t){n.exports={NativeAPI:{failCallback:"updateTokenFail",successCallback:"updateTokenSuccess"},ControllerNativeAPI:{updateToken:"updateToken"},tokenAPI:"iabTokenAPI",payloadKeys:{common:{biddingRVImpressions:!0,biddingISImpressions:!0,totalRVSessionImpressions:!0,totalISSessionImpressions:!0,auid:!0},android:{gpi:!0,blacklistedCampaigns:!0},ios:{}}}},{}],88:[function(o,e,n){e.exports=function(e,r,n,t,i){var a=o("./TokenConstants");return e.PubSub.subscribe(n.CB+"."+a.NativeAPI.failCallback,function(e){r.log("TokenService | updateTokenFail: "+JSON.stringify(e));var n=e.errMsg?e.errMsg:"unknown";t.trackEvent(i.updateTokenFail,{generalMessage:n})}),{updateToken:function(e){if(!r.isLegacy(r.featureMap.tokenAPI)){var n=function(e){if(!e)return{};var n={},t=a.payloadKeys.common;for(var i in jQuery.extend(t,a.payloadKeys[r.getConfig().mobileSDKSettings.deviceOs]),t)t.hasOwnProperty(i)&&e.hasOwnProperty(i)&&(n[i]=e[i]);return n}(e);r.log("TokenService | _updateNativeToken | data: "+JSON.stringify(n)),0!==Object.keys(n).length&&r.callSDKFunction(a.tokenAPI,{functionName:a.ControllerNativeAPI.updateToken,functionParams:n},null,a.NativeAPI.failCallback)}}}}},{"./TokenConstants":87}],89:[function(e,n,t){n.exports={bannerMultipleInstances:"bannerMultipleInstances",storeKitDismissVCOnFinishCallback:"storeKitDismissVCOnFinishCallback",limitAppFiltering:"disableCheckInstalledAppsJSInterface",noPackagesInstallationPolling:"noPackagesInstallationPolling",webviewPerAdV1:"webviewperad-v1",loadStoreKitOncePerAd:"loadStoreKitOncePerAd",SKAdImpression:"SKAdImpression",SKOverlay:"SKOverlay"}},{}],90:[function(e,n,t){n.exports={userData:{ios:"5.1",android:"5.1"},loadIS:{ios:"5.7",android:"5.10"},selfLoadingIS:{ios:"5.19",android:"5.20"},supportImmersive:{ios:"99",android:"5.26"},rvPortraitOrientation:{ios:"5.30",android:"5.30"},MDS:{RewardedVideo:{ios:"5.29",android:"5.29"},Interstitial:{ios:"5.48",android:"5.48"},Banner:{ios:"5.51",android:"5.51"}},nativeHttpEngine:{ios:"5.36",android:"99"},translucent:{ios:"99",android:"5.37"},hybrid:{ios:"5.40",android:"99"},supportOrientation:{ios:"5.39",android:"99"},postAdEventNotification:{ios:"5.43",android:"5.43"},MOAT:{ios:"5.46",android:"5.46"},demandState:{ios:"5.47",android:"5.47"},ringerSwitch:{ios:"5.48",android:"99"},appOrientationRestrictions:{ios:"5.50",android:"99"},GDPRSupport:{ios:"5.51",android:"5.51"},adCloseCB:{ios:"5.51",android:"99"},showStandaloneViewInAdobe:{ios:"5.54",android:"99"},tokenAPI:{ios:"5.62",android:"5.63"},messageSecurity:{ios:"99",android:"5.70"},OMID:{ios:"5.67",android:"5.74"},getTokenSupport:{ios:"5.66",android:"5.73"},pullingNativeDeviceData:{ios:"5.76",android:"5.81"},mutableAdvertingTrackingData:{ios:"5.79",android:"99"}}},{}],91:[function(e,n,t){var u={ext:{clickTags:{backgroundLandscape:"",backgroundPortrait:""},videoData:{videoPoster:"",videoSource:{videoformat_mp4:""}},appData:{appIcon:"",appImages:{both:[],portrait:[],landscape:[]}}}},f={ext:{videoData:{videoSource:{vast:""}}}},g={ext:{vastData:{xmlResponse:""}}},p={ext:{videoData:{videoPoster:"",videoSource:{videoformat_mp4:""}},appData:{appIcon:{url:""},appImages:[{url:""}]},imageData:{landscape:"",portrait:""}}},v={ext:{imageData:{landscape:"",portrait:""},layoutData:{portrait:{closeButtonUrl:"",frameUrl:""},landscape:{closeButtonUrl:"",frameUrl:""}}}},m={ext:{videoData:{videoPoster:"",videoSource:{videoformat_mp4:""}},layoutData:{html:""}}},b={ext:{videoData:{videoSource:{videoformat_mp4:""}},clickTags:{backgroundLandscape:""}}},h={ext:{videoData:{videoSource:{html:""}}}},S={ext:{videoData:{videoSource:{videoformat_mp4:""}},appData:{appIcon:""}}},y={ext:{videoData:{videoPoster:"",videoSource:{videoformat_mp4:""}},imageData:{landscape:"",portrait:""},layoutData:{portrait:{closeButtonUrl:"",frameUrl:""},landscape:{closeButtonUrl:"",frameUrl:""}}}};n.exports=function(){var s=function(e,n){return n+e.split("/").pop()},r=function(e,n){for(var a=[],t=Object.keys(n),i=0;i<t.length;i++)e[t[i]]&&o(n[t[i]],e[t[i]]);function o(e,n){var t,i;if("string"==typeof e)a.push(n);else if(e instanceof Array&&0===e.length)a=a.concat(n);else if(e instanceof Array&&0<e.length&&n instanceof Array&&0<n.length)for(t=0;t<n.length;t++)for(i=0;i<e.length;i++)o(e[i],n[t]);else{var r=Object.keys(e);for(t=0;t<r.length;t++)n[r[t]]&&o(e[r[t]],n[r[t]])}}return a};function o(e){return!!e.src&&e.src}function d(e){var n,t=r(e,l(e)),i=0<t.length&&t[0];return!!i&&((n=document.createElement("div")).innerHTML=i,n.firstChild)}function c(e){return e.ext&&e.ext.ableToCache}function i(e){return e&&e.type&&"playableAd"===e.type}function a(e){return e.ext.videoData&&e.ext.videoData.videoSource&&e.ext.videoData.videoSource.videoformat_mp4}function l(e){if(e.ext)return e.ext.layoutData?e.ext.layoutData.portrait&&e.ext.layoutData.landscape?a(e)?y:v:m:e.ext.appData&&e.ext.appData.appImages&&Array.isArray(e.ext.appData.appImages)?p:e.ext.clickTags&&e.ext.clickTags.backgroundLandscape&&e.ext.videoData.videoformat_mp4?b:i((t=e).ext)&&t.ext.videoData&&t.ext.videoData.videoSource&&t.ext.videoData.videoSource.html?h:a(n=e)&&n.ext.appData&&n.ext.appData.appIcon&&!n.ext.appData.appImages?S:u;var n,t}return{extractStaticFiles:function(e,n){return e.ext&&i(e.ext)?function(e,n){var t=[];if(n&&c(e)){var i=d(e);if(!i)return t;var r=o(i);if(r){t.push(r);var a=function(e){var n,t=[];if(n=e.getAttribute("data-assets"))try{t=(t=JSON.parse(n))&&t.assets?t.assets:[]}catch(e){}return t}(i);a&&0<a.length&&(t=t.concat(a))}}return t}(e,n):r(e,l(e))},extractVastSource:function(e){var n=e.ext&&e.ext.vastData&&e.ext.vastData.xmlResponse?g:f;return r(e,n)},updateAdunitPrecachePath:function(e,n,t){return e.ext&&i(e.ext)?function(e,n){var t=d(e),i=o(t);if(c(e)&&i&&t){var r=s(i,n);t.src=r,e.ext.videoData.videoSource.html=t.outerHTML}}(e,n):function(e,a,n){for(var t=Object.keys(n),i=0;i<t.length;i++)e[t[i]]&&(e[t[i]]=o(n[t[i]],e[t[i]]));function o(e,n){var t,i;if("string"==typeof e||"string"==typeof n)n=s(n,a);else if(e instanceof Array&&0===e.length)for(t=0;t<n.length;t++)n[t]=s(n[t],a);else if(e instanceof Array&&0<e.length&&n instanceof Array&&0<n.length)for(t=0;t<n.length;t++)for(i=0;i<e.length;i++)n[t]=o(e[i],n[t]);else{var r=Object.keys(e);for(t=0;t<r.length;t++)n[r[t]]&&(n[r[t]]=o(e[r[t]],n[r[t]]))}return n}return e}(e,n,l(e))},getPlayableCacheFlag:function(){return"isPrecacheable"},isAdAbleToCache:c}}},{}],92:[function(e,n,t){n.exports={adunitFilesMapping:{js:"main.min.js",css:"main.min.css",html:"adUnit.min.html"},owFilesMapping:{js:"main.min.js",css:"main.min.css",html:"adUnit.min.html"},environment:{develop:"dev",production:"prod",stage:"stage"},adunitAssetsJsonKeys:{html:"html",js:"js",css:"css",sprite:"sprite",BC:"BrandConnect",libs:"libs",graphicAssets:"graphicAssets",adunitVersion:"adunitVersion"},adunitVersionKey:"adunitVersion",adunitLibsFileName:"adunitLibsFile",adunitGlobalsErrorMsgs:{failedDownloadingAssetsJson:"Failed downloading adunitStaticAssets.json",invalidAdunitAssetsJson:"Missing parameters in adunitStaticAssets.json",failedDownloaingGraphicAssets:"Failed to download adunit graphic assets",failedToRetrieveAdunitUrl:"Failed to retrieve Adunit url"},apiResponseTimeout:15e3}},{}],93:[function(e,n,t){n.exports=function(e,n,t,i,r){var a=e||{},o=n||{},s=t&&t.debug,d=t&&t.domain,c=t&&t.scdn,l=t&&t.protocol,u=t&&t.adunitConfig,f=i,g=r||{};function p(){return l+"//"+function(){if(s&&0<parseInt(s)&&"www.supersonicads.com"!==d){var e=d.split(".")[0];return d+"/users/staging/"+e}return c}()+"/adunit/dist/adunitAssets.json"}function v(){return o.ajax({dataType:"json",url:p(),timeout:g.apiResponseTimeout}).then(function(e,n,t){if(e&&(e.libs&&e.libs.adunitVersion||e.adunitVersion))return e;var i=o.Deferred();return i.reject(g.adunitGlobalsErrorMsgs.failedDownloadingAssetsJson),i.promise()},function(e,n,t){return g.adunitGlobalsErrorMsgs.failedDownloadingAssetsJson})}function m(e){return e&&e.libs&&(e.adunitVersion||e.libs.adunitVersion)&&e.graphicAssets}return{getGlobalAssetsJSON:function(){return f===g.environment.develop?v():m(u)?a.Utils.returnResolvedPromise(u):v().then(function(e){return m(e)?a.Utils.returnResolvedPromise(e):a.Utils.returnRejectedPromise(g.adunitGlobalsErrorMsgs.invalidAdunitAssetsJson)})},setProtocol:function(e){l=e}}}},{}],94:[function(B,e,n){function t(t){var l,u,f,g,p,v,m,b,h,S,y,A,C,r,a,o,s,d,c,D,I,w,P=B("./AdUnitConst.js");function T(){var e=f+"//",n="/adunit/dist",t=s?"/versions/"+s:"";if(l&&0<parseInt(l)&&"www.supersonicads.com"!==u){var i=u.split(".")[0],r="/stage/";("local"===i||1<parseInt(i))&&(r="/dev/"),e=e+u+("/users/staging/"+i)+n+t+r}else e=e+g+n+t+"/prod/";return e}function O(){var e=h.getCacheByType({cacheBase:"globals"});return e&&e.cache||[]}function F(e,n){return h.cacheGlobalAssets(e,n)}function L(){return"../"+S+"/globals/"}function x(){return h.getAppData().then(function(e){return(e=e||{})[P.adunitVersionKey]=s,h.setAppData(e)}).always(v.Utils.returnResolvedPromise)}function N(){return h.clearCacheByType({cacheBase:"globals"},[])}function U(e){if(p===t.environment.develop)return v.Utils.returnResolvedPromise(!0);var n=O();return n.length<=0||function(e,n){for(var t=0;t<e.length;t++){var i=e[t].split("."),r=i[i.length-1];if(P.adunitFilesMapping.hasOwnProperty(r)&&e[t]!==P.adunitFilesMapping[r])return n.hasOwnProperty("trackEvent")&&n.trackEvent(m.globalsInOldFormat),!0}return!1}(n,e)?v.Utils.returnResolvedPromise(!0):SuperSonicGlobalConfig.controllerConfig.adunitVersionToDownload&&SuperSonicGlobalConfig.controllerConfig.adunitVersionToDownload!==s?v.Utils.returnResolvedPromise(!0):h.getAppData().then(function(e){e=e||{};var n=v.Utils.versionCompare(s,e[P.adunitVersionKey]?e[P.adunitVersionKey]:"0");return v.Utils.returnResolvedPromise(0===n)}).then(function(e){var n=e&&function(){var e=O(),n=P.adunitFilesMapping;for(var t in n)if(-1===e.indexOf(n[t]))return!1;return!0}();return v.Utils.returnResolvedPromise(!n)}).fail(function(){return v.Utils.returnResolvedPromise(!0)})}function M(e){var a=T();return b.map(e,function(e){var n=/(\.\.\/)/g,t=e.match(n),i=t&&t.length||0;if(e=e.replace(n,""),0<i){var r=a.split("/");return r.splice(r.length-1-i,i),r.join("/")+e}return a+e})}function V(e){s=e.adunitVersion?e.adunitVersion:e.libs.adunitVersion}function E(e){var n,t,i=b.extend({},P.adunitFilesMapping,e);return t=e,(n=i).libs=function(e,n){for(var t in e)e.hasOwnProperty(t)&&"string"==typeof e[t]&&(e[t]=n+e[t]);return e}(t.libs,"../../"),i=n}function k(e){return w.prefetchGlobalAssetsToBrowser(e,T())}return{init:function(e,n,t,i,r,a,o,s,d,c){e,l=n.debug,u=n.domain,f=n.protocol,g=n.scdn,b=t,h=i,S=r,y=a,A=o,p=s,v=d,m=c,C=new(B("./AdUnitDataJsonFetcher.js"))(v,b,n,p,P),w=new(B("./AdUnitUtils.js"))(v,b,P),I=new(B("./AdUnitGraphicAssetsManager.js"))(v,w,h)},setProtocol:function(e){f=e,C.setProtocol(e)},getStaticGlobalsUrl:T,getGlobalAssetsJSON:function(){return C.getGlobalAssetsJSON()},prefetchGlobalAssetsToBrowser:k,getGlobalsCache:O,isAdunitVersionChanged:function(t){var e=O(),i=!0;return b.each(e,function(e,n){return-1<n.indexOf(t)&&(i=!1),i}),i},clearGlobalsCache:N,getLocalGlobalsFolder:L,cacheGlobalAssets:F,assetsToCache:M,updateAdUnitGlobals:function(n,e,t,i){if(n){if(c&&"rejected"!==c.state())return c.promise();c=b.Deferred()}else{if(d&&"rejected"!==d.state())return d.promise();d=b.Deferred()}return D&&"rejected"!==D.state()||(D=C.getGlobalAssetsJSON().then(function(e){var n;V(r=e),r=E(r),a=P.adunitFilesMapping,I.setAdunitAssetsPaths(r.graphicAssets,T()),o=r.libs,A.setLibsFilesPaths(o,T()),n=T()+P.adunitFilesMapping.html,y.setRemoteAdunitUrl(n),y.setLocalAdunitUrlFromCache(L(),O())}).then(function(){return n?A.manageDownloadLibsFileByFiletype(P.adunitLibsFileName,e):k({adunitLibsFile:o.adunitLibsFile})}).fail(function(e){n?c.reject(e):d.reject(e)})),D.then(function(){return n?(e=t,I.shouldUpdateAdunitAssets()?I.precacheAdunitGraphicAssets(e):v.Utils.returnResolvedPromise()).then(null,function(){c.reject(P.adunitGlobalsErrorMsgs.failedDownloaingGraphicAssets)}).then(U.bind(null,i)).then(function(e){return e?N().then(function(e,n){return F(M(e),n).then(function(){y.setLocalAdunitUrl(L()+y.getRemoteAdunitFileName())},function(){return y.setLocalAdunitUrl(y.getRemoteAdunitUrl()),P.adunitGlobalsErrorMsgs.failedToRetrieveAdunitUrl}).then(x)}.bind(null,a,t)).then(function(){c.resolve()},function(e){c.reject(e)}).always(function(){return c.promise()}):(c.resolve(),c.promise())}):k(a).then(I.prefetchAdunitGraphicAssets).then(function(){d.resolve()},function(e){d.reject(e)}).always(function(){return d.promise()});var e})},setAdunitVersion:V,getAdunitGlobalsHTML:function(){return P.adunitFilesMapping.html},updateGlobalAssetsStructure:E,getOWGlobalsHTML:function(){return P.owFilesMapping.html},getOWStaticGlobalsUrl:function(e){var n=f+"//",t="/ow-adunit/dist",i="/versions/"+e;if(l&&0<parseInt(l)&&"www.supersonicads.com"!==u){var r=u.split(".")[0],a="/stage/";("local"===r||1<parseInt(r))&&(a="/dev/"),n=n+u+"/users/staging/"+r+t+i+a}else n=n+g+t+i+"/prod/";return n}}}var i;e.exports=function(e,n){return n?new t(e):(i||(i=new t(e)),i)}},{"./AdUnitConst.js":92,"./AdUnitDataJsonFetcher.js":93,"./AdUnitGraphicAssetsManager.js":95,"./AdUnitUtils.js":96}],95:[function(e,n,t){n.exports=function(e,n,t){var r,a=t||{},o=n||{},s={},i={},d="graphicAssets";function c(){var e=a.getCacheByType({cacheBase:d});return e&&e.cache||[]}return{setAdunitAssetsPaths:function(e,n){s=e,r=n,i.sprite=s.sprite},shouldUpdateAdunitAssets:function(){if(0===c().length)return!0;for(var e in s)if(!a.isAssetInCache(o.extractFileNameFromPath(s[e]),d))return!0;return!1},precacheAdunitGraphicAssets:function(e){return(n=function(){for(var e=c(),n=[],t=function(e){for(var n in s)if(o.extractFileNameFromPath(s[n])===e)return!1;return!0},i=0;i<e.length;i++)t(e[i])&&n.push(e[i]);return n}(),a.deleteCachedListOfAssets(d,n)).then(a.cacheGraphicAssets.bind(null,function(){var e=[];for(var n in s){var t=o.extractFileNameFromPath(s[n]);if(!a.isAssetInCache(t,d)){var i=o.formatAssetsUrlForCache(s[n],r);e.push(i)}}return e}(),e));var n},prefetchAdunitGraphicAssets:function(){return o.prefetchGlobalAssetsToBrowser(i,r)}}}},{}],96:[function(e,n,t){n.exports=function(e,n,t){var p=n||{},v=t||{};return{formatAssetsUrlForCache:function(e,n){var t=n,i=function(e,n){var t=/(\.\.\/)/g,i=n.match(t),r=i&&i.length||0;if(n=n.replace(t,""),0<r){var a=e.split("/");return a.splice(a.length-1-r,r),a.join("/")+n}return e+n};return"string"==typeof e?i(t,e):p.map(e,function(e){i(t,e)})},prefetchGlobalAssetsToBrowser:function(e,n,t,i){var r,a,o=new p.Deferred,s=[],d=0,c=0,l=p.extend(!0,{},e);l.hasOwnProperty(v.adunitAssetsJsonKeys.BC)&&(p.extend(l,l[v.adunitAssetsJsonKeys.BC]),delete l[v.adunitAssetsJsonKeys.BC]),l.hasOwnProperty(v.adunitAssetsJsonKeys.html)&&delete l.html;var u=function(e){return-1<s.indexOf(e)};p.each(l,function(e,n){"string"==typeof n?u(n)||c++:delete l[e]}),0===c&&o.resolve();var f=function(e){var n;if(u(n=e)||s.push(n),++d===c){if("function"==typeof t&&t(s),r)return;clearTimeout(a),o.resolve()}},g=n;return p.each(l,function(e,i){if(!u(i)){var n=g+i;p.get(n,{},null,{dataType:"text"}).done(function(){f(i)}).fail(function(e,n,t){"parsererror"===n&&f(i)})}}),a=setTimeout(function(){d<c&&("function"==typeof i&&i(),o.reject("Failed to preload all global assets ("+d+" out of "+c+" succeeded)")),r=!0},15e3),o.promise()},extractFileVersionFromUrl:function(e){var n=e.split("/");return 0<n.length?n[n.length-2]:"0"},extractFileNameFromPath:function(e){return e.replace(/^.*[\\\/]/,"")}}}},{}],97:[function(A,e,n){function t(e){var a=e||{},n={dapi:"dapi",externalObfuscation:"externalObfuscation",adunitLibsFile:"adunitLibsFile",omid:"omid"},o={dapi:{filename:"dapi.js",type:n.dapi,cacheKeyName:"dapiVersion"},externalObfuscation:{filename:"obfuscateV2.html",type:n.externalObfuscation,cacheKeyName:"externalObfuscation"},adunitLibsFile:{filename:"adunitLibs.min.js",type:n.adunitLibsFile,cacheKeyName:"adunitLibsFile"},omid:{filename:"omid.js",type:n.omid,cacheKeyName:"omid"}},s="libs",d,c,l,i,r;function u(e,n,t){return!!o[e]&&(o[e].url=n,o[e].newVersion=t,!0)}function t(e,n,t){return u(e,n,t),a.returnResolvedPromise()}function f(e,n){return u(e,i.formatAssetsUrlForCache(n,r),i.extractFileVersionFromUrl(n))}function g(e){return d.isAssetInCache(e,s)?d.deleteCachedAsset(s,e):a.returnResolvedPromise()}function p(e,n){return 0===a.versionCompare(e,n)}function v(e,n){var t=o[e],i={};return!!t&&(i[t.cacheKeyName]=n,i)}function m(e,n,t){l=e,c=n,d=t||{},i=new(A("./AdUnitUtils.js"))(c,d)}function b(e,n){if(r=n,e)for(var t in e)f(t,e[t])}function h(e,t){var i=o[e]||{},r=function(){return g(i.filename).then(function(){return l.log("LibsManager | updateFileInCache | going to download",l.LogLevels.verbose),d.cacheLibsAsset(i.url).then(null,function(){return a.returnResolvedPromise()})}).fail(function(){return a.returnResolvedPromise()})};return d.getAppData().then(function(e){e=e||{},i.savedVersion=e&&e[i.cacheKeyName]?e[i.cacheKeyName]:"0";var n=!p(i.newVersion,i.savedVersion);return t||n?r().then(function(e){l.log("LibsManager | updateFileVersion | appData "+JSON.stringify(e),l.LogLevels.verbose);var n=c.extend(e,v(i.type,i.newVersion));return l.log("LibsManager | updateFileVersion | updatedData "+JSON.stringify(n),l.LogLevels.verbose),d.setAppData(n).fail(function(){return a.returnResolvedPromise()})}.bind(null,e)):d.isAssetInCache(i.filename,s)?(l.log("LibsManager | manageDownloadLibsFileByFiletype | file version is updated and file is already in cache",l.LogLevels.verbose),a.returnResolvedPromise()):(l.log("LibsManager | manageDownloadLibsFileByFiletype  | file version updated but file is not in cache - download it again",l.LogLevels.verbose),d.cacheLibsAsset(i.url))},r).then(function(){return l.log("LibsManager | manageDownloadLibsFileByFiletype  | success to download file "+i.url,l.LogLevels.verbose),a.returnResolvedPromise("success")},function(){return l.log("LibsManager | manageDownloadLibsFileByFiletype  | failed to download file "+i.url,l.LogLevels.verbose),S(i)})}function S(e){return e.filename===o.adunitLibsFile.filename?a.returnRejectedPromise("Failed to download file "+e.filename):a.returnResolvedPromise()}var y={init:m,setLibsFilesPaths:b,manageDownloadLibsFileByFiletype:h,updateFileVersionByFilePathForThirdPartyLibraries:t};return y}e.exports=t},{"./AdUnitUtils.js":96}],98:[function(e,n,t){function i(e,t){var n,i,a=function(){return n},r=function(e){n=e},o=function(){var e=null;return n&&(e=n.replace(/^.*[\\\/]/,"")),e},s=function(){return i},d=function(e){i=e},c=function(e,n,t,i){var r=e?s():a();return r+=n&&n.productType?"#?productType="+n.productType:"",r+=n&&n.demandSourceName?"&demandSourceName="+n.demandSourceName:"",r+=t&&t.shouldBuildAdUnitUrlForExternal?"&"+l(i):""};function l(e){var n={mode:"native",viewType:"external"};return e&&(n.deviceOs=e),t.serialize(n)}var u=function(t,e){jQuery.each(e,function(e,n){if("string"==typeof n&&n.match(/.*\.html/))return d(t+n.replace(/^.*[\\\/]/,"")),!1})},f={getAdunitUrl:c,getRemoteAdunitUrl:a,setRemoteAdunitUrl:r,getRemoteAdunitFileName:o,getLocalAdunitUrl:s,setLocalAdunitUrl:d,setLocalAdunitUrlFromCache:u};return f}n.exports=i},{}],99:[function(e,n,t){n.exports={NativeAPI:{adClicked:"adClicked",init:".initInterstitial",load:".loadInterstitial",show:".showInterstitial"},ControllerCallbacks:{cacheReady:".CacheReady",allOffersVast:".AllOffersVast",noMoreOffers:".NoMoreOffers",failedToShow:".failedToShow",failedToLoad:".failedToLoad",fallbackToNonPrecache:".fallbackToNonPrecache",actionClick:".ActionClick",exhaustedDemandSource:".exhaustedDemandSource",onAdWindowsClosed:".onAdWindowsClosed",resetStateManager:".resetStateManager"},AdUnitCallbacks:{adClicked:"SDKController.AdClicked",adVisible:"SDKController.AdVisible",engageEnd:"SDKController.engageEnd"},retriesLogic:{maxNumOfAttemptsToCallAPI:2,initAttemptsDelay:500,serverResponseTimeoutInMilis:1e4}}},{}],100:[function(e,n,t){n.exports=function(e,n,t,i){return{retriesLogic:e.retriesLogic,NativeAPI:e.NativeAPI,ControllerCallbacks:{reset:".reset",isVisible:".isVisible",isInitiated:".isInitiated",cacheReady:".CacheReady",failedToShow:".failedToShow",failedToLoad:".failedToLoad",actionClick:".ActionClick",exhaustedDemandSource:".exhaustedDemandSource",onAdWindowsClosed:".onAdWindowsClosed",noMoreOffers:".NoMoreOffers"},AdUnitCallbacks:e.AdUnitCallbacks,ControllerNativeAPI:e.NativeAPI,ProductName:n.BN,Features:{allowMultiInitCalls:!0,shouldFetchNewFeedOnAdClose:!1,isSupportFetchFeedOnAdCloseLogic:!1,allowReloadDuringShow:!0,displayOnAdReady:!0,allowConsecutiveGatewayRequestsDuringLoad:!1,isExhaustInstanceAllowed:!0},gatewayDestinationMap:{prod:n.gatewayDestinationMap.BN.production},amountOfInventories:2,shouldResetOnEngageEnd:!0,shouldAvoidHandleFrameClose:!0,forcePreload:i,width:t?t.width:0,height:t?t.height:0,label:t?t.label:null,lwsSupported:i}}},{}],101:[function(s,e,n){e.exports=function(r,a){var o=s("../components/Constants");return{create:function(e){var n=s("./ProductAdapter"),t=s("./AdapterSharedConfig"),i=s("./Banner/BannerConfiguration")(t,o,e,a.isBannerAndLoadWhileShowSupported(o.BN));return new n(r,a,i,o)}}}},{"../components/Constants":12,"./AdapterSharedConfig":99,"./Banner/BannerConfiguration":100,"./ProductAdapter":131}],102:[function(re,e,n){function t(y,A){var C="NativeCallback",b="globals",h="graphicAssets",t=!1,o=re("./Cache/CacheConstants"),D={},I={mraid:{cache:[]},globals:{cache:[],cacheQueue:[]},BrandConnect:{cache:[],currentAd:0,cacheQueue:[],evaluatedCache:[]},Interstitial:{cache:[],currentAd:0,cacheQueue:[],evaluatedCache:[]},assets:{cache:[],cacheQueue:[]},libs:{cache:[],cacheQueue:[]},graphicAssets:{cache:[],cacheQueue:[]}},w={BrandConnect:{numOfBannersToCache:1},Interstitial:{numOfBannersToCache:1}},P,n=function(e){return 0!==I[e.cacheBase].cache.length?(I[e.cacheBase].currentAd+1)%I[e.cacheBase].cache.length:0},i=function(i){i=i||{},jQuery.each(I,function(e,n){var t=e;I[t].cache&&0!==I[t].cache.length&&y.Utils.isDefined(i)&&i.hasOwnProperty(t)&&I[t].cache.sort(function(e,n){return i[t].indexOf(e.id)<i[t].indexOf(n.id)?-1:1})})},T=function(e){var n,t=e.length;for(n=0;n<t;n++)y.Utils.isDefined(e[n])&&e[n]&&y.PubSub.unsubscribe(e[n])},r=function(e){A.log("cache: "+JSON.stringify(I[e].cache)+" currentAd: "+I[e].currentAd,A.LogLevels.info),A.log("queue: "+JSON.stringify(I[e].cacheQueue),A.LogLevels.info)},O=function(e,n){var t,i=null,r=I[e.cacheBase].cacheQueue.length;for(t=0;t<r;t++)if(I[e.cacheBase].cacheQueue[t].cachingStatus===n){i=I[e.cacheBase].cacheQueue[t];break}return i},F=function(e,n){return e.cacheBase+"/"+n},L=function(e,n){var t=jQuery.map(I[e.cacheBase].evaluatedCache,function(e){return A.AdUtils.getAdId(e)});if(0<t.length){var i=t.indexOf(n.toString());0<=i&&(A.log("Removing ad from evaluatedCache! "+n,A.LogLevels.verbose),I[e.cacheBase].evaluatedCache.splice(i,1))}},x=function(e,n){var t=A.AdUtils.getAdId(n);if(n&&t){var i,r=I[e.cacheBase].cacheQueue.length;for(i=0;i<r;i++)I[e.cacheBase].cacheQueue[i].id==t&&(I[e.cacheBase].cacheQueue[i]=n)}},N=function(t,e){var i=-1;jQuery.each(I[e.cacheBase].cache,function(e,n){return!(y.Utils.isDefined(n.inventoryIndex)&&n.inventoryIndex>t.inventoryIndex||!y.Utils.isDefined(n.inventoryIndex))||(i=e,!1)}),-1===i?I[e.cacheBase].cache.push(t):I[e.cacheBase].cache.splice(i,0,t);var n={};n.cacheBase=e.cacheBase,n.id=t.id,n.inventoryId=t.inventoryId,n.demandSourceName=t.demandSourceName,y.PubSub.publish("Cache.campaignSaved",[n])},U=function(t){jQuery.each(I[t.cacheBase].cacheQueue,function(e,n){if(n.cachingStatus===P.cachingStatus.none&&0===jQuery.grep(I[t.cacheBase].cache,function(e){return A.AdUtils.getAdId(e)===A.AdUtils.getAdId(n)}).length&&0===jQuery.grep(I[t.cacheBase].evaluatedCache,function(e){return A.AdUtils.getAdId(e)===A.AdUtils.getAdId(n)}).length)return I[t.cacheBase].evaluatedCache.push(n),!1})},a=function(e,n){var t=jQuery.map(I[e.cacheBase].cache,function(e){return A.AdUtils.getAdId(e)});if(0<t.length){var i=t.indexOf(n.toString());0<=i&&(A.log("Removing ad from cache array! "+n,A.LogLevels.verbose),I[e.cacheBase].cache.splice(i,1))}},s=function(i,r){return A.getGlobalAppData().then(function(e){e.cachePriorityArray=e.cachePriorityArray||{};var n=e.cachePriorityArray[i.cacheBase];if(n){var t=n.indexOf(r.toString());0<=t&&(A.log("Removing ad from cache array! "+r,A.LogLevels.verbose),n.splice(t,1),e.cachePriorityArray=n)}return A.setGlobalAppData(e)})};function d(s,l){I[s.cacheBase].evaluatedCache.length;var n,e,t,u,i=I[s.cacheBase].cacheQueue.length,r=(w[s.cacheBase].numOfBannersToCache,null),a=null,f=null,g=null,o=null,p=[],v=[],d=[],m=0,b={};for(t=jQuery.Deferred(),e=0;e<i;e++)I[s.cacheBase].cacheQueue[e].cachingStatus!==P.cachingStatus.pending&&I[s.cacheBase].cacheQueue[e].cachingStatus!==P.cachingStatus.queued||0;var h=function(){0<I[s.cacheBase].evaluatedCache.length?(A.log("line[182]: evaluatedCache is: "+JSON.stringify(I[s.cacheBase].evaluatedCache),A.LogLevels.verbose),(n=O(s,P.cachingStatus.none))?(n.cachingStatus=P.cachingStatus.pending,L(s,A.AdUtils.getAdId(n)),n.numOfAssetsCached=0,D[s.cacheBase][n.id]=[],d.push(A.AdUtils.getAdId(n)),n.preProcessing().then(function(e){if(!y.Utils.isDefined(e))return y.Utils.returnResolvedPromise();n=$(e),x(s,n)},function(){var e={};e.cacheBase=s.cacheBase,e.id=A.AdUtils.getAdId(n),e.inventoryId=n.inventoryId,e.demandSourceName=n.demandSourceName,y.PubSub.publish("Cache.preProcessingFailed",[e]),p.push(e.id),t.reject(I[s.cacheBase].cache,p)}).then(function(){var e={};e.cacheBase=s.cacheBase,e.id=n.id,e.demandSourceName=n.demandSourceName,y.PubSub.publish("Cache.campaignDownloadStarted",[e]),b={},0===n.assets.length?c(s,A.AdUtils.getAdId(n)):(A.log("campaign "+n.id+" download started",A.LogLevels.info),A.cacheAdUnitAssets(F(s,n.id),n))}),0):(T([r,a,o,f,g]),0===p.length?t.resolve(I[s.cacheBase].cache):t.reject(I[s.cacheBase].cache,p,v))):(O(s,P.cachingStatus.pending)&&A.log("cache is full but we're waiting for a campaign to finish downloading (probably the last)",A.LogLevels.verbose),T([r,a,o,f,g]),0===p.length?t.resolve(I[s.cacheBase].cache):t.reject(I[s.cacheBase].cache,p,v))},S=function(e){T([f,g]),e&&(0,h())},c=function(e,n,t,i){var r,a,o=i&&i.hasOwnProperty("file")?i.file:null,s=!(!i||!i.hasOwnProperty("status"))&&i.status,d=[];if((r=E(e,n))&&ne(s,b,o,r.assets,l)){if(l.cacheBase=e.cacheBase,b[o]={isSuccessfullyCached:s},!te(t,o,b,r.assets,m,l))return void m++;m=0}if(D[e.cacheBase][n].push(i),r&&r.id&&D[e.cacheBase][r.id].length===r.assets.length)if(A.log("campaign "+r.id+" download finished!",A.LogLevels.info),u=k(D[e.cacheBase][r.id],function(e){return e.status}),a=B(D[e.cacheBase][r.id],r,function(e){return e.status}),0===r.assets.length&&(u=!0),delete D[e.cacheBase][r.id],u){if(r.cachingStatus=P.cachingStatus.queued,0<=I[e.cacheBase].evaluatedCache.length){V(e,r.id,!1),r.numOfAssetsCached=r.assets.length,N(r,e),d=I[e.cacheBase].cache.map(function(e){return A.AdUtils.getAdId(e)}),e.inventoryId=r.inventoryId,e.demandSourceName=r.demandSourceName;var c=jQuery.extend({},e,{inventoryId:r.inventoryId,demandSourceName:r.demandSourceName});y.PubSub.publish("Cache.cacheUpdated",[c])}else A.log("Cache full, could not enter new ad",A.LogLevels.error);0<d.length?(A.log("mappedAds after 'handleCachedAd/pushNewCachedAd' "+d,A.LogLevels.verbose),A.setCachePriorityArrayKey(e,d).always(function(){h()})):h()}else V(e,n,!1),U(e),f=y.PubSub.subscribe(C+".deleteFolderFailed",function(e){A.log("in delete failure from cache next",A.LogLevels.verbose),A.checkRequiredCallbackParams(["path"],e,"deleteFolderFailed").didSucceed&&(A.log("deleting folder failed: "+JSON.stringify(e),A.LogLevels.error),y.Utils.isDefined(e.errCode)&&1==e.errCode?S(!0):S(!1))}),g=y.PubSub.subscribe(C+".deleteFolderSuccess",function(e){A.log("in delete success from cache next",A.LogLevels.verbose),A.checkRequiredCallbackParams(["path"],e,"deleteFolderSuccess").didSucceed&&(A.log("deleting folder success: "+JSON.stringify(e),A.LogLevels.info),S(!0))}),p.push(r.id),a&&v.push({id:r.id,failedAssetsUrlsArray:a.failedAssetsUrlsArray}),A.deleteFolder(t)};return r=y.PubSub.subscribe(C+".assetCached",function(e,n,t){if(A.checkRequiredCallbackParams(["path","file"],e,"assetCached",t).didSucceed){var i,r=M(e.path),a=decodeURIComponent(e.path),o={file:e.file,status:!0};-1!==jQuery.inArray(r.id,d)?y.Utils.isDefined(D[r.type][r.id])&&r.type===s.cacheBase?(A.log("asset cached success: "+r.id+"/"+e.file,A.LogLevels.verbose),i={cacheBase:r.type},E(i,r.id).numOfAssetsCached++,c(i,r.id,a,o)):A.log("Exiting asset cached. folder:"+r.id+" responses array:"+JSON.stringify(D),A.LogLevels.error):A.log("ad is not recognised in this scope: "+r.id+" adForCaching:"+d,A.LogLevels.info)}}),a=y.PubSub.subscribe(C+".assetCachedFailed",function(e,n,t){if(A.checkRequiredCallbackParams(["path","file"],e,"assetCachedFailed",t).didSucceed){var i,r=M(e.path),a=decodeURIComponent(e.path),o={file:e.file,status:!1};-1!==jQuery.inArray(r.id,d)&&(y.Utils.isDefined(D[r.type][r.id])&&r.type===s.cacheBase?(A.log("asset cached failed: "+r.id+"/"+e.file+" with error: "+e.errMsg,A.LogLevels.error),i={cacheBase:r.type},c(i,r.id,a,o)):A.log("Exiting asset cached failed. folder:"+r.id+" responses array:"+JSON.stringify(D),A.LogLevels.error))}}),o=y.PubSub.subscribe(C+".preCacheFileFail",function(e,n,t){if(A.checkRequiredCallbackParams(["path","file"],e,"preCacheFileFail",t).didSucceed){var i,r=M(e.path),a=decodeURIComponent(e.path),o={file:e.file,status:!1};-1!==jQuery.inArray(r.id,d)&&(y.Utils.isDefined(D[r.type][r.id])&&r.type===s.cacheBase?(A.log("pre cache file fail: "+e.file+" with error: "+e.errMsg,A.LogLevels.error),i={cacheBase:r.type},c(i,r.id,a,o)):A.log("Exiting preCache file fail. folder:"+r.id+" responses array:"+JSON.stringify(D),A.LogLevels.error))}}),h(),t.promise()}var c=function(e){return parseInt(e)},l=function(e){var n;try{n=parseInt(e)}catch(e){n=0}return n},u=function(e,n){var t,i;for(t in n)if(n.hasOwnProperty(t)){if("userUniqueId"===t||"applicationUserId"===t||"applicationKey"===t)continue;if("files"===t){e.cache=n[t];continue}if(c(t)){e.cache.push({id:t,numOfAssetsCached:y.Utils.isDefined(n[t].files)?n[t].files.length:0,lastUpdateTime:y.Utils.isDefined(n[t].lastUpdateTime)?l(n[t].lastUpdateTime):0,assets:y.Utils.isDefined(n[t].files)?n[t].files:[]});continue}if("lastUpdateTime"===t)return;i=A.isRootFolder(t)?e:(P.initCacheBase(t),e[t]),u(i,n[t])}},f=function(e){y.Utils.isDefined(e)&&e&&e!=={}?u(I,e):I={mraid:{cache:[]},globals:{cache:[],cacheQueue:[]},BrandConnect:{cache:[],currentAd:0,cacheQueue:[]},RewardedVideo_Premium:{cache:[],currentAd:0,cacheQueue:[]},RewardedVideo_Direct:{cache:[],currentAd:0,cacheQueue:[]},Interstitial:{cache:[],currentAd:0,cacheQueue:[]},assets:{cache:[],cacheQueue:[]},libs:{cache:[],cacheQueue:[]}}},M=function(e){var n=decodeURIComponent(e).split("/");return{type:n[0],id:y.Utils.isDefined(n[1])?n[1]:null}},g=function(e){var n=e.split("#");return 1<n.length?n[n.length-1]:(n=e.split("/"))[n.length-1]},S=function(e,n){var t,i=-1,r=g(n),a=e.length;for(t=0;t<a;t++)if(g(e[t])===r){i=t;break}return i},V=function(e,n,t){var i,r=I[e.cacheBase].cacheQueue,a=[],o=!1;for(i=0;i<I[e.cacheBase].cacheQueue.length;i++)r[i].id!=n?a.push(r[i]):(o&&!t&&a.push(r[i]),o=!0);I[e.cacheBase].cacheQueue=a},p=function(i,e){var n,t,r,a,o=0,s=I[i.cacheBase].cache.length,d=[],c=[],l=jQuery.Deferred(),u=function(e,n){-1!==jQuery.inArray(decodeURIComponent(e.path),d)&&(e.success=n,c.push(e),c.length>=d.length&&(T([r,a]),k(c,function(e){return y.Utils.isDefined(e.success)&&e.success})?l.resolve():l.reject()))};if(a=y.PubSub.subscribe(C+".deleteFolderFailed",function(e){A.checkRequiredCallbackParams(["path"],e,"deleteFolderFailed").didSucceed&&-1!==e.path.indexOf(i.cacheBase)&&(A.log("deleting folder failed: "+JSON.stringify(e),A.LogLevels.error),y.Utils.isDefined(e.errCode)&&1==e.errCode?u(e,!0):u(e,!1))}),r=y.PubSub.subscribe(C+".deleteFolderSuccess",function(e){if(A.checkRequiredCallbackParams(["path"],e,"deleteFolderSuccess").didSucceed&&-1!==e.path.indexOf(i.cacheBase)){A.log("deleting folder success: "+JSON.stringify(e),A.LogLevels.info),u(e,!0);var n=M(e.path);if(null!==n.id){var t={};t.cacheBase=n.type,t.id=n.id,t.inventoryId=n.inventoryId,y.PubSub.publish("Cache.campaignDeleted",[t])}}}),i.cacheBase===b)I[i.cacheBase].cache=[],I[i.cacheBase].cacheQueue=[],d.push(b);else{for(o=0;o<s;o++)y.Utils.isDefined(I[i.cacheBase].cache[0].id)||A.log("something went wrong. len="+s+" cache size= "+I[i.cacheBase].cache.length+" first element="+JSON.stringify(I[i.cacheBase].cache[0]),1),n=I[i.cacheBase].cache[0].id.toString(),y.Utils.isDefined(n)&&-1===jQuery.inArray(n,e)&&(t=i.cacheBase+"/"+n,-1===jQuery.inArray(t,d)&&d.push(t)),I[i.cacheBase].cache.shift();for(s=I[i.cacheBase].cacheQueue.length,o=0;o<s;o++)n=I[i.cacheBase].cacheQueue[0].id,y.Utils.isDefined(n)&&I[i.cacheBase].cacheQueue[0].cachingStatus!==P.cachingStatus.none&&(t=i.cacheBase+"/"+n,-1===jQuery.inArray(t,d)&&d.push(t)),I[i.cacheBase].cacheQueue.shift()}if(0===d.length)T([r,a]),l.resolve();else for(A.log("Removing irrelevant campaigns: "+JSON.stringify(d)),o=0;o<d.length;o++)A.deleteFolder(d[o]);return l.promise()},v=function(e,n){var t,i=null,r=I[e.cacheBase].cache,a=I[e.cacheBase].cache.length;for(t=0;t<a;t++)if(r[t].id==n){i=r[t];break}return i},E=function(e,n){var t,i=null,r=I[e.cacheBase].cacheQueue,a=I[e.cacheBase].cacheQueue.length;for(t=0;t<a;t++)if(r[t].id==n){i=r[t];break}return i},k=function(e,n){var t,i=e.length,r=!0;for(t=0;t<i;t++)r=r&&n(e[t]);return r};function B(e,n,t){var i,r=e.length,a={failedAssetsUrlsArray:[]},o=function(e,n){if(!e||!e.assets)return null;var t=e.assets;n=n.split("?")[0];for(var i=0;i<t.length;i++){if(n&&-1!==t[i].indexOf(n))return t[i].split("?")[0]}return null};for(i=0;i<r;i++)if(!t(e[i])){var s=o(n,e[i].file);s&&a.failedAssetsUrlsArray.push(s)}return a}var m=function(){y.PubSub.subscribe(C+".printCache",function(e){y.Utils.isDefined(e.type)&&r(e.type)})},e=function(t,i,e){var r=0,a=!1;return jQuery.each(I[e.cacheBase].cache,function(e,n){if(0<jQuery.grep(t,function(e){return A.AdUtils.getAdId(e)===A.AdUtils.getAdId(n)}).length&&i<=++r)return!(a=!0)}),a},R=function(n,e,t,i){var r,a=n.slice(0,e),o=[];for(I[i.cacheBase].evaluatedCache=[],r=0;r<a.length;r++)0===jQuery.grep(I[i.cacheBase].cache,function(e){return A.AdUtils.getAdId(e)===A.AdUtils.getAdId(a[r])&&K(e,a[r])}).length&&I[i.cacheBase].evaluatedCache.push(a[r]);for(r=0;r<a.length;r++)0===jQuery.grep(I[i.cacheBase].cache,function(e){return A.AdUtils.getAdId(e)===A.AdUtils.getAdId(a[r])&&!K(e,a[r])}).length&&o.push(a[r]);for(r=e;r<n.length;r++)0<jQuery.grep(I[i.cacheBase].cache,function(e){return A.AdUtils.getAdId(e)===A.AdUtils.getAdId(n[r])&&K(e,n[r])}).length&&o.push(n[r]);var s,d=n.length;for(r=0;r<I[i.cacheBase].cache.length;r++)0===jQuery.grep(n,function(e){return A.AdUtils.getAdId(e)===A.AdUtils.getAdId(I[i.cacheBase].cache[r])}).length&&(I[i.cacheBase].cache[r].inventoryIndex=++d,o.push(((s=I[i.cacheBase].cache[r]).adId=s.id,s.staticContent=s.assets,s)));return I[i.cacheBase].mergedAds=o.slice(0,t),I[i.cacheBase].mergedAds},K=function(e,n){if(!e||!n)return A.log("line[750]: entering isCachedAdStillUpdated with no ad",A.LogLevels.verbose),!1;var t=X(e.assets),i=X(n.staticContent);return A.log("cachedAdNumOfUniqueAssets: "+t+", newAdNumOfUniqueAssets:"+i,A.LogLevels.verbose),t===i&&(j(n)||e.lastUpdateTime==n.lastUpdateTime)},j=function(e){return e&&"0"!==e.creativeId},W=function(e,n){return I[n]&&-1<I[n].cache.indexOf(e)};function G(e){if(!e)return null;var n=I[o.adsAssetsCacheDir]&&I[o.adsAssetsCacheDir].cache;if(!n)return null;for(var t=0;t<n.length;t++){var i=n[t];if(i&&i.id===e)return i}return null}function H(e){return e&&e.assets?e.assets.length:0}function _(){var e=I[o.adsAssetsCacheDir]&&I[o.adsAssetsCacheDir].cache;if(!e)return[];for(var n=[],t=0;t<e.length;t++)n.push(e[t].id);return n}function q(e){var n=G(A.AdUtils.getAdId(e));return!(!n||!e.adAssets||H(n)!==e.adAssets.length)}function J(e,n){var t=G(n);return!(!e||!t)&&!(!t.assets||-1===t.assets.indexOf(e))}function Q(e,n){if(e&&n&&Array.isArray(n)&&0!==n.length){var t=A.AdUtils.getAdId(e);I[o.adsAssetsCacheDir]||(I[o.adsAssetsCacheDir]={}),I[o.adsAssetsCacheDir].cache||(I[o.adsAssetsCacheDir].cache=[]);for(var i=I[o.adsAssetsCacheDir].cache,r=0;r<i.length;r++){i[r].id===t&&i.splice(r,1)}var a={id:t,assets:n,lastUpdateTime:e.lastUpdateTime?e.lastUpdateTime:0,inventoryIndex:y.Utils.isDefined(e.inventoryIndex)?e.inventoryIndex:-1};i.push(a)}}var z=function(e,n,t){var i=v(e,n);i&&(i.inventoryIndex=t)},X=function(e){var t,i=[];return e?(jQuery.each(e,function(e,n){t=g(n),-1===S(i,t)&&i.push(t)}),i.length):(A.log("cannot extract unique assets count",A.LogLevels.error),-1)},$=function(e){var n={id:A.AdUtils.getAdId(e),demandSourceName:e.demandSourceName,assets:e.staticContent||[],lastUpdateTime:y.Utils.isDefined(e.lastUpdateTime)?e.lastUpdateTime:0,numOfAssetsCached:0,cachingStatus:P.cachingStatus.none,preProcessing:e.preProcessing||y.Utils.returnResolvedPromise};return y.Utils.isDefined(e.credits)&&(n.credits=e.credits),y.Utils.isDefined(e.inventoryIndex)&&(n.inventoryIndex=e.inventoryIndex),n},Y=function(e,n){var t={};t.failedCachedFile=e,t.listOfFilesUrls=n,e=e.split("?")[0];for(var i=0;i<n.length;i++)if(-1!==n[i].indexOf(e))return n[i];return!1},Z=function(e,n,t,i,r,a,o){return{cacheBase:e,productType:n,demandSourceName:t,file:i,currentRetryAttempt:r,totalRetryAttempts:a,assetType:o}},ee=function(e){return e&&e.hasOwnProperty("retryAttempts")&&e.hasOwnProperty("retryInterval")},ne=function(e,n,t,i,r){return t&&i&&0<i.length&&(!e||n[t])&&ee(r)},te=function(e,n,t,i,r,a){var o,s=!0,d=Y(n,i),c=a.retryAttempts,l=a.retryInterval,u={cacheBase:e,failedCachedFile:n,listOfFilesUrls:i};if(d)return t[n].isSuccessfullyCached?0<r&&t[n].isSuccessfullyCached&&(o=Z(e,a.productType,a.demandSourceName,d,r,c,a.assetType),y.PubSub.publish("Cache.assetRetrySuccess",[o])):r<c?(s=!1,setTimeout(function(){A.cacheAsset(e,d)},1e3*l)):(o=Z(e,a.productType,a.demandSourceName,d,r,c,a.assetType),y.PubSub.publish("Cache.assetRetryFailed",[o])),s;y.PubSub.publish("Cache.executeRetryFileUrlEmpty",[u])},ie={init:function(e,n){return P=this,t||(f(e),m(),t=!0),i(n),t},initCacheBase:function(e){I[e]||(I[e]={cache:[],currentAd:0,cacheQueue:[]}),D[e]||(D[e]={})},setAdInventoryIndex:z,cacheNext:function(e,n){return A.log("line[707]: recalling cache next",A.LogLevels.verbose),U(e),d(e,n)},incrementNextCampaign:function(e){I[e.cacheBase].currentAd=n(e)},isNextAvailable:function(e,n){return P.getCurrentAd(e,n)},setSettings:function(e,n){w[e.cacheBase]=n},getCacheSizeByType:function(e){return I[e.cacheBase].cache.length},cacheGlobalAssets:function(e,n){return P.cacheFilesByFolder("globals",e,n)},cacheGraphicAssets:function(e,n){return P.cacheFilesByFolder("graphicAssets",e,n)},cacheFilesByFolder:function(t,i,r){var e,a,o,s,d,c=i.length,l=[],u=0,f={};if(!I.hasOwnProperty(t))return y.Utils.returnResolvedPromise();a=jQuery.Deferred();var g=I[t].cache,p=I[t].cacheQueue,v=function(e,n){if(ne(n,f,e,i,r)){if(f[e]={isSuccessfullyCached:n},r.cacheBase=t,!te(t,e,f,i,u,r))return void u++;u=0}l.push({file:e,status:n}),m(e),l.length>=c&&(T([o,s,d]),k(l,function(e){return e.status})?(g=jQuery.map(i,function(e){return e.replace(/^.*[\\\/]/,"")}),a.resolve(g)):a.reject())},m=function(e){var n=p.indexOf(e);-1<n&&p.splice(n,1)};for(o=y.PubSub.subscribe(C+".assetCached",function(e,n,t){A.checkRequiredCallbackParams(["path","file"],e,"assetCached",t).didSucceed&&(e.path!==b&&e.path!==h||(A.log("asset cached success: "+e.file,A.LogLevels.verbose),v(e.file,!0)))}),s=y.PubSub.subscribe(C+".assetCachedFailed",function(e,n,t){A.checkRequiredCallbackParams(["path","file"],e,"assetCachedFailed",t).didSucceed&&(e.path!==b&&e.path!==h||(A.log("asset cached failed: "+e.file+" with error: "+e.errMsg,A.LogLevels.error),v(e.file,!1)))}),d=y.PubSub.subscribe(C+".preCacheFileFailed",function(e,n,t){A.checkRequiredCallbackParams(["path","file"],e,"preCacheFileFail",t).didSucceed&&(e.path!==b&&e.path!==h||(A.log("failed to request to save file:"+e.file+" with error "+e.errMsg,A.LogLevels.error),v(e.file,!1)))}),e=0;e<c;e++)-1===S(g,i[e])?(-1===S(p,i[e])?p.push(i[e]):m(i[e]),A.cacheAsset(t,i[e])):-1!==S(g,i[e])&&v(i[e],!0);return 0===c&&T([o,s,d]),a.promise()},cacheLibsAsset:function(e){var n=jQuery.Deferred(),t=e.replace(/^.*[\\\/]/,"");return I.libs.cacheQueue.push(t),A.cacheAsset("libs",e).then(function(){!function(e){I.libs.cache.push(t);var n=I.libs.cacheQueue.indexOf(e);-1!==e&&I.libs.cacheQueue.splice(n,1)}(e),n.resolve(I.libs.cache)},function(){n.reject("Libs asset cache failed: "+e)}),n.promise()},cacheAds:function(e,n,t,i){var r,a=t.length;for(r=0;r<a;r++){var o=$(t[r]);I[e.cacheBase].cacheQueue.push(o)}return d(e,i)},cacheSingleAd:function(e,n,t){I[e.cacheBase].cacheQueue.splice(0,0,$(n)),P.cacheNext(e,t)},clearCacheByType:function(e,n){var t,i,r=n.length,a=[],o=null,s=[],d=jQuery.Deferred();if(0===I[e.cacheBase].cache.length&&0===I[e.cacheBase].cacheQueue.length)return d.resolve(I[e.cacheBase].cache),d.promise();for(t=0;t<r;t++)i=A.AdUtils.getAdId(n[t]),o=v(e,i),K(o,n[t])&&(s.push(i),y.Utils.isDefined(n[t].credits)&&!y.Utils.isDefined(o.credits)&&(o.credits=n[t].credits),a.push(o));return jQuery.when(p(e,s)).then(function(){I[e.cacheBase].cache=a,d.resolve(I[e.cacheBase].cache)},function(){A.log("error in clear cache by type",A.LogLevels.error),d.reject()}),d.promise()},getCurrentAd:function(n,e){var i=null;return n&&n.cacheBase&&e?(jQuery.each(e,function(e,t){return jQuery.each(I[n.cacheBase].cache,function(e,n){return!(i=A.AdUtils.getAdId(n)===A.AdUtils.getAdId(t)?n:i)}),!i}),i):null},getNextAvailableAd:function(){return{}},getCacheByType:function(e){return I[e.cacheBase]},getRootCacheStructure:function(){return I},isAdInCache:function(e,n){var t,i=!1,r=I[e.cacheBase],a=r&&r.cache?r.cache.length:0;for(t=0;t<a;t++)if(r.cache[t].id===n){i=!0;break}return i},getAdStatusInQueue:function(e,n){var t=E(e,n);return t?t.cachingStatus:null},setAppData:function(e){return A.setGlobalAppData(e)},getAppData:function(){return A.getGlobalAppData()},deleteCachedAsset:function(e,n){return A.deleteAsset(e,n)},deleteCachedListOfAssets:function(e,n){var t,i=new jQuery.Deferred,r=[],a=0;if(0===n.length)return i.resolve(0),i.promise();for(t=0;t<n.length;t++)r.push(A.deleteAsset(e,n[t]));return jQuery.when.apply(null,r).always(function(){var e=arguments;for(t in e)e[t]&&a++;i.resolve(a)}),i.promise()},deleteCachedCampaign:function(e,n){var t=e.cacheBase+"/"+n;return A.deleteFolder(t),a(e,n),s(e,n)},isAssetInCache:W,isAssetInAdsCacheFolder:J,getCachedAdFolder:G,getAmountOfAssetsInAdFolder:H,isAdExistInCacheAndContainsAllAssets:q,setAdInAdsFolder:Q,mergeCampaigns:R,areCampaignsAvailable:e,getFileIndexInCache:S,removeAdFromCacheArray:a,cachingStatus:{none:0,pending:1,queued:2}};return ie}e.exports=t},{"./Cache/CacheConstants":108}],103:[function(e,n,t){n.exports=function(i,l,u,f){function g(e,n,t){i.PubSub.publish("AdsAssetsClearanceService.cacheReachedMaximumCapacity",[{demandSourceName:e.demandSourceName,productType:e.productType,maxAdsToSaveInCache:n,amountOfAdsCached:t}])}return{enactClearanceLogic:function(e,n,t,i,r){var a,o=function(e){for(var n=[],t=[],i=e.length,r=0;r<i;r++)l.isAdExistInCacheAndContainsAllAssets(e[r])?t.push(e[r]):n.push(e[r]);return{adsFromFeedThatAreNotInCache:n,adsThatWereAlreadyInTheCache:t}}(e),s=o.adsFromFeedThatAreNotInCache,d=l.getCacheSizeByType(t);if(n=function(e,n,t){for(var i=e,r=f.getAdIdsOfAds(t),a=0;a<i&&a<n.length;a++){var o=n[a].isCacheable,s=f.getAdId(n[a]),d=-1!==r.indexOf(s);o&&!d||e--}return e}(n,e,o.adsThatWereAlreadyInTheCache),a=s,n<=0||0===a.length||d+n<=i)return{adsToCache:s,adsToRemoveFromCache:[],adsThatWereAlreadyCached:o.adsThatWereAlreadyInTheCache};var c=function(e){for(var n=l.getCacheByType(e).cache,t=[],i=n.length,r=0;r<i;r++){var a=n[r];0===u.getReferenceCountOfAd(a.id)&&t.push(a)}return t}(t);return 0===c.length?(g(r,i,d),{adsToCache:s,adsToRemoveFromCache:[],adsThatWereAlreadyCached:o.adsThatWereAlreadyInTheCache}):{adsToCache:s,adsToRemoveFromCache:function(e,n,t,i,r){var a=e+t-i,o=n.length;if(o<a)return g(r,i,e),n;if(o===a)return n;if(a<o){var s=n.splice(0,a);return s}}(d,c,n,i,r),adsThatWereAlreadyCached:o.adsThatWereAlreadyInTheCache}}}}},{}],104:[function(r,e,n){e.exports=function(v,m,b){var o,h,s,p=r("./CacheConstants"),S=new(r("./CacheUtils"))(v),d=new(r("./AdsReferencesManager")),u={},y={},i={},c=!1;function f(e,n,t,i){if(!S.isAssetValid(e))return v.Utils.returnRejectedPromise(p.errors.cacheAssetInvalidParams);var r=e[p.assetKeys.URL],a=S.extractFileNameFromURL(r);if(h.isAssetInAdsCacheFolder(a,n))return e[p.assetKeys.file]=a,v.Utils.returnResolvedPromise(e);var o,s,d,c,l,u,f=new jQuery.Deferred,g=S.buildAdFolderPath(n);return o=e,s=g,d=f,c=[],l=v.PubSub.subscribe("AdsAssetsNativeCommunicator.adsAssetCachedSuccess",function(e){e[p.assetKeys.path]===s&&e[p.assetKeys.file]===S.extractFileNameFromURL(o[p.assetKeys.URL])&&(v.PubSub.clearHandlers(c),o[p.assetKeys.path]=S.buildAdAssetsPath(e[p.assetKeys.path],e[p.assetKeys.file]),o[p.assetKeys.file]=e[p.assetKeys.file],d.resolve(o))}),u=v.PubSub.subscribe("AdsAssetsNativeCommunicator.adsAssetCachedFailure",function(e){e[p.assetKeys.file]===S.extractFileNameFromURL(o[p.assetKeys.URL])&&(v.PubSub.clearHandlers(c),d.reject("failed caching file "+e[p.assetKeys.file]))}),c.push(l,u),b.saveFileWithRetry(r,g,t,i),f.promise()}function g(t,i,e){var n,r,a=m.AdUtils.getAdId(t);if(!a)return v.Utils.returnRejectedPromise("Failed to cache ad "+a||m.AdUtils.getBannerId(t));if(!t.isCacheable)return v.Utils.returnResolvedPromise();if(h.isAdExistInCacheAndContainsAllAssets(t))return v.Utils.returnResolvedPromise();if(n=a,u.hasOwnProperty(n))return r=a,u.hasOwnProperty(r)?u[r]:v.Utils.returnResolvedPromise();var o,s,d=new jQuery.Deferred;o=a,s=d.promise(),u.hasOwnProperty(o)||(u[o]=s);for(var c=[],l=0;l<t.adAssets.length;l++)c.push(f(t.adAssets[l],a,i,e));return jQuery.when.apply(null,c).then(function(){var e=v.Utils.convertArrayLikeObjectToArray(arguments);!function(e,n){if(n&&Array.isArray(n)){for(var t=[],i=0;i<n.length;i++){var r=n[i];r&&r.hasOwnProperty(p.assetKeys.file)&&t.push(r[p.assetKeys.file])}h.setAdInAdsFolder(e,t)}}(t,e),A(a),I("saveAdInCacheSuccess",{demandSourceName:i.demandSourceName,productType:i.productType,ad:t}),d.resolve()},function(e){D(m.AdUtils.getAdId(t),i.instanceUniqueId),I("saveAdInCacheFailure",{demandSourceName:i.demandSourceName,productType:i.productType,ad:t});var n=S.buildAdFolderPath(a);!function(n,t,i,r,a){var o=[],s=m.AdUtils.getAdId(n),e=v.PubSub.subscribe("AdsAssetsNativeCommunicator.deleteAdFolderSuccess",c),d=v.PubSub.subscribe("AdsAssetsNativeCommunicator.deleteAdFolderFailure",c);function c(e){e.path===t&&(v.PubSub.clearHandlers(o),I("deleteAdFromCacheSuccess",{demandSourceName:a.demandSourceName,productType:a.productType,ad:n}),A(s),r.reject("ad "+s+" failed to cached with reason: "+i))}o.push(e,d)}(t,n,e,d,i),b.deleteFolder(n)}),d.promise()}function A(e){u.hasOwnProperty(e)&&delete u[e]}function C(e){y.hasOwnProperty(e)&&delete y[e]}function D(e,n){d.unsetReferenceForAd(e,n)}function l(e,n){var t,i,r,a=m.AdUtils.getAdId(e);return t=a,null===h.getCachedAdFolder(t)?v.Utils.returnResolvedPromise():(r=a,y.hasOwnProperty(r)?(i=a,y.hasOwnProperty(i)?y[i]:v.Utils.returnResolvedPromise()):function(e,n){var t,i,r=m.AdUtils.getAdId(e),a=new jQuery.Deferred;t=r,i=a.promise(),y.hasOwnProperty(t)||(y[t]=i);var o,s,d,c,l,u,f,g,p=S.buildAdFolderPath(r);return o=e,s=p,d=a,c=n,l=[],u=m.AdUtils.getAdId(o),f=v.PubSub.subscribe("AdsAssetsNativeCommunicator.deleteAdFolderSuccess",function(e){e.path===s&&(v.PubSub.clearHandlers(l),C(u),h.removeAdFromCacheArray(S.getAdLevelCacheConfiguration(),u),I("deleteAdFromCacheSuccess",{demandSourceName:c.demandSourceName,productType:c.productType,ad:o}),d.resolve())}),g=v.PubSub.subscribe("AdsAssetsNativeCommunicator.deleteAdFolderFailure",function(e){e.path===s&&(v.PubSub.clearHandlers(l),C(u),I("deleteAdFromCacheFailure",{demandSourceName:c.demandSourceName,productType:c.productType,ad:o}),d.reject(e.errorMsg))}),l.push(f,g),b.deleteFolder(p),a.promise()}(e,n))}function I(e,n){v.PubSub.publish("AdsAssetsManager."+e,[n])}return{init:function(e,n){var t;h=e,c=!(!(i=n||{})||!i[p.adLevelCache]),t=i,0!==Object.keys(t).length&&m.getSegmentationAllocator().addAdLevelCacheSegment(t.adLevelCacheGroup),c&&(s=i[p.maxAdsToSaveInCache]||p.defaultMaxAdsToSaveInCache,o=new(r("./AdsAssetsClearanceService"))(v,h,d,m.AdUtils))},setAdAssetsForAds:function(e){if(e&&c)for(var n=0;n<e.length;n++)e[n].adAssets=S.extractAssetsFromAd(e[n])},cacheAssetsOfAd:g,cacheAdsWithClearanceLogic:function(e,n,t,i,r){if(!c||0===e.length||!n||!o)return v.Utils.returnResolvedPromise(p.errors.cacheAdsWithClearanceLogicConfigurationProblem);var a=jQuery.extend(!0,[],e);return function(e,n){if(0===e.length)return v.Utils.returnResolvedPromise();for(var t=[],i=new jQuery.Deferred,r=0;r<e.length;r++)t.push(l(e[r],n));jQuery.when.apply(null,t).then(i.resolve,i.reject),i.promise()}(o.enactClearanceLogic(a,n,S.getAdLevelCacheConfiguration(),s,i).adsToRemoveFromCache,i),function(e,n,t,i,r){function a(){return function e(n,t,i,r){t<=0||0===n.length||g(n.shift(),i,r).then(function(){e(n,--t,i,r)}).fail(function(){e(n,t,i,r)})}(e,n,i,r),v.Utils.returnResolvedPromise()}return 0<t&&!function(e,n){for(var t=0;t<n;t++){var i=e[t];if(i&&i.isCacheable)return!1}return!0}(e,t)?function(e,n){for(var t=0;t<n;t++){var i=e[t];if(i&&i.isCacheable&&!h.isAdExistInCacheAndContainsAllAssets(i))return!1}return!0}(e,t)?(I("adsAlreadyCached",{demandSourceName:i.demandSourceName,productType:i.productType}),a()):(o=jQuery.extend(!0,[],e),s=t,d=i,c=r,l=new jQuery.Deferred,function e(n,t,i,r,a){t<=0?a.resolve():0===n.length&&0<t?a.reject(p.errors.cacheMandatoryAdsFailed):g(n.shift(),i,r).then(function(){e(n,--t,i,r,a)}).fail(function(){e(n,t,i,r,a)})}(o,s,d,c,l),l.promise()).then(a):a();var o,s,d,c,l}(a,n,t,i,r)},isAdLevelCacheEnabled:function(){return c},areNonMandatoryAdsToCacheConfigured:function(e,n){return!(!v.Utils.isDefined(e)||!v.Utils.isDefined(n))&&e<n},setReferencesForAds:function(e,n){var t,i,r;if(Array.isArray(e))for(var a=0;a<e.length;a++)(r=e[a])&&r.isCacheable&&(t=m.AdUtils.getAdId(e[a]),i=n,d.setReferenceForAd(t,i))},unsetReferencesForAds:function(e,n){if(Array.isArray(e))for(var t=0;t<e.length;t++)D(m.AdUtils.getAdId(e[t]),n)},unsetReferencesForInstance:function(e){d.unsetAllReferencesForReferrer(e)}}}},{"./AdsAssetsClearanceService":103,"./AdsReferencesManager":106,"./CacheConstants":108,"./CacheUtils":109}],105:[function(f,e,n){e.exports=function(c,l){var u=f("./CacheConstants");return{saveFileWithRetry:function(n,t,i,r){var a=[],o=new(f("./CacheAssetRetry"))(r,d),e=c.PubSub.subscribe("NativeCallback.assetCached",function(e){e.path=decodeURIComponent(e.path),e[u.assetKeys.path]===t&&-1!==n.indexOf(e[u.assetKeys.file])&&(o.areRetryAttemptsPerformed()&&c.PubSub.publish("AdsAssetsNativeCommunicator.adAssetRetrySuccess",[{demandSourceName:i.demandSourceName,productType:i.productType,file:n,currentRetryAttempt:o.getAttemptsSoFar(),totalRetryAttempts:r.adAssetRetryAttempts}]),c.PubSub.publish("AdsAssetsNativeCommunicator.adsAssetCachedSuccess",[e]),c.PubSub.clearHandlers(a))}),s=c.PubSub.subscribe("NativeCallback.assetCachedFailed",function(e){e.path=decodeURIComponent(e.path),e[u.assetKeys.path]===t&&-1!==n.indexOf(e[u.assetKeys.file])&&(o.shouldExecuteRetry()?o.performRetryWithDelay():(o.areRetryAttemptsPerformed()&&c.PubSub.publish("AdsAssetsNativeCommunicator.adAssetRetryFailed",[{demandSourceName:i.demandSourceName,productType:i.productType,file:n,currentRetryAttempt:o.getAttemptsSoFar(),totalRetryAttempts:r.adAssetRetryAttempts}]),c.PubSub.publish("AdsAssetsNativeCommunicator.adsAssetCachedFailure",[e]),c.PubSub.clearHandlers(a)))});function d(){l.callSDKFunction("saveFile",{file:n,path:t,overrideExistingFile:!1})}a.push(e,s),d()},deleteFolder:function(n){if(n){var t=[],e=c.PubSub.subscribe("NativeCallback.deleteFolderSuccess",function(e){l.isIOS()&&(e.path=decodeURIComponent(e.path)),e.path===n&&(c.PubSub.publish("AdsAssetsNativeCommunicator.deleteAdFolderSuccess",[e]),c.PubSub.clearHandlers(t))}),i=c.PubSub.subscribe("NativeCallback.deleteFolderFailed",function(e){l.isIOS()&&(e.path=decodeURIComponent(e.path)),e.path===n&&(c.PubSub.publish("AdsAssetsNativeCommunicator.deleteAdFolderFailure",[e]),c.PubSub.clearHandlers(t))});t.push(e,i),l.callSDKFunction("deleteFolder",{path:n},"deleteFolderSuccess","deleteFolderFailed")}}}}},{"./CacheAssetRetry":107,"./CacheConstants":108}],106:[function(e,n,t){n.exports=function(){var i={};function r(e,n){if(e&&n&&i.hasOwnProperty(e)){var t=i[e].indexOf(n);-1!==t&&i[e].splice(t,1)}}return{setReferenceForAd:function(e,n){e&&n&&(i.hasOwnProperty(e)||(i[e]=[]),-1===i[e].indexOf(n)&&i[e].push(n))},unsetReferenceForAd:r,unsetAllReferencesForReferrer:function(e){for(var n=Object.keys(i),t=0;t<n.length;t++)r(n[t],e)},getReferenceCountOfAd:function(e){return(n=e,n&&i.hasOwnProperty(n)?i[n]:[]).length;var n}}}},{}],107:[function(e,n,t){n.exports=function(e,n){var t=e&&e.adAssetRetryAttempts,i=e&&e.adAssetRetryInterval,r=0;return{shouldExecuteRetry:function(){return r<t&&"function"==typeof n},areRetryAttemptsPerformed:function(){return 0<r},getAttemptsSoFar:function(){return r},performRetryWithDelay:function(){setTimeout(function(){r++,n()},1e3*i)}}}},{}],108:[function(e,n,t){n.exports={assetKeys:{URL:"URL",size:"size",label:"label",path:"path",file:"file"},errors:{cacheAssetInvalidParams:"Unable to cache asset due to invalid cacheModule/adId/asset",cacheAdsWithClearanceLogicConfigurationProblem:"Unable to cacheAds due to not being in new flow/no ads/no need to cache ads/no clearance service",cacheMandatoryAdsFailed:"Failed to cache mandatory ads"},adsAssetsCacheDir:"ads",supportNewCacheStructureConfigurationKey:"supportNewCacheStructure",fileNameFromURLPattern:/[^/]+$/,adLevelCache:"adLevelCache",maxAdsToSaveInCache:"maxAdsToSaveInCache",defaultMaxAdsToSaveInCache:30}},{}],109:[function(e,n,t){n.exports=function(r){var i=e("./CacheConstants");function a(e){return i.adsAssetsCacheDir+"/"+e}function o(e,n){return"../"+e+"/"+n}function s(e){return e?e.match(i.fileNameFromURLPattern)[0]:null}return{isAssetValid:function(e){return e&&"string"==typeof e[i.assetKeys.URL]},extractAssetsFromAd:function(e){e.ext&&e.ext.appData&&e.ext.appData.adAssets&&(e.ext.appData.appImages=e.ext.appData.adAssets,delete e.ext.appData.adAssets);for(var n=[],t=r.AdAssets.extractStaticFiles(e),i=0;i<t.length;i++)n.push({URL:t[i]});return n},buildAdFolderPath:a,buildAdAssetsPath:o,extractFileNameFromURL:s,extendAssetWithLocalPath:function(e,n){if(!e)return null;var t=s(e[i.assetKeys.URL]);return jQuery.extend({},e,{file:t,path:o(a(n),t)})},getAdLevelCacheConfiguration:function(){return{cacheBase:i.adsAssetsCacheDir}}}}},{"./CacheConstants":108}],110:[function(Le,e,n){e.exports=function(I,w,P,e,T,n,O){"use strict";var F,l,u,f,t=!1,c=e.demandSourceName,L=w.adUnitUrl,x=w.jQuery(),g=!1,p=new(Le("./../../components/MultipleInventories")),N=new(Le("./PreloadAdManager"))(I,w),v=Le("../../components/OMIDConstants"),U=new(Le("./../../components/sdkPluginType/SDKPluginTypeHandler"))(w,I.Utils),M=T.eventicsCategories,V={},E=T.displayMode,m=!1,r=0,i=null,k={},b=P.closeButtonStates,a=[],B=null,s=P.CB,d=null,h=0,S={},y=w[T.productType],R=new(Le("./DemandEntityBuilder.js"))(T,e),A=Le("../../patches/PatchIOSLoadAfterLoad.js")(I,w,R),K=n,o=Le("./FetchDemand/FetcherPatch.js")(I,w,T,K,P),C=w.DemandUtils,D=new(Le("./../RewardedVideo/dsTaskManager.js"))(I,w,R,P),j=Le("../../components/VastService.js")(I,w),W=new(Le("./../RewardedVideo/availabilityReporter.js"))(I,w,T,R,D),G=new(Le("./../RewardedVideo/availabilityManager.js"))(I,w,W,T,K),H=new(Le("./PayloadBuilder.js"))(x,w,I,R,P),_=Le("../../components/containers/WPADUtils")(w),q=!0,J=w.InstancesTimers;function Q(){return w.ImpressionsCounterService.getCountersByProduct(T.productType).bidding+1}var z=function(){a.push(I.PubSub.subscribe("PrecacheManager.cacheUpdatedCallback",function(e){if(C.shouldReceiveMessage(R,e)){var n,t,i;w.log("globals ready: "+m+" initSuccess in settings: "+V.numOfBannersToInitSuccess+" adUnits: "+p.size(e.inventoryId),w.LogLevels.verbose);var r=O.getCacheSizeByType(R.productType),a=ee.bind(null,e.inventoryId);if(0===V.numOfBannersToInitSuccess)t=1,n=O.areCampaignsAvailable(ae(e.inventoryId).slice(0,t),t);else{var o=oe(e.inventoryId);t=o.length;var s=Y(p.getOffers(e.inventoryId),V.numOfBannersToInitSuccess);i=s<=t?s:t,n=O.areCampaignsAvailable(o,i)}w.log("PM | cacheUpdatedCallback cache updated areCampaignsAvailable: "+n,w.LogLevels.verbose),G.cacheUpdate(r,m,n,a)}})),a.push(I.PubSub.subscribe("PrecacheManager.campaignDeletedCallback",function(e){if(C.shouldReceiveMessage(R,e)){var n,t=-1,i={};I.Utils.isDefined(e.id)&&(n=re(e.id,e.inventoryId),i=w.AdUtils.updateEventWithAdParams(V,n,i),t=n&&I.Utils.isDefined(n.inventoryIndex)?n.inventoryIndex:-1),K.trackEvent(M.campaignDeletedCache,{inventoryIndex:t},i)}})),a.push(I.PubSub.subscribe("PrecacheManager.campaignSavedCallback",function(e){if(C.shouldReceiveMessage(R,e)){var n,t=-1,i=null,r={};I.Utils.isDefined(e.id)&&(n=re(e.id,e.inventoryId),i=e.id,t=n&&I.Utils.isDefined(n.inventoryIndex)?n.inventoryIndex:-1,r=w.AdUtils.updateEventWithAdParams(V,n,r)),x.extend(r,{eNameStart:{name:M.campaignSavedCache.name+(i||"")},inventoryIndex:t}),K.trackTimingStop(M.campaignSavedCache,r)}})),a.push(I.PubSub.subscribe("PrecacheManager.campaignDownloadStartedCallback",function(e){if(C.shouldReceiveMessage(R,e)){var n=x.extend({},M.campaignSavedCache);n.name=n.name+(e.id||""),K.trackTimingStart(n)}})),a.push(I.PubSub.subscribe("PrecacheManager.cacheAdsSuccessCallback",function(e){C.shouldReceiveMessage(R,e)&&w.log("RV cacheAdsSuccessCallback "+JSON.stringify(e),w.LogLevels.verbose)})),a.push(I.PubSub.subscribe("PrecacheManager.cacheNextFail",function(o){C.shouldReceiveMessage(R,o)&&o.deletedAds&&0<o.deletedAds.length&&x.each(o.deletedAds,function(e,n){var t=re(n,o.inventoryId),i=w.AdUtils.updateEventWithAdParams(V,t,{}),r=o.deletedAdsData;if(r&&r[e].id==n){var a=r[e].failedAssetsUrlsArray.toString();i.rvnomoreoffersreason=a.substring(0,999)}K.trackEvent(M.campaignFailedToCache,{},i),te(n,o.inventoryId)})})),a.push(I.PubSub.subscribe("PrecacheManager.fallbackToNonPrecache",function(e){C.shouldReceiveMessage(R,e)&&(I.PubSub.publish(T.productType+".fallbackToNonPrecache",[e]),K.trackEvent(M.fallbackToNonPrecache))})),a.push(I.PubSub.subscribe("PrecacheManager.cacheAdsFailedCallback",function(e){if(C.shouldReceiveMessage(R,e)){w.log("RV cacheAdsFailedCallback "+JSON.stringify(e),w.LogLevels.verbose);for(var n,t,i,r=e.deletedOffers.length,a=e.deletedOffers,o=e.deletedAdsData,s=0;s<r;s++){var d=a[s],c=re(d,e.inventoryId),l=w.AdUtils.updateEventWithAdParams(V,c,{});if(o&&o[s].id==d){var u=o[s].failedAssetsUrlsArray.toString();l.rvnomoreoffersreason=u.substring(0,999)}K.trackEvent(M.campaignFailedToCache,{},l),ne(d,e.inventoryId)}if(0===V.numOfBannersToInitSuccess)t=1,n=O.areCampaignsAvailable(ae(e.inventoryId).slice(0,t),t);else{var f=oe(e.inventoryId);t=f.length;var g=Y(p.getOffers(e.inventoryId),V.numOfBannersToInitSuccess);i=g<=t?g:t,n=O.areCampaignsAvailable(f,i)}G.cacheAdsFailed(m,n,e.errorLog,ee.bind(null,e.inventoryId))}})),a.push(I.PubSub.subscribe("PrecacheManager.preProcessingFailedCallback",function(e){C.shouldReceiveMessage(R,e)&&w.log("PM | preProcessingFailedCallback "+e,w.LogLevels.verbose)})),a.push(I.PubSub.subscribe("Cache.assetRetrySuccess",function(e){if(C.shouldReceiveMessage(R,e)&&e.file&&e.currentRetryAttempt&&e.totalRetryAttempts){var n=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]",t=J.extendEventDataWithElapsedLoadTime(R.productType,R.demandSourceName,{});e.assetType===P.assetType.adunitAsset?K.trackEvent(M.adUnitRetrySuccess,{generalMessage:n.substring(0,250)},t):e.assetType===P.assetType.adAsset&&K.trackEvent(M.adAssetRetrySuccess,{generalMessage:n.substring(0,250)},t)}})),a.push(I.PubSub.subscribe("Cache.assetRetryFailed",function(e){if(C.shouldReceiveMessage(R,e)&&e.file&&e.currentRetryAttempt&&e.totalRetryAttempts){var n=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]",t=J.extendEventDataWithElapsedLoadTime(R.productType,R.demandSourceName,{});e.assetType===P.assetType.adunitAsset?K.trackEvent(M.adUnitRetryFail,{generalMessage:n.substring(0,250)},t):e.assetType===P.assetType.adAsset&&K.trackEvent(M.adAssetRetryFail,{generalMessage:n.substring(0,250)},t)}})),a.push(I.PubSub.subscribe("Cache.executeRetryFileUrlEmpty",function(e){var n={},t=e.listOfFilesUrls.toString();n.callfailreason=e.failedCachedFile.substring(0,255),n.rvnomoreoffersreason=t.substring(0,999),K.trackEvent(M.executeRetryFileUrlEmpty,{},n)})),a.push(I.PubSub.subscribe("SDKController.AdTracked",function(e){C.shouldReceiveMessage(R,e)&&(e=w.AdUtils.formatParamsToAdId(e),w.callSDKFunction("adCredited",C.extendCallbackParamsWithParentProductConfig(R,{credits:re(w.AdUtils.getAdId(e),e.inventoryId).credits}),"adCreditedSuccess","adCreditedFailed"))})),a.push(I.PubSub.subscribe("SDKController.AdStarted",function(e){if(C.shouldReceiveMessage(R,e)&&w.RingerSwitchService.isInitiated()){var n={},t=he();t&&t.ext&&(n=Ce(i.ext)),w.RingerSwitchService.startListener(n),w.log("Ringer | startListener ringer status from AdStarted.",w.LogLevels.info)}})),a.push(I.PubSub.subscribe("SDKController.Analytics",function(e){if(C.shouldReceiveMessage(R,e)&&e&&e.action){var n=e.action,t=e.eventParam;"fireEvent"===n?K.trackEvent(t.eName,t.label,t.data):"startTiming"===n?K.trackTimingStart(t.eName,t.data):"stopTiming"===n?K.trackTimingStop(t.eName,t.data):"setCustomData"===n&&(w.log("Controller - setCustomData received",w.LogLevels.verbose),K.updateBaseData(t.data))}})),a.push(I.PubSub.subscribe("SDKController.AdLoaded",function(e){if(C.shouldReceiveMessage(R,e)){var n,t,i,r=w.AdUtils.getAdId(e),a=re(r,e.inventoryId),o=e.inventoryId;if(clearTimeout(F),w.log("ad loaded with params: "+JSON.stringify(e),w.LogLevels.verbose),a&&K.updateBaseData({rvPlayMethod:a.displayMode}),I.Utils.isDefined(e.errMsg)){D.publish("AdErrorState",[C.extendCallbackParamsWithDemandConfig(R,{error:!0})]),w.log("Error in loading ad: "+e.errMsg,w.LogLevels.error);var s={generalMessage:e.errMsg,vastViewCount:0};return s=J.extendEventDataWithElapsedLoadTime(R.productType,R.demandSourceName,s),s=w.AdUtils.updateEventWithAdParams(V,a,s),K.trackEvent(M.adLoadedError,{},s),a.ext.isHybridFlow&&a.ext.viewUniqueId&&(w.HybridService.clearAppPage(a.ext.viewUniqueId),I.PubSub.publish("HybridService.closeHybridFlow",[{viewUniqueId:a.ext.viewUniqueId}])),ve(a),n=a,t=w.AdUtils.getAdId(n),i=D.getStatus().duringEngage,te(t,n.inventoryId),$(),void(i&&!g?function(){w.log(T.productType+" adLoaded with error | no offers for user - show dialog",w.LogLevels.verbose),w.setCloseButtonState({productType:T.productType,demandSourceName:c,state:b.close});var e={productType:T.productType,message:l&&l.noOffers?l.noOffers:P.labels.noOffers,yes:"close",alwaysClose:!0};w.postAdUnitEvent({name:"alertUserOnError",options:e}),K.trackEvent(M.userAlert,{inventoryIndex:n.inventoryIndex||-1})}():(w.log("DemandSource | adLoaded with error - removing and moving to next offer",w.LogLevels.verbose),be(null),w.removeAdUnit(re(t,n.inventoryId))))}V.viewType===P.viewTypes.externalView&&K.incrementSessionNumber(),K.trackEvent(M.adLoaded,{vastViewCount:0}),I.Utils.isDefined(e.enableBackButton)&&w.setBackButtonState(e.enableBackButton),e=w.AdUtils.formatParamsToAdId(e),w.onAdLoaded(re(w.AdUtils.getAdId(e),e.inventoryId));var d={totalNumberCredits:ie(o),numOfAdUnits:p.size(o),adViewId:e.adViewId};G.adLoadedSuccessfully(d)}})),a.push(I.PubSub.subscribe("SDKController.AdError",function(e){C.shouldReceiveMessage(R,e)&&w.log("SDKController.AdError:"+JSON.stringify(e),w.LogLevels.verbose)})),a.push(I.PubSub.subscribe("SDKController.dialogBoxResume",function(e){C.shouldReceiveMessage(R,e)&&K.trackEvent(M.dialogBoxResume)})),a.push(I.PubSub.subscribe("SDKController.dialogBoxExit",function(e){C.shouldReceiveMessage(R,e)&&K.trackEvent(M.dialogBoxExit)})),a.push(I.PubSub.subscribe(T.productType+".isVisible",function(e){if(C.shouldReceiveMessage(R,e)){var n=he();w.setCurrentDisplayedAd(n);var t=w.getAdViewContainer(n);t&&t.shouldReportAdVisible()&&w.onAdVisible()}})),a.push(I.PubSub.subscribe("SDKController.adClosed",function(e){C.shouldReceiveMessage(R,e)&&(w.SKAdImpressionService.endImpression(e.ad,Oe,Fe),K.resetBaseData(P.keysToResetOnAdClosed))})),a.push(I.PubSub.subscribe(T.productType+".GetConfig",function(e){if(C.shouldReceiveMessage(R,e)){w.log("Bidder ProductInstance | getConfig received");var n=he();if(!n)return void w.log("Bidder ProductInstance | getConfig with no loaded ad");w.HybridService.isHybridCampaign(n,V)&&(n.ext.shouldInitHybridFlow=!0),o=n,s=e,(d=re(w.AdUtils.getAdId(o),o.inventoryId))?(function(e){V.requestID&&(e.requestID=V.requestID);var n,t,i,r=(n=w.getApiData({scdn:1,protocol:0,defaultProtocol:1}).scdn,t=w.decideUrlProtocolAccordingToHTTPSCompliance()+"//"+n,"prod"!==w.getEnv()&&(t=w.api()+"/users/staging/"+SuperSonicGlobalConfig.mobileSDKSettings.env),t);x.extend(!0,e,w.getFormattedDeviceData(),(i=r,{settings:{protocol:w.decideUrlProtocolAccordingToHTTPSCompliance(),urltocdn:i,appKey:w.getSDKDataByKey(P.requiredSDKDataKeys.applicationKey),appOrientation:w.getSDKDataByKey(P.requiredSDKDataKeys.appOrientation),deviceLanguage:w.getSDKDataByKey(P.requiredSDKDataKeys.deviceLanguage),bundleId:w.getSDKDataByKey(P.requiredSDKDataKeys.bundleId),sdkAbName:w.getSDKDataByKey(P.requiredSDKDataKeys.sdkAbName),deviceId:w.getDeviceId(),skOverlaySupported:w.SKOverlayManager.isSKOverlaySupported()}}))}(d),w.MOATService.containsMOATData(o)&&w.MOATService.enableTracking(),a=(t=d).displayMode!=E.softprecache&&O.isPrecache(),t.settings.omidUrl=(i=t,r=w.OMIDService.getVersionData().omidVersion,w.OMIDService.isAdOmidSupported(i)&&v.omidVersionRequiresWebviewPerAd[r]?w.OMIDService.getOmidBundleUrl():""),void 0===t.productType&&(t.productType=R.productType),void 0===t.demandSourceName&&(t.demandSourceName=R.demandSourceName),t.displayOnAdReady=V.displayOnAdReady,t.settings.precache=a,t.settings.sessionDepth=Q(),t.settings.viewType=V.viewType,I.AdAssets.isAdAbleToCache(t)&&(t.settings.ableToCache=t.ext.ableToCache,delete t.ext.ableToCache),w.MOATService.containsMOATData(t)&&w.MOATService.isTrackingEnabled()&&(t.settings.moatData=w.MOATService.extractMoatDataFromAd(t)),s&&s.callback&&s.callback.call(null,d)):w.log("line[456]: no current available ad",w.LogLevels.verbose)}var t,i,r,a,o,s,d})),a.push(I.PubSub.subscribe(T.productType+"isVisible",function(e){if(w.log("Bidder ProductInstance | isVisible"),C.shouldReceiveMessage(R,e)){var n=he();if(w.isAdDisplayed(n))return void w.log("Bidder ProductInstance | isVisible | isAdDisplayed=true");if(!n)return void w.log("Bidder ProductInstance | isVisible | ad is null");w.getCurrentDisplayedAdType()!==T.productType&&w.getCurrentDisplayedAd()||w.setCurrentDisplayedAd(n)}}))};function X(e){var n={};if(I.Utils.isDefined(e.ad)){var t=e.ad&&I.Utils.isDefined(e.ad.inventoryIndex)?e.ad.inventoryIndex:-1;n=w.AdUtils.updateEventWithAdParams(V,e.ad,n),x.extend(n,{inventoryIndex:t})}return n}function $(){B=null}a.push(I.PubSub.subscribe("ExternalContainer.duringCreation",function(e){C.shouldReceiveMessage(R,e)&&K.trackEvent(M.duringCreation)}));var Y=function(e,n){for(var t=e.length<n?e.length:n,i=n,r=0;r<t;r++)e[r].isCacheable||i--;return i},Z=function(){D.publish("InitiatedAPICall",[C.extendCallbackParamsWithProductConfig(R,{duringInit:!1})])},ee=function(e){var n,t,i;if(w.log("Bidder ProductInstance | handlePossibleAdUnitsReady",w.LogLevels.verbose),se(e)){var r=p.size(e),a=ie(e);G.canReportAvailable(r,a,!1,!1),t=se(n=e),i=O.isPrecache(),N.canPreloadCandidateAd(!1,!1,t,!1,i,V.displayOnAdReady)&&function(e){var n=new x.Deferred;if(!D.canPreload())return w.log("Cannot preload at this time, "+D.getStatusMsg(),w.LogLevels.error),I.Utils.returnRejectedPromise(P.errors.showAdFailedReasons.taskManagerPreload);var t=he()||se(e);if(!t)return w.log("Cannot preload with no offer",w.LogLevels.error),I.Utils.returnRejectedPromise(P.errors.showAdFailedReasons.preloadNoAd);x.extend(!0,t,R),w.MOATService.containsMOATData(t)?setTimeout(function(){we(t,!1,n)},0):we(t,!1,n),n.promise()}(n)}},ne=function(e,n){p.removeOfferById(e,n)&&!p.isEmpty(n)&&O.incrementNextCampaign()},te=function(e,n){var t=p.getOfferById(e,n);t?t.toRemove=!0:w.log("Error in mark current ad to be removed:"+e,w.LogLevels.error)},ie=function(e){for(var n=0,t=p.getOffers(e),i=p.size(e),r=0;r<i;r++)n+=t[r].credits;return n},re=function(e,n){var t=p.getOfferById(e,n);return t||w.log("Error in getAdUnitById, id "+e+" not found in "+JSON.stringify(p.getOffers(n)),1),t},ae=function(e){return x.grep(p.getOffers(e),function(e){return!(I.Utils.isDefined(e.toRemove)&&e.toRemove)})},oe=function(e){var n=ae(e);return x.grep(n,function(e){return e.isCacheable})},se=function(e){var n,t=re(w.AdUtils.getAdId(le(e)),e);return n=O.isPrecache()&&t&&t.isCacheable?(t=re(w.AdUtils.getAdId(ce(e)),e),E.precache):E.nonprecache,t&&!t.displayMode&&de(t,n),t},de=function(e,n){e&&(e.displayMode=n)},ce=function(e){return 0===V.numOfBannersToInitSuccess?O.getCurrentAd(ae(e).slice(0,1)):O.getCurrentAd(ae(e))},le=function(e){return p.getCurrentOffer(e)},ue=function(e){g=!1;var n=w.AdUtils.getAdId(e);D.publish("Engaged",[C.extendCallbackParamsWithProductConfig(R,{duringEngage:!1})]),$();var t=re(n,e.inventoryId);clearTimeout(F),t?(w.log("onEngageEnd with params: "+JSON.stringify(t),w.LogLevels.verbose),I.Utils.isDefined(t)&&t.toRemove&&(w.AdsAssetsManager.unsetReferencesForAds([e],R.instanceUniqueId),w.log("removing ad id: "+n,w.LogLevels.verbose),ne(n,t.inventoryId))):w.log("Tried to end engage with no ad",w.LogLevels.error)},fe=function(e){var n=new x.Deferred;if(I.Utils.isDefined(e.response)&&I.Utils.isDefined(e.response.errorCode)){Z();var t=I.Utils.isDefined(e.response.errorMessage)&&e.response.errorMessage?e.response.errorMessage:T.errors.init[1003];n.reject(t)}else I.Utils.isDefined(e.seatbid)&&I.Utils.isDefined(e.seatbid.bid)&&I.Utils.isDefined(e.seatbid.ext)&&I.Utils.isDefined(e.seatbid.ext.labels)?n.resolve(e):(Z(),n.reject(T.errors.init[1004]));return n.promise()},ge=function(e){var s=function(e){return V.disableTokenFiltering||void 0===e||0===e.length||(e.forEach(me),function(e){if(e){var n={blacklistedCampaigns:e.join(",")};w.getTokenService().updateToken(n)}}(y.filteredListService.getFilteredListCampaigns())),I.Utils.returnResolvedPromise()},d=function(e){return function(e){for(var n=0;n<e.length;n++){var t=e[n].ext.layoutData;if(I.Utils.isDefined(t)&&I.Utils.isDefined(t.html)&&0<t.html.length)return!0}return!1}(e)?w.libsManager.manageDownloadLibsFileByFiletype(T.libsCacheFiles.dapi):I.Utils.returnResolvedPromise()},c=function(n){return O.isPrecache()&&function(e){for(var n=!1,t=0;t<e.length;t++)if(w.AdUtils.isPlayablePrecachedAd(e[t])){n=!0;break}return n}(n)?w.libsManager.manageDownloadLibsFileByFiletype(T.libsCacheFiles.externalObfuscation).then(function(e){!function(e,n){for(var t=0;t<e.length;t++)w.AdUtils.isPlayablePrecachedAd(e[t])&&(e[t].ext.ableToCache="success"===n)}(n,e)}):I.Utils.returnResolvedPromise()};return function(e){D.setConnection(!0);var n,t,i,r=e.seatbid.bid,a=e.seatbid.ext,o=p.getAvailableInventoryId();return K.updateBaseData({landingId:a.landingId,strategyId:a.strategyId}),f=a.deliveryPlumbus,x.when((t=e,i=t.seatbid.ext,i.shouldStartMuted=w.AdUtils.isCampaignShouldStartMuted(w.getConfig().controllerConfig,T.productType),x.extend(i,T.overrideFeedSettings),x.extend(i,w.getApplicationExternalConfig().getABTestConfiguration(y.getProductType(),i.landingId)),w.DeviceDataService.setPullDataOnLoadAd(i.enablePullDataOnLoadAd),void(V=i)),(n=a,u=n.labels,void(n.templateid==T.customDialog?u.confirmCloseMsg[P.confirmCloseMsgMap[0]].alwaysClose=!0:l=n.labels))).then(function(e){e&&e.hasOwnProperty(P.numOfBannersToInitSuccess)&&e.hasOwnProperty(P.numOfBannersToCache)&&K.updateBaseData({cacheConfig:e[P.numOfBannersToInitSuccess]+"/"+e[P.numOfBannersToCache]})}.bind(null,V)).then(w.CampaignsFilter.filterByAppInstalled.bind(null,r,V,T.filterDisableTypes)).then(s).then(function(e){for(var n=e&&e.length||0,t="",i=0;i<n;i++)t+=w.AdUtils.getAdType(e[i],V),i<n-1&&(t+=", ");return K.updateBaseData({feedSize:n,feedCampaignOrder:t}),I.Utils.returnResolvedPromise()}.bind(null,r)).then(function(e){return e.some(w.OMIDService.isAdOmidSupported)&&w.OMIDService.downloadOmidJsBundle(),I.Utils.returnResolvedPromise()}.bind(null,r)).then(O.decidePrecacheStatus.bind(null,{numOfCampaigns:r.length,settings:V})).then(function(){return G.setAMSettings({preFetchAllVasts:V.preFetchAllVasts,shouldRefreshInventory:!1,isPreCache:O.isPrecache(),numOfBannersToInitSuccess:V.numOfBannersToInitSuccess,reportOnAdunitReady:V.reportOnAdunitReady,forcePreload:T.forcePreload}),r&&0<r.length?(m=!1,S={productType:T.productType,demandSourceName:R.demandSourceName,retryAttempts:V.adunitRetryAttempts,retryInterval:V.adunitRetryInterval,assetType:P.assetType.adunitAsset},w.adUnitGlobals.updateAdUnitGlobals(!0,V.purgeAdunitLibsFile,S,K)):I.Utils.returnRejectedPromise(P.errors.noFill)}).then(function(){return x.when(d(r),c(r))}).then(w.AdsAssetsManager.setAdAssetsForAds.bind(null,r)).then(function(e){for(var n=0;n<e.length;n++)e[n].isCacheable=0<e[n].adAssets.length}.bind(null,r)).then(w.AdsAssetsManager.setReferencesForAds.bind(null,r,R.instanceUniqueId)).then(function(e){x.each(e,function(e,n){n.inventoryIndex=e})}.bind(null,r)).then(function(e,n,t){var i,r=new x.Deferred,a=w.AdsAssetsManager.cacheAdsWithClearanceLogic(e,n.numOfBannersToCache,n.numOfBannersToInitSuccess,t,Ae(n)).then(function(){clearTimeout(i),r.resolve()}).fail(function(e){clearTimeout(i),r.reject(e)});return i=setTimeout(function(){var e=a.state();"pending"!==e&&"rejected"!==e||(K.trackEvent(M.adLevelCachingTimeout,{callfailreason:"ad level timeout expired when caching ads"}),r.reject("cacheAdsAssets timeout expired")),"resolved"===e&&r.resolve()},T.precacheConfig.timeoutForCachingAdsInAdLevelCacheFlow),r.promise()}.bind(null,r,V,R)).then(function(){m=!0;var e=p.setOffers(r.slice(0),o);0!==V.numOfBannersToInitSuccess||T.forcePreload||G.reportAdAvailable({numOfAdUnits:p.size(e),totalNumberCredits:ie(e)}),ee(e)}).fail(function(e){var n=e||"Fail parse adUnit info from api response";w.AdsAssetsManager.unsetReferencesForAds(r,R.instanceUniqueId),p.removeInventory(o),Se(),be(null),e&&w.log(e,w.LogLevels.error),G.inventoryEmpty(e||n)}),(new x.Deferred).resolve(x.extend({},e.seatbid.ext,{numOfAdUnits:e.seatbid.bid.length}))}(e)},pe=function(e,n,t){var i,r=w.AdUtils.getAdId(e);w.log("Error in loading ad - timeout in "+r,w.LogLevels.error),i=t?M.showAdFail:M.adLoadedError;var a,o,s={isprecache:O.isPrecache()};s=w.AdUtils.updateEventWithAdParams(V,e,s),K.trackEvent(i,{callfailreason:"Error in loading ad - timeout"},s),C.extendCallbackParamsWithProductConfig(R,e),te(r,e.inventoryId),be(null),$(),j.removeIframe((a=r,o="",I.Utils.isDefined(R.demandSourceName)&&(o=R.demandSourceName),o+=R.productType+a)),V.viewType===P.viewTypes.externalView?w.removeAdUnitFromExternal(e):w.removeAdUnit(e)},ve=function(e){e&&e.cid?w.blacklistService.addToBlacklistedCampaigns(R.productType,R.demandGroupName,e.cid):w.log("DemandSource | cannot add to blacklist with no ad",w.LogLevels.error)},me=function(e){e&&e.cid&&y.filteredListService.addToFilteredListCampaigns(e.cid)},be=function(e){i=e},he=function(){return i},Se=function(){$(),G.reset(),N.reset()},ye=function(){for(var e=Object.keys(p.getInventories()),n=0;n<e.length;n++)w.AdsAssetsManager.unsetReferencesForAds(p.getOffers(e[n]),R.instanceUniqueId)};function Ae(e){return{adAssetRetryAttempts:e.adAssetRetryAttempts||0,adAssetRetryInterval:e.adAssetRetryInterval||1}}function Ce(e){return e?{ringerUpdateDelay:V.ringerUpdateDelay,shouldSetRingerUpdateDelay:w.AdUtils.isPlayableCampaign(e)||w.AdUtils.isMRAIDCampaign(e)||w.AdUtils.isExternalCampaign(e)}:{}}function De(e,n){w.log(n,w.LogLevels.error);var t=C.extendCallbackParamsWithDemandConfig(R,{errMsg:n});I.PubSub.publish(T.productType+".failedToShow",[t]);var i=n;i!==P.errors.showAdFailedReasons.preloadNoAd&&i!==P.errors.showAdFailedReasons.showNoAd&&(i+=D.getStatusMsg()),K.trackEvent(M.showAdFail,{callFailReason:i}),w.callSDKFunction(e,C.extendCallbackParamsWithDemandConfig(R,{errMsg:n}))}function Ie(){return P.integrationType.manual}function we(e,n,t){w.log("Bidder ProductInstance | preloadFlow"),N.preloadAdFinished();var i,r,a,o,s,d,c,l=!1,u=O.isPrecache();e.displayMode===E.softprecache&&(l=!0),o=l,s=e,d=!1,u&&!o&&(w.AdUtils.isPlayablePrecachedAd(s)?I.AdAssets.isAdAbleToCache(s)&&(d=!0):d=!0),d&&(i=e,r=w.AdUtils.getAdId(i),a=O.getConfig().precachePath+r+"/",I.AdAssets.updateAdunitPrecachePath(i,a,w.AdUtils.isPlayablePrecachedAd(i))),e.isWPAD=_.shouldDisplayAdOnExternalWebView(e,V,Ie()),c=e.isWPAD?(w.AdUtils.setViewType(V,e,P.viewTypes.externalView),k.shouldBuildAdUnitUrlForExternal=!0,2):(w.log("Bidder ProductInstance | ad is not WPAD"),w.AdUtils.removeViewTypeFromSetting(V),k.shouldBuildAdUnitUrlForExternal=!1,1),e.displayStrategy=c;var f=w.AdUtils.updateEventWithAdParams(V,e,{});x.extend(f,{displaystrategy:c}),K.updateBaseData(f),be(e);var g,p,v,m,b,h,S,y,A,C=!l&&u,D=L.getAdunitUrl(C,R,k,w.getDeviceOs());g=e,p=D,v=n,m=T.timerLengths.loadAdTimeout,clearTimeout(F),F=setTimeout(function(){pe(g,p,v)},m),x.extend(V,{preload:!0}),w.AdUtils.setViewType(V,e),!w.HybridService.isHybridCampaign(e,V)||null!==B||n||I.Utils.isDefined(e.toRemove)&&e.toRemove||(b=e,B=new x.Deferred,b.ext.viewUniqueId=w.HybridService.createHybridId(b,R),w.HybridService.loadHybridCampaign(w.AdUtils.getStoreAppId(b),b.ext.viewUniqueId).then(function(){if("resolved"!==B.state())return b.ext.forceOrientation="portrait",b.ext.isHybridFlow=!0,B.resolve()},function(){if("resolved"!==B.state())return K.trackEvent(M.hybridFlowFail,{callFailReason:"Store load fail"}),b.ext.isHybridFlow=!1,B.resolve()})),U.shouldShowInStandAloneView(w.getConfig())&&w.AdUtils.extendSettingsWithStandaloneViewSupport(V),e=w.StoreKitService.updateAdWithStoreAppId(e,V),w.loadAdUnitUrl(e,D,R,V),e.isWPAD?(h=e,S=t,y=w.getContainerCreationHandler(h),(A=y.getState())===y.getCreationStates().createdSuccessfully?(w.log("product instance | containerState | createdSuccessfully ",w.LogLevels.info),S.resolve(h)):A===y.getCreationStates().duringCreation?x.when(y.getCreationResultPromise()).then(function(){w.log("product instance | during creation result: success",w.LogLevels.info),S.resolve(h)}).fail(function(e){S.reject("product instance | "+e)}):S.reject("product instance | did not start to create native webview")):t.resolve(e)}function Pe(){K.trackEvent(M.startImpressionSuccess)}function Te(e){K.trackEvent(M.startImpressionFailed,{},{callfailreason:e.errMsg})}function Oe(){K.trackEvent(M.endImpressionSuccess)}function Fe(e){K.trackEvent(M.endImpressionFailed,{},{callfailreason:e.errMsg})}return{name:c,init:function(){t||(Se(),z(),a.push(I.PubSub.subscribe("AdsAssetsClearanceService.cacheReachedMaximumCapacity",function(e){if(C.shouldReceiveMessage(R,e)){var n={custom_b:e.maxAdsToSaveInCache};n=J.extendEventDataWithElapsedLoadTime(R.productType,R.demandSourceName,n),K.trackEvent(M.adLevelCacheReachedMaxCapacity,{},n)}})),a.push(I.PubSub.subscribe("AdsAssetsManager.saveAdInCacheSuccess",function(e){if(C.shouldReceiveMessage(R,e)){var n=X(e);n=J.extendEventDataWithElapsedLoadTime(R.productType,R.demandSourceName,n),K.trackEvent(M.saveAdInCacheSuccess,{},n);var t=w.AdsAssetsManager.areNonMandatoryAdsToCacheConfigured(V.numOfBannersToInitSuccess,V.numOfBannersToCache);m&&t&&ee(p.getActiveInventoryId())}})),a.push(I.PubSub.subscribe("AdsAssetsManager.saveAdInCacheFailure",function(e){if(C.shouldReceiveMessage(R,e)){var n=X(e);n=J.extendEventDataWithElapsedLoadTime(R.productType,R.demandSourceName,n),K.trackEvent(M.saveAdInCacheFailure,{},n),te(w.AdUtils.getAdId(e.ad))}})),a.push(I.PubSub.subscribe("AdsAssetsManager.deleteAdFromCacheSuccess",function(e){if(C.shouldReceiveMessage(R,e)){var n=X(e);n=J.extendEventDataWithElapsedLoadTime(R.productType,R.demandSourceName,n),K.trackEvent(M.deleteAdFromCacheSuccess,{},n)}})),a.push(I.PubSub.subscribe("AdsAssetsManager.deleteAdFromCacheFailure",function(e){if(C.shouldReceiveMessage(R,e)){var n=X(e);n=J.extendEventDataWithElapsedLoadTime(R.productType,R.demandSourceName,n),K.trackEvent(M.deleteAdFromCacheFailure,{},n)}})),a.push(I.PubSub.subscribe("AdsAssetsManager.adsAlreadyCached",function(e){if(C.shouldReceiveMessage(R,e)){var n=J.extendEventDataWithElapsedLoadTime(R.productType,R.demandSourceName,{});n=x.extend(n,e),K.trackEvent(M.adsAlreadyCached,{},n)}})),a.push(I.PubSub.subscribe("AdsAssetsNativeCommunicator.adAssetRetrySuccess",function(e){if(C.shouldReceiveMessage(R,e)){var n=J.extendEventDataWithElapsedLoadTime(R.productType,R.demandSourceName,{}),t=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]";K.trackEvent(M.adAssetRetrySuccess,{generalMessage:t.substring(0,250)},n)}})),a.push(I.PubSub.subscribe("AdsAssetsNativeCommunicator.adAssetRetryFailed",function(e){if(C.shouldReceiveMessage(R,e)){var n=J.extendEventDataWithElapsedLoadTime(R.productType,R.demandSourceName,{}),t=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]";K.trackEvent(M.adAssetRetryFail,{generalMessage:t.substring(0,250)},n)}})),O.init(),D.init(),w.initEventics(C.extendCallbackParamsWithParentProductConfig(R,{})),(T=T||{}).isExhaustInstanceAllowed=!1,t=!0)},initProduct:function(e){e&&e.demandSourceName},loadAdWithAdm:function(e,i){e&&e.adm&&e.demandSourceName===c&&(w.log("loadAdWithAdm | bidder | resetting last response to none",w.LogLevels.verbose),w.unloadAdViewsByProductExceptDisplayedView(R),w.DeviceDataService.shouldPullDataOnLoadAd()&&w.DeviceDataService.pullData(),Se(),be(null),o.applyCommunicationSolution(window.timerService.timeElapsed(window.lastWebviewClosedTimer),!D.canEngage()),(D.publish("InitiatedAPICall",[C.extendCallbackParamsWithProductConfig(R,{duringInit:!0})]),I.Utils.returnResolvedPromise(e.adm)).then(fe).then(ge,function(e){var n;switch(n=T.errors.init[1005],typeof e){case"object":e.responseText&&""!==e.responseText?n=e.responseText:e.errorMessage&&""!==e.errorMessage&&(n=e.errorMessage);break;case"string":""!==e&&(n=e)}return Z(),I.Utils.returnRejectedPromise(n)}).then(function(){},function(e){try{if("string"==typeof e){var n=parseInt(e);1001<n&&n<1006&&(e=T.errors.load.invalid)}}catch(e){}var t=C.extendCallbackParamsWithDemandConfig(R,{errMsg:e});w.callSDKFunction(i,t),I.PubSub.publish(T.productType+".failedToLoad",[t])}))},showAd:function(e,a,o){var n,t,i=he()||se(p.getActiveInventoryId());function r(e){return(n=e,n?D.canEngage()?(D.publish("Engaged",[C.extendCallbackParamsWithProductConfig(R,{duringEngage:!0})]),i={viewUniqueId:(t=n).ext.viewUniqueId,status:t.ext.isHybridFlow?"success":"fail"},r=x.extend({name:"hybridCampaignStatusChange"},i),w.postAdUnitEvent(r,!0),w.HybridService.isHybridCampaign(t,V)&&null!==B&&"pending"===B.state()&&(B.resolve(),K.trackEvent(M.hybridFallback),w.HybridService.clearAppPage(t.ext.viewUniqueId),I.PubSub.publish("HybridService.closeHybridFlow",[{viewUniqueId:t.ext.viewUniqueId}])),w.displayAdView(n),I.Utils.returnResolvedPromise()):I.Utils.returnRejectedPromise(P.errors.showAdFailedReasons.taskManagerEngage):I.Utils.returnRejectedPromise(P.errors.showAdFailedReasons.showNoAd)).then(function(){var e;e=a,K.trackTimingStop(M.showAdSuccess,{eNameStart:M.showAdCalled}),w.callSDKFunction(e,C.extendCallbackParamsWithDemandConfig(R)),A.onShowSuccess(R)},function(e){De(o,e)});var n,t,i,r}i?(w.RingerSwitchService.isInitiated()&&i&&(w.RingerSwitchService.startListener(Ce(i.ext)),w.log("Ringer | startListener from DS.",w.LogLevels.info)),function(){d=new x.Deferred;var n=I.PubSub.subscribe(s+".getDemandSourceStateSuccess",function(e){C.shouldReceiveMessage(R,e)&&(I.PubSub.unsubscribe(n),I.PubSub.unsubscribe(t),"resolved"!==d.state()&&(h=e&&e.state||h,d.resolve(e)))}),t=I.PubSub.subscribe(s+".getDemandSourceStateFail",function(e){C.shouldReceiveMessage(R,e)&&(I.PubSub.unsubscribe(t),I.PubSub.unsubscribe(n),"resolved"!==d.state()&&d.resolve())}),e=C.extendCallbackParamsWithParentProductConfig(R);w.callSDKFunction("getDemandSourceState",e,"getDemandSourceStateSuccess","getDemandSourceStateFail")}(),w.isContainerLoaded(i)?r(i):(n=i,t=new x.Deferred,we(n,!0,t),t.promise()).then(r).fail(function(e){De(o,e)})):De(o,"ShowAd | Bidding | there is no ad to show.")},onShowAdFailed:De,adVisible:function(e){g=!0;var n,t=w.AdUtils.getAdId(e),i=re(t,e.inventoryId);w.log("Bidder ProductInstance | adVisible | id="+t),D.publish("Engaged",[C.extendCallbackParamsWithParentProductConfig(R,{duringEngage:!0})]),K.trackTimingStop(M.adVisible,{eNameStart:M.showAdCalled}),w.log("Bidder ProductInstance | send event adVisible"),w.SKAdImpressionService.startImpression(i,Pe,Te),te(t,e.inventoryId),K.trackTimingStart(M.adVisibleToClose),V.extraOffersInEndCard&&w.ExtraOffers.isSupported(w.getConfig().mobileSDKSettings.deviceOs,w.getConfig().mobileSDKSettings.deviceApiLevel,i,V)&&x.when((n={impressionsCount:Q(),firstAttemptToGetFeed:q,retryCounter:r,deliveryPlumbus:f},H.createPayload(n).then(function(e){return e}))).then(function(e){var n=w.getCurrentDisplayedAd();return w.ExtraOffers.fetchExtraOffersInventory(e,n.productType,n.cid,n.settings.requestID,n.ext.opportunityID)}).then(function(e){w.postAdUnitEvent(JSON.stringify({name:"extraOffersEndCardData",data:{inventory:e}}))}).fail(function(e){w.postAdUnitEvent(JSON.stringify({name:"cancelExtraOffersEndCard"}));var n=e&&"string"==typeof e?e:"Extra offers flow failed";w.log("onExtraOffersFetchFail | Reason: "+n),K.trackEvent(M.getExtraOffersInventoryFailed,{callfailreason:n})})},engageEnd:function(e,n){if(w.log("engageEnd",w.LogLevels.verbose),C.shouldReceiveMessage(R,e)){var t;t=e,w.log("_resetPreloadedAd",w.LogLevels.verbose),ue(t),K.resetBaseData(P.baseDataKeys),N.setCanPreloadFlag(!0);var i={handlePrefetchFailedOnBackground:function(e){w.log("_backgroundPrefetchFailed | ManualLoad",w.LogLevels.verbose),this.publishNoMoreOffers(P.noMoreOffersReason.noMoreOffersToShowInFeed)},handlePrefetchFailedOnVisible:function(e){var n;w.log("handlePrefetchFailedOnVisible | manuel load",w.LogLevels.verbose),n=e,O.isPrecache()&&w.AdsAssetsManager.cacheAssetsOfAd(p.getActiveInventory().getCurrentOffer(),R,Ae(V)).then(ee.bind(null,n.inventoryId))},handleAdClosed:function(e){w.log("handleAdClosed | manuel load",w.LogLevels.verbose),w.AdsAssetsManager.unsetReferencesForAds(p.getOffers(e.inventoryId),R.instanceUniqueId),p.removeInventory(e.inventoryId)},publishNoMoreOffers:function(e){w.log("publishNoMoreOffers | ManualLoad",w.LogLevels.verbose);var n=C.extendCallbackParamsWithDemandConfig(R,{errorMsg:e||P.noMoreOffersReason.noMoreOffersToShowInFeed});I.PubSub.publish(T.productType+".NoMoreOffers",[n])}};!function(e){w.log("getAndResetErrorStateFromTaskManager",w.LogLevels.verbose);var n=e.getStatus().adErrorState;return e.publish("AdErrorState",[C.extendCallbackParamsWithProductConfig(R,{error:!1})]),n}(D)?e.engaged?i.handleAdClosed(e):i.handlePrefetchFailedOnBackground(e):e.engaged?i.handlePrefetchFailedOnVisible(e):i.handlePrefetchFailedOnBackground(e),(I.Utils.isFunction(n)?n:function(){})()}},getConfirmCloseMsg:function(){return u&&u.confirmCloseMsg[P.confirmCloseMsgMap[0]]},getDSEventics:function(){return K},getIntegrationType:Ie,reset:function(){ye(),p.reset(),D.publish("InitiatedTimeoutAttempt",[C.extendCallbackParamsWithProductConfig(R,{duringAPITimeoutAttempts:!1})]),Se(),be(null)},clearListeners:function(){x.each(a,function(e,n){I.PubSub.unsubscribe(n)})},shouldAvoidHandleFrameClose:function(){return!1}}}},{"../../components/OMIDConstants":42,"../../components/VastService.js":61,"../../components/containers/WPADUtils":74,"../../patches/PatchIOSLoadAfterLoad.js":169,"./../../components/MultipleInventories":36,"./../../components/sdkPluginType/SDKPluginTypeHandler":82,"./../RewardedVideo/availabilityManager.js":139,"./../RewardedVideo/availabilityReporter.js":140,"./../RewardedVideo/dsTaskManager.js":141,"./DemandEntityBuilder.js":111,"./FetchDemand/FetcherPatch.js":115,"./PayloadBuilder.js":116,"./PreloadAdManager":118}],111:[function(i,e,n){e.exports=function(e,n){var t=i("../../components/Constants.js");return{productType:e.productType,demandGroupName:n.demandGroupName||n.demandSourceName,demandSourceName:n.demandSourceName,demandType:n.demandType||t.demandSourceType.demandSource,isInAppBidding:n.isInAppBidding,integrationType:n.integrationType||t.integrationType.automatic,demandSourceId:n.demandSourceId,waterfallPosition:n.waterfallPosition,originalDemandSourceName:n.originalDemandSourceName||n.demandSourceName,instanceUniqueId:e.productType+"."+n.demandSourceName,adSize:n.adSize}}},{"../../components/Constants.js":12}],112:[function(e,n,t){n.exports=function(){return{initAd:{name:"initAd",id:1},initAdFail:{name:"initAdFail",id:2},initAdToAdReady:{name:"initAdToAdReady",id:-1},adReady:{name:"adReady",id:3},showAd:{name:"showAd",id:4},showAdFail:{name:"showAdFail",id:5},showAdSuccess:{name:"showAdSuccess",id:26},showAdCalled:{name:"showAdCalled",id:-3},adVisible:{name:"adVisible",id:8},videoStarted:{name:"videoStarted",id:9},videoCompleted:{name:"videoCompleted",id:10},endCardDisplayed:{name:"endCardDisplayed",id:11},clickDownloadNow:{name:"clickDownloadNow",id:12},endCardDisplayedToClickDownload:{name:"endCardDisplayedToClickDownload",id:-4},campaignSavedCache:{name:"campaignSavedCache",id:106},campaignsAvailableFromCache:{name:"campaignsAvailableFromCache",id:107},noMoreOffers:{name:"noMoreOffers",id:105},clickReplay:{name:"clickReplay",id:111},clickVideoSound:{name:"clickVideoSound",id:112},adVisibleToClose:{name:"adVisibleToClose",id:-5},adUnitRetrySuccess:{name:"adUnitRetrySuccess",id:170},adUnitRetryFail:{name:"adUnitRetryFail",id:171},adLoaded:{name:"adLoaded",id:6},adLoadedError:{name:"adLoadedError",id:7},userAlert:{name:"userAlert",id:113},backFill:{name:"backFill",id:115},campaignFailedToCache:{name:"campaignFailedToCache",id:109},campaignDeletedCache:{name:"campaignDeletedCache",id:108},hybridFallback:{name:"hybridFallback",id:118},hybridFlowFail:{name:"hybridFlowFail",id:120},loadAd:{name:"loadAd",id:21},loadAdFailed:{name:"loadAdFailed",id:22},loadAdFailedForExhaustedInstance:{name:"loadAdFailedExhaustedInstance",id:32},loadAdIgnored:{name:"loadAdIgnored",id:24},loadAdSuccess:{name:"loadAdSuccess",id:23},bannerLoaded:{name:"bannerLoaded",id:27},getInventory:{name:"getInventory",id:158},getInventoryFailed:{name:"getInventoryFailed",id:159},getExtraOffersInventoryFailed:{name:"getExtraOffersInventoryFailed",id:160},bannerDestroyed:{name:"bannerDestroyed",id:30},bannerLoadSuccessToVisible:{name:"bannerLoadSuccessToVisible",id:-7},bannerVisibleToClick:{name:"bannerVisibleToClick",id:-8},bannerReloadDuringLoad:{name:"bannerReloadDuringLoad",id:251},bannerLoadedDuringShow:{name:"bannerLoadedDuringShow",id:232},gatewayRequest:{name:"gatewayRequest",id:310},initBeforeLoad:{name:"initBeforeLoad",id:128},loadAdToAdReady:{name:"loadAdToAdReady",id:-9},loadAdToShowAd:{name:"loadAdToShowAd",id:-10},fallbackToNonPrecache:{name:"fallbackToNonPrecache",id:154},parseVastSuccess:{name:"parseVastSuccess",id:240},parseVast:{name:"parseVast",id:-11},parseVastFail:{name:"parseVastFail",id:241},dialogBoxExit:{name:"dialogBoxExit",id:155},dialogBoxResume:{name:"dialogBoxResume",id:156},parseVastInfo:{name:"parseVastInfo",id:157},refreshInterval:{name:"refreshInterval",id:164},attemptToBringNewFeed:{name:"attemptToBringNewFeed",id:163},adAssetRetrySuccess:{name:"adAssetRetrySuccess",id:320},adAssetRetryFail:{name:"adAssetRetryFail",id:321},executeRetryFileUrlEmpty:{name:"executeRetryFileUrlEmpty",id:323},saveAdInCacheSuccess:{name:"saveAdInCacheSuccess",id:279},saveAdInCacheFailure:{name:"saveAdInCacheFailure",id:280},deleteAdFromCacheSuccess:{name:"deleteAdFromCacheSuccess",id:281},deleteAdFromCacheFailure:{name:"deleteAdFromCacheFailure",id:282},adLevelCacheReachedMaxCapacity:{name:"adLevelCacheReachedMaxCapacity",id:283},adsAlreadyCached:{name:"adsAlreadyCached",id:284},adLevelCachingTimeout:{name:"adLevelCachingTimeout",id:285},duringCreation:{name:"duringCreation",id:287},startImpressionSuccess:{name:"startImpressionSuccess",id:304},startImpressionFailed:{name:"startImpressionFailed",id:305},endImpressionSuccess:{name:"endImpressionSuccess",id:306},endImpressionFailed:{name:"endImpressionFailed",id:307},overlayDismissed:{name:"overlayDismissed",id:299},noFill:{name:"noFill",id:20}}}},{}],113:[function(e,n,t){n.exports={direct:{http:{method:"GET",dataType:"jsonp"}}}},{}],114:[function(e,n,t){n.exports=function(i){var r=e("./FetchDemandConst.js");return{fetchFeed:function(e,n,t){return i({url:e,data:n,type:r.direct.http.method,dataType:r.direct.http.dataType,timeout:t||1e4})}}}},{"./FetchDemandConst.js":113}],115:[function(e,n,t){n.exports=function(r,i,e,a,o){var s=295e3,d=i.getConfig().mobileSDKSettings.deviceOs,c=i.getConfig().controllerConfig||{},l=!(e.overrideFeedSettings.isSupportFetchFeedOnAdCloseLogic&&!e.overrideFeedSettings.shouldFetchNewFeedOnAdClose),u={applyPatchLogic:{name:"applyPatchLogic",id:841},applyPatchLogicEnd:{name:"applyPatchLogicEnd",id:842}};function f(){setTimeout(function(){i.callSDKFunction("displayWebView",{display:!1}),window.timerService.stopTimer(window.lastWebviewClosedTimer),window.lastWebviewClosedTimer=window.timerService.startTimer()})}function g(t){var n=r.PubSub.subscribe(o.CB+".viewableChange",function(e){e.isViewable&&(r.PubSub.unsubscribe(n),f())}),i=r.PubSub.subscribe(o.CB+".webviewPatch",function(){var e,n;r.PubSub.unsubscribe(i),e=t,n=window.timerService.timeElapsed(window.lastWebviewClosedTimer)-e,a.trackEvent(u.applyPatchLogicEnd,{generalMessage:0<n?n:-9}),f()})}function p(e){if(d!==o.deviceOs.android)return!1;if("number"!=typeof e||e<s)return!1;var n=(i.getApplicationExternalConfig().getGeneralConfig()||{}).shouldApplyNetworkSolution,t=c.shouldApplyNetworkSolution;return!(l&&(!1===n||!1===t))}return{applyCommunicationSolution:function(e,n){var t;p(e)&&(n||(i.log("applyCommunicationSolution five minutes communication issue | timeElapsed window.lastWebviewClosedTimer > 5 minutes: "+e),t=e,a.trackEvent(u.applyPatchLogic,{generalMessage:0<s?t:-8}),g(e),i.callSDKFunction(o.nativeInterfaceMethod.displayWebView,{display:!0,productType:o.IS,activityThemeTranslucent:!0,success:"webviewPatch"})))},shouldApplyCommunicationSolution:p}}},{}],116:[function(x,e,n){e.exports=function(o,s,d,r,c){var a,l=x("./PayloadBuilderConstants.js"),n="PayloadBuilder | ",t=x("../../components/storeKit/SKANModel")(),i=r.productType,u=r.demandSourceName,f=r.demandGroupName,g=0,p=!1,v=0,m=s.getConfig().controllerConfig;function b(e){var n=s.getSDKDataByKey(c.abTests.abt);return n&&n.hasOwnProperty(c.abtParamByProductType[i])&&0<n[c.abtParamByProductType[i]].length&&(e.abt=n[c.abtParamByProductType[i]]),d.Utils.returnResolvedPromise(e)}function h(e){var n=t.extractDataForPayload(m,s.getConfig().applicationSettings);return o.extend(e,n),d.Utils.returnResolvedPromise(e)}function S(e){return o.extend(e,{demandSource:u,impressionsCount:g,auid:s.AppUserIdService.getAUID()}),d.Utils.returnResolvedPromise(e)}function y(e){var n=s.ImpressionsCounterService.getPayloadCounters(r);return o.extend(e,n),d.Utils.returnResolvedPromise(e)}function A(e){var n={},t=s.getApiData({fpf:0});p&&t&&(n.fpf=t.fpf);var i=r.waterfallPosition;return d.Utils.isDefined(i)&&(n.wp=i),n.integrationType=r.integrationType,n.retryCounter=v,n.delpl=a,o.extend(e,n),d.Utils.returnResolvedPromise(e)}function C(e){var n=s.getApiData({segmentId:0}),t=s.getApiData({segmentName:0});return n&&t&&o.extend(e,{segmentId:n.segmentId,segmentName:t.segmentName}),d.Utils.returnResolvedPromise(e)}function D(e){var n=s.getApiData({coppa:0});return e.cscd=n&&n.coppa,d.Utils.returnResolvedPromise(e)}function I(n){var e=new o.Deferred;return s.shouldExtendApiDataWithDebugData()?s.getSDKDebugParams().then(function(e){return o.extend(n,e),d.Utils.returnResolvedPromise(n)}).always(function(){e.resolve(n)}):e.resolve(n),e.promise()}function w(e){if(!s.blacklistService.isEmpty(i,f)){var n=s.blacklistService.getBlacklistedCampaigns(i,f);o.extend(e,{blacklistedCampaigns:n.join(",")})}return d.Utils.returnResolvedPromise(e)}function P(e){return s.LastSeenCampaignService.shouldAddLastDisplayedAdCampaignIdToPayload(i)&&o.extend(e,{lastSeenCampaignId:s.LastSeenCampaignService.getLastDisplayedAdCampaignId()}),d.Utils.returnResolvedPromise(e)}function T(e){if(s.OMIDService.isNativeServiceActivated()){var n=s.OMIDService.getVersionData();o.extend(e,{omidEnabled:!0,omidVersion:n.omidVersion,omidPartnerVersion:n.omidPartnerVersion})}else o.extend(e,{omidEnabled:!1,moatSupported:s.MOATService.isInitialized()});return d.Utils.returnResolvedPromise(e)}function e(){var n,t,i=o.Deferred();if(s.isLegacy(s.featureMap.getTokenSupport))return d.Utils.returnResolvedPromise({});var r=function(e){d.PubSub.clearHandlers([n,t]),i.resolve(e)};return n=d.PubSub.subscribe(l.CB+"."+l.callbacks.getTokenSuccess,function(e){r(e)}),t=d.PubSub.subscribe(l.CB+"."+l.callbacks.getTokenFailed,function(e){e&&e.errMsg?s.log(l.errorLog+": "+e.errMsg,s.LogLevels.error):s.log(l.errorLog),r({})}),s.callSDKFunction(l.nativeFunction,{functionName:l.nativeAPI.getToken},l.callbacks.getTokenSuccess,l.callbacks.getTokenFailed),i.promise()}function O(a){return e().then(function(e){if("object"!=typeof e)return d.Utils.returnResolvedPromise(a);var n,i,t,r=(n=s.SupplyConfigurations.getNetworkConfigValueByKey(l.addTokenKeysToPayload),Array.isArray(n)||(n=[]),n);return o.each(e,function(e,n){var t;t=e,(-1<r.indexOf(t)||-1<e.indexOf(l.metaDataPrefix))&&(a[e]=n)}),s.isIOS()&&!s.isLegacy(s.featureMap.mutableAdvertingTrackingData)&&(i=a,(t=function(e){for(var n,t={},i=c.advertiserIdParamsToUpdate,r=0;r<i.length;r++)n=i[r],void 0!==e[n]&&(t[n]=e[n]);return t}(e))&&(s.getConfigurationHelper().parseConfiguration(t,{},s.getConfig().mobileSDKSettings),s.AdvertisingIdService.decideOnAdvertisingId(s.getConfig().mobileSDKSettings,m),o.each(t,function(e,n){var t=s.getSDKDataByKey(e);void 0!==t&&(i[e]=t)}))),d.Utils.returnResolvedPromise(a)})}function F(e){var n=s.getSDKDataByKey(c.xCodeVersion);return n&&o.extend(e,{xCodeVersion:n}),d.Utils.returnResolvedPromise(e)}function L(e){return s.log(n+"returnPayload | built payload for "+i),d.Utils.returnResolvedPromise(e)}return{createPayload:function(e){return g=e.impressionsCount,p=e.firstAttemptToGetFeed,v=e.retryCounter,a=e.deliveryPlumbus,s.getApplicationInfo(s.DemandUtils.extendCallbackParamsWithParentProductConfig(r,{})).then(s.getAPIRequiredData).then(S).then(y).then(A).then(D).then(C).then(b).then(h).then(I).then(w).then(P).then(T).then(O).then(F).then(L)},getToken:e}}},{"../../components/storeKit/SKANModel":84,"./PayloadBuilderConstants.js":117}],117:[function(e,n,t){n.exports={CB:"NativeCallback",metaDataPrefix:"metadata_",addTokenKeysToPayload:"addTokenKeysToPayload",nativeFunction:"iabTokenAPI",nativeAPI:{getToken:"getToken"},callbacks:{getTokenSuccess:"getTokenSuccess",getTokenFailed:"getTokenFailed"},errorLog:"payloadBuilder | getToken Failed"}},{}],118:[function(e,n,t){n.exports=function(s,d){var c=!0;function e(e){c=!!e}return{canPreloadCandidateAd:function(e,n,t,i,r,a){if(!c)return d.log("PreloadAdManager | Can not preload next ad right now"),!1;if(e&&!n)return d.log("PreloadAdManager | Skipping preload on capped demand"),!1;if(a)return d.log("PreloadAdManager | can preload true | Display when ad ready true"),!0;var o=s.VastUtils.isVastCampaign(t);return n||r&&!o||i?(d.log("PreloadAdManager | preload ad "+d.AdUtils.getAdId(t)),!0):(d.log("PreloadAdManager | skip preload ad "+d.AdUtils.getAdId(t)),!1)},preloadAdFinished:function(){e(!1)},setCanPreloadFlag:e,reset:function(){e(!0)}}}},{}],119:[function(Yt,e,n){function t(u,p,f,e,d,n){"use strict";var c,t=!1,l=e.demandSourceName,g=p.adUnitUrl,v=p.jQuery(),i,m=new(Yt("./../../components/MultipleInventories.js")),b=new(Yt("./PreloadAdManager"))(u,p),r=Yt("../../components/OMIDConstants"),a=new(Yt("../../patches/PublisherPatchEasybrain.js"))(p.getConfigurationHelper()),h=new(Yt("./../../components/sdkPluginType/SDKPluginTypeHandler.js"))(p,u.Utils),S=d.eventicsCategories,y={},o=v.extend({},d.precacheConfig),A=d.displayMode,C=!1,s=0,D=null,I=null,w=null,P=!1,T=!1,O,F=[],L,x={},N,U=f.closeButtonStates,M=!1,V=[],E=null,k=null,B=null,R=null,K=f.CB,j=null,W=0,G={},H={},_,q=p[d.productType],J=new(Yt("./DemandEntityBuilder.js"))(d,e),Q=Yt("../../patches/PatchIOSLoadAfterLoad.js")(u,p,J),z=n||pe(),X=Yt("./FetchDemand/FetcherPatch.js")(u,p,d,z,f),$=p.DemandUtils,Y=new(Yt("./../RewardedVideo/dsTaskManager.js"))(u,p,J,f),Z=Yt("../../components/VastService.js")(u,p),ee=new(Yt("./../RewardedVideo/availabilityReporter.js"))(u,p,d,J,Y),ne=new(Yt("./../RewardedVideo/availabilityManager.js"))(u,p,ee,d,z),te=new(Yt("./PayloadBuilder.js"))(v,p,u,J,f),ie=Yt("../../components/containers/WPADUtils")(p),re,ae=!0,oe=1,se=!1,de=p.getExternalContainer(),ce=p.InstancesTimers,le=function(){V.push(u.PubSub.subscribe("PrecacheManager.cacheUpdatedCallback",function(e){if($.shouldReceiveMessage(J,e)){var n,t,i;p.log("globals ready: "+C+" initSuccess in settings: "+y.numOfBannersToInitSuccess+" adUnits: "+m.size(e.inventoryId),p.LogLevels.verbose);var r=re.getCacheSizeByType(J.productType),a=Je.bind(null,e.inventoryId);if(0===y.numOfBannersToInitSuccess)t=1,n=re.areCampaignsAvailable(Ze(e.inventoryId).slice(0,t),t);else{var o=en(e.inventoryId);t=o.length;var s=He(m.getOffers(e.inventoryId),y.numOfBannersToInitSuccess);i=s<=t?s:t,n=re.areCampaignsAvailable(o,i)}p.log("PM | cacheUpdatedCallback cache updated areCampaignsAvailable: "+n,p.LogLevels.verbose),ne.cacheUpdate(r,C,n,a)}})),V.push(u.PubSub.subscribe("PrecacheManager.campaignDeletedCallback",function(e){if($.shouldReceiveMessage(J,e)){var n,t=-1,i={};u.Utils.isDefined(e.id)&&(n=$e(e.id,e.inventoryId),i=p.AdUtils.updateEventWithAdParams(y,n,i),t=n&&u.Utils.isDefined(n.inventoryIndex)?n.inventoryIndex:-1),z.trackEvent(S.campaignDeletedCache,{inventoryIndex:t},i)}})),V.push(u.PubSub.subscribe("PrecacheManager.campaignSavedCallback",function(e){if($.shouldReceiveMessage(J,e)){var n,t=-1,i=null,r={};u.Utils.isDefined(e.id)&&(n=$e(e.id,e.inventoryId),i=e.id,t=n&&u.Utils.isDefined(n.inventoryIndex)?n.inventoryIndex:-1,r=p.AdUtils.updateEventWithAdParams(y,n,r)),v.extend(r,{eNameStart:{name:S.campaignSavedCache.name+(i||"")},inventoryIndex:t}),z.trackTimingStop(S.campaignSavedCache,r)}})),V.push(u.PubSub.subscribe("PrecacheManager.campaignDownloadStartedCallback",function(e){if($.shouldReceiveMessage(J,e)){var n=v.extend({},S.campaignSavedCache);n.name=n.name+(e.id||""),z.trackTimingStart(n)}})),V.push(u.PubSub.subscribe("PrecacheManager.cacheAdsSuccessCallback",function(e){$.shouldReceiveMessage(J,e)&&p.log("RV cacheAdsSuccessCallback "+JSON.stringify(e),p.LogLevels.verbose)})),V.push(u.PubSub.subscribe("PrecacheManager.cacheNextFail",function(o){$.shouldReceiveMessage(J,o)&&o.deletedAds&&0<o.deletedAds.length&&v.each(o.deletedAds,function(e,n){var t=$e(n,o.inventoryId),i=p.AdUtils.updateEventWithAdParams(y,t,{}),r=o.deletedAdsData;if(r&&r[e].id==n){var a=r[e].failedAssetsUrlsArray.toString();i.rvnomoreoffersreason=a.substring(0,999)}z.trackEvent(S.campaignFailedToCache,{},i),ze(n,o.inventoryId)})})),V.push(u.PubSub.subscribe("PrecacheManager.fallbackToNonPrecache",function(e){$.shouldReceiveMessage(J,e)&&(u.PubSub.publish(d.productType+".fallbackToNonPrecache",[e]),z.trackEvent(S.fallbackToNonPrecache))})),V.push(u.PubSub.subscribe("PrecacheManager.cacheAdsFailedCallback",function(e){if($.shouldReceiveMessage(J,e)){p.log("RV cacheAdsFailedCallback "+JSON.stringify(e),p.LogLevels.verbose);for(var n,t,i,r=e.deletedOffers.length,a=e.deletedOffers,o=e.deletedAdsData,s=0;s<r;s++){var d=a[s],c=$e(d,e.inventoryId),l=p.AdUtils.updateEventWithAdParams(y,c,{});if(o&&o[s].id==d){var u=o[s].failedAssetsUrlsArray.toString();l.rvnomoreoffersreason=u.substring(0,999)}z.trackEvent(S.campaignFailedToCache,{},l),Qe(d,e.inventoryId)}if(0===y.numOfBannersToInitSuccess)t=1,n=re.areCampaignsAvailable(Ze(e.inventoryId).slice(0,t),t);else{var f=en(e.inventoryId);t=f.length;var g=He(m.getOffers(e.inventoryId),y.numOfBannersToInitSuccess);i=g<=t?g:t,n=re.areCampaignsAvailable(f,i)}ne.cacheAdsFailed(C,n,e.errorLog,Je.bind(null,e.inventoryId))}})),V.push(u.PubSub.subscribe("PrecacheManager.preProcessingFailedCallback",function(e){if($.shouldReceiveMessage(J,e)){p.log("PM | preProcessingFailedCallback "+e,p.LogLevels.verbose);var n=e.id,t=$e(n,e.inventoryId);Re(t)&&($.extendCallbackParamsWithProductConfig(J,t),p.addAdToLoadedCreatives(t),qe(),Ae(t))}})),V.push(u.PubSub.subscribe("Cache.assetRetrySuccess",function(e){if($.shouldReceiveMessage(J,e)&&e.file&&e.currentRetryAttempt&&e.totalRetryAttempts){var n=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]",t=ce.extendEventDataWithElapsedLoadTime(J.productType,J.demandSourceName,{});e.assetType===f.assetType.adunitAsset?z.trackEvent(S.adUnitRetrySuccess,{generalMessage:n.substring(0,250)},t):e.assetType===f.assetType.adAsset&&z.trackEvent(S.adAssetRetrySuccess,{generalMessage:n.substring(0,250)},t)}})),V.push(u.PubSub.subscribe("Cache.assetRetryFailed",function(e){if($.shouldReceiveMessage(J,e)&&e.file&&e.currentRetryAttempt&&e.totalRetryAttempts){var n=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]",t=ce.extendEventDataWithElapsedLoadTime(J.productType,J.demandSourceName,{});e.assetType===f.assetType.adunitAsset?z.trackEvent(S.adUnitRetryFail,{generalMessage:n.substring(0,250)},t):e.assetType===f.assetType.adAsset&&z.trackEvent(S.adAssetRetryFail,{generalMessage:n.substring(0,250)},t)}})),V.push(u.PubSub.subscribe("Cache.executeRetryFileUrlEmpty",function(e){var n={},t=e.listOfFilesUrls.toString();n.callfailreason=e.failedCachedFile.substring(0,255),n.rvnomoreoffersreason=t.substring(0,999),z.trackEvent(S.executeRetryFileUrlEmpty,{},n)})),V.push(u.PubSub.subscribe("SDKController.AdTracked",function(e){$.shouldReceiveMessage(J,e)&&(e=p.AdUtils.formatParamsToAdId(e),p.callSDKFunction("adCredited",$.extendCallbackParamsWithParentProductConfig(J,{credits:$e(p.AdUtils.getAdId(e),e.inventoryId).credits}),"adCreditedSuccess","adCreditedFailed"))})),V.push(u.PubSub.subscribe("SDKController.AdStarted",function(e){if($.shouldReceiveMessage(J,e)&&p.RingerSwitchService.isInitiated()){var n={},t=Mn();t&&t.ext&&(n=yt(w.ext)),p.RingerSwitchService.startListener(n),p.log("Ringer | startListener ringer status from AdStarted.",p.LogLevels.info)}})),V.push(u.PubSub.subscribe("SDKController.Analytics",function(e){if($.shouldReceiveMessage(J,e)&&e&&e.action){var n=e.action,t=e.eventParam;"fireEvent"===n?z.trackEvent(t.eName,t.label,t.data):"startTiming"===n?z.trackTimingStart(t.eName,t.data):"stopTiming"===n?z.trackTimingStop(t.eName,t.data):"setCustomData"===n&&(p.log("Controller - setCustomData received",p.LogLevels.verbose),z.updateBaseData(t.data))}})),V.push(u.PubSub.subscribe("SDKController.AdLoaded",function(e){if($.shouldReceiveMessage(J,e)){var n=p.AdUtils.getAdId(e),t=$e(n,e.inventoryId),i=e.inventoryId;clearTimeout(O),p.log("ad loaded with params: "+JSON.stringify(e),p.LogLevels.verbose),t&&z.updateBaseData({rvPlayMethod:t.displayMode});var r=0;if(u.VastUtils.isVastCampaign(t)&&(r=u.VastUtils.getVastViewCount(t)),u.Utils.isDefined(e.errMsg)){Y.publish("AdErrorState",[$.extendCallbackParamsWithDemandConfig(J,{error:!0})]),p.log("Error in loading ad: "+e.errMsg,p.LogLevels.error);var a={generalMessage:e.errMsg,vastViewCount:u.VastUtils.getVastViewCountForEvent(r)};return a=p.AdUtils.updateEventWithAdParams(y,t,a),a=ce.extendEventDataWithElapsedLoadTime(J.productType,J.demandSourceName,a),z.trackEvent(S.adLoadedError,{},a),t.ext.isHybridFlow&&t.ext.viewUniqueId&&(p.HybridService.clearAppPage(t.ext.viewUniqueId),u.PubSub.publish("HybridService.closeHybridFlow",[{viewUniqueId:t.ext.viewUniqueId}])),u.VastUtils.setMaxVastCount(t),Fn(t),void Ae(t)}y.viewType===f.viewTypes.externalView&&z.incrementSessionNumber();var o=ce.extendEventDataWithElapsedLoadTime(J.productType,J.demandSourceName,{});z.trackEvent(S.adLoaded,{vastViewCount:u.VastUtils.getVastViewCountForEvent(r)},o),u.Utils.isDefined(e.enableBackButton)&&p.setBackButtonState(e.enableBackButton),e=p.AdUtils.formatParamsToAdId(e),p.onAdLoaded($e(p.AdUtils.getAdId(e),e.inventoryId)),ne.adLoadedSuccessfully({numOfAdUnits:m.size(i),totalNumberCredits:Xe(i)})}})),V.push(u.PubSub.subscribe("SDKController.AdLoadError",function(e){$.shouldReceiveMessage(J,e)&&(ne.adLoadError(),p.unloadAdViewsByProduct(J),Ot()||Hn())})),V.push(u.PubSub.subscribe("SDKController.AdError",function(e){$.shouldReceiveMessage(J,e)&&p.log("SDKController.AdError:"+JSON.stringify(e),p.LogLevels.verbose)})),V.push(u.PubSub.subscribe("SDKController.dialogBoxResume",function(e){$.shouldReceiveMessage(J,e)&&z.trackEvent(S.dialogBoxResume)})),V.push(u.PubSub.subscribe("SDKController.dialogBoxExit",function(e){$.shouldReceiveMessage(J,e)&&z.trackEvent(S.dialogBoxExit)})),V.push(u.PubSub.subscribe("SDKController.adClosed",function(e){$.shouldReceiveMessage(J,e)&&(p.SKAdImpressionService.endImpression(e.ad,Ht,_t),z.resetBaseData(f.keysToResetOnAdClosed))})),V.push(u.PubSub.subscribe(d.productType+".GetConfig",function(t){if($.shouldReceiveMessage(J,t)){p.log("ProductInstance | getConfig received");var e=Mn();if(!e)return void p.log("ProductInstance | getConfig with no loaded ad");u.VastUtils.isVastCampaign(e)&&k?k.then(function(e,n){me(n||e,t)}):(p.HybridService.isHybridCampaign(e,y)&&ge(e),me(e,t))}})),V.push(u.PubSub.subscribe(d.productType+".isVisible",function(e){if(p.log("ProductInstance | isVisible"),$.shouldReceiveMessage(J,e)){var n=Mn(),t=p.getCurrentDisplayedAd();if(p.isAdDisplayed(n))return void p.log("ProductInstance | isVisible | isAdDisplayed=true");n?t&&p.getCurrentDisplayedAdType()!==d.productType?z.trackEvent(S.bannerLoadedDuringShow):(p.setCurrentDisplayedAd(n),p.getCurrentDisplayedAdType()===f.BN&&de.shouldReportAdVisibleForBanners()&&(p.log("ProductInstance | isVisible | shouldReportAdVisible"),p.onAdVisible())):p.log("ProductInstance | isVisible | ad is null")}}))};V.push(u.PubSub.subscribe("ExternalContainer.duringCreation",function(e){$.shouldReceiveMessage(J,e)&&z.trackEvent(S.duringCreation)}));var ue=function(){V.push(u.PubSub.subscribe("AdsAssetsClearanceService.cacheReachedMaximumCapacity",function(e){if($.shouldReceiveMessage(J,e)){var n={custom_b:e.maxAdsToSaveInCache};n=ce.extendEventDataWithElapsedLoadTime(J.productType,J.demandSourceName,n),z.trackEvent(S.adLevelCacheReachedMaxCapacity,{},n)}})),V.push(u.PubSub.subscribe("AdsAssetsManager.saveAdInCacheSuccess",function(e){if($.shouldReceiveMessage(J,e)){var n=fe(e);n=ce.extendEventDataWithElapsedLoadTime(J.productType,J.demandSourceName,n),z.trackEvent(S.saveAdInCacheSuccess,{},n);var t=p.AdsAssetsManager.areNonMandatoryAdsToCacheConfigured(y.numOfBannersToInitSuccess,y.numOfBannersToCache);C&&t&&Je(m.getActiveInventoryId())}})),V.push(u.PubSub.subscribe("AdsAssetsManager.saveAdInCacheFailure",function(e){if($.shouldReceiveMessage(J,e)){var n=fe(e);n=ce.extendEventDataWithElapsedLoadTime(J.productType,J.demandSourceName,n),z.trackEvent(S.saveAdInCacheFailure,{},n),ze(p.AdUtils.getAdId(e.ad))}})),V.push(u.PubSub.subscribe("AdsAssetsManager.deleteAdFromCacheSuccess",function(e){if($.shouldReceiveMessage(J,e)){var n=fe(e);n=ce.extendEventDataWithElapsedLoadTime(J.productType,J.demandSourceName,n),z.trackEvent(S.deleteAdFromCacheSuccess,{},n)}})),V.push(u.PubSub.subscribe("AdsAssetsManager.deleteAdFromCacheFailure",function(e){if($.shouldReceiveMessage(J,e)){var n=fe(e);n=ce.extendEventDataWithElapsedLoadTime(J.productType,J.demandSourceName,n),z.trackEvent(S.deleteAdFromCacheFailure,{},n)}})),V.push(u.PubSub.subscribe("AdsAssetsManager.adsAlreadyCached",function(e){$.shouldReceiveMessage(J,e)&&(e=ce.extendEventDataWithElapsedLoadTime(J.productType,J.demandSourceName,e),z.trackEvent(S.adsAlreadyCached,{},e))})),V.push(u.PubSub.subscribe("AdsAssetsNativeCommunicator.adAssetRetrySuccess",function(e){if($.shouldReceiveMessage(J,e)){var n=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]",t=ce.extendEventDataWithElapsedLoadTime(J.productType,J.demandSourceName,{});z.trackEvent(S.adAssetRetrySuccess,{generalMessage:n.substring(0,250)},t)}})),V.push(u.PubSub.subscribe("AdsAssetsNativeCommunicator.adAssetRetryFailed",function(e){if($.shouldReceiveMessage(J,e)){var n=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]",t=ce.extendEventDataWithElapsedLoadTime(J.productType,J.demandSourceName,{});z.trackEvent(S.adAssetRetryFail,{generalMessage:n.substring(0,250)},t)}}))};function fe(e){var n={};if(u.Utils.isDefined(e.ad)){var t=e.ad&&u.Utils.isDefined(e.ad.inventoryIndex)?e.ad.inventoryIndex:-1;n=p.AdUtils.updateEventWithAdParams(y,e.ad,n),v.extend(n,{inventoryIndex:t})}return n}function ge(e){e.ext.shouldInitHybridFlow=!0}function pe(){var e=Pt()?f.integrationType.manual:f.integrationType.automatic,n={productChance:(p.getEnv(),1),baseData:{productType:J.productType,demandSourceName:J.demandSourceName,integrationType:e,isBiddingInstance:Ot()}};return u.Eventics.createEventic(n,p.EventsManager)}function ve(){return z}function me(e,n){var t=$e(p.AdUtils.getAdId(e),e.inventoryId);return t?(u.VastUtils.isVastCampaign(e)||be(t),p.MOATService.containsMOATData(e)&&p.MOATService.enableTracking(),we(t),n&&n.callback&&n.callback.call(null,t)):p.log("line[456]: no current available ad",p.LogLevels.verbose),t}function be(e){y.requestID&&(e.requestID=y.requestID);var n=he(p.getApiData({scdn:1,protocol:0,defaultProtocol:1}).scdn);return v.extend(!0,e,p.getFormattedDeviceData(),Se(n))}function he(e){var n=p.decideUrlProtocolAccordingToHTTPSCompliance()+"//"+e;return"prod"!==p.getEnv()&&(n=p.api()+"/users/staging/"+SuperSonicGlobalConfig.mobileSDKSettings.env),n}function Se(e){return{settings:{protocol:p.decideUrlProtocolAccordingToHTTPSCompliance(),urltocdn:e,appKey:p.getSDKDataByKey(f.requiredSDKDataKeys.applicationKey),appOrientation:p.getSDKDataByKey(f.requiredSDKDataKeys.appOrientation),deviceLanguage:p.getSDKDataByKey(f.requiredSDKDataKeys.deviceLanguage),bundleId:p.getSDKDataByKey(f.requiredSDKDataKeys.bundleId),sdkAbName:p.getSDKDataByKey(f.requiredSDKDataKeys.sdkAbName),deviceId:p.getDeviceId(),skOverlaySupported:p.SKOverlayManager.isSKOverlaySupported()}}}function ye(){E=B=k=null}function Ae(n){var e=p.AdUtils.getAdId(n);ze(e,n.inventoryId);var t=Y.getStatus().duringEngage;Vn(e,n.inventoryId),ye();var i=c.getNextAd(t,n.inventoryId);function r(){p.log("DemandSource | adLoaded with error - removing and moving to next offer",p.LogLevels.verbose),Un(null),p.removeAdUnit($e(e,n.inventoryId))}function a(){p.log("RV adLoaded with error | no offers for user - show dialog",p.LogLevels.verbose),p.setCloseButtonState({productType:d.productType,demandSourceName:l,state:U.close});var e={productType:d.productType,message:L&&L.noOffers?L.noOffers:f.labels.noOffers,yes:"close",alwaysClose:!0};p.postAdUnitEvent({name:"alertUserOnError",options:e}),z.trackEvent(S.userAlert,{inventoryIndex:n.inventoryIndex||-1})}if(t&&n.isWPAD)a();else if(t&&!i){var o=m.getBackfillOffer(n.inventoryId);if(o){En();var s=p.AdUtils.updateEventWithAdParams(y,o,{rvPlayMethod:o.displayMode});z.trackEvent(S.backFill,{},s),r()}else a()}else r()}function Ce(e){return e&&e.displayMode?e.displayMode:A.softprecache}function De(){var e=m.getActiveInventoryId();z.incrementSessionNumber();var n=Mn()||nn(e);n||(n=tn(!0,e));var t=p.AdUtils.updateEventWithAdParams(y,n,{});t.rvPlayMethod=Ce(n),z.updateBaseData(t)}function Ie(e){var n=p.OMIDService.getVersionData().omidVersion;return p.OMIDService.isAdOmidSupported(e)&&r.omidVersionRequiresWebviewPerAd[n]?p.OMIDService.getOmidBundleUrl():""}function we(e){var n=e.displayMode!=A.softprecache&&re.isPrecache();e.settings.omidUrl=Ie(e),void 0===e.productType&&(e.productType=J.productType),void 0===e.demandSourceName&&(e.demandSourceName=J.demandSourceName),e.settings.precache=n,e.settings.sessionDepth=oe,e.settings.viewType=y.viewType,u.AdAssets.isAdAbleToCache(e)&&(e.settings.ableToCache=e.ext.ableToCache,delete e.ext.ableToCache),p.MOATService.containsMOATData(e)&&p.MOATService.isTrackingEnabled()&&(e.settings.moatData=p.MOATService.extractMoatDataFromAd(e))}var Pe=function(e){var n="AttemptToBringNewAds | ";if(p.log(n),z.trackEvent(S.attemptToBringNewFeed,{generalMessage:Y.getStatusMsg()}),Pt()||z.trackTimingStart(S.initAdToAdReady),M)p.log(n+"Cannot bring feed attemptToBringNewAdsInProcess="+M);else{if(M=!0,!Y.allowExternalCallToApi())return p.log(n+"Cannot bring feed: "+Y.getStatusMsg()),void(I=setTimeout(function(){M=!1,p.log(n+"2 minutes delay finished"),Pe(e)},d.timerLengths.riDelay));ne.inventoryEmpty(e),setTimeout(function(){p.log(n+"Can bring feed"),Te(y.refreshInterval),p.unloadAdViewsByProduct(J),M=!1,Hn()},0)}},Te=function(e){p.log("setting refresh interval to: "+e,p.LogLevels.info),D&&clearInterval(D),e&&0!==e&&!Ot()?D=setInterval(function(){z.trackEvent(S.refreshInterval),Y.canEngage()?(clearInterval(D),Y.canInitCallToApi().then(Pe)):(p.log("setDuringRefreshInterval(true)",p.LogLevels.info),Mt(!0))},e*d.timeUnit):p.log("No Refresh interval is needed")};function Oe(e){N=e.labels,e.templateid==d.customDialog?N.confirmCloseMsg[f.confirmCloseMsgMap[0]].alwaysClose=!0:L=e.labels}var Fe=function(e){var n=e.seatbid.ext;n.shouldStartMuted=p.AdUtils.isCampaignShouldStartMuted(p.getConfig().controllerConfig,d.productType),v.extend(n,d.overrideFeedSettings),v.extend(n,p.getApplicationExternalConfig().getABTestConfiguration(Le(),n.landingId)),D&&clearInterval(D),$n()&&Te(n.refreshInterval),p.isLegacy(p.featureMap.rvPortraitOrientation)&&(n.orientation=f.appInfo.orientation.landscape),d.productType===f.BN&&(n.numOfBannersToInitSuccess=0,n.numOfBannersToCache=0),p.DeviceDataService.setPullDataOnLoadAd(n.enablePullDataOnLoadAd),y=n},Le=function(){return J.demandSourceName===f.RIS?f.RIS:q.getProductType()},xe=function(e){v.each(e,function(e,n){n.inventoryIndex=e,re.isPrecache()&&re.setAdInventoryIndex(p.AdUtils.getAdId(n),e)})};function Ne(e){if(p.AdsAssetsManager.isAdLevelCacheEnabled())for(var n=0;n<e.length;n++)e[n].isCacheable=0<e[n].adAssets.length}function Ue(e){p.AdsAssetsManager.isAdLevelCacheEnabled()&&v.each(e,function(e,n){n.inventoryIndex=e})}function Me(){v.each(V,function(e,n){u.PubSub.unsubscribe(n)})}function Ve(){I&&clearTimeout(I),D&&clearInterval(D)}function Ee(e){p.AdsAssetsManager.unsetReferencesForInstance(J.instanceUniqueId);var n=!!e&&e.engaged;Me(),Ve();var t=v.extend({},J,{engaged:n});u.PubSub.publish(d.productType+".exhaustedDemandSource",[t])}function ke(e){var n,t=[];for(n=0;n<e.length;n++)re.isAdInCache(p.AdUtils.getAdId(e[n]))||t.push(e[n]);return t}var Be=function(e){var t=[];return v.each(e,function(e,n){n.ext&&n.ext.appData&&n.ext.appData.adAssets&&(n.ext.appData.appImages=n.ext.appData.adAssets,delete n.ext.appData.adAssets),t.push(n)}),t},Re=function(e){return re.isPrecache()&&u.VastUtils.isVastCampaign(e)&&e.ext.precacheVasts},Ke=function(e){return 1===e.length&&Re(e[0])&&(T=!0),u.Utils.returnResolvedPromise()},je=function(e){return pn(u.VastUtils.isVastCampaign(e)),e.inventoryId&&yn(),fn(e).then(function(e,n){return p.AdUtils.formatVastAdForPrecache(n,je.bind(null,e))})},We=function(e){var n=[];return T?n.push(p.AdUtils.formatVastAdForPrecache(e[0],je.bind(null,e[0]))):n=p.AdUtils.formatAdsForPrecache(e),n},Ge=function(a,o){var s,d,e,c=re.isPrecache();a=Be(a),xe(a);var l=m.setOffers(a.slice(0),o);s=We(a),d=He(a,y.numOfBannersToCache);var n=function(){if(u.VastUtils.isThereVastCampaign(Ze(l))&&ne.setAMSettings({reportOnAdunitReady:!1},!0),c){var e=He(a,y.numOfBannersToInitSuccess),n=re.areCampaignsAvailable(s.slice(0,e),e);p.log("DemandSource | updateCurrentAds areCampaignsAvailable "+n,p.LogLevels.verbose);var t=Je.bind(null,l);ne.preCacheMode(n,d,t,u.VastUtils.areAllCampaignTypesAreVast(Ze(l)),hn.bind(null,l),m.size(l),Xe(l),u.VastUtils.isVastCampaign(a[0]));var i=ke(s),r={cacheTimeoutSuccessCallback:function(){Ge(a,o)},cacheTimeoutFailCallback:_e,applicationUserId:p.getSDKDataByKey(f.requiredSDKDataKeys.applicationUserId),applicationKey:p.getSDKDataByKey(f.requiredSDKDataKeys.applicationKey),newAdsToEnterCache:i,inventoryId:l,adAssetsCacheConfig:H};re.handleCacheAds(r)}else ne.notPreCacheMode(Je.bind(null,l))};c&&(e=re.mergeCampaigns(s,d),p.log("DemandSource | updateCurrentAds after merge "+JSON.stringify(e),p.LogLevels.verbose)),!c||y.purgeCacheOnInit?(p.log("DemandSource | already purged cache so go strait to adding the new ads",p.LogLevels.verbose),n()):re.clearCacheByType(e).always(n)},He=function(e,n){for(var t=e.length<n?e.length:n,i=n,r=0;r<t;r++)e[r].isCacheable||i--;return i},_e=function(e){ne.cacheTimeoutFail(e)},qe=function(){Y.publish("InitiatedAPICall",[$.extendCallbackParamsWithProductConfig(J,{duringInit:!1})])},Je=function(e){p.log("ProductInstance | handlePossibleAdUnitsReady",p.LogLevels.verbose);var n=nn(e);if(n){var t=u.VastUtils.isVastCampaign(n);if(T&&pn(t,e))Sn(e);else{var i=m.size(e),r=Xe(e),a=u.VastUtils.areAllCampaignTypesAreVast(Ze(e));ne.canReportAvailable(i,r,a,t)}de&&J.productType===f.BN?Kt(y,J,x):c.attemptToPreloadAd(!1,e)}},Qe=function(e,n){m.removeOfferById(e,n)&&!m.isEmpty(n)&&re.incrementNextCampaign()},ze=function(e,n){if(!kn()){var t=m.getOfferById(e,n);t?t.toRemove=!0:p.log("Error in mark current ad to be removed:"+e,p.LogLevels.error),R=null}},Xe=function(e){for(var n=0,t=m.getOffers(e),i=m.size(e),r=0;r<i;r++)n+=t[r].credits;return n},$e=function(e,n){var t=m.getOfferById(e,n);if(!t){if(kn())return m.getBackfillOffer(n);p.log("Error in getAdUnitById, id "+e+" not found in "+JSON.stringify(m.getOffers(n)),1)}return t},Ye=function(e,n,t){return m.replaceOfferById(e,n,t)},Ze=function(e){return v.grep(m.getOffers(e),function(e){return!(u.Utils.isDefined(e.toRemove)&&e.toRemove)})},en=function(e){var n=Ze(e);return v.grep(n,function(e){return e.isCacheable})},nn=function(e){var n,t=$e(p.AdUtils.getAdId(sn(e)),e);return n=re.isPrecache()&&t&&t.isCacheable?(t=$e(p.AdUtils.getAdId(on(e)),e),A.precache):A.nonprecache,t&&!t.displayMode&&rn(t,n),t},tn=function(e,n){if(!e)return null;var t=an(n);return t?$e(p.AdUtils.getAdId(t),n):null},rn=function(e,n){e&&(e.displayMode=n)},an=function(e){return 0<Ze(e).length?Ze(e)[0]:null},on=function(e){return 0===y.numOfBannersToInitSuccess?re.getCurrentAd(Ze(e).slice(0,1)):re.getCurrentAd(Ze(e))},sn=function(e){return m.getCurrentOffer(e)},dn=function(e){var n=p.AdUtils.getAdId(e);Y.publish("Engaged",[$.extendCallbackParamsWithProductConfig(J,{duringEngage:!1})]),Un(null),ye();var t=$e(n,e.inventoryId);clearTimeout(O),t?(p.log("onEngageEnd with params: "+JSON.stringify(t),p.LogLevels.verbose),Vn(n,t.inventoryId),u.Utils.isDefined(t)&&t.toRemove&&(p.AdsAssetsManager.unsetReferencesForAds([e],J.instanceUniqueId),p.log("removing ad id: "+n,p.LogLevels.verbose),Qe(n,t.inventoryId))):p.log("Tried to end engage with no ad",p.LogLevels.error)},cn=function(e){var n=p.AdUtils.getAdId(e),t=$e(n,e.inventoryId);u.Utils.isDefined(t)&&t.toRemove&&(p.log("removing ad id: "+n,p.LogLevels.verbose),Qe(n,t.inventoryId))};function ln(e){E&&"pending"===E.state()&&(u.Utils.isDefined(e)?(p.log("handleVastAvailability - VAST failed to load with reason: "+e),E.reject()):(p.log("handleVastAvailability - VAST verified - resolve"),E.resolve()))}function un(e){var n="";return u.Utils.isDefined(J.demandSourceName)&&(n=J.demandSourceName),n+=J.productType+e}function fn(r){var a=p.AdUtils.getAdId(r),o=mn(r),s=r.inventoryId;if(r.ext.videoData.isVast&&R){var e=u.VastUtils.getVastViewCount(r),n=r.settings.preload,t=r.displayMode;R=u.VastUtils.setVastViewCount(R,e),(r=R).settings.preload=n,r.displayMode=t}else(r=u.VastUtils.setVastViewCount(r,0)).ext.vastExhaustIndex&&1<r.ext.vastExhaustIndex&&(R=r);return be(r),k=new v.Deferred,r.vastIframeId=un(a),z.trackTimingStart(S.parseVast),Z.parseVast(r,re.isPrecache(),y).then(function(e){if(null!==k){if(z.trackTimingStop(S.parseVastSuccess,{generalMessage:o,eNameStart:S.parseVast}),!u.Utils.isDefined(r.toRemove)||!r.toRemove){e.ext.videoData.isVast=!0,u.Utils.isDefined(r.displayMode)&&(e.displayMode=r.displayMode),u.VastUtils.incrementVastViewCount(e),ln(e.errMsg);var n=r;return u.VastUtils.incrementVastViewCount(n),Ye(r=e,p.AdUtils.getAdId(r),s),k.resolve(n,e)}Z.removeIframe(un(a))}},function(e){if(null!==k){var n={generalMessage:o,eNameStart:S.parseVast};if(n=p.AdUtils.updateEventWithAdParams(y,r,n),e.isTimeLimitReached&&(n.callFailReason="timeout"),z.trackTimingStop(S.parseVastFail,n),!u.Utils.isDefined(r.toRemove)||!r.toRemove){var t=u.VastUtils.incrementVastViewCount(r);ln(e.errMsg),Y.publish("AdErrorState",[$.extendCallbackParamsWithProductConfig(J,{error:!0})]),p.log("Error in loading ad: "+e.errMsg,p.LogLevels.error);var i={generalMessage:e.errMsg,vastViewCount:u.VastUtils.getVastViewCountForEvent(t)};return i=p.AdUtils.updateEventWithAdParams(y,r,i),z.trackEvent(S.adLoadedError,{},i),u.VastUtils.setMaxVastCount(r),Fn($e(a,s)),k.reject()}Z.removeIframe(un(a))}})}function gn(e){return B=new v.Deferred,e.ext.viewUniqueId=p.HybridService.createHybridId(e,J),p.HybridService.loadHybridCampaign(p.AdUtils.getStoreAppId(e),e.ext.viewUniqueId).then(function(){if("resolved"!==B.state())return e.ext.forceOrientation="portrait",e.ext.isHybridFlow=!0,B.resolve()},function(){if("resolved"!==B.state())return z.trackEvent(S.hybridFlowFail,{callFailReason:"Store load fail"}),e.ext.isHybridFlow=!1,B.resolve()})}function pn(e,n){return vn(e)||bn(n)}function vn(e){return y.preFetchAllVasts&&e}function mn(e){var n;return vn(u.VastUtils.isVastCampaign(e))?n="preFetchAllVasts":bn(e.inventoryId)&&(n="vastAvailabilityValidation"),n}function bn(e){return re.isPrecache()&&u.VastUtils.areAllCampaignTypesAreVast(Ze(e))}function hn(e){p.log("handleVastAvailability",p.LogLevels.verbose),yn(),Sn(e),qe()}function Sn(e){v.when(E).then(function(){ne.allVastPromiseResolved(m.size(e),Xe(e))})}function yn(){E&&"pending"===E.state()||(E=new v.Deferred)}var An=function(){return Y.canInitCallToApi().then(function(){},function(){return p.log(d.errors.init[1001]+Y.getStatusMsg(),p.LogLevels.error),d.errors.init[1001]}).then(function(){return Y.publish("InitiatedAPICall",[$.extendCallbackParamsWithProductConfig(J,{duringInit:!0})]),s++,u.Utils.decodeValues(i),f.BN===d.productType&&z.trackEvent(S.getInventory),X.applyCommunicationSolution(window.timerService.timeElapsed(window.lastWebviewClosedTimer)),p.FetchDirectService.fetchFeed(q.getDestination(l),i,d.timerLengths.serverResponseTimeoutInMilis)}).then(Cn).then(In,function(e,n){var t,i=new v.Deferred;switch(t=d.errors.init[1005],typeof e){case"object":e.responseText&&""!==e.responseText?t=e.responseText:e.errorMessage&&""!==e.errorMessage&&(t=e.errorMessage);break;case"string":""!==e&&(t=e)}return qe(),"timeout"===n?i.reject(d.errors.load.timeout):i.reject(t),i.promise()})},Cn=function(e){var n=new v.Deferred;if(u.Utils.isDefined(e.response)&&u.Utils.isDefined(e.response.errorCode)){qe();var t=u.Utils.isDefined(e.response.errorMessage)&&e.response.errorMessage?e.response.errorMessage:d.errors.init[1003];n.reject(t)}else u.Utils.isDefined(e.seatbid)&&u.Utils.isDefined(e.seatbid.bid)&&u.Utils.isDefined(e.seatbid.ext)&&u.Utils.isDefined(e.seatbid.ext.labels)?n.resolve(e):(qe(),n.reject(d.errors.init[1004]));return n.promise()};function Dn(e){if(e){var n={blacklistedCampaigns:e.join(",")};p.getTokenService().updateToken(n)}}var In=function(e){var a=function(e){return Ot()&&(y.disableTokenFiltering||void 0===e||0===e.length||(e.forEach(Ln),Dn(q.filteredListService.getFilteredListCampaigns()))),u.Utils.returnResolvedPromise()};return function(e){Y.setConnection(!0);var t=e.seatbid.bid,n=e.seatbid.ext;q.getAmountOfSupportedInventories()===f.DEFAULT_AMOUNT_OF_INVENTORIES&&(Kn(),m.reset());var i=m.getAvailableInventoryId();if(z.updateBaseData({landingId:n.landingId,strategyId:n.strategyId}),e.seatbid.backfill){var r=e.seatbid.backfill;r.id=p.AdUtils.getAdId(r),rn(r,A.softprecache),i=m.setBackfillOffer(r,i)}return _=n.deliveryPlumbus,v.when(Fe(e),Oe(n)).then(zn.bind(null,y)).then(p.CampaignsFilter.filterByAppInstalled.bind(null,t,y,d.filterDisableTypes)).then(a).then(function(e){for(var n=e&&e.length||0,t="",i=0;i<n;i++)t+=p.AdUtils.getAdType(e[i],y),i<n-1&&(t+=", ");return z.updateBaseData({feedSize:n,feedCampaignOrder:t}),u.Utils.returnResolvedPromise()}.bind(null,t)).then(function(e){return e.some(p.OMIDService.isAdOmidSupported)&&p.OMIDService.downloadOmidJsBundle(),u.Utils.returnResolvedPromise()}.bind(null,t)).then(re.decidePrecacheStatus.bind(null,{numOfCampaigns:t.length,settings:y})).then(function(){return ne.setAMSettings({preFetchAllVasts:y.preFetchAllVasts,shouldRefreshInventory:Xn(y),isPreCache:re.isPrecache(),numOfBannersToInitSuccess:y.numOfBannersToInitSuccess,reportOnAdunitReady:y.reportOnAdunitReady}),t&&0<t.length?(C=!1,_n(),p.adUnitGlobals.updateAdUnitGlobals(!0,Yn(),G,z)):u.Utils.returnRejectedPromise(f.errors.noFill)}).then(function(){return v.when(Zn(t)?p.libsManager.manageDownloadLibsFileByFiletype(d.libsCacheFiles.dapi):u.Utils.returnResolvedPromise(),(n=t,re.isPrecache()&&et(n)?p.libsManager.manageDownloadLibsFileByFiletype(d.libsCacheFiles.externalObfuscation).then(function(e){nt(n,e)}):u.Utils.returnResolvedPromise()));var n}).then(function(){return Xt()?u.Utils.returnResolvedPromise():re.handleCacheClear()}).then(Ke(t)).then(p.AdsAssetsManager.setAdAssetsForAds.bind(null,t)).then(Ne.bind(null,t)).then(p.AdsAssetsManager.setReferencesForAds.bind(null,t,J.instanceUniqueId)).then(Ue.bind(null,t)).then(function(e,n,t){if(!Xt())return u.Utils.returnResolvedPromise();var i,r=new v.Deferred,a=p.AdsAssetsManager.cacheAdsWithClearanceLogic(e,n.numOfBannersToCache,n.numOfBannersToInitSuccess,t,Jn(n)).then(function(){clearTimeout(i),r.resolve()}).fail(function(e){clearTimeout(i),r.reject(e)});return i=setTimeout(function(){var e=a.state();if("pending"===e||"rejected"===e){var n={callfailreason:"ad level timeout expired when caching ads"};n=ce.extendEventDataWithElapsedLoadTime(t.productType,t.demandSourceName,n),z.trackEvent(S.adLevelCachingTimeout,{},n),r.reject("cacheAdsAssets timeout expired")}"resolved"===e&&r.resolve()},d.precacheConfig.timeoutForCachingAdsInAdLevelCacheFlow),r.promise()}.bind(null,t,y,J)).then(function(){if(C=!0,!Xt())return qn(),Ge(t,i);var e=m.setOffers(t.slice(0),i);0===y.numOfBannersToInitSuccess&&ne.reportAdAvailable({numOfAdUnits:m.size(e),totalNumberCredits:Xe(e)}),Je(e)}).fail(function(e){var n=e||"Fail parse adUnit info from api response";p.AdsAssetsManager.unsetReferencesForAds(t,J.instanceUniqueId),m.removeInventory(i),f.BN===d.productType&&z.trackEvent(S.getInventoryFailed,{generalMessage:n}),Bn(),e&&p.log(e,p.LogLevels.error),ne.inventoryEmpty(e||n),Qt()&&Ee()}),(new v.Deferred).resolve(v.extend({},e.seatbid.ext,{numOfAdUnits:e.seatbid.bid.length}))}(e)},wn=function(){v.each(F,function(e,n){clearTimeout(n)}),F=[]};function Pn(){Y.publish("Engaged",[$.extendCallbackParamsWithProductConfig(J,{duringEngage:!0})])}function Tn(){var e;e={productType:d.productType,message:L&&L.noInternet?L.noInternet:f.labels.noInternet,yes:"close",alwaysClose:!0},p.alert(e)}var On=function(e,n,t){var i,r=p.AdUtils.getAdId(e);p.log("Error in loading ad - timeout in "+r,p.LogLevels.error),i=t?S.showAdFail:S.adLoadedError;var a={isprecache:re.isPrecache()};a=p.AdUtils.updateEventWithAdParams(y,e,a),z.trackEvent(i,{callfailreason:"Error in loading ad - timeout"},a),$.extendCallbackParamsWithProductConfig(J,e),u.VastUtils.isVastCampaign(e)&&Fn(e),ze(r,e.inventoryId),Un(null),ye(),Z.removeIframe(un(r)),y.viewType===f.viewTypes.externalView?p.removeAdUnitFromExternal(e):p.removeAdUnit(e)},Fn=function(e){kn()||(e&&e.cid?p.blacklistService.addToBlacklistedCampaigns(J.productType,J.demandGroupName,e.cid):p.log("DemandSource | cannot add to blacklist with no ad",p.LogLevels.error))},Ln=function(e){e&&e.cid&&q.filteredListService.addToFilteredListCampaigns(e.cid)},xn=function(){var e={errMsg:void 0,didSucceed:!0};return u.Utils.isDefined(y.allowMultiInitCalls)&&!y.allowMultiInitCalls?(e.errMsg=d.errors.init.multi,e.didSucceed=!1):Y.allowExternalCallToApi()?a.shouldFail(p.getConfig())&&(e.errMsg=d.errors.init.deviceOsIsNotSupported,e.didSucceed=!1):(e.errMsg="Already attempting to initiate",e.didSucceed=!1),e},Nn=function(){I&&clearTimeout(I)},Un=function(e){w=e},Mn=function(){return w},Vn=function(e,n){var t=m.getBackfillOffer(n);t&&e==t.id&&(P=!1)},En=function(){P=!0},kn=function(){return!0===P},Bn=function(){Un(null),ye(),ne.reset(),b.reset()},Rn=function(){Kn(),m.reset(),Y.publish("InitiatedTimeoutAttempt",[$.extendCallbackParamsWithProductConfig(J,{duringAPITimeoutAttempts:!1})]),Bn()},Kn=function(){for(var e=Object.keys(m.getInventories()),n=0;n<e.length;n++)p.AdsAssetsManager.unsetReferencesForAds(m.getOffers(e[n]),J.instanceUniqueId)},jn=function(){var e=!1;if(J.productType===f.BN&&m){var n=m.getActiveInventoryId();n&&(e=m.isNextOfferAvailable(n))}return e},Wn=function(){var e=m.getActiveInventoryId();if(e){var n=nn(e);m.removeOfferById(n.id,e),Je(e)}};function Gn(){p.DeviceDataService.shouldPullDataOnLoadAd()&&p.DeviceDataService.pullData()}function Hn(i,r,a){var e=function(e){if(!o){s=0,Y.publish("InitiatedTimeoutAttempt",[$.extendCallbackParamsWithProductConfig(J,{duringAPITimeoutAttempts:!1})]),e=e||d.errors.init[1002],f.BN===d.productType&&(z.trackEvent(S.getInventoryFailed,{generalMessage:e}),de.resetExternalAdViewsIdentifiers());try{if("string"==typeof e){var n=parseInt(e);1001<n&&n<1006&&(e=d.errors.load.invalid)}}catch(e){}var t=$.extendCallbackParamsWithDemandConfig(J,{errMsg:e});p.callSDKFunction(a,t),u.PubSub.publish(d.productType+".failedToLoad",[t]),Qt()&&Ee()}};if(Gn(),Bn(),jn())Wn();else{var o=!1;(F.push(setTimeout(function(){e(d.errors.load.timeout),o=!0},7*d.timeUnit)),(new v.Deferred).resolve()).then(Nn).then(It).then(An).always(wn).then(function(e){o||(s=0,Y.publish("InitiatedTimeoutAttempt",[$.extendCallbackParamsWithProductConfig(J,{duringAPITimeoutAttempts:!1})]),ae=!1,p.callSDKFunction(r,$.extendCallbackParamsWithDemandConfig(J,e)))},function(e){var n=new v.Deferred,t=q.doesAllowConsecutiveGatewayRequestsDuringLoad();return o||(e===d.errors.load.timeout&&t&&s<d.maxNumOfAttemptsToCallAPI?(Y.publish("InitiatedTimeoutAttempt",[$.extendCallbackParamsWithProductConfig(J,{duringAPITimeoutAttempts:!0})]),setTimeout(function(){Hn(i,r,a)},d.timerLengths.initAttemptsDelay),n.resolve()):n.reject(e)),n.promise()}).then(null,e)}}function _n(){G={productType:d.productType,demandSourceName:J.demandSourceName,retryAttempts:y.adunitRetryAttempts,retryInterval:y.adunitRetryInterval,assetType:f.assetType.adunitAsset}}function qn(){H={productType:d.productType,demandSourceName:J.demandSourceName,retryAttempts:y.adAssetRetryAttempts,retryInterval:y.adAssetRetryInterval,assetType:f.assetType.adAsset}}function Jn(e){return{adAssetRetryAttempts:e.adAssetRetryAttempts||0,adAssetRetryInterval:e.adAssetRetryInterval||1}}function Qn(e,n,i){if(e&&e.adm&&e.demandSourceName===l){p.log("product loadAdWithAdm | resetting last response to none",p.LogLevels.verbose),p.unloadAdViewsByProduct(J),Bn(),X.applyCommunicationSolution(window.timerService.timeElapsed(window.lastWebviewClosedTimer));(Y.publish("InitiatedAPICall",[$.extendCallbackParamsWithProductConfig(J,{duringInit:!0})]),u.Utils.returnResolvedPromise(e.adm)).then(Cn).then(In,function(e){var n;switch(n=d.errors.init[1005],typeof e){case"object":e.responseText&&""!==e.responseText?n=e.responseText:e.errorMessage&&""!==e.errorMessage&&(n=e.errorMessage);break;case"string":""!==e&&(n=e)}return qe(),u.Utils.returnRejectedPromise(n)}).then(function(e){p.callSDKFunction(n,$.extendCallbackParamsWithDemandConfig(J,e))},function(e){try{if("string"==typeof e){var n=parseInt(e);1001<n&&n<1006&&(e=d.errors.load.invalid)}}catch(e){}var t=$.extendCallbackParamsWithDemandConfig(J,{errMsg:e});p.callSDKFunction(i,t),u.PubSub.publish(d.productType+".failedToLoad",[t]),Qt()&&Ee()})}}function zn(e){e&&e.hasOwnProperty(f.numOfBannersToInitSuccess)&&e.hasOwnProperty(f.numOfBannersToCache)&&z.updateBaseData({cacheConfig:e[f.numOfBannersToInitSuccess]+"/"+e[f.numOfBannersToCache]})}function Xn(e){return!(e.singleInventoryPerSession&&!0===e.singleInventoryPerSession)}function $n(){return!Ot()}function Yn(){return y.purgeAdunitLibsFile}function Zn(e){for(var n=0;n<e.length;n++){var t=e[n].ext.layoutData;if(u.Utils.isDefined(t)&&u.Utils.isDefined(t.html)&&0<t.html.length)return!0}return!1}function et(e){for(var n=!1,t=0;t<e.length;t++)if(p.AdUtils.isPlayablePrecachedAd(e[t])){n=!0;break}return n}function nt(e,n){for(var t=0;t<e.length;t++)p.AdUtils.isPlayablePrecachedAd(e[t])&&(e[t].ext.ableToCache="success"===n)}function tt(e){var n=y.numOfBannersToCache,t=Ze(e).slice(0,n),i=!0;return v.each(t,function(e,n){return!p.AdUtils.isCacheableAd(n)||Re(n)||re.isAdInCache(p.AdUtils.getAdId(n))||re.getAdStatusInQueue(p.AdUtils.getAdId(n))===re.cachingStatus.pending||(i=!1),i}),i}function it(e){var n=re.isPrecache();n&&Xt()?p.AdsAssetsManager.cacheAssetsOfAd(m.getActiveInventory().getCurrentOffer(),J,Jn(y)).then(Je.bind(null,e.inventoryId)):n&&!tt(e.inventoryId)?re.updateCache(H):T&&u.VastUtils.isVastCanPlayAgain(e)&&re.cacheSingleAd(p.AdUtils.formatVastAdForPrecache(e,je.bind(null,e)),H)}function rt(e,n){if(p.log("engageEnd",p.LogLevels.verbose),$.shouldReceiveMessage(J,e))if(e.productType!==f.BN){ot(e);var t=st(Pt());at(Y)?e.engaged?t.handlePrefetchFailedOnVisible(e):t.handlePrefetchFailedOnBackground(e):e.engaged?t.handleAdClosed(e):t.handlePrefetchFailedOnBackground(e),(u.Utils.isFunction(n)?n:function(){})()}else cn(e)}function at(e){p.log("getAndResetErrorStateFromTaskManager",p.LogLevels.verbose);var n=e.getStatus().adErrorState;return e.publish("AdErrorState",[$.extendCallbackParamsWithProductConfig(J,{error:!1})]),n}function ot(e){p.log("_resetPreloadedAd",p.LogLevels.verbose),dn(e),z.resetBaseData(f.baseDataKeys),b.setCanPreloadFlag(!0)}function st(e){return e?dt:ct}var dt={handleCappingOnAdClosed:function(e){p.log("_handleCappingOnAdClosed | ManuelLoad",p.LogLevels.verbose),this.publishNoMoreOffers(f.noMoreOffersReason.noMoreOffersToShowInFeed),Ee(e)},handlePrefetchFailedOnBackground:function(e){p.log("_backgroundPrefetchFailed | ManualLoad",p.LogLevels.verbose),c.getNextAd(!1,e.inventoryId,!0)?it(e):this.publishNoMoreOffers(f.noMoreOffersReason.noMoreOffersToShowInFeed)},handlePrefetchFailedOnVisible:function(e){p.log("handlePrefetchFailedOnVisible | manuel load",p.LogLevels.verbose),it(e)},shouldPerformInternalLoad:function(){var e=d.overrideFeedSettings.isSupportFetchFeedOnAdCloseLogic&&d.overrideFeedSettings.shouldFetchNewFeedOnAdClose;return u.Utils.isDefined(y.shouldFetchNewFeedOnAdClose)?y.shouldFetchNewFeedOnAdClose:e},handleAdClosed:function(e){if(p.log("handleAdClosed | manuel load",p.LogLevels.verbose),qt())this.handleCappingOnAdClosed(e);else{if(Ot())return p.log("handleAdClosed | manuel load | isInAppBiddingInstance=true"),p.AdsAssetsManager.unsetReferencesForAds(m.getOffers(e.inventoryId),J.instanceUniqueId),void m.removeInventory(e.inventoryId);if(this.shouldPerformInternalLoad())return p.AdsAssetsManager.unsetReferencesForAds(m.getOffers(e.inventoryId),J.instanceUniqueId),m.removeInventory(e.inventoryId),void Pe();p.log("handleAdClosed | manuel load | Do not perform internal load."),Bn(),Kn(),m.reset(),u.PubSub.publish(d.productType+".resetStateManager",[J])}},publishNoMoreOffers:function(e){p.log("publishNoMoreOffers | ManualLoad",p.LogLevels.verbose);var n=$.extendCallbackParamsWithDemandConfig(J,{errorMsg:e||f.noMoreOffersReason.noMoreOffersToShowInFeed});u.PubSub.publish(d.productType+".NoMoreOffers",[n])}},ct={handleCappingOnAdClosed:function(e){p.log("_handleCappingOnAdClosed | AutomaticLoad",p.LogLevels.verbose),ne.instanceReachCapping(f.noMoreOffersReason.noMoreOffersToShowInFeed,Ee.bind(null,e))},handlePrefetchFailedOnBackground:function(e){p.log("_backgroundPrefetchFailed | AutomaticLoad",p.LogLevels.verbose),c.getNextAd(!1,e.inventoryId,!0)?this.bringNextAdFromExistingFeed(e):Xn(y)?this.bringNextAdFromNewFeed():this.endSessionOnInstance(e)},handlePrefetchFailedOnVisible:function(e){p.log("handlePrefetchFailedOnVisible | automatic load",p.LogLevels.verbose),it(e)},handleAdClosed:function(e){if(p.log("handleAdClosed | automatic load",p.LogLevels.verbose),qt())return p.AdsAssetsManager.unsetReferencesForAds(m.getOffers(e.inventoryId),J.instanceUniqueId),void this.handleCappingOnAdClosed(e);c.getNextAd(!0,e.inventoryId,!0)?Vt()&&Xn(y)?(p.AdsAssetsManager.unsetReferencesForAds(m.getOffers(e.inventoryId),J.instanceUniqueId),m.removeInventory(e.inventoryId),this.bringNextAdFromNewFeed(Vt())):this.bringNextAdFromExistingFeed(e):Xn(y)?(p.AdsAssetsManager.unsetReferencesForAds(m.getOffers(e.inventoryId),J.instanceUniqueId),m.removeInventory(e.inventoryId),this.bringNextAdFromNewFeed()):this.endSessionOnInstance(e)},bringNextAdFromNewFeed:function(e){p.log("bringNextAdFromNewFeed | AutomaticLoad",p.LogLevels.verbose),Mt(!1);var n=e?f.noMoreOffersReason.refreshFeedAfterClosingAd:f.noMoreOffersReason.noMoreOffersToShowInFeed;Pe(n)},bringNextAdFromExistingFeed:function(e){p.log("bringNextAdFromExistingFeed | AutomaticLoad",p.LogLevels.verbose),p.AdsAssetsManager.unsetReferencesForAds([e],J.instanceUniqueId),it(e),ne.adClosedMovingToNextAd(u.VastUtils.areAllCampaignTypesAreVast(Ze(e.inventoryId)),f.noMoreOffersReason.noMoreOffersToShowInFeed)},endSessionOnInstance:function(e){p.log("endSessionOnInstance | AutomaticLoad",p.LogLevels.verbose),ne.sessionOver(f.noMoreOffersReason.noMoreOffersToShowInFeed,Ee.bind(null,e))}};function lt(e){if($.shouldReceiveMessage(J,e)){var n=p.AdUtils.getAdId(e),t=$e(n,e.inventoryId);p.log("ProductInstance | adVisible | id="+n),Y.publish("Engaged",[$.extendCallbackParamsWithParentProductConfig({duringEngage:!0})]),p.SKAdImpressionService.startImpression(t,Wt,Gt);t.displayMode;if(u.VastUtils.isVastCampaign(t)){var i=u.VastUtils.getVastViewCount(t);z.trackTimingStop(S.adVisible,{vastViewCount:u.VastUtils.getVastViewCountForEvent(i),eNameStart:S.showAdCalled}),p.log("ProductInstance | send event adVisible"),u.VastUtils.isVastCanPlayAgain(t)||ze(n,e.inventoryId)}else z.trackTimingStop(S.adVisible,{eNameStart:S.showAdCalled}),p.log("ProductInstance | send event adVisible"),ze(n,e.inventoryId);oe++,z.trackTimingStart(S.adVisibleToClose),y.extraOffersInEndCard&&p.ExtraOffers.isSupported(p.getConfig().mobileSDKSettings.deviceOs,p.getConfig().mobileSDKSettings.deviceApiLevel,t,y)&&ut()}}function ut(){v.when(It()).then(function(e){var n=p.getCurrentDisplayedAd();return p.ExtraOffers.fetchExtraOffersInventory(e,n.productType,n.cid,n.settings.requestID,n.ext.opportunityID)}).then(function(e){p.postAdUnitEvent(JSON.stringify({name:"extraOffersEndCardData",data:{inventory:e}}))}).fail(function(e){p.postAdUnitEvent(JSON.stringify({name:"cancelExtraOffersEndCard"}));var n=e&&"string"==typeof e?e:"Extra offers flow failed";p.log("onExtraOffersFetchFail | Reason: "+n),z.trackEvent(S.getExtraOffersInventoryFailed,{callfailreason:n})})}function ft(e,n,t){return new(Yt("../../components/precacheManager.js"))(e,n,gt(t))}function gt(e){var n,t=Xt()?f.cacheAdsDirectory:J.productType+"_"+J.demandSourceName;return n=J.productType===f.IS?J.productType:f.BC,o.cacheBase=e?n:t,o.precachePath="../"+o.cacheBase+"/",v.extend(o,J),o}function pt(){var e=p.getSDKDataByKey(f.cacheConfiguration);if(e){var n=e&&e.adLevelCacheTimeout?1e4*e.adLevelCacheTimeout:f.defaultTimeoutForCachingAds;d.precacheConfig.timeoutForCachingAdsInAdLevelCacheFlow=n}}function vt(e){return J[e]}function mt(e,n){e&&e.demandSourceName===l&&It().then(function(e){u.Utils.isFunction(n)&&n({payload:e,eventics:z})})}function bt(e,n,t){if(p.log("in load ad with params: "+JSON.stringify(e),p.LogLevels.verbose),!e||e.demandSourceName!==l){var i=ce.extendEventDataWithElapsedLoadTime(d.productType,l,{});return z.trackEvent(S.loadAdIgnored,{callFailReason:d.errors.general.dsNameNotValid},i),void ce.clearLoadStartTimeForInstance(d.productType,l)}var r=xn();if(r.errMsg){var a=Pt()?S.loadAdFailed:S.initAdFail;i=ce.extendEventDataWithElapsedLoadTime(d.productType,l,{});return z.trackEvent(a,{callFailReason:r.errMsg,demandSourceName:l},i),ce.clearLoadStartTimeForInstance(d.productType,l),void p.callSDKFunction(t,$.extendCallbackParamsWithDemandConfig(J,{errMsg:r.errMsg}))}p.unloadAdViewsByProduct(J),p.log("resetting last response to none",p.LogLevels.verbose),Hn(e,n,t)}function ht(){for(var e=q.getDestination(l),n=[f.gatewayDestinationMap.IS.production,f.gatewayDestinationMap.BN.production,f.gatewayDestinationMap.RV.production],t=0;t<n.length;t++)if(-1!==e.indexOf(n[t]))return!1;return!0}function St(e,n,t){var i=nn(m.getActiveInventoryId());p.RingerSwitchService.isInitiated()&&i&&(p.RingerSwitchService.startListener(yt(i.ext)),p.log("Ringer | startListener from DS.",p.LogLevels.info)),p.isLegacy(p.featureMap.demandState)||Ft(),c.preload(!0,m.getActiveInventoryId()).then(function(){return c.show(Mn())}).then(function(){Ct(n)}).fail(function(e){p.log("Cannot engage at this time "+Y.getStatusMsg(),p.LogLevels.error),Dt(t,e)})}function yt(e){return e?{ringerUpdateDelay:y.ringerUpdateDelay,shouldSetRingerUpdateDelay:p.AdUtils.isPlayableCampaign(e)||p.AdUtils.isMRAIDCampaign(e)||p.AdUtils.isExternalCampaign(e)}:{}}function At(){ne.instanceOnHold()}function Ct(e){z.trackTimingStop(S.showAdSuccess,{eNameStart:S.showAdCalled}),p.callSDKFunction(e,$.extendCallbackParamsWithDemandConfig(J)),Q.onShowSuccess(J)}function Dt(e,n){var t=$.extendCallbackParamsWithDemandConfig(J,{errMsg:n});u.PubSub.publish(d.productType+".failedToShow",[t]);var i=n;i!==f.errors.showAdFailedReasons.preloadNoAd&&i!==f.errors.showAdFailedReasons.showNoAd&&(i=i+". "+Y.getStatusMsg()),z.trackEvent(S.showAdFail,{callFailReason:i}),p.callSDKFunction(e,$.extendCallbackParamsWithDemandConfig(J,{errMsg:n}))}function It(){var e={impressionsCount:oe-1,firstAttemptToGetFeed:ae,retryCounter:s,deliveryPlumbus:_};return te.createPayload(e).then(function(e){return i=e})}function wt(){return e&&e.integrationType}function Pt(){return e&&e.integrationType===f.integrationType.manual}function Tt(){return!Pt()}function Ot(){return e&&e.isInAppBidding}function Ft(){j=new v.Deferred;var n=u.PubSub.subscribe(K+".getDemandSourceStateSuccess",function(e){$.shouldReceiveMessage(J,e)&&(u.PubSub.unsubscribe(n),u.PubSub.unsubscribe(t),"resolved"!==j.state()&&(W=e&&e.state||W,j.resolve(e)))}),t=u.PubSub.subscribe(K+".getDemandSourceStateFail",function(e){$.shouldReceiveMessage(J,e)&&(u.PubSub.unsubscribe(t),u.PubSub.unsubscribe(n),"resolved"!==j.state()&&j.resolve())}),e=$.extendCallbackParamsWithParentProductConfig(J);p.callSDKFunction("getDemandSourceState",e,"getDemandSourceStateSuccess","getDemandSourceStateFail")}function Lt(){return N&&N.confirmCloseMsg[f.confirmCloseMsgMap[0]]}function xt(e,n){var t=p.getContainerCreationHandler(e),i=t.getState();i===t.getCreationStates().createdSuccessfully?(p.log("product instance | containerState | createdSuccessfully ",p.LogLevels.info),n.resolve(e)):i===t.getCreationStates().duringCreation?v.when(t.getCreationResultPromise()).then(function(){p.log("product instance | during creation result: success",p.LogLevels.info),n.resolve(e)}).fail(function(e){n.reject("product instance | "+e)}):n.reject("product instance | did not start to create native webview")}function Nt(e){var n=p.AdUtils.getAdId(e),t=o.precachePath+n+"/";u.AdAssets.updateAdunitPrecachePath(e,t,p.AdUtils.isPlayablePrecachedAd(e))}function Ut(e,n,t){var i=!1;return e&&!n&&(p.AdUtils.isPlayablePrecachedAd(t)?u.AdAssets.isAdAbleToCache(t)&&(i=!0):u.VastUtils.isVastCampaign(t)&&!Re(t)||(i=!0)),i}function Mt(e){se=e}function Vt(){return se}function Et(e,n,t){var i=d.timerLengths.loadAdTimeout;clearTimeout(O),O=setTimeout(function(){On(e,n,t)},i)}function kt(e){!T&&u.VastUtils.isVastCampaign(e)&&(null!==k||u.Utils.isDefined(e.toRemove)&&e.toRemove||fn(e).then(null,Ae.bind(null,e)))}function Bt(e){var n=v.extend({name:"hybridCampaignStatusChange"},e);p.postAdUnitEvent(n,!0)}function Rt(e){Bt({viewUniqueId:e.ext.viewUniqueId,status:e.ext.isHybridFlow?"success":"fail"}),p.HybridService.isHybridCampaign(e,y)&&null!==B&&"pending"===B.state()&&(B.resolve(),z.trackEvent(S.hybridFallback),p.HybridService.clearAppPage(e.ext.viewUniqueId),u.PubSub.publish("HybridService.closeHybridFlow",[{viewUniqueId:e.ext.viewUniqueId}]))}function Kt(r,a,o,s){de.checkStatusOfAdView().then(function(e){var n=nn(s);p.AdUtils.setViewType(r,n,f.viewTypes.externalView);var t=p.AdUtils.updateEventWithAdParams(r,n,{});z.updateBaseData(t),Un(n),o.shouldBuildAdUnitUrlForExternal=!0;var i=g.getAdunitUrl(!1,a,o,p.getDeviceOs());e.isExternalAdViewInitiated?(me(n),de.updateAdInAdView(i,n,a,r)):(Et(n,i,!1),v.extend(r,{adViewId:de.getContainerID()}),de.createAdUrlInAdView(i,n,a,r)),p.addAdToLoadedCreatives(n)})}function jt(){return e.shouldAvoidHandleFrameClose}function Wt(){z.trackEvent(S.startImpressionSuccess)}function Gt(e){z.trackEvent(S.startImpressionFailed,{},{callfailreason:e.errMsg})}function Ht(){z.trackEvent(S.endImpressionSuccess)}function _t(e){z.trackEvent(S.endImpressionFailed,{},{callfailreason:e.errMsg})}function qt(){var e=W===f.demandSourceStates.cappedPerSession;return e&&u.Utils.isDefined(J)&&p.log("isDemandCapped | demandSource "+J.demandSourceName+" is capped"),e}function Jt(){return!!Pt()&&!1===y.isExhaustInstanceAllowed}function Qt(){return d.isExhaustInstanceAllowed&&J.demandType===f.demandSourceType.instance&&!Jt()}function zt(){Ot()&&d&&(d.isExhaustInstanceAllowed=!1)}function Xt(){return p.AdsAssetsManager.isAdLevelCacheEnabled()&&!ht()}var $t={name:l,init:function(){c=this,t||(Bn(),re=ft(u,p,$.isLegacy(J)),le(),p.AdsAssetsManager.isAdLevelCacheEnabled()&&(ue(),pt()),re.init(),Y.init(),p.initEventics($.extendCallbackParamsWithParentProductConfig(J,{})),zt(),t=!0)},isNextAvailable:function(e){if(re.isPrecache()){var n=Ze(e);return re.isNextAvailable(n)||n&&n[0]&&!n[0].isCacheable}return m.isNextOfferAvailable(e)||u.VastUtils.isVastCanPlayAgain(nn(e))},prepareAdToEngageEnd:function(e){return Re(e)?re.deleteCachedCampaign(p.AdUtils.getAdId(e)):u.Utils.returnResolvedPromise()},getNextAd:function(e,n,t){var i=c.isNextAvailable(n);return re.isPrecache()&&!i&&(i=tn(t||e,n)),!i&&kn()&&(i=m.getBackfillOffer(n)),i},attemptToPreloadAd:function(e,n){var t=qt();if(!t||e){var i=Ze(n),r=nn(n),a=vn(u.VastUtils.isVastCampaign(r))||u.VastUtils.areAllCampaignTypesAreVast(i),o=re.isPrecache();ne.preLoadNext(u.VastUtils.areAllCampaignTypesAreVast(i),hn.bind(null,n),u.VastUtils.isVastCampaign(r)),b.canPreloadCandidateAd(t,e,r,a,o,y.displayOnAdReady)&&c.preloadAd(e,n)}else p.log("Skipping preload on capped demand",p.LogLevels.verbose)},preloadAd:function(e,n){c.preload(e,n).then(function(){e&&c.show(Mn())})},preload:function(e,n){var t,i=new v.Deferred;return Y.canPreload()?(t=Mn()||nn(n))||(t=tn(e,n),rn(t,A.softprecache),t)?(v.extend(!0,t,J),p.isContainerLoaded(t)?i.resolve(t):p.MOATService.vastContainsMOATData(t)||p.MOATService.containsMOATData(t)?setTimeout(function(){c.preloadFlow(t,e,i)},0):c.preloadFlow(t,e,i),i.promise()):(p.log("Cannot preload with no offer",p.LogLevels.error),u.Utils.returnRejectedPromise(f.errors.showAdFailedReasons.preloadNoAd)):(p.log("Cannot preload at this time, "+Y.getStatusMsg(),p.LogLevels.error),u.Utils.returnRejectedPromise(f.errors.showAdFailedReasons.taskManagerPreload))},preloadFlow:function(e,n,t){p.log("ProductInstance | preloadFlow"),b.preloadAdFinished();var i,r=!1,a=re.isPrecache(),o={preload:!n};e.displayMode==A.softprecache&&(r=!0),Ut(a,r,e)&&Nt(e),e.isWPAD=ie.shouldDisplayAdOnExternalWebView(e,y,wt()),i=e.isWPAD?(p.AdUtils.setViewType(y,e,f.viewTypes.externalView),x.shouldBuildAdUnitUrlForExternal=!0,2):(p.log("ProductInstance | ad is not WPAD"),p.AdUtils.removeViewTypeFromSetting(y),x.shouldBuildAdUnitUrlForExternal=!1,1),e.displayStrategy=i;var s=p.AdUtils.updateEventWithAdParams(y,e,{});v.extend(s,{displaystrategy:i}),z.updateBaseData(s),Un(e);var d=!r&&a,c=g.getAdunitUrl(d,J,x,p.getDeviceOs());Et(e,c,n),v.extend(y,o),p.AdUtils.setViewType(y,e),!p.HybridService.isHybridCampaign(e,y)||null!==B||n||u.Utils.isDefined(e.toRemove)&&e.toRemove||gn(e),h.shouldShowInStandAloneView(p.getConfig())&&p.AdUtils.extendSettingsWithStandaloneViewSupport(y),e=p.StoreKitService.updateAdWithStoreAppId(e,y),p.loadAdUnitUrl(e,c,J,y),kt(e),e.isWPAD?xt(e,t):t.resolve()},show:function(e){return e?Y.canEngage()?(Pn(),Rt(e),p.displayAdView(e),u.Utils.returnResolvedPromise()):u.Utils.returnRejectedPromise(f.errors.showAdFailedReasons.taskManagerEngage):u.Utils.returnRejectedPromise(f.errors.showAdFailedReasons.showNoAd)},getConfirmCloseMsg:Lt,getDSEventics:ve,adVisible:lt,engageEnd:rt,initProduct:mt,instanceOnHold:At,loadAd:bt,updateEventicsWithAdData:De,showAd:St,onShowAdFailed:Dt,getProperty:vt,getIntegrationType:wt,isInAppBiddingInstance:Ot,loadAdWithAdm:Qn,isDemandCapped:qt,shouldAvoidHandleFrameClose:jt,reset:Rn};return c=$t,$t}e.exports=t},{"../../components/OMIDConstants":42,"../../components/VastService.js":61,"../../components/containers/WPADUtils":74,"../../components/precacheManager.js":79,"../../patches/PatchIOSLoadAfterLoad.js":169,"../../patches/PublisherPatchEasybrain.js":172,"./../../components/MultipleInventories.js":36,"./../../components/sdkPluginType/SDKPluginTypeHandler.js":82,"./../RewardedVideo/availabilityManager.js":139,"./../RewardedVideo/availabilityReporter.js":140,"./../RewardedVideo/dsTaskManager.js":141,"./DemandEntityBuilder.js":111,"./FetchDemand/FetcherPatch.js":115,"./PayloadBuilder.js":116,"./PreloadAdManager":118}],120:[function(e,n,t){n.exports=function(e,n){var t,i=(e=e||{}).retriesLogic||{},r=e.Features||{},a=e.ProductName;return{initiated:!1,overrideFeedSettings:r,productType:a,errors:{init:{missingData:"Failed to get required parameters",multi:"Multiple Init calls not allowed",1001:"Trying to call API while during an un-finished process",1002:"1002",1003:"1003",1004:"Invalid API response",1005:"1005",deviceOsIsNotSupported:"Device OS is not Supported"},load:{noMoreOffers:"Failed to load "+a+" ad",duringLoad:"Load "+a+" is already in progress",duringShow:"Can not Load "+a+" when showing ad",timeout:"API request timeout",invalid:"Invalid API response",instanceExhausted:"Instance already exhausted",inStateVisibleOrInShowingProcess:"in state visible or inShowingProcess",inLoadingStateOrWaitingToLoad:"in state waitingToLoad or internalLoadingProcess",instanceOnHold:"Instance on Hold"},show:{isConnected:"no internet connection",duringEngage:"already engaged with an offer",notLoaded:"ad was not loaded, try to load before calling to show",duringLoad:a+" load is in progress",visible:a+" is already showing",tryingToEngage:a+" is in showing process",instanceExhausted:"Can not show - Instance already exhausted"},vast:{noOffers:"empty"},general:{dsNotSet:"trying to call demandSource function, but demandSource object is not set",dsNameNotValid:"demand source name is not valid"}},displayMode:{nonprecache:"nonprecache",precache:"precache",softprecache:"softprecache"},libsCacheFiles:{dapi:"dapi",externalObfuscation:"externalObfuscation"},responseTypesWithReason:{none:0,ready:1,notReady:2},precacheConfig:{maxCachedCampaigns:10,nonPrecacheFallback:3e5,cacheBase:null,precachePath:null,timeoutForCachingAdsInAdLevelCacheFlow:3e4},timeUnit:6e4,timerLengths:{initAttemptsDelay:i.initAttemptsDelay||500,serverResponseTimeoutInMilis:i.serverResponseTimeoutInMilis,riDelay:12e4,loadAdTimeout:16e3},customDialog:4,filterDisableTypes:[],maxNumOfAttemptsToCallAPI:i.maxNumOfAttemptsToCallAPI||2,eventicsCategories:n,isExhaustInstanceAllowed:(t=r,void 0===t.isExhaustInstanceAllowed||t.isExhaustInstanceAllowed),shouldDisplayOnAdReady:!!r.displayOnAdReady,forcePreload:e.forcePreload}}},{}],121:[function(t,e,n){e.exports=function(e){var n={prod:t("./EnvironmentProduction"),staging:t("./EnvironmentStaging")};return n[e.environment]?new n[e.environment](e,t("./constants")):new n.staging(e,t("./constants"))}},{"./EnvironmentProduction":122,"./EnvironmentStaging":123,"./constants":124}],122:[function(e,n,t){n.exports=function(e,n){var t,i,r=n.fileExtension,a=n.controllerFolder,o=n.cacheRootFolder,s=n.jQueryFileName,d=e.controllerVersion,c=e.schema,l=e.cdnDomain,u=e.scdnDomain,f=e.environment,g=o[e.deviceOs],p=e.cdnService,v=e.domain;function m(){return c+"//"+l+"/mobileSDKController"}function b(){return g}return{getControllerHost:m,getControllerJsUrl:function(){return m()+"/versions/"+d+"/sdk_controller"+r+".js"},getJQueryUrls:function(){return[c+"//code.jquery.com/"+s,c+"//"+l+"/libs/"+s]},getConfig:function(){return{controllerVersion:d,schema:c,cdnDomain:l,environment:f,cacheRootFolder:g,serviceCdn:p,domain:v}},getCacheControllerJsUrl:function(){return b()+"/"+a+d+"/sdk_controller"+r+".js"},getCacheJQueryPath:function(){return b()+"/assets/"+s},getAppConfigDomain:function(){return c+"//"+p},getMicroJobUrl:function(){return c+"//"+l+"/users/microjob/sdkconfig.json"},getUrlToCdnAdUnit:function(){return t.decideUrlProtocolAccordingToHTTPSCompliance()+"//"+u},setController:function(e){t=e},getStaticGlobalsUrl:function(e){return c+"//"+u+"/adunit/dist/versions/"+e+"/prod/"},getAssetsJsonUrl:function(){return c+"//"+u+"/adunit/dist/adunitAssets.json"},getAppConfigUrl:function(){return c+"//"+p+"/delivery/mobile/adUnit/getAppConfig.php"},setBaseServerUrlForOfferwall:function(e){i=e},getBaseServerUrlForOfferwall:function(){return i?c+"//"+i:""},getCacheRootFolder:b,getExternalLibrariesUrl:function(){return m()+"/libs/"},getCacheLibsPath:function(){return b()+"/libs/"}}}},{}],123:[function(e,n,t){n.exports=function(e,n){n.fileExtension;var t=n.controllerFolder,i=n.cacheRootFolder,r=n.jQueryFileName,a=e.controllerVersion,o=e.schema,s=e.cdnDomain,d=(e.scdnDomain,e.environment),c=e.stagingCdnDomain,l=i[e.deviceOs],u=e.cdnService,f=e.domain;function g(){var e=c.split(".")[0];return o+"//"+c+"/users/staging/"+e}function p(){return l}return{getControllerHost:g,getControllerJsUrl:function(){return g()+"/controller/"+a+"/sdk_controller.js"},getJQueryUrls:function(){return[o+"//code.jquery.com/"+r,o+"//"+s+"/libs/"+r]},getConfig:function(){return{controllerVersion:a,schema:o,cdnDomain:s,environment:d,cacheRootFolder:l,stagingCdnDomain:c,domain:f}},getCacheControllerJsUrl:function(){return e=a,p()+"/"+t+e+"/sdk_controller.js";var e},getCacheJQueryPath:function(){return p()+"/assets/"+r},getAppConfigDomain:function(){return o+"//"+u},getMicroJobUrl:function(){return o+"//"+s+"/users/microjob/sdkconfig_staging.json"},getUrlToCdnAdUnit:function(){var e=c.split(".")[0];return o+"//"+c+"/users/staging/"+e},setController:function(e){},getStaticGlobalsUrl:function(e){var n=c.split(".")[0];return o+"//"+c+"/users/staging/"+n+"/adunit/dist/versions/"+e+"/stage/"},getAssetsJsonUrl:function(){var e=c.split(".")[0];return o+"//"+c+"/users/staging/"+e+"/adunit/dist/adunitAssets.json"},getAppConfigUrl:function(){return o+"//"+u+"/delivery/mobile/adUnit/getAppConfig.php"},setBaseServerUrlForOfferwall:function(e){},getBaseServerUrlForOfferwall:function(){return""},getCacheRootFolder:p,getExternalLibrariesUrl:function(){return g()+"/common/libs/"},getCacheLibsPath:function(){return p()+"/libs/"}}}},{}],124:[function(e,n,t){n.exports={fileExtension:".min.gz",controllerFolder:"controller_",cacheRootFolder:{ios:"../SSAPublisher",android:"../supersonicads"},jQueryFileName:"jquery-1.9.1.min.js"}},{}],125:[function(An,e,n){function t(d,c){"use strict";var t=An("../components/Constants.js"),l=An("./DemandSource/EventCategories.js")(t.IS),r,i=!1,a,e=c.MRAID,u=c.adUnitUrl,f,g="Interstitial",n="NativeCallback",o="TaskManager",s="PrecacheManager",p={videoIS:"videoInterstitial",imageIS:"imageInterstitial"},v=2,m={productType:g,maxCachedCampaigns:10,cacheBase:null,precachePath:null,nonPrecacheFallback:5*t.timeunit},b={productType:g},h={init:{missingData:"Failed to get required parameters",multi:"Multiple Init calls not allowed",invalid:"Invalid API response",timeout:"API request timeout"},load:{isConnected:"no internet connection",duringEngage:"already engaged with an offer",adState:{0:"not initiated yet",1:"not ready yet",5:"error loading ad"}},show:{isConnected:"no internet connection",duringEngage:"already engaged with an offer",available:"ad not available"}},S={1e3:"Ad not available",1001:"Not initiated yet",1002:"Multiple Init calls not allowed",1003:"Failed to get required parameters or they are invalid",1004:"Invalid API response",1005:"API request timeout",1006:"Already engaged with an offer",1007:"Not ready yet",1008:"Not ready",1009:"No internet connection",1010:"Failed to pre-load creative assets",1011:"Failed to load interstitial ad",1012:"Already engaged with another offer",1013:"Failed to init interstitial",1014:"Failed to load interstitial ad",1015:"Failed to show interstitial ad",1020:"Ad state error",1021:"Trying to call API while during an un-finished process",1022:"Failed on get inventory",1023:"No offers on prepare ad unit assets",1024:"Failed updating ad unit assets",1025:"No more offers",1026:"Cannot load at this time"},y={initISSuccess:null,initISFailure:null,loadISSuccess:null,loadISFailure:null,showISSuccess:null,showISFailure:null},A={none:0,ready:1,noOffers:2,noOffersRI:3},C={initial:0,notready:1,initiated:2,pending:3,loaded:4,error:5,opened:6},D=null,I=6e4,w={initAttemptsDelay:1e4,apiResponseTimeout:1e4,loader:5e3,riDelay:2*I,loadedState:30*I,p:5e3,np:12e3,buffer:2*I},P={},T="",O={},F={},L=!1,x=!1,N=!0,U=[],M=0,V=0,E="about:blank",k=C.initial,B=A.none,R,K=null,j=null,W=!1,G=!1,H,_=null,q=null,J=null,Q=null,z=null,X={seatbid:{}},$,Y,Z=1,ee=c.Cache,ne=c.adUnitGlobals,te=(ie=!1,re=!1,ae=!1,oe=!1,se=!1,de=!0,{init:function(){ie||(d.PubSub.subscribe(o+".Engaged",function(e){d.Utils.isDefined(e.duringEngage)&&(d.Utils.isDefined(e.productType)&&e.productType!==g?ae=e.duringEngage:re=e.duringEngage),c.log("line[191]: IS engaged "+re+", other engaged: "+ae,c.LogLevels.verbose)}),d.PubSub.subscribe(o+".CacheUpdateStatus",function(e){d.Utils.isDefined(e.duringCacheUpdate)&&d.Utils.isDefined(e.productType)&&e.productType===g&&(oe=e.duringCacheUpdate)}),d.PubSub.subscribe(o+".AdStatusChange",function(e){d.Utils.isDefined(e.state)&&d.Utils.isDefined(e.productType)&&e.productType===g&&(c.log("Ad state changed from "+k+" to "+e.state,c.LogLevels.verbose),k=e.state)}),d.PubSub.subscribe(n+".enterBackground",function(){se=!0}),d.PubSub.subscribe(n+".enterForeground",function(){se=!1}),d.PubSub.subscribe(n+".viewableChange",function(e){}),d.PubSub.subscribe(n+".deviceStatusChanged",function(e){d.Utils.isDefined(e.connectionType)&&(de="none"!==e.connectionType&&"notReachable"!==e.connectionType)}),ie=!0)},canLoad:function(){return(k===C.error||k===C.initiated)&&!re&&de},canEngage:function(){return!re&&!c.getCurrentDisplayedAd()&&de},canForceEngage:function(){return!re&&!c.getCurrentDisplayedAd()&&de},canInitCallToApi:function(){return W?!oe&&de:!(re&&c.getCurrentDisplayedAdType()===g)&&!se&&!oe&&de},setConnection:function(e){de=e},getStatusMsg:function(){return"duringEngage:"+re+" duringCacheUpdate:"+oe+" appInBackground:"+se+" isConnected:"+de+" ad state:"+k},getStatus:function(){return{duringEngage:re,duringCacheUpdate:oe,appInBackground:se,isConnected:de,adState:k}},publish:function(e,n){return d.PubSub.publish(o+"."+e,n)},subscribe:function(e,n){return d.PubSub.subscribe(o+"."+e,n)},unsubscribe:function(e){return d.PubSub.unsubscribe(e)}}),ie,re,ae,oe,se,de,ce=function(e){c.log("on creative opened",3),Y.trackTimingStart(l.adVisibleToClose),Y.trackEvent(l.adVisible),te.publish("AdStatusChange",[{state:C.opened,productType:g}]),x=!0,We(e),Ge(e)},le=function(){var e=je();return e&&(c.log("pre load on get config is: "+F.preload,3),e.settings=e.settings||{},e.settings.preload=F.preload),e},ue=function(e){var n,t=c.getApiData({scdn:1,protocol:0,defaultProtocol:1}),i=c.decideUrlProtocolAccordingToHTTPSCompliance(),r=t.scdn;return n="prod"!==c.getEnv()?c.api()+"/users/staging/"+SuperSonicGlobalConfig.mobileSDKSettings.env:i+"//"+r,a.extend(!0,e,{settings:{protocol:i,urltocdn:n,precache:f.isPrecache()}})};function fe(e,n,t){var i=an();return y.initISSuccess=n,y.initISFailure=t,c.initEventics(b),Y.trackEvent(l.initAd),i.allowed?k===C.pending||k===C.loaded?(Ze(),void d.PubSub.publish(g+".CacheReady",[{productType:g,numOfAdUnits:U.length}])):(B=A.none,c.log("IS - resetting last response to none",c.LogLevels.verbose),void r.initInterstitial(e).then(Ze,$e)):(Ye(),void $e(i.errMsg))}function ge(e,n,t){y.loadISSuccess=n,y.loadISFailure=t,r.loadInterstitial(e).then(nn,en)}function pe(e,n,t){me(e,n,t)}var ve=function(){d.PubSub.subscribe(s+".cacheUpdatedCallback",function(e){if(!e||e.productType===g){c.log("IS |  cacheUpdatedCallback "+JSON.stringify(e),c.LogLevels.verbose);var n=U.length,t=f.getCacheSizeByType(g),i=F.numOfBannersToInitSuccess<=n?F.numOfBannersToInitSuccess:n,r=f.areCampaignsAvailable(U,i);0===t?Le("Cache updated with zero campaigns"):L&&r&&Ne()}}),d.PubSub.subscribe(s+".campaignSavedCallback",function(e){if(!e||e.productType===g){c.log("IS campaignSavedCallback "+JSON.stringify(e),c.LogLevels.verbose);var n,t=-1,i={};d.Utils.isDefined(e.id)&&(n=Ke(e.id),t=d.Utils.isDefined(n.inventoryIndex)?n.inventoryIndex:-1,i=c.AdUtils.updateEventWithAdParams(F,n,{})),a.extend(i,{eNameStart:{name:l.campaignSavedCache.name+""},inventoryIndex:t}),Y.trackTimingStop(l.campaignSavedCache,i)}}),d.PubSub.subscribe(s+".campaignDownloadStartedCallback",function(e){if(!e||e.productType===g){var n=a.extend({},l.campaignSavedCache);n.name=n.name+(e.id||""),Y.trackTimingStart(n)}}),d.PubSub.subscribe(s+".campaignDeletedCallback",function(e){if(!e||e.productType===g){var n={};if(d.Utils.isDefined(e.id)){var t=Ke(e.id);n=c.AdUtils.updateEventWithAdParams(F,t,{})}c.log("IS campaignDeletedCallback "+JSON.stringify(e),c.LogLevels.verbose),Y.trackEvent(l.campaignDeletedCache,n)}}),d.PubSub.subscribe(s+".cacheAdsSuccessCallback",function(e){e&&e.productType!==g||c.log("IS cacheAdsSuccessCallback "+JSON.stringify(e),c.LogLevels.verbose)}),d.PubSub.subscribe(s+".cacheAdsFailedCallback",function(e){if(!e||e.productType===g){c.log("IS cacheAdsFailedCallback "+JSON.stringify(e),c.LogLevels.verbose);for(var n=e.deletedOffers.length,t=e.deletedOffers,i=0;i<n;i++){var r=Ke(t[i]),a=c.AdUtils.updateEventWithAdParams(F,r,{});Y.trackEvent(l.campaignFailedToCache,a),Ge(t[i])}var o=U.length,s=F.numOfBannersToInitSuccess<=o?F.numOfBannersToInitSuccess:o,d=f.areCampaignsAvailable(U,s);L&&d?Ne():Le(e.errorLog)}}),d.PubSub.subscribe("SDKController.AdVideoEnded",function(e){e.productType===g&&c.log("Got AdVideoEnded in IS",c.LogLevels.info)}),d.PubSub.subscribe("SDKController.engageEnd",function(e,n){e.productType===g&&(ze(),d.Utils.isFunction(n)&&n.call())}),d.PubSub.subscribe(g+".GetConfig",function(e){if(e.productType===g){var n=le();n&&ue(n),e.callback&&e.callback.call(null,n),clearTimeout(H),k!==C.error&&d.Utils.isDefined(e.errMsg)&&qe(e)}}),d.PubSub.subscribe("SDKController.AdLoaded",function(e){e.productType===g&&k!==C.error&&k!==C.loaded?_e(e):c.log("Controller | IS | try to load when error or already loaded. adState: "+k,c.LogLevels.info)}),d.PubSub.subscribe("SDKController.AdError",function(e){e.productType===g&&(clearTimeout(H),d.Utils.isDefined(e.errMsg)&&qe(e))}),d.PubSub.subscribe("SDKController.AdPlaying",function(e){}),d.PubSub.subscribe("SDKController.AdPaused",function(e){}),d.PubSub.subscribe("SDKController.AdStarted",function(e){e.productType===g&&c.log("Got AdStarted in IS",c.LogLevels.info)}),d.PubSub.subscribe("SDKController.AdClicked",function(e){e.productType===g&&c.callSDKFunction("adClicked",{productType:g})}),d.PubSub.subscribe("SDKController.AdVisible",function(e){be(e)}),d.PubSub.subscribe("SDKController.onAdWindowsClosed",function(e){e.productType!==g&&k===C.error&&He()}),te.subscribe("AdStatusChange",function(e){e.productType===g&&Xe(e)}),d.PubSub.subscribe("SDKController.Analytics",function(e){if(e.productType===g&&e&&e.action){var n=e.action,t=e.eventParam;"fireEvent"===n?Y.trackEvent(t.eName,t.label,t.data):"startTiming"===n?Y.trackTimingStart(t.eName,t.data):"stopTiming"===n?Y.trackTimingStop(t.eName,t.data):"setCustomData"===n&&Y.updateBaseData(t.data)}}),d.PubSub.subscribe(n+".initInterstitial",function(e,n,t){}),d.PubSub.subscribe(n+".loadInterstitial",function(e,n,t){}),d.PubSub.subscribe(n+".showInterstitial",function(e,n,t){}),d.PubSub.subscribe(n+".forceShowInterstitial",function(e,n,t){me(e,n,t)}),d.PubSub.subscribe(g+".ActionClick",function(e){c.OpenURLService.open(e)||c.log(g+" failed to perform ActionClick",c.LogLevels.info)})};function me(e,n,t){y.showISSuccess=n,y.showISFailure=t,r.showInterstitial(e).then(rn,tn)}var be=function(e){e.productType!==g?(te.publish("Engaged",[{duringEngage:!0,productType:e.productType}]),k!==C.pending&&k!==C.loaded||c.log("line[456]: IS on engage with another offer",c.LogLevels.verbose)):(k===C.loaded&&(e?(c.log("creative open from ad visible",c.LogLevels.verbose),ce(e.crid)):c.log("opened with no current ad",c.LogLevels.error)),Z++)},he=function(e){var n="Cannot load Interstitial ad: ";return e.isConnected||(n+=h.load.isConnected),e.duringEngage?n+=h.load.duringEngage:d.Utils.isDefined(h.load.adState[e.adState])&&(n+=h.load.adState[e.adState]),n},Se=function(e){var n="Cannot engage interstitial ad: ";return D||(n+=h.show.available),e.isConnected||(n+=h.show.isConnected),e.duringEngage?n+=h.show.duringEngage:c.getCurrentDisplayedAd()&&(n+=S[1012]),n},ye=function(){var e=te.canInitCallToApi();return c.log("can init again?"+e+te.getStatusMsg(),c.LogLevels.info),e?(Le(),Ae(F.refreshInterval),c.log("Resetting last response to no offers RI",c.LogLevels.verbose),B=A.noOffersRI,r.initInterstitial()):j=setTimeout(function(){ye()},w.riDelay),e},Ae=function(e){c.log("setting refresh interval to: "+e,c.LogLevels.info),K&&clearInterval(K),0!==e&&(K=setInterval(function(){ye()||clearInterval(K)},e*I))},Ce=function(e){var n=e.ext||{};a.extend(n,c.getApplicationExternalConfig().getABTestConfiguration("Interstitial",n.landingId)),K&&clearInterval(K),d.Utils.isDefined(n.refreshinterval)&&0!==n.refreshinterval&&Ae(n.refreshinterval),n.numOfBannersToCache=1,n.numOfBannersToInitSuccess=1,F=n},De=function(e){return!q||"pending"!==q.state()&&"resolved"!==q.state()?q=f.decidePrecacheStatus(e).then(function(){return L=!1,0<e.numOfCampaigns?ne.updateAdUnitGlobals(f.isPrecache()):(U=[],d.Utils.returnRejectedPromise("We did not receive any campaigns in inventory",1023))}).then(f.handleCacheClear).then(function(){return L=!0,d.Utils.returnResolvedPromise()},function(e){return xe(),d.Utils.returnRejectedPromise(e,1024)}):q},Ie=function(e,n){var t,i=[];for(t=0;t<e.length;t++)f.isAdInCache(c.AdUtils.getAdId(n[t]))||i.push(n[t]);return i},we=function(e){var n={};return n.id=c.AdUtils.getAdId(e),n.bannerID=c.AdUtils.getBannerId(e),n.creativeId=c.AdUtils.getCreativeId(e),n.title="",n.staticContent=d.AdAssets.extractStaticFiles(e),n.lastUpdateTime=d.Utils.isDefined(e.lastUpdateTime)?e.lastUpdateTime:0,n},Pe=function(e){var n=[];return a.each(e,function(){n.push(we(this))}),n},Te=function(e){a.each(e,function(e,n){n.inventoryIndex=e,f.isPrecache()&&f.setAdInventoryIndex(c.AdUtils.getAdId(n),e)})},Oe=function(e){var t=[];return a.each(e,function(e,n){n.ext&&n.ext.appData&&n.ext.appData.adAssets&&(n.ext.appData.appImages=n.ext.appData.adAssets,delete n.ext.appData.adAssets),t.push(n)}),t},Fe=function(t){var i,e,r=f.isPrecache(),a=t.length;t=Oe(t),Te(t),i=Pe(t);var n=function(){if(0!==a)if(U=t.slice(0),r){if(f.areCampaignsAvailable(i,F.numOfBannersToInitSuccess))return Y.trackEvent(l.campaignsAvailableFromCache),void Ne();var e=Ie(t,i),n={cacheTimeoutSuccessCallback:function(){Fe(t)},cacheTimeoutFailCallback:Le,applicationUserId:O.applicationUserId,applicationKey:O.applicationKey,newAdsToEnterCache:e};f.handleCacheAds(n)}else Ne();else Le()};r&&(e=f.mergeCampaigns(i),c.log("IS | updateCurrentAds after merge "+JSON.stringify(e),c.LogLevels.verbose)),!r||F.purgeCacheOnInit?(c.log("already purged cache so go strait to adding the new ads",c.LogLevels.verbose),n()):f.clearCacheByType(e).always(n)},Le=function(){te.publish("AdStatusChange",[{state:C.notready,productType:g}]),Q&&Q.reject("load Intertitial failed",1025),Ue(!1)};function xe(){k!==C.initial&&te.publish("AdStatusChange",[{state:C.error,productType:g}]),Ue(!1)}var Ne=function(){(B===A.none||B===A.noOffers||B===A.noOffersRI||W)&&(te.publish("AdStatusChange",[{state:C.initiated,productType:g}]),W||(d.PubSub.publish(g+".CacheReady",[{productType:g,numOfAdUnits:U.length}]),B=A.ready),G?r.loadInterstitial():gn())},Ue=function(e){"boolean"==typeof e?D!==e&&(D=e,c.log("available: "+e,c.LogLevels.verbose),c.callSDKFunction("interstitialAvailability",{available:e})):c.log("IS available param is not a boolean",c.LogLevels.error)},Me=function(e){var n=null;return d.Utils.isDefined(e)&&(d.Utils.isDefined(e.applicationUserId)&&""!==e.applicationUserId?n=e.applicationUserId:d.Utils.isDefined(e["deviceIds[IFA]"])&&""!==e["deviceIds[IFA]"]?n=e["deviceIds[IFA]"]:d.Utils.isDefined(e["deviceIds[IDFV]"])&&""!==e["deviceIds[IDFV]"]?n=e["deviceIds[IDFV]"]:d.Utils.isDefined(e["deviceIds[AID]"])&&""!==e["deviceIds[AID]"]&&(n=e["deviceIds[AID]"])),n};function Ve(){if(te.canInitCallToApi())return d.Utils.returnResolvedPromise();var e="trying to call API while during an un-finished process";return c.log(e+te.getStatusMsg(),c.LogLevels.error),d.Utils.returnRejectedPromise(e,1021)}function Ee(e){var n=new a.Deferred;return(O=e).impressionsCount=Z-1,c.shouldExtendApiDataWithDebugData()?c.extendApiDataWithDebugParams(O).then(function(e){n.resolve(e)}):n.resolve(O),n.promise()}function ke(e,n){q=null,(_=e.seatbid.bid||e.seatbid[0]&&e.seatbid[0].bid)&&1<_.length&&(_=[_[0]]);var t=e.seatbid.ext||e.seatbid[0]&&e.seatbid[0].ext;if(Y.updateBaseData({landingId:t.landingId,strategyId:t.strategyId}),G){var i=De({numOfCampaigns:_.length,settings:F});return i.then(Fe.bind(null,_)),i}return d.Utils.returnResolvedPromise()}var Be=function(){var t=new a.Deferred;return V++,d.Utils.decodeValues(O),$.getInventory(O).then(function(e){t.resolve(e)},function(e){var n;e&&(n=e.errorMessage),n&&-1!==n.indexOf("timeout")&&V<3?setTimeout(function(){Be().then(function(e){t.resolve(e)},t.reject)},w.initAttemptsDelay):t.reject(n,1022)}).always(function(){te.setConnection(!0)}),t.promise()},Re=function(){V=0;var t=Me(O);return Be().then(function(e){Ce(e.seatbid.ext?e.seatbid:e.seatbid[0]);var n=e.seatbid.bid||e.seatbid[0].bid;return n&&1<n.length&&(n=[n[0]]),c.CampaignsFilter.filterByAppInstalled(n,F).then(function(){return d.Utils.returnResolvedPromise(e,t)})}).then(ke)},Ke=function(e){var n,t=null,i=U.length;for(n=0;n<i;n++)if(c.AdUtils.getAdId(U[n])==e){t=U[n];break}return t||c.log("Error in getCreativeById, id "+e+" not found in "+JSON.stringify(U),1),t},je=function(){return U&&0<U.length?a.extend(!0,U[M],c.getFormattedDeviceData()):null},We=function(){return!0},Ge=function(e){var n,t=U.length;if(c.log("removing current creative",c.LogLevels.verbose),F.preload)for(n=0;n<t;n++)if(c.AdUtils.getAdId(U[n])==e){U.splice(n,1);break}He()},He=function(){c.log("self initiating call to API",c.LogLevels.verbose),Ue(!1),r.initInterstitial(R,!0).then(null,function(e){return xe(),d.Utils.returnRejectedPromise(e)})},_e=function(e){clearTimeout(H),d.Utils.isDefined(e.errMsg)?qe(e):(te.publish("AdStatusChange",[{state:C.loaded,productType:g}]),c.onAdLoaded(je()),d.Utils.isDefined(e.enableBackButton)&&c.setBackButtonState(e.enableBackButton))},qe=function(e){var n="Ad loaded with error: "+e.errMsg;Y.trackEvent(l.adLoadedError,{generalMessage:e.errMsg}),Qe(e,n)},Je=function(e){Qe(e,"Timeout in loading ad")};function Qe(e,n){var t=e.crid;te.publish("AdStatusChange",[{state:C.error,errMsg:n,productType:g}]),c.log(n,c.LogLevels.error),We(t),Ge(t),e.productType=g,c.removeAdUnit(e)}var ze=function(){te.publish("Engaged",[{duringEngage:!1,productType:g}]),Y.unsetParamFromBaseData("landingId"),G&&r.loadInterstitial()},Xe=function(e){e&&e.state&&(e.state===C.error?(clearTimeout(H),h.load.adState[C.error]=e.errMsg,Q&&Q.reject(e.errMsg,1020),Ue(!1)):e.state===C.loaded&&Q&&Q.resolve())};function $e(e){e=e||S[1013],Y.trackEvent(l.initAdFail,{callFailReason:e}),c.callSDKFunction(y.initISFailure,{errMsg:e})}function Ye(){!c.isLegacy(c.featureMap.loadIS)&&c.isSupportedOsVersion(g)||(k=k.error)}function Ze(){N=!1,c.callSDKFunction(y.initISSuccess)}function en(e){e=e||S[1014],c.callSDKFunction(y.loadISFailure,{errMsg:e})}function nn(){c.callSDKFunction(y.loadISSuccess)}function tn(e){e=e||S[1015],Y.trackEvent(l.showAdFail,{callFailReason:e}),c.callSDKFunction(y.showISFailure,{errMsg:e})}function rn(){c.callSDKFunction(y.showISSuccess),Y.trackEvent(l.showAdSuccess)}function an(){var e={allowed:!0};return c.isLegacy(c.featureMap.loadIS)?(e.allowed=!1,e.errMsg="SDK version "+c.getApiData({SDKVersion:1}).SDKVersion+" is not supported"):c.isSupportedOsVersion(g)?N?c.isLimitedDeviceModel()&&(e.errMsg="Device is not supported",e.allowed=!1):(e.allowed=!1,e.errMsg=h.init.multi):(e.allowed=!1,e.errMsg="Operating system version "+c.getApiData({deviceOSVersion:1}).deviceOSVersion+" is not supported"),e}function on(){return j&&(clearTimeout(j),j=null),d.Utils.returnResolvedPromise()}function sn(){return Ve().then(c.getAPIRequiredData).then(Ee).then(Re).then(function(){_&&0<_.length?te.publish("AdStatusChange",[{state:C.initiated,productType:g}]):Le()})}function dn(e,n){if(J&&"pending"===J.state())return J;W=n;var t=c.getApplicationInfo(b,e).then(on);return J=t,(G||n)&&(J=t.then(sn)),J}function cn(e){var n=c.getApiData({deviceOs:1}).deviceOs;F.standaloneView=e.type===p.imageIS&&e.templateid==v&&n===t.deviceOs.ios,F.translucentView=e.type===p.imageIS&&e.templateid==v&&n===t.deviceOs.android}function ln(){return k===C.initial&&!G&&J&&"resolved"===J.state()?sn():k===C.error?d.Utils.returnRejectedPromise(null,1020):d.Utils.returnResolvedPromise()}function un(){return Y.trackEvent(l.loadIS),Y.trackTimingStart(l.loadAdToAdReady),Y.trackTimingStart(l.loadAdToShowAd),ln().then(r.load).then(Ue.bind(null,!0)).then(function(){Y.trackTimingStop(l.loadAdSuccess,{eNameStart:l.loadAdToAdReady})},function(e,n){n=n||"1014",Y.trackTimingStop(l.loadAdFailed,{eNameStart:l.loadAdToAdReady,callFailReason:S[n]}),d.Utils.returnRejectedPromise(e)}).always(function(){Q=null})}function fn(){var e,n;return Q&&"pending"===Q.state()?Q.promise():(Q||(Q=new a.Deferred),k===C.loaded||D?Q.resolve():te.canLoad()?(J&&"rejected"===J.state()&&He(),a.when(J).then(function(){return c.CampaignsFilter.filterByAppInstalled(_,F).then(function(){return 0<_.length?d.Utils.returnResolvedPromise(_):(Le(),d.Utils.returnRejectedPromise(he(te.getStatus()),1025))})}).then(function(){a.extend(F,{preload:!0}),te.publish("AdStatusChange",[{state:C.pending,productType:g}])}).then(function(){return G?(gn(),d.Utils.returnResolvedPromise(_)):De({numOfCampaigns:_.length,settings:F}).then(function(){return Fe(_),d.Utils.returnResolvedPromise(_)})}.bind(null,_)).then(null,Q.reject)):(n=te.getStatus(),e=he(n),c.log(e,c.LogLevels.error),G&&((k!==C.initial||J&&"pending"===J.state())&&k!==C.notready||(Y.trackEvent(l.initBeforeLoad),He())),Q.reject(e,1026)),Q.promise())}function gn(){var e,n,t=f.isPrecache();if(e=je()){var i=Ke(c.AdUtils.getAdId(e)),r=c.AdUtils.updateEventWithAdParams(F,i,{});if(Y.updateBaseData(r),t){var a=c.AdUtils.getAdId(e),o=m.precachePath+a+"/";e=d.AdAssets.updateAdunitPrecachePath(e,o)}E=u.getAdunitUrl(t,b),cn(e.ext);var s=w.np;clearTimeout(H),H=setTimeout(function(){Je(e)},s),e.isWPAD=!1,c.loadAdUnitUrl(e,E,b,F)}else n="No available creative in load attempt",c.log(n,c.LogLevels.error),te.publish("AdStatusChange",[{state:C.notready,productType:g}]),Q.reject(n)}function pn(){return r.show().always(function(){z=null})}function vn(){var e;if(z&&"pending"===z.state())return z.promise();if(z||(z=new a.Deferred),c.log(te.getStatusMsg(),c.LogLevels.verbose),!te.canEngage())return e=Se(te.getStatus()),z.reject(e),z.promise();Y.trackTimingStop(l.showAd,{eNameStart:l.loadAdToShowAd});var n=je();te.publish("Engaged",[{duringEngage:!0,productType:g}]);return n.isWPAD=!1,c.loadAdUnitUrl(n,E,b,{preload:!1}),c.displayAdView(n),z.resolve(),z.promise()}var mn=function(){var e=c.getProtocol();P={dev:e+t.gatewayDestinationMap.IS.production,stage:e+t.gatewayDestinationMap.IS.production,prod:e+t.gatewayDestinationMap.IS.production}},bn=function(e){return P[e]||P.prod};function hn(){m.cacheBase=b.productType,m.precachePath="../"+m.cacheBase+"/",a.extend(m,b)}function Sn(){return m}var yn={init:function(){r=this,a=c.jQuery(),mn();var e=bn(c.getEnv());if(f=new(An("../components/precacheManager.js"))(d,c,Sn()),$=new(An("../components/FetcherService.js"))(e,X,w.apiResponseTimeout),!i){U=[];var n={productChance:(c.getEnv(),1),baseData:{productType:g}};Y=d.Eventics.createEventic(n,c.EventsManager),hn(),te.init(),ve(),f.init(),T=ne.getStaticGlobalsUrl(),G=c.isLegacy(c.featureMap.selfLoadingIS),i=!0}},getCurrentAd:function(){return a.extend(je(),{type:g})},isNextAvailable:function(){return!1},initInterstitial:dn,loadInterstitial:un,showInterstitial:pn,load:fn,show:vn,initProduct:fe,loadProduct:ge,showProduct:pe,className:g};return yn}e.exports=t},{"../components/Constants.js":12,"../components/FetcherService.js":21,"../components/precacheManager.js":79,"./DemandSource/EventCategories.js":112}],126:[function(e,n,t){n.exports=function(e,n,t){var i=n.shouldFetchNewFeedOnAdCloseFlag(t.IS);return i=void 0===i||i,{NativeAPI:e.NativeAPI,ControllerCallbacks:e.ControllerCallbacks,AdUnitCallbacks:e.AdUnitCallbacks,ControllerNativeAPI:e.NativeAPI,retriesLogic:e.retriesLogic,DemandName:"InterstitialDS",ProductName:t.IS,Features:{allowMultiInitCalls:!0,reportOnAdunitReady:!0,shouldFetchNewFeedOnAdClose:i,isSupportFetchFeedOnAdCloseLogic:!0,preFetchAllVasts:!0,allowConsecutiveGatewayRequestsDuringLoad:!0,isExhaustInstanceAllowed:!0},gatewayDestinationMap:{prod:t.gatewayDestinationMap.IS.production},amountOfInventories:1,lwsSupported:!1}}},{}],127:[function(a,e,n){e.exports=function(t,i){var r=a("../components/Constants.js");return{create:function(){if(i.isLegacy(i.featureMap.MDS[r.RV]))return new(a("./Interstitial.js"))(t,i);var e=a("./AdapterSharedConfig.js"),n=a("./InterstitialDemandSource/AdConfiguration.js")(e,i.SupplyConfigurations,r);return new(a("./ProductAdapter.js"))(t,i,n,r)}}}},{"../components/Constants.js":12,"./AdapterSharedConfig.js":99,"./Interstitial.js":125,"./InterstitialDemandSource/AdConfiguration.js":126,"./ProductAdapter.js":131}],128:[function(e,n,t){n.exports=function(){var i=[];function r(e){return-1!==i.indexOf(e)}return{removeAll:function(e,n){if(!r(n)){for(var t=0;t<i.length;t++)e[i[t]].clearListeners(),delete e[i[t]];i=[]}},add:function(e){r(e)||i.push(e)},clear:function(e){var n=i.indexOf(e);-1!==n&&i.splice(n,1)}}}},{}],129:[function(e,n,t){n.exports=function(){return{showOWCalled:{name:"showOWCalled",id:16},showOWFail:{name:"showOWFail",id:17},owVisible:{name:"owVisible",id:18},inventoryGetToReceived:{name:"inventoryGetToReceived",id:-12},initControllerToShowOWCalled:{name:"initControllerToShowOWCalled",id:-13},showOWCalledToOwVisible:{name:"showOWCalledToOwVisible",id:-14},adVisibleToClose:{name:"adVisibleToClose",id:-5},initOW:{name:"initOW",id:13},initOWFail:{name:"initOWFail",id:14},initOWSuccess:{name:"initOWSuccess",id:127},staticAssetsLoaded:{name:"staticAssetsLoaded",id:126},dialogBoxExit:{name:"dialogBoxExit",id:155},dialogBoxResume:{name:"dialogBoxResume",id:156},getInventory:{name:"getInventory",id:158},getInventoryFailed:{name:"getInventoryFailed",id:159}}}},{}],130:[function(kn,e,n){function t(d,s){"use strict";var i=kn("../../components/Constants.js"),r,a=!1,n=6e4,c="https://guc-api.sonic-us.supersonicads.com/api/v1/guc.php?format=json",t="https://guc-api.sonic-us.supersonicads.com/api/v1/myOffers",o="openRTB",l=i.OW,u="TaskManager",f=i.CB,g=window.jQuery,e,p={},v,m={},b={},h={productType:l},S=i.confirmCloseMsgMap,y={missingData:"Failed to get required parameters",invalid:"Invalid API response",appInfo:"Failed to retrieve application info",timeout:"API request timeout",server:"Server error",engaged:"Already engaged with OfferWall product",adunitAssetsTimeout:"Timeout in loading ad unit static assets",closeBeforeVisible:"User closed before ad loaded",missingDeviceIds:"Missing deviceIds",preconditions:"Failed to initiated OW, preconditions did not pass"},A={adunit:"adunit",inventory:"inventory",inventoryInBackground:"inventoryInBackground",preConditions:"preConditions",close:"close"},C={v:1,controllerId:1,applicationKey:0,applicationUserId:0,debug:0,language:0,maxVideoLength:0,itemName:0,itemCount:0,timestamp:0,localTime:1,timezoneOffset:1,itemSignature:0,disableCache:0,showDeliveryLimitationsLog:0,disableSession:0,minimumOfferCommission:0,minimumOfferCommissionSignature:0,applicationUserGender:0,applicationUserAgeGroup:0,applicationUserCreationDate:0,applicationUserCreationDateSignature:0,demoCampaigns:0,appOrientation:1,mobileCarrier:0,connectionType:1,iphoneAppOnIpadDevice:0,deviceOs:1,SDKVersion:1,deviceOSVersion:1,deviceOEM:0,deviceVolume:0,immersiveMode:0,att:0,"deviceIds[OpenUDID]":0,"deviceIds[IFA]":0,"deviceIds[IDFV]":0,"deviceIds[SERIAL]":0,"deviceIds[AndroidID]":0,"deviceIds[IMEI]":0,"deviceIds[AID]":0,displaySizeWidth:0,displaySizeHeight:0,deviceWidthDP:0,deviceHeightDP:0,deviceScreenScale:0,deviceLanguage:0,deviceModel:0,diskFreeSize:1,country:0,pageSize:0,page:0,landingId:0,customParams:0,admin:0,useClientSideCallbacks:0,isLimitAdTrackingEnabled:0,SDKPluginType:0,bundleId:0,jb:0,gpi:0,allowArbitraryLoads:0,allowArbitraryLoadsInWebContent:0,mcc:0,mnc:0,appVersion:0,batteryLevel:0,cdnCn:0,sdkAbName:0,segmentId:0,segmentName:0,consent:0,moatSupported:0,mediationType:0},D={settings:{},textData:{},offers:[]},I={SDKVersion:1},w={id:0,url:""},P={openAppStoreSheet:!0,preload:!1},T={osNotSupported:"Sorry, your operating system version is not supported.",dialogErrorMessage:"Sorry, we were unable to display the wall at the moment. Please try again later.",noOffers:"Sorry, we currently have no offers to display. Please try again later.",noInternet:"No internet connection. Please connect and try again."},O={initOWSuccess:null,initOWFailure:null},F=0,L,x={},N,U,M,V,E,k=!1,B=!1,R=null,K=null,j=s.adUnitGlobals,W="#/?productType="+l+"&mode=msdkctrl",G=null,H=null,_=null,q=null,J=null,Q=!1,z=null,X,$={adUnitAssetsTimeout:6e4,pollAPITimeout:1e4},Y={offers:[],settings:{},textData:{noOffers:T.noOffers},ext:{emptyOWReason:"default empty OW reason"}},Z={},ee=kn("./OWEventCategories.js")(),ne,te,ie,re,ae=(oe=!1,se=!1,de=!1,ce=!0,le=!1,{init:function(){oe||(d.PubSub.subscribe(u+".Engaged",function(e){d.Utils.isDefined(e.duringEngage)&&(se=e.duringEngage)}),d.PubSub.subscribe(f+".enterBackground",function(){de=!0}),d.PubSub.subscribe(f+".enterForeground",function(e){de=!1,!pe()||e&&d.Utils.isDefined(e.active)&&!e.active||(s.log("poll on CPI offer closed/external browser offer closed (iOS flow)"),B=!1,Ae())}),d.PubSub.subscribe(f+".viewableChange",function(e){e&&d.Utils.isDefined(e.isViewable)&&(!le||!e.isViewable||d.Utils.isDefined(e.webview)&&"main"!==e.webview||(le=!1,s.postAdUnitEvent({name:"OfferClosed"})),pe()&&e.isViewable&&d.Utils.isDefined(e.webview)&&"main"===e.webview&&(s.log("poll on CPI offer closed/external browser offer closed (Android flow)"),B=!1,Ae()))}),d.PubSub.subscribe(f+".deviceStatusChanged",function(e){d.Utils.isDefined(e.connectionType)&&(ce="none"!==e.connectionType&&"notReachable"!==e.connectionType)}),oe=!0)},canEngage:function(){if(se||!ce)return!1;var e=s.getCurrentDisplayedAd();return!e||e.productType===i.BN},isConnected:function(){return ce},setConnection:function(e){ce=e},setAdOpened:function(e){le=e},getStatusMsg:function(){return" duringEngage:"+se+" appInBackground:"+de+" isConnected:"+ce},getStatus:function(){return{duringEngage:se,appInBackground:de,isConnected:ce,isAdOpened:le}},duringEngage:function(){return se},publish:function(e,n){d.PubSub.publish(u+"."+e,n)},waitUntilAppInForeground:function(){var e=g.Deferred();return de?(s.log("OfferWall | Waiting for app to be in foreground"),d.PubSub.subscribeOnce(f+".enterForeground",function(){e.resolve()})):e.resolve(),e.promise()},waitUntilConnected:function(){var n=g.Deferred();if(ce)n.resolve();else{s.log("OfferWall | waiting for internet connection");var t=d.PubSub.subscribe(f+".deviceStatusChanged",function(e){d.Utils.isDefined(e.connectionType)&&(ce="none"!==e.connectionType&&"notReachable"!==e.connectionType)&&(d.PubSub.unsubscribe(t),n.resolve())})}return n.promise()}}),oe,se,de,ce,le,ue=function(){d.PubSub.subscribe(l+".ActionClick",function(e){s.OpenURLService.openForOW(e)||s.log(l+" failed to perform ActionClick")}),d.PubSub.subscribe("SDKController.AdClosed",function(e){if(e.productType===l){var n="ios"===s.getApiData({deviceOs:1}).deviceOs;ae.getStatus().isAdOpened&&n&&(s.postAdUnitEvent({name:"OfferClosed"}),ae.setAdOpened(!1),pe()&&(s.log("OfferWall | poll on ad closed"),Ae()))}}),d.PubSub.subscribe("SDKController.AdOpened",function(e){e.productType===l&&(ae.setAdOpened(!0),k&&be(e.bannerId,!0))}),d.PubSub.subscribe("SDKController.engageEnd",function(e,n){e.productType===l&&(k&&(s.log("OfferWall | poll on engageEnd(ad closed)"),Ae()),ae.publish("Engaged",[{duringEngage:!1,productType:l}]),te.unsetParamFromBaseData("landingId"),d.Utils.isFunction(n)&&n.call(),Q&&"pending"===H.state()&&Me("User closed before visible"),G&&G.always(function(){G=null;xe(!0)}))}),d.PubSub.subscribe("SDKController.adLoaded",function(e){e.adType===l&&(s.log("OfferWall | received ad loaded event"),s.onAdLoaded(w))}),d.PubSub.subscribe("SDKController.AdVisible",function(e){e.productType===l&&(s.log("OfferWall | ad visible"),te.trackTimingStop(ee.owVisible,{eNameStart:ee.showOWCalledToOwVisible}),te.trackTimingStart(ee.adVisibleToClose))}),d.PubSub.subscribe("SDKController.Analytics",function(e){if(e.productType===l&&e&&e.action){var n=e.action,t=e.eventParam;"fireEvent"===n?te.trackEvent(t.eName,t.label,t.data):"startTiming"===n?te.trackTimingStart(t.eName,t.data):"stopTiming"===n?te.trackTimingStop(t.eName,t.data):"setCustomData"===n?te.updateBaseData(t.data):"unsetCustomData"===n&&(t&&t.data&&"bannerId"===t.data?te.resetBaseData(i.baseDataKeys):te.unsetParamFromBaseData(t.data))}}),d.PubSub.subscribe(f+".initOfferWall",function(e,n,t){s.log("OfferWall | CB.init called"),Se(),te.trackEvent(ee.initOW),s.getApplicationInfo(h).then(Sn,function(e){s.callSDKFunction(t,{errMsg:e||y.appInfo})}).then(function(){return te.trackEvent(ee.initOWSuccess),s.callSDKFunction(n),d.Utils.returnResolvedPromise()},function(e){return te.trackEvent(ee.initOWFail,{callFailReason:e}),s.callSDKFunction(t,{errMsg:e}),d.Utils.returnResolvedPromise()}).then(Oe).then(function(){k&&Ae()})}),d.PubSub.subscribe(f+".showOfferWall",function(e,n,t){e&&s.AppOrientationManager.updateAppOrientationByNewRestriction(e.orientationRestriction),r.showOfferWall().then(function(){s.callSDKFunction(n,{placementId:tn()})},function(e){s.callSDKFunction(t,{errMsg:e})}).always(function(){In(Dn())&&(G=null)})}),d.PubSub.subscribe(f+".getUserCredits",function(e,n,t){if(s.checkRequiredCallbackParams(["applicationKey","applicationUserId","productType"],e,"getOfferWallCredits",t).didSucceed&&e.productType===l){if(d.Utils.decodeValues(e),On(e)&&ae.duringEngage()){var i="Could not provide credits, user provided is different from current user";return s.callSDKFunction(t,{errMsg:i}),void s.log(i,s.LogLevels.error)}Oe(!0,e).then(function(){Ae(e,t)},function(e){s.log(e,s.LogLevels.error),s.callSDKFunction(t,{errMsg:"Failed to initiate client side callbacks"})})}}),d.PubSub.subscribe("SDKController.OWOfferClicked",function(e){s.getCurrentDisplayedAdType()===l&&ve(e)}),d.PubSub.subscribe("SDKController.videoOfferClosed",function(){s.RingerSwitchService.isInitiated()&&(s.RingerSwitchService.stopListener(),s.log("OfferWall | Ringer | stop detecting ringer status changes from OW videoOfferClosed event")),pe()&&(B=!1,Ae())}),d.PubSub.subscribe("SDKController.dialogBoxResume",function(e){ge(e)&&te.trackEvent(ee.dialogBoxResume)}),d.PubSub.subscribe("SDKController.dialogBoxExit",function(e){ge(e)&&te.trackEvent(ee.dialogBoxExit)}),d.PubSub.subscribe(l+".GetCompletionOffers",function(e){if(d.Utils.isDefined(e.productType)){var n=je();re.getInventory(n.data,t,"json").then(fe.bind(null,e),fe.bind(null,e))}}),d.PubSub.subscribe("SDKController.OWPopupOfferOpened",function(e){ne||(ne=window.timerService.startTimer())})};function fe(e,n){re.isValidResponseStructure(n)&&(n=sn(n)),e&&e.callback&&e.callback.call(null,n)}function ge(e){return e&&e.productType===h.productType}function pe(){return k&&B}function ve(e){s.log("OfferWall | marked offer clicked for CSC with type "+e.type),B=!0}function me(e){return L=e&&e.placementId||F,s.log("OfferWall | Updated placement to "+L),L}var be=function(e,n){E&&"pending"===E.state()&&g.when(E).always(function(){be(e,n)}),(x[e]=n)?N++:N--,g.when(V).always(function(){s.log("poll counter set to: "+N),E=s.setUserData(m.applicationKey,m.applicationUserId,{counter:N}),g.when(E).always(function(){E=null})})},he=function(){var e=new g.Deferred,n={counter:0,timestamp:0};return g.when(V,E).always(function(){g.when(s.getUserData(K,R)).then(function(e){N=n.counter=d.Utils.isDefined(e.counter)?e.counter:0,U=n.timestamp=d.Utils.isDefined(e.timestamp)?e.timestamp:0}).always(function(){g.when(s.setUserData(K,R,n)).then(function(){s.log("initiation done with resolve"),e.resolve()},function(){s.log("initiation done with reject",s.LogLevels.error),e.reject()})})}),e.promise()};function Se(){if(!ie){ie=!0,s.initEventics(h);var e={owPageNumber:0,isPrecache:Z.precache};te.updateBaseData(e)}}var ye=function(e){var n,t;if(V){if("pending"===V.state())return V.promise()}else V=new g.Deferred;return n=d.PubSub.subscribe(f+".adCreditedSuccess",function(){U=e.timestamp,V.resolve(),d.PubSub.clearHandlers([n,t])}),t=d.PubSub.subscribe(f+".adCreditedFailed",function(e){V.reject(e.errMsg),d.PubSub.clearHandlers([n,t])}),g.when(E).always(function(){s.callSDKFunction("adCredited",e,"adCreditedSuccess","adCreditedFailed")}),V.promise()},Ae=function(n,t){var i={},r=[];if(s.log("In poll with counter "+N),!d.Utils.isDefined(n)&&N<=0||M&&"pending"===M.state())s.log("Exit poll, p:"+(M?M.state():null)+" a:"+(V?V.state():null));else{var e=s.getApiData(I),a=0;if(d.Utils.isDefined(e.errMsg)||!d.Utils.isDefined(K)||!d.Utils.isDefined(R))return s.log(e.errMsg,s.LogLevels.error),void(d.Utils.isDefined(n)&&d.Utils.isDefined(t)&&s.callSDKFunction(t,{errMsg:"Failed to make polling request, missing data"}));d.Utils.decodeValues(e);var o={aid:K,auid:R,SDKVersion:e.SDKVersion,timestamp:U};He(o),M=g.ajax({url:c,data:o,timeout:$.pollAPITimeout,type:"GET",dataType:"jsonp"}),g.when(M).then(function(e){if(s.log("Received poll data"),!(d.Utils.isDefined(e.rewardsData)&&d.Utils.isDefined(e.sig)&&d.Utils.isDefined(e.rewardsSummary)))return s.log("Poll data error",s.LogLevels.error),void(d.Utils.isDefined(n)&&d.Utils.isDefined(t)&&s.callSDKFunction(t,{errMsg:"Failed to retrieve user completion data, data error"}));!d.Utils.isEmptyObject(e.rewardsData)||d.Utils.isDefined(n)?(s.log(a),i={productType:l,credits:e.rewardsFromTime,total:e.rewardsSummary,signature:e.sig,timestamp:e.latestCompletionTime,externalPoll:d.Utils.isDefined(n),totalCreditsFlag:0===U},g.when(V).always(function(){V=null,g.when(ye(i)).then(function(){g.each(e.rewardsData,function(){this.b&&x[this.b]&&be(this.b,!1),r.push(this.id),a+=this.r?this.r:0}),0<r.length&&g.ajax({url:e.callbackURL,type:"GET",dataType:"jsonp",data:{vt:r.join(","),applicationKey:K,applicationUserId:R},success:function(){s.log("successfully updated server on csc")},error:function(e){s.log("failed to update server on csc",s.LogLevels.error)}})}).always(function(){V=null})})):s.log("no new completions")},function(e){s.log("Error retrieve user completion data"),d.Utils.isDefined(n)&&d.Utils.isDefined(t)&&s.callSDKFunction(t,{errMsg:"Failed to retrieve user completion data"})})}};function Ce(){return ae.canEngage()?d.Utils.returnResolvedPromise():ae.isConnected()?d.Utils.returnRejectedPromise(y.engaged):d.Utils.returnRejectedPromise(T.noInternet)}function De(e){e&&(p=e)}function Ie(e){return e in p?p[e]:null}function we(e,n){var t;return t=e?n:m=s.getApiData(C),d.Utils.returnResolvedPromise(t)}function Pe(e){return k=e&&("true"===e.useClientSideCallbacks||"boolean"==typeof e.useClientSideCallbacks&&e.useClientSideCallbacks),d.Utils.returnResolvedPromise(e)}function Te(e){var n=On(e);return d.Utils.returnResolvedPromise(n,e)}function Oe(t,e){return we(t,e).then(Pe).then(Te).then(function(e,n){return e&&(k||t)?(s.log("OfferWall | init client side callbacks"),Fn(n),he()):d.Utils.returnResolvedPromise()})}function Fe(){return Ce().then(s.getApplicationInfo.bind(s,h)).then(function(){return me(s.getApiData({placementId:1})),Oe()})}function Le(){s.log("OfferWall | In Refresh Interval"),ae.duringEngage()?s.log("OfferWall | Refresh Interval Popped, but during engage - ignore"):ae.waitUntilAppInForeground().then(ae.waitUntilConnected).then(function(){s.log("OfferWall | Refresh Interval Popped, calling refreshOfferWall"),s.unloadAdViewsByProduct(h),xe()})}function xe(e){Ee(),ae.isConnected()&&($e(),Z.precache?vn():e&&!Z.getInventoryOnInit||Ve())}function Ne(){z=setTimeout(function(){s.log("OfferWall | Adunit static assets timer popped"),Me(y.adunitAssetsTimeout)},$.adUnitAssetsTimeout)}function Ue(e){clearTimeout(z),s.log("OfferWall | Resolve adunit static assets promise"),H.resolve(e)}function Me(e){clearTimeout(z),s.log("OfferWall | Reject adunit static assets promise - "+JSON.stringify(e)),H.reject.apply(H.reject,arguments)}function Ve(){var e=je();e.errMsg||gn(e).always(yn)}function Ee(){q=J=_=null}function ke(){var e=d.PubSub.subscribe(l+".GetConfig",function(e){s.log("OfferWall | Received getConfig event from adunit"),Ue(e)});return function(){d.PubSub.unsubscribe(e)}}function Be(){var e=d.PubSub.subscribe(u+".Engaged",function(e){e.productType===l&&(Q=!0)});return function(){d.PubSub.unsubscribe(e)}}function Re(){s.log("OfferWall | Load Adunit"),H=new g.Deferred,te.trackTimingStart(ee.staticAssetsLoaded);var e=ke();return g.when(v?(s.log("Using cached adunit url: "+v),d.Utils.returnResolvedPromise({html:v})):j.getGlobalAssetsJSON()).then(function(e){if(v||(j.setAdunitVersion(e),v=j.getAdunitGlobalsHTML()),Q)Me("User closed before visible");else if("rejected"===_.state())Me("Finished when flow already failed");else{var n=j.getStaticGlobalsUrl()+v+W;setTimeout(function(){s.updateAdUnitUrl(w,n,h,{preload:!0,forceCreation:!0})},0),Ne()}},Me),H.promise().then(function(e){return te.trackTimingStop(ee.staticAssetsLoaded),e}).always(function(){e()})}function Ke(){var e={pass:!0,reason:"ok"};return ae.isConnected()?s.isSupportedOsVersion(l)?s.isLimitedDeviceModel()&&(e.reason="Device is not supported",e.pass=!1):(e.pass=!1,e.reason="Operating system version "+s.getConfigurationHelper().getDeviceOsVersion()+" is not supported"):(e.pass=!1,e.reason=T.noInternet),e}function je(){var e={data:null,errMsg:null},n=s.getApiData(C);return d.Utils.isDefined(n.errMsg)?e.errMsg=n.errMsg:n==={}?e.errMsg=y.missingData:(n.format=o,He(n),Ge(n),We(n),d.Utils.decodeValues(n),n.auid=s.AppUserIdService.getAUID(),e.data=n,m=n),e}function We(e){var n=s.getApiData({coppa:0});e.cscd=n&&n.coppa}function Ge(e){var n=s.getSDKDataByKey(i.xCodeVersion);n&&(e.xCodeVersion=n)}function He(e){var n=s.getSDKDataByKey(i.abTests.abt);n&&n.hasOwnProperty(i.abtParamByProductType[l])&&0<n[i.abtParamByProductType[l]].length&&(e.abt=n[i.abtParamByProductType[l]])}function _e(e){_&&"pending"===_.state()&&(s.log("OfferWall | Rejecting Get Inventory | "+e.errMsg),e.errCode&&(eventObj.errorCode=e.errCode),e.failFlow!=A.preConditions&&te.trackEvent(ee.getInventoryFailed,{callFailReason:e.errMsg}),_.reject(e))}function qe(e,n){return{failFlow:e,errMsg:n}}function Je(){return qe(A.close,"User closed before visible",!0)}function Qe(e,n,t){var i=qe(e,n);return i.errCode=t||0,i}function ze(){return G&&"pending"===G.state()}function Xe(){return _&&"pending"===_.state()}function $e(){X&&(clearTimeout(X),X=null)}function Ye(){var e=s.getApiData({scdn:1,protocol:0,defaultProtocol:1}),n=s.decideUrlProtocolAccordingToHTTPSCompliance(),t=e.scdn;return{protocol:n,urltocdn:"prod"!==s.getEnv()?s.api()+"/users/staging/"+SuperSonicGlobalConfig.mobileSDKSettings.env:n+"//"+t,preload:Z.precache,hasNotch:s.getNotchService().hasNotch()}}function Ze(e,n){var t=ze(),i=e.offers&&0<e.offers.length;if(t||i)return T.confirmCloseMsg=e.textData.confirmCloseMsg,g.extend(e.settings,Ye(),s.getFormattedDeviceData()),nn(e),rn(e).then(function(e){en(e),n.callback.call(null,e)});var r=qe(A.inventoryInBackground,"Empty Inventory");return s.log("No inventory available while preloading in background - Remove iframe"),s.unloadAdViewsByProduct(h),_e(r),d.Utils.returnRejectedPromise(r)}function en(e){var n={settings:{deviceId:s.getDeviceId(),appKey:s.getSDKDataByKey(i.requiredSDKDataKeys.applicationKey),userApplicationId:s.getSDKDataByKey(i.requiredSDKDataKeys.applicationUserId),shouldShowOWPopup:Mn()}};return g.extend(!0,e,n)}function nn(e){s.getConfig().mobileSDKSettings.deviceOs!==i.deviceOs.ios&&e.settings.forceOWOrientation&&(w.ext={forceOrientation:e.settings.forceOWOrientation})}function tn(){return L||F}function rn(e){var n=new g.Deferred;if(!e.settings.placementsFlow)return n.resolve(sn(e));if(ze())n.resolve(dn(e));else{s.log("Waiting for show before resolving getConfig");var t=d.PubSub.subscribe(f+".showOfferWall",function(){d.PubSub.unsubscribe(t),s.getApplicationInfo(h).then(function(){me(s.getApiData({placementId:1})),n.resolve(dn(e))})})}return n.promise()}function an(e,n){if(!e)return!1;if(e.offers&&0<e.offers.length){var t=e.offers[0];return t.rewards&&t.rewards[n]}return!!e.settings.currency&&e.settings.currency[n]}function on(e,n){if(!e.intermediateData||!e.intermediateData.text)return e;var t=e.currency||n,i=e.intermediateData.text.actionButton,r=e.intermediateData.text.instructionDescription,a=e.intermediateData.text.instructions,o={"{{rewardCount}}":e.rewards,"{{currencyName}}":t};if(0<i.length&&(e.intermediateData.text.actionButton=d.Utils.replacePlaceHolder(i,o)),0<r.length&&(e.intermediateData.text.instructionDescription=d.Utils.replacePlaceHolder(r,o)),0<a.length)for(var s=0;s<a.length;s++)a[s]=d.Utils.replacePlaceHolder(a[s],o);return e}function sn(e){for(var n=e.offers,t=0;t<n.length;t++)n[t]=on(n[t],e.settings.currency);return e}function dn(e){var n=e.offers,t=tn();an(e,t)||(t=me({placementId:F})),s.log("Offerwall | currentPlacement: "+t),e.settings.placementId=t;for(var i=0;i<n.length;i++)n[i].textData=n[i].textData[t],n[i].rewards=n[i].rewards[t],n[i].multiCompletionsRewards&&n[i].multiCompletionsRewards[t]&&(n[i].multiCompletionsRewards=n[i].multiCompletionsRewards[t]),n[i]=on(n[i],e.settings.currency[t]);try{e.settings.currency=e.settings.currency[t],e.settings.doublePromotionData&&(e.settings.doublePromotionData=e.settings.doublePromotionData[t]),e.settings.multiCreditPromotionData&&(e.settings.multiCreditPromotionData=e.settings.multiCreditPromotionData[t]),e.settings.linksData.contactSupport.label=e.settings.linksData.contactSupport.label[t],e.textData.header=e.textData.header[t]}catch(e){s.log("OfferWall | Failed to interpolate inventory response",s.LogLevels.error)}return e}function cn(e,t){t.failFlow!==A.close?(ze()?t.failFlow===A.inventory&&(e&&"rejected"!==e.state()||(e=un()),e.then(function(e){var n=g.extend({},Y);n.ext.emptyOWReason=t.errMsg,en(n),e.callback.call(null,n)})):(t.failFlow===A.inventory&&(t=qe(A.inventoryInBackground,"Failed to get Inventory"),s.log("OfferWall | Inventory failed while preloading in background - Remove iframe")),s.unloadAdViewsByProduct(h)),_e(t)):_e(t)}function ln(e){s.log("Offerwall | Get Inventory"),te.trackEvent(ee.getInventory);var n=s.getProtocol()+i.gatewayDestinationMap.OW.production;return re.getInventory(e.data,n).then(function(e){if(Q){var n=Je();return d.Utils.returnRejectedPromise(n)}return e},function(e){return Q?Je():Qe(A.inventory,e.errorMessage,e.errorCode)}).then(function(e){return s.CampaignsFilter.filterByAppInstalledOW(e.offers,e.settings).then(function(){return d.Utils.returnResolvedPromise(e)})})}function un(){var e=Ie(i.offerWallSetting.OWVersion)||i.offerWallSetting.defaultOWVersion;return En.bind(null,e)().then(null,function(e){return Q?Je():qe(A.adunit,e)})}function fn(){if(s.log("OfferWall | _handlePreConditions"),q&&"pending"===q.state())return s.log("OfferWall | _handlePreConditions already has deferred "+q.state()),q;var e;q=new g.Deferred,Q=!1,$e();var n=!0,t=Ke();t.pass||(_e(e=qe(A.preConditions,t.reason)),n=!1);var i=je();return i.errMsg&&(_e(e=qe(A.preConditions,i.errMsg)),n=!1),n?q.resolve(i):q.reject(e),q.promise()}function gn(e){return s.log("OfferWall | _getInventoryWithPromise"),J&&"rejected"!==J.state()?(s.log("OfferWall | _getInventoryWithPromise already has deferred "+J.state()),J):J=ln(e).then(function(e){e.settings=e.settings||{};var n=e.settings;return n.shouldStartMuted=s.AdUtils.isCampaignShouldStartMuted(s.getConfig().controllerConfig,i.OW),De(g.extend(n,s.getApplicationExternalConfig().getABTestConfiguration("Offerwall",e.settings.templateId))),pn({feedSize:e.offers.length,landingId:e.settings.templateId,strategyId:e.settings.strategyId}),d.Utils.returnResolvedPromise(e)})}function pn(e){te.updateBaseData(e)}function vn(){return s.log("OfferWall | _initOfferWall"),_&&"rejected"!==_.state()?s.log("OfferWall | _initOfferWall using cached promise in Init OW flow"):(_=new g.Deferred,bn().then(function(){_.resolve()})),_.promise()}function mn(n){var t=new g.Deferred;return s.shouldExtendApiDataWithDebugData()?s.extendApiDataWithDebugParams(n.data).then(function(e){n.data=e,t.resolve(n)}):t.resolve(n),t.promise()}function bn(){var n=null;return fn().then(function(e){return mn(e)}).then(function(e){return gn(e)}).then(function(e){return n=un(),g.when(e,n)}).then(function(e,n){return Ze(e,n)},function(e){return cn(n,e)}).always(yn)}function hn(){return fn().then(gn,function(e){return e&&e.errMsg||(e={errMsg:y.preconditions}),s.log("OfferWall.js | CB.init preConditionsFailed "+JSON.stringify(e),s.LogLevels.verbose),d.Utils.returnRejectedPromise(e.errMsg)}).then(null,function(e){return s.log("OfferWall.js | CB.init getInventoryPromise fail",s.LogLevels.verbose),e=e||y.server,d.Utils.returnRejectedPromise(e)}).always(yn)}function Sn(){return Z.precache?(vn(),d.Utils.returnResolvedPromise()):Z.getInventoryOnInit?hn():d.Utils.returnResolvedPromise()}function yn(){if(!X&&(Z.precache||Z.getInventoryOnInit)&&!In(Dn())){var e=Z.refreshInterval;s.log("Setting OW refresh interval - "+e+" minutes",s.LogLevels.verbose),X=setTimeout(Le,e*n)}}function An(){Q&&d.Utils.returnRejectedPromise(Je().errMsg)}function Cn(e){"object"!=typeof e&&(e={errMsg:e});var n=e.errMsg||"Generic error on ShowOfferWall";return Q?n:e.failFlow===A.adunit?(te.trackEvent(ee.showOWFail,{callFailReason:"l1651: "+n}),xn(n),n):e.failFlow===A.preConditions?(te.trackEvent(ee.showOWFail,{callFailReason:"l1655: "+n}),xn(n),n):(s.log("Empty OfferWall error",s.LogLevels.verbose),Tn(),d.Utils.returnResolvedPromise())}function Dn(){var e,n=Ie("standaloneOfferWallData");if(n&&n.url){var t=n.url,i=tn();d.Utils.isDefined(i)&&(t=d.Utils.replacePlaceHolder(t,{"{{PlacementId}}":i})),-1===t.indexOf("openOWInStandalone")&&(t+="&openOWInStandalone=true"),e=g.extend({},n,{url:t})}return e}function In(e){return e&&e.openInStandaloneOfferWall&&e.url}function wn(){return G&&"rejected"!==G.state()?(s.log("line[354]: Recalling showOW before resolving previous flow",s.LogLevels.error),te.trackEvent(ee.showOWFail,{callFailReason:"Recalling showOW before resolving previous flow"}),G):(G=new g.Deferred,Se(),te.incrementSessionNumber(),te.trackTimingStart(ee.initControllerToShowOWCalled,s.getApiData({controllerTimeLoaded:1}).controllerTimeLoaded),te.trackTimingStop(ee.showOWCalled,{eNameStart:ee.initControllerToShowOWCalled}),te.trackTimingStart(ee.showOWCalledToOwVisible),Fe().then(function(){if(In(t=Dn()))return d.Utils.returnResolvedPromise();var e=vn();return n=Be(),Pn(e),e.then(An,Cn)},function(e){return te.trackEvent(ee.showOWFail,{callFailReason:"l1735: "+e}),xn(e),e}).always(function(){n&&n()}).then(function(){if(In(t)){var e={url:t.url,method:"external_browser"};s.openUrl(e)}else Tn();s.log("Resolving ShowOfferWall"),G.resolve.apply(this,arguments)},function(e){s.log("Rejecting ShowOfferWall"),G.reject(e)}),G.promise());var n,t}function Pn(e){if(w.url=null,w.isWPAD=!1,"resolved"!==e.state()||!Z.precache){var n={preload:!1,immersive:!!Ie(i.offerWallSetting.immersive)&&Ie(i.offerWallSetting.immersive),OLXD:Ie(i.offerWallSetting.OLXD)};s.loadAdUnitUrl(w,w.url,h,n),s.displayAdView(w)}}function Tn(){w.isWPAD=!1,s.loadAdUnitUrl(w,w.url,h,{preload:!1}),s.displayAdView(w)}var On=function(e){var n=e.applicationUserId,t=e.applicationKey;return n!==R||t!==K},Fn=function(e){R=e.applicationUserId,K=e.applicationKey};function Ln(e){return T.dialogErrorMessage}function xn(e){s.log("No OfferWall dialog error");var n={productType:l,message:Ln(e),alwaysClose:!0,yes:"close",no:"OK"};s.alert(n)}function Nn(){var e=s.getProtocol();b={dev:e+i.gatewayDestinationMap.OW.production,stage:e+i.gatewayDestinationMap.OW.production,prod:e+i.gatewayDestinationMap.OW.production}}function Un(e){return b[e]||b.prod}function Mn(){var e=s.getApplicationExternalConfig().getABTestConfiguration("Offerwall",m.landingId),n=e.OWPopupInterval?e.OWPopupInterval:0;if(!n||!ne)return!0;var t=window.timerService.timeElapsed(ne);return n*i.timeunit-t<=0&&(window.timerService.stopTimer(ne),!(ne=void 0))}var Vn={init:function(e){r=this,g=s.jQuery(),Nn();var n=Un(s.getEnv());if(!a){var t={productChance:(s.getEnv(),1),baseData:{productType:l}};"android"===s.getConfig().mobileSDKSettings.deviceOs&&(C.deviceApiLevel=0),te=d.Eventics.createEventic(t,s.EventsManager),re=new(kn("../../components/FetcherService.js"))(n,D),ae.init(),ue(),Z=e.supplyConfig,a=!0}},getNextBtnText:function(){return d.Utils.isDefined(T.next)?T.next:"Next"},getConfirmCloseMsg:function(){return T.confirmCloseMsg&&T.confirmCloseMsg[S[0]]},showOfferWall:wn,isNextAvailable:function(){return!1},getBack:function(){return w.url}};function En(n){s.log("OfferWall | Load external version: "+n),H=new g.Deferred,te.trackTimingStart(ee.staticAssetsLoaded);var e=ke();if(Q)Me("User closed before visible");else{var t=j.getOWStaticGlobalsUrl(n)+j.getOWGlobalsHTML()+W;s.log("composedUrl: "+t),setTimeout(function(){s.updateAdUnitUrl(w,t,h,{preload:!0,forceCreation:!0})},0),Ne()}return H.promise().then(function(e){return te.trackTimingStop(ee.staticAssetsLoaded,{custom_a:n}),e}).always(function(){e()})}return g.extend(Vn,{_promisedCanEngage:Ce,_initiateClientSideCallbacks:Oe,_preShowOfferWall:Fe,_refreshInterval:Le,_refreshOfferWall:xe,_setAdunitAssetsTimer:Ne,_resolveAdunitAssetsPromise:Ue,_rejectAdunitAssetsPromise:Me,_subscribeGetConfig:ke,_subscribeCloseDuringShow:Be,_loadAdunitToIframe:Re,_verifyRestrictions:Ke,_getAPIRequiredData:je,_rejectInitWithReason:_e,_generateErrorObject:qe,_generateCloseBeforeVisibleErrorObject:Je,_isDuringShow:ze,_isDuringInit:Xe,_clearRefreshInterval:$e,_handleDependenciesResolve:Ze,_handleDependenciesReject:cn,_getInventory:ln,_loadAdunit:un,_handleInitOfferWallError:Cn,_showLoaderIfNeeded:Pn,_initOfferWallByConfig:Sn,_displayOfferWall:Tn,_getInventoryAndPreload:bn,_initOfferWall:vn,_setOfferWallSettings:De,_getOfferWallSetting:Ie}),Vn}e.exports=t},{"../../components/Constants.js":12,"../../components/FetcherService.js":21,"./OWEventCategories.js":129}],131:[function(G,e,n){e.exports=function(p,f,g,v){"use strict";var a,n,i,r=f.jQuery(),e=G("./LoadedInstances"),t=f.instancesManager.getManualLoadInstancesBuilder(),m=new(G("./DemandSource/EventCategories"))(g.ProductName),b=new(G("./DemandSource/dsConfig"))(g,m),h=new(G("./prdTaskManager"))(p,f,g.ProductName,v),o=new(G("../components/FilteredListService")),s={},d={},c=!1,S=f.DemandUtils,l=[],u=new e,y=f.InstancesTimers,A={loadSuccess:null,loadFailure:null};function C(e){y.clearInstanceTimers(g.ProductName,e),delete a[e]}function D(e){return r.extend({},{originalDemandSourceName:R(e)},e)}function I(e,n){var t=U(e);return t||(t=k(n)),t}function w(e){return n=e,!(f.getConfig().mobileSDKSettings.deviceOs===v.deviceOs.ios&&!n.isViewControllerSet);var n}function P(e,n,t){var i=R(e),r=j(e);if(L(r,i),N(i))!function(e,n,t){var i=b.errors.load.instanceExhausted;e.productType=g.ProductName;var r=S.extendCallbackParamsWithDemandConfig(e,{errMsg:i});r=y.extendEventDataWithElapsedLoadTime(e.productType,e.demandSourceName,r),n.trackEvent(m.loadAdFailedForExhaustedInstance,{},r),y.clearLoadStartTimeForInstance(e.productType,e.demandSourceName),f.callSDKFunction(t,r)}(e,r,t);else{var a=I(i,e);if(T(a)){if(e&&e.productType===v.BN){if(!w(e))return o=e,r.trackEvent(m.loadAdFailed,{},{callfailreason:"Missing Parameter : View Controller",timingvalue:y.stopLoadTimer(o.productType,o.demandSourceName)}),void f.callSDKFunction(s,S.extendCallbackParamsWithDemandConfig(o,{errMsg:"Missing Parameter : View Controller"}));f.addExternalAdViewIdAndSetStatus(e)}var o,s,d,c,l,u;h.canEngage()?(c=e,l=n,u=t,(d=a).statesManager.load(d.loadAd,l,u,d.readyStateParams,c)):K(e,r,t,"LWS is not allowed for nonBidding instance")}else O(e,r,t)}}function T(e){return e&&e.statesManager}function O(e,n,t){K(e,n,t,b.errors.general.dsNotSet)}function F(e,n){var t,i,r,a,o,s,d,c=I(R(e),e),l=W(c),u=function(e){if(!e)return null;try{var n=p.Utils.parseJSON(decodeURIComponent(e));return p.Utils.isEmptyObject(n)&&(n=null),n}catch(e){}return null}(e.adm),f=(t=e)&&t.dynamicDemandSource?t.dynamicDemandSource:null,g=(d="-1",(s=u)&&s.seatbid.ext.hasOwnProperty("auction")?s.seatbid.ext.auction.id:d);l.updateBaseData({auctionId:g,dynamicDemandSource:f}),L(l,e.originalDemandSourceName),T(c)?u?(i=c,a=u,o=n,(r=e).adm=a,i.statesManager.loadWithADM(i.loadAdWithAdm,o,i.readyStateParams,r)):K(e,l,n,"unable to parse adm from native SDK"):O(e,l,n)}function L(e,n,t){f.log("productAdapter - load",f.LogLevels.verbose);var i=y.extendEventDataWithElapsedLoadTime(g.ProductName,n,{});e.trackEvent(m.loadAd,{demandSourceName:n},i),b.shouldDisplayOnAdReady&&e.trackTimingStart(m.showAdCalled)}function x(e){return e&&e.productType===g.ProductName}function N(e){return-1!==l.indexOf(e)}function U(e){return e?a[e]:null}function M(e){return p.Eventics.createEventic({productChance:1,baseData:{productType:g.ProductName,demandSourceName:e.originalDemandSourceName,integrationType:v.integrationType.manual,isBiddingInstance:e.isInAppBidding}},f.EventsManager)}function V(e){var n=M(e);i=function(e){if(i)return i;var n={productType:g.ProductName,isInAppBidding:!0,originalDemandSourceName:e.originalDemandSourceName||R(e)},t=r.extend({},b.precacheConfig);return t.cacheBase=v.cacheAdsDirectory,t.precachePath="../"+t.cacheBase+"/",r.extend(t,n),new(G("../components/precacheManager"))(p,f,t)}(e);var t=new(G("./DemandSource/BidderProductInstance"))(p,f,v,e,b,n,i);return t.statesManager=new(G("./ProductAdapter/BidderProductStatesManager"))(p,f,e,b,v,n,g.NativeAPI),t}function E(e){if(e){var n,t,i,r=e.demandSourceName;return a[r]||(f.log("initiating "+g.ProductName+" demand source with configuration "+JSON.stringify(e),f.LogLevels.verbose),e.shouldAvoidHandleFrameClose=g.shouldAvoidHandleFrameClose,a[r]=e.isInAppBidding?V(e):(t=M(n=e),(i=new(G("./DemandSource/ProductInstance"))(p,f,v,n,b,t)).statesManager=new(G("./ProductAdapter/ProductStatesManager"))(p,f,n,b,v,t,g.NativeAPI),i),a[r].init()),a[r]}}function k(e){return E(t.createDemandEntityConfigObj({productType:g.ProductName,demandSourceName:R(e),isInAppBidding:B(e),demandSourceId:e.demandSourceId,originalDemandSourceName:e.originalDemandSourceName||R(e),adSize:{width:e.width,height:e.height,label:e.label}}))}function B(e){return!(!e||!e.inAppBidding||"true"!==e.inAppBidding.toLowerCase())}function R(e){return e&&e.demandSourceName?e.demandSourceName:g.DemandName}function K(e,n,t,i){e.productType=g.ProductName;var r=S.extendCallbackParamsWithDemandConfig(e,{errMsg:i});r.callfailreason=i,r.timingvalue=y.stopLoadTimer(e.productType,e.demandSourceName),r=y.extendEventDataWithElapsedLoadTime(e.productType,e.demandSourceName,r),n.trackEvent(m.loadAdFailed,{},r),y.clearLoadStartTimeForInstance(e.productType,e.demandSourceName),f.callSDKFunction(t,r)}function j(e){return W(a[R(e)])}function W(e){return e&&e.getDSEventics()?e.getDSEventics():n}return{init:function(){if(a=this,!c){var e={productChance:1,baseData:{productType:g.ProductName,integrationType:v.integrationType.manual}};n=p.Eventics.createEventic(e,f.EventsManager),function(){var e=f.getProtocol();s={dev:e+g.gatewayDestinationMap.prod,stage:e+g.gatewayDestinationMap.prod,prod:e+g.gatewayDestinationMap.prod};var n,t,i=f.getApiData({destinationMap:0});if(i&&i.destinationMap)for(n in d=i.destinationMap)t=d[n],d[n]&&0<d[n].length&&-1===d[n].indexOf(e)&&(d[n]=e+t)}(),p.PubSub.subscribe(g.AdUnitCallbacks.engageEnd,function(e,n){if(x(e)){var t=U(e.demandSourceName);t&&t.statesManager&&((e&&e.engaged||g.shouldResetOnEngageEnd)&&t.statesManager.engageEnd(),t.engageEnd(e,function(){h.publish("Engaged",[{duringEngage:!1,productType:g.ProductName}]),p.Utils.isFunction(n)&&n()}))}}),p.PubSub.subscribe(g.AdUnitCallbacks.adClicked,function(e){if(x(e)){var n=f.getCurrentDisplayedAd();n&&f.callSDKFunction(g.ControllerNativeAPI.adClicked,S.extendCallbackParamsWithProductConfig(n,{}))}}),p.PubSub.subscribe(g.AdUnitCallbacks.adVisible,function(e){if(x(e)){var n=U(e.demandSourceName);n?(f.log("ProductAdapter | "+g.AdUnitCallbacks.adVisible+" demandSourceName="+e.demandSourceName),n.adVisible(e),n.statesManager&&n.statesManager.adVisible()):f.log(g.AdUnitCallbacks.adVisible+" called without an active demand source name")}}),p.PubSub.subscribe(g.ProductName+g.ControllerCallbacks.cacheReady,function(e){var n=U(e.demandSourceName);n&&n.statesManager&&(n.readyStateParams=e,n.statesManager.cacheReady(A.loadSuccess,e))}),p.PubSub.subscribe(g.ProductName+g.ControllerCallbacks.allOffersVast,function(e){var n=U(e.demandSourceName);n&&n.statesManager&&n.statesManager.allOffersVast(A.loadFailure,e.errorMsg)}),p.PubSub.subscribe(g.ProductName+g.ControllerCallbacks.noMoreOffers,function(e){var n=U(e.demandSourceName);n&&n.statesManager&&n.statesManager.noMoreOffers(A.loadFailure,e.errorMsg)}),p.PubSub.subscribe(g.ProductName+g.ControllerCallbacks.failedToShow,function(e){var n=U(e.demandSourceName);n&&n.statesManager&&(f.log(g.ProductName+" failed to show - can not engage ad",f.LogLevels.error),n.statesManager.failedToShow())}),p.PubSub.subscribe(g.ProductName+g.ControllerCallbacks.failedToLoad,function(e){var n=U(e.demandSourceName);if(n&&n.statesManager){f.log(g.ProductName+" failed to load",f.LogLevels.error);var t={callFailReason:e.errMsg,timingvalue:y.stopLoadTimer(g.ProductName,e.demandSourceName)};t=y.extendEventDataWithElapsedLoadTime(g.ProductName,e.demandSourceName,t),j(e).trackEvent(m.loadAdFailed,{},t),y.clearLoadStartTimeForInstance(g.ProductName,e.demandSourceName),n.statesManager.failedToLoad()}}),p.PubSub.subscribe(g.ProductName+g.ControllerCallbacks.actionClick,function(e){f.OpenURLService.open(e)||f.log(g.ProductName+" failed to perform ActionClick",f.LogLevels.info)}),p.PubSub.subscribe(g.ProductName+g.ControllerCallbacks.exhaustedDemandSource,function(e){var n=R(e),t=U(n);f.log("exhaustedDemandSource: "+n,f.LogLevels.verbose),t&&(t.exhausted=!0),l.push(n),e&&e.engaged||(f.log("Demand source deleted in BG: "+n,f.LogLevels.verbose),C(n))}),p.PubSub.subscribe(g.ProductName+g.ControllerCallbacks.fallbackToNonPrecache,function(e){var n=U(e.demandSourceName);n&&n.statesManager&&n.statesManager.noMoreOffers(A.loadFailure,"failed due to fallbackToNonPrecache flow on manual load")}),p.PubSub.subscribe(g.ProductName+g.ControllerCallbacks.resetStateManager,function(e){var n=U(R(e));n&&n.statesManager&&n.statesManager.resetAdState()}),p.PubSub.subscribe("SDKController"+g.ControllerCallbacks.onAdWindowsClosed,function(e){if(x(e)){var n=U(e.demandSourceName);if(n)return n.exhausted?(f.log("Demand source deleted: "+e.demandSourceName,f.LogLevels.verbose),void C(e.demandSourceName)):void(e.isInAppBidding&&u.add(e.demandSourceName))}}),g.ControllerCallbacks.reset&&p.PubSub.subscribe(g.ProductName+g.ControllerCallbacks.reset,function(e){var n=U(e.demandSourceName);if(n)return f.getExternalContainer().resetReportAdVisibilityFlags(),j(e).trackEvent(m.bannerDestroyed),n.statesManager.resetAdState(),void n.reset();f.log("Reset called without an active demand source name",f.LogLevels.verbose)}),h.init(),c=!0}},getProductType:function(){return g.ProductName},getDestination:function(e){return d&&d[e]?d[e]:s[f.getEnv()]},getAmountOfSupportedInventories:function(){return g.amountOfInventories},shouldAvoidHandleFrameClose:function(){return g.shouldAvoidHandleFrameClose},doesAllowConsecutiveGatewayRequestsDuringLoad:function(){return g.Features.allowConsecutiveGatewayRequestsDuringLoad},getProductTM:function(){return h},getConfirmCloseMsg:function(e){return a[e]?a[e].getConfirmCloseMsg():null},initProduct:function(e,n,t){var i=R(e);B(e=D(e))&&(e.demandSourceName=e.demandSourceId),y.setLoadStartTimeForInstance(g.ProductName,e.demandSourceName,e.loadStartTime);var r={isBiddingInstance:B(e)};r=y.extendEventDataWithElapsedLoadTime(g.ProductName,e.demandSourceName,r),j(e).trackEvent(m.initAd,{demandSourceName:e.originalDemandSourceName},r);var a=f.getSDKLimitationData(g.ProductName);if(!a.didSucceed)return r={callFailReason:a.errMsg,demandSourceName:e.originalDemandSourceName},r=y.extendEventDataWithElapsedLoadTime(g.ProductName,e.demandSourceName,r),j(e).trackEvent(m.initAdFail,{},r),y.clearLoadStartTimeForInstance(g.ProductName,e.demandSourceName),void f.callSDKFunction(t,{errMsg:a.errMsg,demandSourceName:i});var o=k(e);o&&(o.initProduct&&p.Utils.isFunction(o.initProduct)&&o.initProduct(e),o.statesManager&&o.statesManager.init(n))},loadProduct:function(e,n,t){f.log("productAdapter - loadProduct",f.LogLevels.verbose),e=D(e),y.startLoadTimer(g.ProductName,e.demandSourceName),y.setLoadStartTimeForInstance(g.ProductName,e.demandSourceName,e.loadStartTime),A.loadSuccess=n,A.loadFailure=t,B(e)?((e.productType!==v.BN||f.isBannerAndLoadWhileShowSupported(e.productType))&&(u.removeAll(a,e.demandSourceId),u.add(e.demandSourceId),e.demandSourceName=e.demandSourceId),F(e,t)):P(e,n,t)},showProduct:function(e,n,t){B(e=D(e))&&(u.clear(e.demandSourceId),e.demandSourceName=e.demandSourceId);var i=R(e),r=U(i),a=e&&e.orientationRestriction;j(e).updateBaseData({sessionDepth:f.ImpressionsCounterService.getCountersByProduct(b.productType).totalSessionImpressions+1}),j(e).trackEvent(m.showAd),f.AppOrientationManager.updateAppOrientationByNewRestriction(a),function(e,n,t,i){if(N(t)){var r={errMsg:b.errors.show.instanceExhausted,demandSourceName:t};return j(e).trackEvent(m.showAdFail,{callfailreason:b.errors.show.instanceExhausted}),f.callSDKFunction(n,r),!1}return!!i||(j(e).trackEvent(m.showAdFail,{callfailreason:b.errors.general.dsNotSet}),f.callSDKFunction(n,{errMsg:b.errors.general.dsNotSet}),!1)}(e,t,i,r)&&(h.canEngage()?(j(e).trackTimingStart(m.showAdCalled),r.statesManager&&r.statesManager.show(r.showAd,n,t)):r.onShowAdFailed(t,"Cannot engage offer at this time"))},isManualIntegration:!0,className:"ProductAdapter",filteredListService:o}}},{"../components/FilteredListService":23,"../components/precacheManager":79,"./DemandSource/BidderProductInstance":110,"./DemandSource/EventCategories":112,"./DemandSource/ProductInstance":119,"./DemandSource/dsConfig":120,"./LoadedInstances":128,"./ProductAdapter/BidderProductStatesManager":132,"./ProductAdapter/ProductStatesManager":134,"./prdTaskManager":167}],132:[function(e,n,t){function i(a,s,d,o,c,l,e){var u=s.jQuery(),f={readyToLoad:0,inLoadingProcess:1,loaded:2,readyToShow:3,inShowingProcess:4,visible:5},n=f.readyToLoad,t=f.readyToShow,g=o.eventicsCategories,p=s.DemandUtils,v=!1,m=p.extendCallbackParamsWithDemandConfig(d),b=s.InstancesTimers;function r(e){return n===e}function h(e){return t===e}function S(e){n=parseInt(e,10)}function y(e){t=parseInt(e,10)}function A(){return S(f.readyToLoad)}function i(){return y(f.readyToShow)}function C(){return r(f.readyToLoad)?o.errors.show.notLoaded:r(f.inLoadingProcess)?o.errors.show.duringLoad:h(f.inShowingProcess)?o.errors.show.tryingToEngage:h(f.visible)?o.errors.show.visible:"fail reason is unknown."}function D(e){if(h(f.visible)||h(f.inShowingProcess))s.log(C(),s.LogLevels.error);else if(!r(f.loaded)){var n=p.extendCallbackParamsWithDemandConfig(d,{errMsg:C()});s.callSDKFunction(e,n)}}function I(e){var n=p.isLegacy(d)?{}:m;v=!0,s.callSDKFunction(e,n)}function w(e,n,t,i){if(s.log("_loadWithADM",s.LogLevels.error),!v){var r="instance was not initiated",a=p.extendCallbackParamsWithDemandConfig(d,{errMsg:r}),o=u.extend({},m,{demandSourceName:d.originalDemandSourceName,callfailreason:r,timingvalue:b.stopLoadTimer(d.productType,d.originalDemandSourceName)});return o=b.extendEventDataWithElapsedLoadTime(d.productType,d.originalDemandSourceName,o),l.trackEvent(g.loadAdFailed,{},o),b.clearLoadStartTimeForInstance(d.productType,d.originalDemandSourceName),void s.callSDKFunction(n,a)}S(f.inLoadingProcess),e(i,n)}function P(e,n,t){if(r(f.loaded)&&h(f.readyToShow))y(f.inShowingProcess),e(m,n,t);else{var i=u.extend({},m,{demandSourceName:d.originalDemandSourceName});l.trackEvent(g.showAdFail,{callfailreason:C()},i),D(t)}}function T(e,n){S(f.loaded);var t=u.extend({},m,{demandSourceName:d.originalDemandSourceName,timingvalue:b.stopLoadTimer(d.productType,d.originalDemandSourceName)});t=b.extendEventDataWithElapsedLoadTime(d.productType,d.originalDemandSourceName,t),l.trackEvent(g.loadAdSuccess,{},t),b.clearLoadStartTimeForInstance(d.productType,d.originalDemandSourceName),s.callSDKFunction(e,p.extendCallbackParamsWithDemandConfig(d,n)),a.PubSub.publish("ProductStatesManager.stateResolved",[p.extendCallbackParamsWithProductConfig(d,{response:!0})])}function O(e,n){var t=n===c.errors.noFill?g.noFill:g.loadAdFailed,i=u.extend({},m,{demandSourceName:d.originalDemandSourceName,callFailReason:n,timingvalue:b.stopLoadTimer(d.productType,d.originalDemandSourceName)});i=b.extendEventDataWithElapsedLoadTime(d.productType,d.originalDemandSourceName,i),l.trackEvent(t,{},i),b.clearLoadStartTimeForInstance(d.productType,d.originalDemandSourceName);var r=p.extendCallbackParamsWithDemandConfig(d,{errMsg:o.errors.load.noMoreOffers});s.callSDKFunction(e,r),a.PubSub.publish("ProductStatesManager.stateResolved",[p.extendCallbackParamsWithProductConfig(d,{response:!1})]),A()}function F(){i()}function L(){A()}function x(){y(f.readyToShow)}function N(){S(f.readyToLoad),y(f.visible)}var U={init:I,show:P,cacheReady:T,noMoreOffers:O,failedToShow:F,failedToLoad:L,engageEnd:x,adVisible:N,loadWithADM:w,resetAdState:i};return U}n.exports=i},{}],133:[function(e,n,t){n.exports={NativePrefix:"NativeCallback",className:"ProductAdapter",adStates:{notSet:0,waitingToLoad:1,inLoadingProcess:2,internalLoadingProcess:3,loaded:4,loadedFromInternalLoad:5,visible:6,inShowingProcess:7,failedInBackground:8}}},{}],134:[function(_,e,n){function t(o,d,c,l,a,u,s){var e=_("./ProductAdapterConstants.js"),f=e.adStates,n=f.notSet,g=l.eventicsCategories,p=!1,v=!1,m=d.DemandUtils,b=!1,h=m.extendCallbackParamsWithDemandConfig(c),S=d.InstancesTimers;function y(e){return n===e}function A(e){n=parseInt(e,10)}function t(){return n}function C(){return A(f.notSet)}function i(){return y(f.loadedFromInternalLoad)||y(f.loaded)}function r(e,n,t){if(p)p=!1;else if(y(f.waitingToLoad))A(f.internalLoadingProcess);else{if(y(f.inLoadingProcess)||v||c.productType===a.BN&&y(f.loaded)){t.name===g.loadAdFailed.name&&n===a.errors.noFill&&(t=g.noFill);var i=jQuery.extend({},h);i=S.extendEventDataWithElapsedLoadTime(c.productType,c.demandSourceName,i),u.trackEvent(t,{callFailReason:n},i),S.clearLoadStartTimeForInstance(c.productType,c.demandSourceName);var r=m.extendCallbackParamsWithDemandConfig(c,{errMsg:l.errors.load.noMoreOffers});d.callSDKFunction(e,r),o.PubSub.publish("ProductStatesManager.stateResolved",[m.extendCallbackParamsWithProductConfig(c,{response:!1})])}v=!1,C()}}function D(e){if(s)if(e===s.load){if(y(f.inLoadingProcess)||y(f.waitingToLoad))return l.errors.load.duringLoad;if(y(f.visible)||y(f.inShowingProcess))return l.errors.load.duringShow}else if(e===s.show){if(y(f.notSet))return l.errors.show.notLoaded;if(y(f.inLoadingProcess)||y(f.waitingToLoad))return l.errors.show.duringLoad;if(y(f.visible)||y(f.inShowingProcess))return l.errors.show.visible}}function I(e,n){if(s)if(e===s.load)(y(f.inLoadingProcess)||y(f.waitingToLoad))&&d.log(D(s.load),d.LogLevels.error);else if(e===s.show)if(y(f.notSet)||E()||y(f.inLoadingProcess)){var t=m.extendCallbackParamsWithDemandConfig(c,{errMsg:D(s.show)});d.callSDKFunction(n,t)}else(y(f.visible)||y(f.inShowingProcess))&&d.log(D(s.show),d.LogLevels.error)}function w(e){var n=m.isLegacy(c)?{}:h;b=!0,d.callSDKFunction(e,n)}function P(e,n,t,i,r){c.productType!==a.BN?T(e,n,t,i):O(e,n,t,i)}function T(e,n,t,i){if(y(f.notSet)||y(f.loaded))A(f.inLoadingProcess),e(h,function(){},t);else if(y(f.loadedFromInternalLoad)){var r={timingvalue:d.InstancesTimers.stopLoadTimer(c.productType,c.demandSourceName)};r=S.extendEventDataWithElapsedLoadTime(c.productType,c.demandSourceName,r),u.trackEvent(g.loadAdSuccess,{},jQuery.extend({},h,r)),d.callSDKFunction(n,m.extendCallbackParamsWithDemandConfig(c,i)),A(f.loaded),S.clearLoadStartTimeForInstance(c.productType,c.demandSourceName),o.PubSub.publish("ProductStatesManager.stateResolved",[m.extendCallbackParamsWithProductConfig(c,{response:!0})])}else if(p||v){var a=p?l.errors.load.inStateVisibleOrInShowingProcess:l.errors.load.inLoadingStateOrWaitingToLoad;r=jQuery.extend({},h);r=S.extendEventDataWithElapsedLoadTime(c.productType,c.demandSourceName,r),u.trackEvent(g.loadAdIgnored,{callfailreason:a},r),S.clearLoadStartTimeForInstance(c.productType,c.demandSourceName)}else y(f.visible)||y(f.inShowingProcess)?p=!0:E()?v=!0:(u.trackEvent(g.loadAdFailed,{},jQuery.extend({},h,{callfailreason:D(s.load),timingvalue:d.InstancesTimers.stopLoadTimer(c.productType,c.demandSourceName)})),I(s.load))}function O(e,n,t,i){var r=function(){};if(y(f.notSet))A(f.inLoadingProcess),e(h,r,t);else if(y(f.loaded))A(f.notSet),e(h,void 0,t);else if(y(f.visible)||y(f.inShowingProcess))A(f.inLoadingProcess),e(h,r,t);else if(E())v=!0;else if(y(f.inLoadingProcess))u.trackEvent(g.bannerReloadDuringLoad,m.extendCallbackParamsWithDemandConfig(c));else{var a=jQuery.extend({},h,{callfailreason:D(s.load),timingvalue:d.InstancesTimers.stopLoadTimer(c.productType,c.demandSourceName)});u.trackEvent(g.loadAdFailed,{},a),I(s.load)}}function F(e,n,t,i,r){if(!b){var a="instance was not initiated",o=m.extendCallbackParamsWithDemandConfig(c,{errMsg:a}),s=jQuery.extend({},h,{callfailreason:a,timingvalue:d.InstancesTimers.stopLoadTimer(c.productType,c.demandSourceName)});return s=S.extendEventDataWithElapsedLoadTime(c.productType,c.demandSourceName,s),u.trackEvent(g.loadAdFailed,{},s),d.callSDKFunction(t,o),void S.clearLoadStartTimeForInstance(c.productType,c.demandSourceName)}if(y(E())){s=jQuery.extend({},h);return s=S.extendEventDataWithElapsedLoadTime(c.productType,c.demandSourceName,s),u.trackEvent(g.loadAdIgnored,{callfailreason:l.errors.load.inLoadingStateOrWaitingToLoad},s),d.log("productStateManager | loadWithADM | already in loading process",d.LogLevels.verbose),void S.clearLoadStartTimeForInstance(c.productType,c.demandSourceName)}A(f.inLoadingProcess),e(r,function(){},t)}function L(e,n,t){i()?(A(f.inShowingProcess),e(h,n,t)):(u.trackEvent(g.showAdFail,{callfailreason:D(s.show)},h),I(s.show,t))}function x(e,n){c.productType!==a.BN?N(e,n):U(e,n)}function N(e,n){var t=!1;if((y(f.inLoadingProcess)||v)&&(t=!0),v=!1,y(f.internalLoadingProcess)?A(f.loadedFromInternalLoad):A(f.loaded),t){var i=jQuery.extend({},h,{timingvalue:d.InstancesTimers.stopLoadTimer(c.productType,c.demandSourceName)});i=S.extendEventDataWithElapsedLoadTime(c.productType,c.demandSourceName,i),u.trackEvent(g.loadAdSuccess,{},i),S.clearLoadStartTimeForInstance(c.productType,c.demandSourceName),d.callSDKFunction(e,m.extendCallbackParamsWithDemandConfig(c,n)),o.PubSub.publish("ProductStatesManager.stateResolved",[m.extendCallbackParamsWithProductConfig(c,{response:!0})])}}function U(e,n){(y(f.inLoadingProcess)||y(f.visible)||v)&&(u.trackEvent(g.loadAdSuccess,{},{timingvalue:d.InstancesTimers.stopLoadTimer(c.productType,c.demandSourceName)}),u.trackTimingStart(g.bannerLoadSuccessToVisible),d.callSDKFunction(e,m.extendCallbackParamsWithDemandConfig(c,n)),o.PubSub.publish("ProductStatesManager.stateResolved",[m.extendCallbackParamsWithProductConfig(c,{response:!0})])),v=!1,A(f.loaded)}function M(e,n){r(e,n,g.loadAdFailed)}function V(e,n){r(e,n,g.loadAdFailed)}function E(){return y(f.waitingToLoad)||y(f.internalLoadingProcess)}function k(){C()}function B(){C()}function R(){c.productType===a.BN?j():K()}function K(){A(p?f.inLoadingProcess:f.waitingToLoad)}function j(){A(f.notSet)}function W(){A(f.visible)}function G(){return y(f.failedInBackground)}var H={getAdState:t,init:w,load:P,show:L,cacheReady:x,allOffersVast:M,noMoreOffers:V,failedToShow:k,failedToLoad:B,engageEnd:R,isFailedInBG:G,adVisible:W,loadWithADM:F,resetAdState:C};return H}e.exports=t},{"./ProductAdapterConstants.js":133}],135:[function(c,e,n){e.exports=function(a,o,i){"use strict";var e,n=c("./AdapterSharedConfig.js"),t=[],r=!1;function s(e){return o.RewardedVideo||(o.RewardedVideo=o.RewardedAdFactory.create({isManualLoadFlow:e.isManualLoadFlow}),o.BrandConnect=o.RewardedVideo,o.RewardedVideo.init()),o.RewardedVideo}function d(e){return e&&"true"===e.rewarded?s({isManualLoadFlow:!0}):(o.Interstitial||(o.Interstitial=o.InterstitialFactory.create(),o.Interstitial.init()),o.Interstitial)}return{initModule:function(){e||(t.push(a.PubSub.subscribe(i.CB+n.NativeAPI.init,function(e,n,t){var i,r;o.log("productRouter | NativeAPI.init"),(i=e)&&i.apiVersion&&(r=a.Utils.apiVersionCompareTo(i.apiVersion,"1")),0<r&&(n=t=function(){}),d(e).initProduct(e,n,t)})),t.push(a.PubSub.subscribe(i.CB+n.NativeAPI.load,function(e,n,t){o.log("productRouter | NativeAPI.load"),d(e).loadProduct(e,n,t)})),t.push(a.PubSub.subscribe(i.CB+n.NativeAPI.show,function(e,n,t){var i;(i=e,i&&"true"===i.rewarded?o.RewardedVideo:o.Interstitial).showProduct(e,n,t)})),t.push(a.PubSub.subscribe(i.CB+".initRewardedVideo",function(e,n,t){s({isManualLoadFlow:!1}).initRewardedVideo(e,n,t)})),t.push(a.PubSub.subscribe(i.CB+".showRewardedVideo",function(e,n,t){o.RewardedVideo.showRewardedVideo(e,n,t)})),t.push(a.PubSub.subscribe(i.CB+".initBrandConnect",function(e,n,t){s({isManualLoadFlow:!1}).initBrandConnect(e,n,t)})),t.push(a.PubSub.subscribe(i.CB+".showBrandConnect",function(e,n,t){o.RewardedVideo.showBrandConnect(e,n,t)})),t.push(a.PubSub.subscribe(i.CB+".initBanner",function(e,n,t){var i;!e||e.inAppBidding||r||(r=!0,o.initBannerExternalService()),(i=e,o.Banner||(o.Banner=o.BannerFactory.create(i),o.Banner.init()),o.Banner).initProduct(e,n,t)})),t.push(a.PubSub.subscribe(i.CB+".loadBanner",function(e,n,t){e.productType=i.BN,o.Banner.loadProduct(e,n,t)})),t.push(a.PubSub.subscribe(i.CB+".bannerViewVisible",function(e,n,t){o.Banner.showProduct(e,n,t)})),e=!0)},destroyListeners:function(){jQuery.each(t,function(e,n){a.PubSub.unsubscribe(n)}),e=!1},className:"ProductRouter"}}},{"./AdapterSharedConfig.js":99}],136:[function(d,e,n){e.exports=function(a,o){var s=d("../components/Constants.js");return{create:function(e){var n;if(!0===e.isManualLoadFlow){var t=d("./ProductAdapter.js"),i=d("./AdapterSharedConfig.js"),r=d("./RewardedVideo/RewardedAdConfiguration.js")(i,o.SupplyConfigurations,s);n=new t(a,o,r,s)}else n=new(d("./RewardedVideo/RewardedVideo.js"))(a,o);return n}}}},{"../components/Constants.js":12,"./AdapterSharedConfig.js":99,"./ProductAdapter.js":131,"./RewardedVideo/RewardedAdConfiguration.js":137,"./RewardedVideo/RewardedVideo.js":138}],137:[function(e,n,t){n.exports=function(e,n,t){var i=n.shouldFetchNewFeedOnAdCloseFlag(t.RV);return i=void 0===i||i,{NativeAPI:e.NativeAPI,ControllerCallbacks:e.ControllerCallbacks,AdUnitCallbacks:e.AdUnitCallbacks,ControllerNativeAPI:e.NativeAPI,retriesLogic:e.retriesLogic,DemandName:"SupersonicAds",ProductName:t.RV,Features:{allowMultiInitCalls:!0,reportOnAdunitReady:!0,shouldFetchNewFeedOnAdClose:i,isSupportFetchFeedOnAdCloseLogic:!0,preFetchAllVasts:!0,allowConsecutiveGatewayRequestsDuringLoad:!0,isExhaustInstanceAllowed:!0},gatewayDestinationMap:{prod:t.gatewayDestinationMap.RV.production},amountOfInventories:1,lwsSupported:!0}}},{}],138:[function(N,e,n){function t(i,d){"use strict";var c,n=!1,o=N("../../components/Constants.js"),e={preFetchAllVasts:!0,shouldFetchNewFeedOnAdClose:!1,isSupportFetchFeedOnAdCloseLogic:!1},l=o.RV,t={ProductName:l,Features:e,retriesLogic:{maxNumOfAttemptsToCallAPI:2,initAttemptsDelay:500,serverResponseTimeoutInMilis:1e4}},u=new(N("./../DemandSource/EventCategories.js"))(l),r=new(N("./../DemandSource/dsConfig.js"))(t,u),a=new(N("./../prdTaskManager.js"))(i,d,l,o),f,s={},g={},p;function v(n,t,i){if(!n||!n.demandSourceName)return f.trackEvent(u.initAdFail,{callFailReason:"Missing demand name on initiation"}),void d.callSDKFunction(i,{errMsg:"Missing demand name on initiation"});var e=d.getSDKLimitationData(l);if(e.didSucceed){var r=d.instancesManager.createUninitializedDemandInstance(l,n.demandSourceName,!1);C(r);var a=c[r.demandSourceName],o=a.initProduct.bind(null,n,function(e){e&&e.eventics&&(e.eventics.trackEvent(u.initAd),e.eventics.trackTimingStart(u.initAdToAdReady)),a.loadAd(n,t,i)},i),s=a.instanceOnHold;d.instancesManager.initiateDemandInstance(l,n.demandSourceName,o,s)}else A(n.demandSourceName,i,e)}function m(e,n,t){if(e&&e.demandSourceName){var i=F(e.demandSourceName);i?(y(i),d.AppOrientationManager.updateAppOrientationByNewRestriction(e.orientationRestriction),i.showAd(e,n,t)):d.callSDKFunction(t,{errMsg:"Error calling show, uninitialized product.",demandSourceName:e.demandSourceName})}else d.callSDKFunction(t,{errMsg:"Missing demand name on show."})}function b(n,t,i){if(d.isLegacy(d.featureMap.MDS[o.RV])){n||(n={}),n.demandSourceName=o.BC;var e=d.getSDKLimitationData(l);if(e.didSucceed){var r=d.instancesManager.createUninitializedDemandInstance(l,n.demandSourceName,!1);d.initEventics({productType:o.BC});var a=C(r);a.initProduct(n,function(e){e&&e.eventics&&(e.eventics.trackEvent(u.initAd),e.eventics.trackTimingStart(u.initAdToAdReady)),a.loadAd(n,t,i)},i)}else A(n.demandSourceName,i,e)}else d.callSDKFunction(i,{errMsg:"Unsupported API function, use initAds instead."})}function h(e,n,t){if(d.isLegacy(d.featureMap.MDS[o.RV])){var i=F(o.BC);i?(e||(e={}),e.demandSourceName=o.BC,y(i),i.showAd(e,n,t)):d.callSDKFunction(t,{errMsg:"Error calling show, uninitialized product."})}else d.callSDKFunction(t,{errMsg:"Unsupported API function, use showRewardedVideo instead."})}var S=function(){i.PubSub.subscribe(l+".exhaustedDemandSource",function(e){var n=e;I(e)&&n.demandSourceName&&c[n.demandSourceName]&&(c[n.demandSourceName].exhausted=!0,d.instancesManager.exhaustedDemandSource(l,n),e&&e.engaged||(d.log("Demand source deleted in BG: "+n.demandSourceName,d.LogLevels.verbose),delete c[n.demandSourceName]))}),i.PubSub.subscribe("SDKController.AdVisible",function(e){if(I(e)){a.publish("Engaged",[D({duringEngage:!0})]);var n=F(e.demandSourceName);n&&n.adVisible(e)}}),i.PubSub.subscribe("SDKController.onAdWindowsClosed",function(e){if(I(e)){var n=e.demandSourceName;n&&c[n]&&c[n].exhausted&&(d.log("Demand source deleted: "+n,d.LogLevels.verbose),delete c[n])}}),i.PubSub.subscribe("SDKController.engageEnd",function(e,n){if(I(e)){var t=F(e.demandSourceName);t&&t.engageEnd(e,function(){O(e.engaged),i.Utils.isFunction(n)&&n()})}}),i.PubSub.subscribe("SDKController.AdClicked",function(e){var n=d.getCurrentDisplayedAd();I(e)&&n&&"CPVI"===n.ext.type&&d.callSDKFunction("adClicked",{productType:l,demandSourceName:n.demandSourceName})}),i.PubSub.subscribe(l+".ActionClick",function(e){d.OpenURLService.open(e)||d.log(l+" failed to perform ActionClick",d.LogLevels.info)}),i.PubSub.subscribe(l+".failedToLoad",function(e){e&&e.demandSourceName&&f.trackEvent(u.initAdFail,{callFailReason:e.errMsg})})};function y(e){e.updateEventicsWithAdData(),e.getDSEventics().trackEvent(u.showAd),e.getDSEventics().trackTimingStart(u.showAdCalled)}function A(e,n,t){f.trackEvent(u.initAd,{callFailReason:t.errMsg,demandSourceName:e}),f.trackEvent(u.initAdFail,{callFailReason:t.errMsg,demandSourceName:e}),d.callSDKFunction(n,{errMsg:t.errMsg,demandSourceName:e})}function C(e){var n=e.demandSourceName;return c[n]||(c[n]=new(N("./../DemandSource/ProductInstance.js"))(i,d,o,e,r,null),c[n].init(),f=c[n].getDSEventics()),c[n]}function D(e){return(e=e||{}).productType=T(),e}function I(e){return e&&(e.productType===l||e.productType===o.BC)}function w(){var e=d.getProtocol();s={dev:e+o.gatewayDestinationMap.RV.production,stage:e+o.gatewayDestinationMap.RV.production,prod:e+o.gatewayDestinationMap.RV.production};var n,t,i=d.getApiData({destinationMap:0});if(i&&i.destinationMap)for(n in g=i.destinationMap)t=g[n],g[n]&&0<g[n].length&&-1===g[n].indexOf(e)&&(g[n]=e+t)}function P(e){return g&&g[e]?g[e]:s[d.getEnv()]}function T(){return p?o.BC:l}var O=function(e){e&&a.publish("Engaged",[{duringEngage:!1,productType:l}])};function F(e){return e?c[e]:(d.log("cannot extract demand source name from data",d.LogLevels.verbose),null)}function L(e){return c[e]?c[e].getConfirmCloseMsg():null}var x={name:"RewardedVideo",className:"RewardedVideo",init:function(){if(c=this,!n){var e={productChance:(d.getEnv(),1),baseData:{productType:l,integrationType:o.integrationType.automatic}};f=i.Eventics.createEventic(e,d.EventsManager),p=d.isLegacy(d.featureMap.MDS[o.RV]),S(),a.init(),w(),n=!0}},getProductType:T,getDestination:P,getProductTM:function(){return a},getConfirmCloseMsg:L,getAmountOfSupportedInventories:function(){return o.DEFAULT_AMOUNT_OF_INVENTORIES},doesAllowConsecutiveGatewayRequestsDuringLoad:function(){return!0},initRewardedVideo:v,showRewardedVideo:m,initBrandConnect:b,showBrandConnect:h};return c=x,x}e.exports=t},{"../../components/Constants.js":12,"./../DemandSource/EventCategories.js":112,"./../DemandSource/ProductInstance.js":119,"./../DemandSource/dsConfig.js":120,"./../prdTaskManager.js":167}],139:[function(e,n,t){n.exports=function(e,n,d,t,f){var g=t.eventicsCategories,i=t.responseTypesWithReason,p={};function r(e){e&&"RewardedVideo"===t.productType&&n.DemandUtils&&!n.DemandUtils.isManualRewardedVideoIntegration()&&f.trackEvent(g.noMoreOffers,{callFailReason:e}),d.publishAvailabilityFalse("NoMoreOffers",e)}function v(e,n){return p.preFetchAllVasts&&n||p.isPreCache&&e}function m(e,n,t,i,r,a,o){v(e,o)?(n(),r()):p.reportOnAdunitReady&&p.isPreCache&&0!==a||r()}function c(e,n){r(e),n()}function l(e,n){c(e,n)}function b(e){n.log("Availability Manager | reportAdAvailable",n.LogLevels.verbose),a(i.ready)||(a(i.none)&&f.trackTimingStop(g.adReady,{eNameStart:g.initAdToAdReady}),d.publishAvailabilityTrue(e))}function a(e){return d.isCurrentState(e)}function o(e,n){if(p.forcePreload)return d.reportNotInInit();p.reportOnAdunitReady&&p.isPreCache&&0!==p.numOfBannersToInitSuccess?d.reportNotInInit():b({numOfAdUnits:e,totalNumberCredits:n})}return{setAMSettings:function(e,n){e&&"object"==typeof e&&(n?jQuery.extend(p,e):p=e)},cacheAdsFailed:function(e,n,t,i){e&&n?i():r(t)},cacheUpdate:function(e,n,t,i){0===e?r("Cache updated with zero campaigns"):n&&t&&i()},cacheTimeoutFail:function(e){r(e)},canReportAvailable:function(e,n,t,i){v(t,i)||o(e,n)},adLoadError:function(){r("Ad loaded with error")},inventoryEmpty:function(e){r(e)},engageEnd:function(e,n,t,i,r,a,o,s){e?l(r,a):(v(n,s)&&d.publishAvailabilityFalse("AllOffersVast",r),t||!p.isPreCache&&!i||(p.shouldRefreshInventory?o(r):c(r,a)))},reportBasedOnVast:m,shouldValidateVast:v,isCurrentState:a,preLoadNext:function(e,n,t){v(e,t)&&n()},allVastPromiseResolved:function(e,n){o(e,n)},notPreCacheMode:function(e){e()},preCacheMode:function(e,n,t,i,r,a,o,s){if(e&&f.trackEvent(g.campaignsAvailableFromCache),0===p.numOfBannersToInitSuccess)return d=t,c=o,l=r,u=a,v(i,s)?l():b({numOfAdUnits:u,totalNumberCredits:c}),void d();var d,c,l,u;e?t():0===n&&m(i,r,0,0,t,n,s)},reportAdAvailable:b,reset:function(){d.setLastResponse(i.none),p={}},adLoadedSuccessfully:function(e){p.forcePreload?b(e):(p.reportOnAdunitReady||p.preFetchAllVasts)&&p.isPreCache&&b(e)},instanceOnHold:function(){r("Instance on hold")},instanceReachCapping:function(e,n){l(e,n)},adClosedMovingToNextAd:function(e,n){v(e)&&d.publishAvailabilityFalse("AllOffersVast",n)},sessionOver:function(e,n){c(e,n)}}}},{}],140:[function(e,n,t){n.exports=function(t,e,i,r,n){var a=i.responseTypesWithReason,o=a.none,s=e.DemandUtils;function d(e){return o===e}function c(e,n){t.PubSub.publish(i.productType+"."+e,[s.extendCallbackParamsWithParentProductConfig(r,n)])}function l(){n.publish("InitiatedAPICall",[s.extendCallbackParamsWithProductConfig(r,{duringInit:!1})])}return{setLastResponse:function(e){o=e},getLastResponse:function(){return o},publishAvailabilityTrue:function(e){l(),d(a.ready)||(c("CacheReady",jQuery.extend(e,{firstCampaignCredits:1})),o=a.ready)},publishAvailabilityFalse:function(e,n){l(),d(a.notReady)||("NoMoreOffers"===e||"AllOffersVast"===e&&d(a.ready))&&(c(e,{numOfAdUnits:0,firstCampaignCredits:0,totalNumberCredits:0,errorMsg:n}),o=a.notReady)},isCurrentState:d,reportNotInInit:l}}},{}],141:[function(e,n,t){n.exports=function(t,n,i,r){var a,e=!1,o=!1,s=!1,d=!1,c=!1,l=!1;function u(e){return e&&e.productType===i.productType&&(!i.demandSourceName||e.demandSourceName===i.demandSourceName)}return{init:function(){e||(t.PubSub.subscribe(r.taskManager+".InitiatedAPICall",function(e){u(e)&&t.Utils.isDefined(e.duringInit)&&(o=e.duringInit)}),t.PubSub.subscribe(r.taskManager+".AdErrorState",function(e){u(e)&&t.Utils.isDefined(e.error)&&(c=e.error)}),t.PubSub.subscribe(r.taskManager+".Engaged",function(e){u(e)&&t.Utils.isDefined(e.duringEngage)&&(s=e.duringEngage,n.log("duringEngage "+s+" on demand "+i.demandSourceName,n.LogLevels.verbose))}),t.PubSub.subscribe(r.taskManager+".CacheUpdateStatus",function(e){u(e)&&t.Utils.isDefined(e.duringCacheUpdate)&&(d=e.duringCacheUpdate)}),t.PubSub.subscribe(r.taskManager+".InitiatedTimeoutAttempt",function(e){u(e)&&t.Utils.isDefined(e.duringAPITimeoutAttempts)&&(l=e.duringAPITimeoutAttempts)}),e=!0,a=n[i.productType].getProductTM())},canEngage:function(){return!o&&!s&&a.canEngage()},canPreload:function(){var e=!c&&!o&&a.isConnected();return i&&i.isInAppBidding||(e=e&&!s),e},canInitCallToApi:function(){return s||o||d||!a.isConnected()?t.Utils.returnRejectedPromise():a.canInitCallToApi()},allowExternalCallToApi:function(){return!l},setConnection:function(e){return a.setConnection(e)},getStatusMsg:function(){return" duringInit:"+o+" duringEngage:"+s+" duringCacheUpdate:"+d+" error state:"+c+" during timeout attempts:"+l+a.getStatusMsg()},getStatus:function(){return{duringInit:o,duringEngage:s,duringCacheUpdate:d,adErrorState:c,timeoutAttempts:l,isConnected:a.isConnected()}},publish:function(e,n){t.PubSub.publish(r.taskManager+"."+e,n)}}}},{}],142:[function(t,e,n){e.exports=function(n,e,s,d){var c=t("./configurationValidator.js")(s,d.DebugLevels,d.errors),l=function(){var t=!0;return e.each(n.mobileSDKSettings,function(e,n){return e.match(/^deviceIds/)&&s.isDefined(n)&&n&&(t=!1),t}),t};return{parseConfiguration:function(e,n,t){var i,r,a=[],o=n.length;for(r=0;r<o;r++)s.isDefined(e[n[r]])||("applicationUserId"!==n[r]||l())&&a.push(n[r]);return 0<a.length?{didSucceed:(i={errMsg:d.errors.missing+JSON.stringify(a)},!1),errMsg:i}:c(e,t)},getDeviceApiLevel:function(){var e=n.mobileSDKSettings.deviceApiLevel;return"android"!==n.mobileSDKSettings.deviceOs||e?"ios"!==n.mobileSDKSettings.deviceOs||e||(e=n.mobileSDKSettings.deviceOSVersion.split(".")[0]):e=n.mobileSDKSettings.deviceOSVersion,e},getDeviceOsVersion:function(){var e=n.mobileSDKSettings.deviceOSVersion;return"android"===n.mobileSDKSettings.deviceOs&&(e=n.mobileSDKSettings.deviceApiLevel?n.mobileSDKSettings.deviceOSVersion:""),e}}}},{"./configurationValidator.js":150}],143:[function(e,n,t){n.exports=function(){return{adVisibleToClose:{name:"adVisibleToClose",id:-5},adClosed:{name:"adClosed",id:100},OWClosed:{name:"OWClosed",id:104},getExternalApplicationConfigurationError:{name:"getExternalApplicationConfigurationError",id:136},openUrlError:{name:"openUrlError",id:114},failedToStartStoreActivity:{name:"failedToStartStoreActivity",id:209},cdnABTestSuccess:{name:"cdnABTestSuccess",id:223},cdnABTestFail:{name:"cdnABTestFail",id:224},cdnABTestException:{name:"cdnABTestException",id:225},latencyTestSuccess:{name:"latencyTestSuccess",id:244},latencyTestFail:{name:"latencyTestFail",id:245},latencyTestException:{name:"latencyTestException",id:246},userClosedBeforeAdVisible:{name:"userClosedBeforeAdVisible",id:151},controllerException:{name:"controllerException",id:153},mismatchAdLoadError:{name:"mismatchAdLoadError",id:206},dialogBoxExit:{name:"dialogBoxExit",id:155},dialogBoxResume:{name:"dialogBoxResume",id:156},updateTokenFail:{name:"updateTokenFail",id:184},globalsInOldFormat:{name:"globalsInOldFormat",id:274},unauthorizedMessage:{name:"unauthorizedMessage",id:268},omidServiceFailure:{name:"omidServiceFailure",id:270},removeContainerError:{name:"removeContainerError",id:190},linkActivationOnAd:{name:"linkActivationOnAd",id:324},auidFail:{name:"auidFail",id:197},patchOrientation:{name:"patchOrientation",id:343},initFailed:{name:"initFailed",id:344}}}},{}],144:[function(e,n,t){n.exports=function(){var a={},o="loadTimer",r={};function s(e,n){return e&&n?e+"."+n:null}function d(e,n){var t=s(e,n);return r.hasOwnProperty(t)?{timeElapsed:Date.now()-r[t],columnName:"custom_c"}:{timeElapsed:Date.now(),columnName:"custom_d"}}return{startLoadTimer:function(e,n){var t=s(e,n);t&&(a.hasOwnProperty(t)?a[t][o]&&window.timerService.stopTimer(a[t][o]):a[t]={},a[t][o]=window.timerService.startTimer())},stopLoadTimer:function(e,n){var t=s(e,n);if(!(t&&a[t]&&a[t][o]))return-1;var i=a[t][o],r=window.timerService.stopTimer(i);return delete a[t][o],r},clearInstanceTimers:function(e,n){var t=s(e,n);if(t&&a[t]){var i=a[t];for(var r in i)i.hasOwnProperty(r)&&window.timerService.stopTimer(i[r]);delete a[t]}},setLoadStartTimeForInstance:function(e,n,t){var i=s(e,n);!r.hasOwnProperty(i)&&t&&(r[i]=t)},getTimeElapsedFromLoadForInstance:d,clearLoadStartTimeForInstance:function(e,n){var t=s(e,n);r.hasOwnProperty(t)&&delete r[t]},extendEventDataWithElapsedLoadTime:function(e,n,t){var i=d(e,n);return t[i.columnName]=i.timeElapsed,t}}}},{}],145:[function(e,n,t){n.exports=function(n){var t="LoadedCreatives | ",i=n.AdUtils,r=[];function a(e){return e?void 0!==c(i.getAdId(e),e):(l("in _isExistAd without ad"),!1)}function o(){return r.length}function s(e,n){return e.productType===n.productType&&(!n.demandSourceName||e.demandSourceName===n.demandSourceName)}function d(n,t){return function(e){return s(e,t)&&i.getAdId(e)==n}}function c(e,n){var t=d(e,n),i=r.filter(t);return 0<i.length?i[0]:void 0}function l(e){n.log(t+e)}return{isExistAd:a,addAd:function(e){return l("_addAd"),e?a(e)?(l("_addAd ad already exist"),!1):(r.push(e),!0):(l("_addAd ad is undefined"),!1)},removeAdById:function(e,n){l("_isExistAd adId = "+e);var t=d(e,n),i=o();return r=r.filter(function(e){return!t(e)}),i!==o()},getAdById:c,getAds:function(n){return r.filter(function(e){return s(e,n)})},getAdsByProductType:function(n){return r.filter(function(e){return e.productType===n.productType})},size:o,toArray:function(){return r.slice()},printAll:function(){r.forEach(function(e){n.log("adViewId "+e.adViewId)})}}}},{}],146:[function(n,e,t){e.exports=function(e,r){var a=n("../DemandSource/DemandEntityBuilder.js"),o=e&&e.instancesMap,s=e&&e.waterfallMap;return{createDemandEntityConfigObj:function(e){var n=function(e,n){var t=o&&o[r.sspProductNames[e]];if(t)for(var i=0;i<t.length;i++)if(-1!==t[i].instances.indexOf(n))return{demandGroupName:t[i].demandGroupName,isInstance:!0}}(e.productType,e.demandSourceName)||{},t=!0===n.isInstance?r.demandSourceType.instance:r.demandSourceType.demandSource,i={demandGroupName:n.demandGroupName,demandSourceName:e.demandSourceName,demandType:t,isInAppBidding:e.isInAppBidding,integrationType:r.integrationType.manual,demandSourceId:e.demandSourceId,waterfallPosition:function(e,n){var t=s&&s[r.sspProductNames[e]];if(t)return t[n]}(e.productType,e.demandSourceName),originalDemandSourceName:e.originalDemandSourceName,adSize:e.adSize};return new a({productType:e.productType},i)}}}},{"../DemandSource/DemandEntityBuilder.js":111}],147:[function(e,n,t){n.exports=function(i,r,a,o){var s="$$",d="MSFAPI";return{handler:function(e){return!!((n=e)&&"string"==typeof n.data&&0<n.data.length)&&(0===e.data.indexOf(s)?function(e){var n=e.slice(s.length);if(!n)return!1;var t=a.getParams(n);return a.isDefined(t.event)?(r.log("received event: "+t.event,r.LogLevels.verbose),i.publish("SDKController."+t.event,[t]),!0):a.isDefined(t.name)&&a.isDefined(t.parameters)?(r.log("received event: "+t.name,r.LogLevels.verbose),i.publish("SDKController."+t.name,[t.parameters]),!0):void 0}(e.data):-1!==e.data.indexOf(d)?(t=e.data,r.log("MOAT message was fired: "+t.toString(),r.LogLevels.verbose),!0):function(n){try{var e=JSON.parse(n);return a.extend(e.arguments,{callback:o(e.id)}),i.publish("SDKController."+e.method,[e.arguments]),!0}catch(e){r.log("SDKController | unable to parse message: "+JSON.stringify(n),r.LogLevels.error)}return!1}(e.data));var n,t}}}},{}],148:[function(yi,e,n){function G(p,v,m){var b="SDKController | ",o=yi("../../patches/PatchAppOrientation"),i=yi("./MessageHandler"),l=yi("../../presenter/uiConfig.js"),t=yi("../../components/Logger.js")(p.Utils),r=yi("../AdUnitManager/AdUnitGlobals.js")(m),e=yi("../AdUnitManager/LibsManager.js")(p.Utils),n=yi("../../components/DisplayedAdManager.js"),a=yi("../AdUnitUrl.js")(r,p.Utils),s=yi("./mainConfig.js")(),d=new(yi("../../components/ExternalConfig")),c=yi("./instancesManager.js")(p,m),u=new(yi("../../components/BlacklistService"))(m),h=new(yi("../../components/FrameHelper.js"))(t,v),f=yi("./ConfigurationHelper.js"),g=yi("../../components/AdOrientationManager"),S=yi("../../components/containers/WebViewManager.js"),y=yi("../../components/containers/AdViewsManager.js"),A=yi("../../components/containers/BannerExternalContainer.js"),C=yi("./sessionConfig")(),D=yi("../../components/NativeLifeCycleEventsConstants.js"),I=new(yi("../../components/NotchFactory.js"))(v,m),w=yi("../../components/token/TokenService.js"),P=yi("../UserSegmentation/SegmentationManager"),T=yi("../UserSegmentation/SegmentationAllocator.js"),O=yi("../../components/NativeAPIAdapter.js"),F=yi("../../constants/SDKFeatureNames"),L,x,N,U,M,V,E,k,B,R,K,j,W,G,H,_,q=!1,J,Q,z=p.Utils,X=p.PubSub,$=null,Y,Z=!1,ee=!0,ne=!1,te=m.CB,ie=m.BC,re=m.RV,ae=m.OW,oe=m.IS,se=m.BN,de=m.errors,ce=m.videoStates,le=m.closeButtonStates,ue=m.featureCompatibilityMap,fe=m.confirmCloseMsg,ge=m.requiredDeviceInfo,pe=m.requiredAppInfo,ve=m.optionalAppInfo,me={v:"3.0.119",controllerbn:"362",controllerId:(new Date).getTime()+"_"+Math.random(),controllerTimeLoaded:(new Date).getTime(),mobileSDKSettings:{protocol:null,defaultProtocol:null,securedProtocol:null,domain:null,overrideDebug:!1,defaultDebug:0,debug:0,appOrientation:null,mobileCarrier:null,connectionType:null,iphoneAppOnIpadDevice:null,deviceOs:"",SDKVersion:null,deviceOSVersion:null,deviceApiLevel:null,bundleId:null,deviceOEM:null,deviceScreenScale:null,"deviceScreenSize[width]":null,"deviceScreenSize[height]":null,"deviceIds[OpenUDID]":null,"deviceIds[IFA]":null,"deviceIds[IDFV]":null,"deviceIds[SERIAL]":null,"deviceIds[AndroidID]":null,"deviceIds[IMEI]":null,"deviceIds[AID]":null,deviceWidthDP:null,deviceHeightDP:null,deviceLanguage:null,deviceModel:null,diskFreeSize:null,geoLocation:null,isLimitAdTrackingEnabled:null,unLocked:null,gpi:null,webviewType:null,allowArbitraryLoads:null,allowArbitraryLoadsInWebContent:null,mcc:null,mnc:null,appVersion:null,batteryLevel:null,safeAreaInsets:null},applicationSettings:{preCache:"device",applicationKey:null,applicationUserId:null,numOfCampaigns:null,campaignId:null,pageSize:null,landingId:null,page:null,applicationUserGender:null,applicationUserAgeGroup:null,applicationUserCreationDate:null,applicationUserCreationDateSignature:null,useClientSideCallbacks:null,SDKPluginType:null,disableCache:null,showDeliveryLimitationsLog:null,country:null,admin:null,placementId:null,consent:null,moatSupported:null,skd:null},configMapping:{jb:function(){return me.mobileSDKSettings.unLocked}},controllerConfig:{fpf:null,destinationMap:null,isSecured:null,segmentId:null,segmentName:null,instancesMap:null,abt:null,waterfallMap:null},userType:SuperSonicGlobalConfig.userType},be={localTime:function(){return(new Date).getTime()},timezoneOffset:function(){return(new Date).getTimezoneOffset()}},he="mobileController.min.css",Se=SuperSonicGlobalConfig.mobileSDKSettings.isProd?"/versions/"+me.v+"/"+he:me.v+"/"+he,ye,Ae,Ce,De,Ie,we,Pe,Te=!1,Oe=!1,Fe=0,Le=3,xe,Ne={defaultBehavior:0,adunitResponsibility:1},Ue={close:1,nextFrame:2},Me=m.defaultOrientation,Ve={none:0,device:1,controller:2},Ee=l.style.defaultControlFrames,ke=m.blockedProductsPerApiLevel,Be=m.storeSearchKeys,Re={scrollHeight:""},Ke={BrandConnect:{},RewardedVideo:{},Interstitial:{},OfferWall:Ne.defaultBehavior,Banner:Ne.defaultBehavior},je={BrandConnect:{},RewardedVideo:{},Interstitial:{},OfferWall:le.close,Banner:le.closeBanner},We={BrandConnect:le.close,RewardedVideo:le.close,Interstitial:le.close,OfferWall:le.close,Banner:le.closeBanner},Ge={cdns:[{cdnName:"a.akamaihd.net",assets:["https://akm.ssacdn.com/users/cdn/jsonFile.json","https://akm.ssacdn.com/users/cdn/videoFile.mp4","https://akm.ssacdn.com/users/cdn/imgFile.png"]},{cdnName:"cncn.ssacdn.com",assets:["https://cncn.ssacdn.com/users/cdn/jsonFile.json","https://cncn.ssacdn.com/users/cdn/videoFile.mp4","https://cncn.ssacdn.com/users/cdn/imgFile.png"]},{cdnName:"itcn.ssacdn.com",assets:["https://itcn.ssacdn.com/users/cdn/jsonFile.json","https://itcn.ssacdn.com/users/cdn/videoFile.mp4","https://itcn.ssacdn.com/users/cdn/imgFile.png"]}]},He=[{url:"https://pm-gateway.supersonicads.com/test",method:"GET",region:"all"},{url:"https://init.supersonicads.com/admin/healthCheck",method:"GET",region:"all"},{url:"https://ow-gateway.supersonicads.com/delivery/mobilePanel.php",method:"GET",region:"all"}],_e,qe,Je=!1,Qe=m.appExtConfigPath,ze=m.appExtConfigPathStaging,Xe=Math.floor(100*Math.random()),$e=!1,Ye=l.templates.mainDefaultTemplate,Ze=l.templates.defaultDialogBoxTemplate,en=l.templates.defaultNavigationTemplate,nn=l.templates.loaderOWTemplate,tn=l.templates.loaderOWOfferTemplate,rn=p.Eventics,an=yi("../../modules/SDKController/EventCategories")(),on=function(e,n){var t=j.getDisplayedAdType(),i={productType:"UnKnown",action:"stopTiming",eventParam:{eName:an.adClosed,data:{eNameStart:an.adVisibleToClose}}};if(n&&n.customData&&n.customData.click&&v.extend(i.eventParam.data,n.customData.click),e&&(i.eventParam.data.generalMessage=e),t){t===m.OW&&(i.eventParam.eName=an.OWClosed),i.productType=t;var r=j.getDisplayedAdDemandName();r&&(i.demandSourceName=r);var a={productType:i.productType,demandSourceName:i.demandSourceName};n&&n.customData&&"object"==typeof n.customData&&v.extend(a,n.customData),a.ad=j.get(),X.publish("SDKController.Analytics",[i]),X.publish("SDKController.adClosed",[a])}else X.publish("SDKController.Analytics",[i])},sn=function(e,n,t,i){var r,a=e.length,o=!0,s=[],d=null;for(r=0;r<a;r++)z.isDefined(n[e[r]])||(s.push(e[r]),o=!1);return o||(d=de.missing+JSON.stringify(s)+" in "+t,z.isDefined(i)&&i&&J.callSDKFunction(i,{errMsg:d}),J.log(d,J.LogLevels.error)),{didSucceed:o,errMsg:d}},dn=function(){v.fn.textfill2=function(e){var n,t,i=e.maxFontPixels,r=e.maxHeight,a=e.maxWidth,o=void 0!==e.parentContainer?v(e.parentContainer):null,s=v(this),d=null!==o?o.height():v(this).parent().height(),c=null!==o?o.width():v(this).parent().width();return void 0!==r&&(d=r),void 0!==a&&(c=a),s.each(function(){for(i=e.maxFontPixels;v(this).css({"font-size":i}),i-=1,e.lineHeight&&o.css({"line-height":e.lineHeight+"em"}),n=v(this).height(),t=v(this).width(),d<n||c<t&&3<i;);}),this},v.fn.textWidth=function(){var e,n=v(this).children(),t=v('<span style="display: inline-block;" />');return n.wrap(t),e=n.parent().width(),n.unwrap(),e}},cn=function(){X.subscribe(te+".initProducts",function(e,n,t){v.when(Cn(e)).then(function(){"use strict";z.isDefined(n)&&J.callSDKFunction(n),Dn(e)},function(e){"use strict";z.isDefined(t)&&J.callSDKFunction(t,{errMsg:e})})}),X.subscribe(te+".nativeNavigationPressed",function(){if(j.isDisplayed()){var e=j.getDisplayedAdType(),n=j.getDisplayedAdDemandName();ne||((n?Ke[e][n]:Ke[e])===Ne.adunitResponsibility?Un({name:"backButtonPressed"}):zn())}}),X.subscribe(te+".engageEnd",function(e){if(!fn())if("forceClose"===e.action)on(),Wn(!1,!1),G.onEngageEnd();else if("secondaryClose"===e.action){var n=j.getDisplayedAdType();B.returnFromNavigationMode(Pn,Re,n,On),n===ae&&X.publish("SDKController.AdClosed",[j.get()])}}),X.subscribe(te+".failedToStartStoreActivity",function(e){if(e){J.log("failedToStartStoreActivity | params: "+JSON.stringify(e),J.LogLevels.info);var n={};n.rvnomoreoffersreason=decodeURIComponent(e.url);var t=j.getDisplayedAdType();t&&(n.productType=t),De.trackEvent(an.failedToStartStoreActivity,{generalMessage:decodeURIComponent(e.errMsg)},n)}}),X.subscribe(te+".interceptedUrlToStore",function(e){j.isDisplayed()&&Un({name:"interceptedUrlToStore",intercept:!0})}),X.subscribe(te+".pageFinished",function(){Un({name:"pageFinished"})}),X.subscribe(te+".enterBackground",function(e){J.log("entered BG");var n={name:"enterBackground"};e&&z.isDefined(e.action)&&(n.action=e.action),Un(n)}),X.subscribe(te+".enterForeground",function(e){var n=k.getContainerState();J.log("entered FG | webview is "+JSON.stringify(n));var t={name:"enterForeground"};e&&z.isDefined(e.active)&&(t.active=e.active),n.engaged&&n.opened&&me.mobileSDKSettings.deviceOs===m.deviceOs.android&&!n.standalone&&(j.isDisplayed()&&on(),Wn(!1,!1)),Un(t)}),X.subscribe(te+".viewableChange",function(e){var n={name:"viewableChange"};if(e&&z.isDefined(e.isViewable)){var t=j.getDisplayedAdType();if("Banner"===t&&(e.changeReason===m.viewableChangeReasons.storeKitClose||e.changeReason===m.viewableChangeReasons.storeKitOpen))return void J.log("viewableChange from Banner storeKit - ignored",J.LogLevels.info);if(Te=e.isViewable,J.StoreKitService.isStoreKitVisible()&&(Un({name:"viewableChangeInSK",isViewable:Te}),Te))return;J.log("viewableChange to:"+e.isViewable),z.isDefined(e.webview)&&"main"!==e.webview||k.setContainerVisibility(e.isViewable),n.isViewable=e.isViewable,j.isDisplayed()&&_n(),z.isDefined(e.webview)&&(n.webview=e.webview),t&&(n.productType=t),e.changeReason&&(n.changeReason=e.changeReason)}Un(n),e&&z.isDefined(e.isViewable)&&k.triggerRedraw()}),X.subscribe(te+".deviceStatusChanged",function(e){var n=v.extend({name:"deviceStatusChanged"},e);Un(n),p.Utils.isDefined(e.connectionType)&&(rn.updateBaseData({connectionType:e.connectionType}),ee="none"!==e.connectionType&&"notReachable"!==e.connectionType)}),X.subscribe(te+".parseBandwidth",function(e){J.log(JSON.stringify(e),3)}),X.subscribe(te+".getBandwidthFailed",function(e){J.log(JSON.stringify(e),3),J.log("getBandwidth Failed",J.LogLevels.error)}),X.subscribe(ie+".CacheReady",function(e){J.log("Succeeded to init BC with:"+JSON.stringify(e),J.LogLevels.info),J.callSDKFunction("adUnitsReady",e)}),X.subscribe(ie+".NoMoreOffers",function(e){J.log("BC currently has no more offers",J.LogLevels.info),J.callSDKFunction("adUnitsReady",e)}),X.subscribe(re+".CacheReady",function(e){J.log("Succeeded to init BC with:"+JSON.stringify(e),J.LogLevels.info),J.callSDKFunction("adUnitsReady",e)}),X.subscribe(re+".NoMoreOffers",function(e){J.log("BC currently has no more offers",J.LogLevels.info),J.callSDKFunction("adUnitsReady",e)}),X.subscribe(re+".AllOffersVast",function(e){J.log("RV rest of the feed is Vast",J.LogLevels.info),J.callSDKFunction("adUnitsReady",e)}),X.subscribe(oe+".CacheReady",function(e){J.log("Succeeded to init IS with:"+JSON.stringify(e),J.LogLevels.info),J.callSDKFunction("adUnitsReady",e)}),X.subscribe(oe+".NoMoreOffers",function(e){J.log("IS currently has no more offers",J.LogLevels.info),J.callSDKFunction("adUnitsReady",e)}),X.subscribe("SDKController.GetConfig",function(e){e&&e.productType&&X.publish(e.productType+".GetConfig",[e])}),X.subscribe("SDKController.GetCompletionOffers",function(e){e&&e.productType&&X.publish(e.productType+".GetCompletionOffers",[e])}),X.subscribe("SDKController.ActionClick",function(e){e&&e.productType&&X.publish(e.productType+".ActionClick",[e])}),X.subscribe("SDKController.OpenUrl",function(e){sn(["url","method"],e,"openUrl").didSucceed?(J.log("Request to open external url",J.LogLevels.info),Tn(e)):J.log("error calling open url with "+JSON.stringify(e),J.LogLevels.error)}),X.subscribe("SDKController.nativePixel",function(e){sn(["url"],e,"nativePixel").didSucceed?(J.log("Request to send click in native api",J.LogLevels.info),ni(e.url)):J.log("error sending safe click "+JSON.stringify(e),J.LogLevels.error)}),X.subscribe("SDKController.FirePixel",function(e){sn(["url"],e,"FirePixel").didSucceed?(J.log("Request to fire pixel from controller",J.LogLevels.info),"native"===e.type&&ni(e.url)||ti(e)):J.log("error firing pixel "+JSON.stringify(e),J.LogLevels.error)}),X.subscribe("SDKController.adEventNotification",function(e){J.log("ad notified controller with event: "+JSON.stringify(e),J.LogLevels.info),J.isLegacy(ue.postAdEventNotification)?J.log("postAdEventNotification on legacy SDK version",J.LogLevels.info):sn(["eventName","productType","dsName"],e,"adEventNotification").didSucceed&&ii(e.eventName,e.productType,e.dsName,e.extData)}),X.subscribe("SDKController.hideClose",function(e){var n=Y.getAdById(J.AdUtils.getAdId(e),e);if(n){var t=k.getAdViewByAd(n);t.data("close",!1),k.isViewDisplayed(t,n)&&In()}else J.log("line[1196]: ERROR",J.LogLevels.error)}),X.subscribe("SDKController.AdClose",function(e){e.ignoreClick?Zn():zn(e)}),X.subscribe("SDKController.closeAdunit",function(e){on(),Wn(!1)}),X.subscribe("SDKController.setBackButtonState",function(e){if(e&&e.state&&e.productType){var n="default"===e.state?Ne.defaultBehavior:Ne[e.state];e.demandSourceName?Ke[e.productType][e.demandSourceName]=n:Ke[e.productType]=n}}),X.subscribe("SDKController.setCloseButtonState",function(e){Gt(e)}),X.subscribe("SDKController.ScrollHeight",function(e){var n,t,i;p.Utils.isDefined(e.value)&&(n=e.value,J.log("scroll height is: "+n,J.LogLevels.info),v.when(Xn()).then(function(e){i=j.getDisplayedAdType(),t=i&&"application"===Me[i]&&V.isAppOrientation("portrait")?Math.max(e.height,e.width):i&&z.isDefined(i)&&"application"===Me[i]&&V.isAppOrientation("landscape")?Math.min(e.height,e.width):e.height,n<t&&(n=t),J.log("min scroll height is: "+t+"scroll height was set to: "+n+" screen height: "+e.height,J.LogLevels.verbose),Re.scrollHeight=n,me.mobileSDKSettings.deviceOs!==m.deviceOs.android&&v("body").css("height",Re.scrollHeight)}))}),X.subscribe("SDKController.scrollTop",function(){J.log("scrollTop",J.LogLevels.verbose),setTimeout(function(){v("html,body").scrollTop(0)},1e3)}),X.subscribe("SDKController.getScreenSize",function(){v.when(Xn()).then(function(e){Un({name:"screenSize",width:e.width,height:e.height,orientation:e.orientation,scrollTop:e.scrollTop})})}),X.subscribe("SDKController.showNoConnectionMessage",function(){var e={productType:ae,message:"You are not connected to the internet, please connect and try again.",yes:"close",no:"OK"};J.alert(e)}),X.subscribe("SDKController.GetDeviceVolume",function(e){z.isDefined(e.callback)&&Bt(e.callback)}),X.subscribe(D.serviceCallback+"."+D.AndroidEvents.onDestroy,function(e){J.log("SDKController | received event | onDestroy",J.LogLevels.verbose),fn()?J.log("SDKController | onDestroy - shouldAvoidHandleFrameClose, with params: "+JSON.stringify(e),J.LogLevels.verbose):gn()}),X.subscribe(m.CB+".unauthorizedMessage",function(e){De.trackEvent(an.unauthorizedMessage,{generalMessage:JSON.stringify(e)}),J.log("SDKController | Failed to authorize message",J.LogLevels.error)}),X.subscribe(m.CB+".linkActivationOnAd",function(e){e&&e.url&&De.trackEvent(an.linkActivationOnAd,{generalMessage:e.url})}),X.subscribe("SDKController.onOmidServiceFailure",function(e){De.trackEvent(an.omidServiceFailure,{generalMessage:e})}),X.subscribe("SDKController.removeContainerError",function(e){e&&e.errMsg&&De.trackEvent(an.removeContainerError,{callFailReason:e.errMsg})})};function ln(){H=yi("./videoStateHandler.js")(p.PubSub,J),_=yi("./nativeConfigHandler.js")(p.PubSub,J)}function un(){var e={productChance:(J.getEnv(),1),protocol:me.mobileSDKSettings.protocol?me.mobileSDKSettings.protocol:"https:",baseData:{productType:"controller"}};De=rn.createEventic(e,J.EventsManager)}function fn(){var e=qt(j.get());return!e||!p.Utils.isFunction(e.shouldAvoidHandleFrameClose)||e.shouldAvoidHandleFrameClose()}function gn(){J.log("SDKController.js | handleFrameDestroyed",J.LogLevels.verbose),j.isDisplayed()&&on(m.adClosedErrorReason.unexpectedCloseActivityDestroy),Wn(!1,!1),nt()}var pn=function(){v("body").append(Ye+Ze+en+nn);for(var e="",n=0;n<10;n++)e+=tn;v(".loaderOW .offers").prepend(e),rt()};function vn(){X.subscribe(te+".acknowledgeMessage",function(e){N.acknowledgeMessage(e)})}function mn(e){var n=new i(p.PubSub,J,p.Utils,Tt);p.Msg.init(J,n.handler,at),X.init();var t=yi("../SDKInterface.js");Ae=new t(me.mobileSDKSettings,m,J,e),N=new O(J,p,Ae,v),vn()}function bn(){t.init(me.mobileSDKSettings.deviceOs,Ae,me.mobileSDKSettings.debug,J.PixelTrackingService.firePixel),X.subscribe("SDKController.log",function(e){z.isDefined(e.debugLevel)&&z.isDefined(e.msg)&&("string"==typeof e.msg&&(e.msg=decodeURI(e.msg)),J.log(e.msg,e.debugLevel,e.origin))})}var hn=function(){e.init(t,v,J.Cache),r.init(t,me.mobileSDKSettings,v,J.Cache,dt(),a,e,J.getEnv(),p,an),c.init(me.controllerConfig,t),u.init(t),j=new n(J.AdUtils),J.ProductRouter=yi("../ProductRouter.js")(p,J,m),J.ProductRouter.initModule(),J.OfferWall.init({supplyConfig:J.SupplyConfigurations.getOfferWallConfig()})};function Sn(){J.HTTPService.init(!J.isLegacy(ue.nativeHttpEngine)),J.OrientationService.init(!J.isLegacy(m.featureCompatibilityMap.appOrientationRestrictions),De),J.GDPRService.init(!J.isLegacy(m.featureCompatibilityMap.GDPRSupport)),yn()&&J.RingerSwitchService.init(),J.NativeLifeCycleEventsService.init(),mt();var e=yi("../../components/containers/WebView"),n=yi("../../components/containers/BackgroundController"),t=yi("../../components/containers/NavigationModeView"),i=yi("../../components/IframeManager"),r=yi("../../components/containers/BannerExternalAdViewService"),a=new n(J,m,l),o=yi("../../components/containers/WPADUtils")(J),s=new e(p,J,l.style.forceCloseProperties,m,An(),a,M),d=new i(J,m,h,j),c=new S(p,J,m,j);k=new y(J,d,c,s,j),B=new t(J,k,s),K=new r(p,J,m,j),R=new A(p,J,K,o.generateBannerAdViewId()),W=new w(p,J,m,De,an),J.AppUserIdService.init(De),(L=new P(p,J)).init(),x=new T(L),J.AndroidNomediaFileHandler.init(De),J.DeviceDataService.init(De)}function yn(){return!J.isLegacy(m.featureCompatibilityMap.ringerSwitch)&&me.mobileSDKSettings.deviceOs===m.deviceOs.ios&&"wk"===me.mobileSDKSettings.webviewType}function An(){return{supportImmersive:J.isLegacy(ue.supportImmersive),supportOrientation:J.isLegacy(ue.supportOrientation),translucent:J.isLegacy(ue.translucent),supportAdCloseCB:!J.isLegacy(ue.adCloseCB)}}var Cn=function(e){var n=new v.Deferred;J.log("Products info received: "+JSON.stringify(e),J.LogLevels.info);var t,i,r,a=ve.length,o=[];for(t=0;t<a;t++)z.isDefined(e[ve[t]])||(me.applicationSettings[ve[t]]=null);for(i in e)e.hasOwnProperty(i)&&i.match(/^custom/)&&o.push(i);return ct(o),(r=E.parseConfiguration(e,pe,me.applicationSettings)).didSucceed?n.resolve():n.reject(r.errMsg),n.promise()},Dn=function(e){v.each(e.products,function(e,n){p.hasOwnProperty(n)&&z.isFunction(p[n].init)&&p[n].init()})},In=function(){Ce.addClass("ssaOnAdUnitCloseVisible")},wn=function(){Ce.removeClass("ssaOnAdUnitCloseVisible")},Pn=function(e,n,t){if(jn()&&Un({name:"dialogBoxAboutToClose",shouldResume:e}),!n||!jn()){if(v(".dialogBox").css("visibility","hidden"),v("#ssaDialogBoxOverlay").css("display","none"),z.isFunction(t))return void t.call();h.getDisplayedAdFrame()&&Un({name:"showFrame"})}Ie.fadeOut(100,function(){v(".dialogBox").css("visibility","hidden"),v("#ssaDialogBoxOverlay").fadeOut(100,function(){z.isFunction(t)?t.call():h.getDisplayedAdFrame()&&Un({name:"showFrame"})})})},Tn=function(n,t){var i,r=[],e=null,a=null;function o(){var e=j.getDisplayedAdType();j.isDisplayed()&&X.publish("SDKController.AdOpened",[{productType:e}]),t&&t.call(null)}a=X.subscribe(te+".openUrlFailure",function(e){clearTimeout(i),X.clearHandlers(r),X.unsubscribe(a);var n=z.isDefined(e.errMsg)?e.errMsg:"Unknown reason for error",t=j.getDisplayedAdType()||"";De.trackEvent(an.openUrlError,{generalMessage:n},{productType:t}),J.log("SDK failed to open url",J.LogLevels.verbose)}),e=gi()&&"webview"===n.method?X.subscribe(te+".openUrlSuccess",function(){if(clearTimeout(i),X.clearHandlers(r),n.controls){var e=j.getDisplayedAdType();B.changeToNavigationMode(Pn,Ce,Re,e,On)}o()}):X.subscribe(te+".viewableChange",function(e){clearTimeout(i),X.clearHandlers(r),!z.isDefined(e.isViewable)||e.isViewable||me.mobileSDKSettings.deviceOs===m.deviceOs.android&&"main"!==e.webview||o()}),r.push(a),r.push(e),"storeKit"===n.method&&(me.mobileSDKSettings.deviceOs!==m.deviceOs.ios||J.isLegacy({ios:"5.17",android:"99"})?n.method="external_browser":n.method="store"),"webview"===n.method&&n.controls?me.mobileSDKSettings.deviceOs===m.deviceOs.android?J.callSDKFunction("openUrl",{url:n.url,method:"webview"},"openUrlSuccess","openUrlFailure"):J.callSDKFunction("openUrl",{url:n.url,method:n.method,controlFrames:Ee},"openUrlSuccess","openUrlFailure"):J.callSDKFunction("openUrl",{url:n.url,method:n.method,appId:n.appId,viewUniqueId:n.viewUniqueId},"openUrlSuccess","openUrlFailure"),i=setTimeout(function(){X.unsubscribe(e),"ios"===J.getApiData({deviceOs:1}).deviceOs&&parseFloat(J.getConfigurationHelper().getDeviceOsVersion())<8&&t&&t.call(null)},500)},On=function(){Ce.unbind("touchend").bind("touchend",zn),Fn(Ue.close),Pe.unbind("click").bind("click",function(e){e.stopPropagation(),e.preventDefault(),X.publish("SDKController.dialogBoxResume",[j.get()]),Pn(!0,!0)})},Fn=function(t){we.unbind("click").bind("click",function(e){e.stopPropagation(),e.preventDefault();var n=ee?t:Ue.close;switch(X.publish("SDKController.dialogBoxExit",[j.get()]),n){case Ue.nextFrame:Un({name:"moveToNextFrame"}),Pn(!1,!0);break;case Ue.close:j.isDisplayed()?(Un({name:"confirmCloseClicked"}),Pn(!1,!0)):Wn(!0)}})};function Ln(n){J.log(b+"broadcastMessageToAllAdViews"),R.checkStatusOfAdView().then(function(e){e&&e.isExternalAdViewInitiated&&R.sendMessageToExternalAdView(n)}),k.sendMessageToAllAdViews(n)}function xn(e){return e===m.BN&&!J.isBannerAndLoadWhileShowSupported(e)}function Nn(e,n){if(n)return n.settings.viewType===m.viewTypes.externalView&&xn(n.productType)?R.sendMessageToExternalAdView(e):(J.log("sendMessageToDisplayedAdView | posting to DISPLAYED ad unit"),k.sendMessageToAdView(e,n));var t="";try{t=JSON.stringify(e)}catch(e){}J.log("sendMessageToDisplayedAdView | can't find displayed ad. "+t)}var Un=function(e,n){if("string"==typeof e)throw new Error("postAdUnitEvent message type not supported "+typeof e);return J.log(b+"postAdUnitEvent | before posting to ad unit"+JSON.stringify(e)),n?Ln(e):Nn(e,j.get())};function Mn(){var e=j.getDisplayedAdType(),n=j.getDisplayedAdDemandName();J.log("in setDefaultBackAndCloseBehavior with product "+e+" and demand "+n,J.LogLevels.verbose),e&&(n?(je[e][n]=le.close,Ke[e][n]=Ne.defaultBehavior):(je[e]=le.close,Ke[e]=Ne.defaultBehavior))}function Vn(e){for(var n=v("#ssaDialogBox"),t=n[0]&&n[0].className.split(" "),i=0;i<t.length;i++){var r=t[i];r!==m.styleAccordingToProtocol.secured&&r!==m.styleAccordingToProtocol.unsecured||n.removeClass(r),r.match(/template.*/)&&n.removeClass(r)}var a=me.mobileSDKSettings.protocol===m.protocol.https?m.styleAccordingToProtocol.secured:m.styleAccordingToProtocol.unsecured;n.addClass(a),e.settings.templateid&&n.addClass("template"+e.settings.templateid)}function En(e){e?wn():In()}function kn(){Kn()}var Bn=function(e,n){var t=v.Deferred();return J.log("SDKController | onAdUnitOpen"),Fn(Ue.close),k.displayContainer(e),v.when($n(e)).then(function(){et(),Vn(e),k.handleScreenVisible(n,e),t.resolve()}),t.promise()};function Rn(e){e&&(J.ImpressionsCounterService.setInstanceImpressionsCounter(e),W.updateToken(J.ImpressionsCounterService.getTokenCounters()))}var Kn=function(){var e=j.get(),n=j.getDisplayedAdType();try{Oe=!0,clearTimeout(xe),e?qn():J.log("_shouldReceiveMessage"),e&&e.settings&&J.LastSeenCampaignService.setLastDisplayedAdCampaignId(e.cid,e.settings.landingId,n),Rn(e),J.log("SDKController | onAdVisible"),X.publish("SDKController.AdVisible",[e]),Un({name:"adVisible",productType:n})}catch(e){throw J.log("SDKController | onAdVisible | Exception"),e}};function jn(){return z.isVisible(Ie)}var Wn=function(e,n){J.RingerSwitchService.isInitiated()&&J.RingerSwitchService.stopListener(),Re.scrollHeight="",v("body").css("height",Re.scrollHeight);var t=function(){Gn(n)};jn()?Pn(!1,e,t):t()};function Gn(e){var n=function(){},t=j.get();if(j.reset(),e&&k.displayLoader(t.productType),J.callSDKFunction("setBackButtonState",{state:Ve.controller}),e?wn():n=Hn.bind(this,t),t)return t.engaged=!0,void At(t,{preloadNextInBG:!e},n);k.unloadProductFromContainer(),n()}var Hn=function(e){J.log("SDKController | ad unit close done",J.LogLevels.verbose),e&&e.isWPAD?(J.log("SDKController | ad unit close done wpad",J.LogLevels.verbose),k.hideContainer(e)):(setTimeout(function(){J.log("SDKController | closing webview with currentAd "+JSON.stringify(e),J.LogLevels.verbose),k.hideContainer(e)},250),e&&e.settings&&e.settings.setContainerBGColorBlack&&k.setContainerBGColorTransparent())},_n=function(){if(!ne){var e,n=j.getDisplayedAdType(),t=j.getDisplayedAdDemandName(),i=j.getDisplayedAdSettings();e=n===m.OW?i&&(i.OLXD||0===i.OLXD)?1e3*i.OLXD:m.closeAndBackDisabledTimerOW:m.closeAndBackDisabledTimer;var r={eventParam:{eName:an.userClosedBeforeAdVisible},action:"startTiming",productType:n,demandSourceName:t};X.publish("SDKController.Analytics",[r]),Jn(),ne=!0,xe=setTimeout(function(){qn()},e)}},qn=function(){Qn(),ne=!1},Jn=function(){v("#ssaNavigatorCloseButton").addClass("invisible")},Qn=function(){v("#ssaNavigatorCloseButton").removeClass("invisible")},zn=function(e){k.hideLoader(),Zn();var n=j.getDisplayedAdType(),t=j.getDisplayedAdDemandName();if(!n)return on(null,e),void Wn(!1);if(!Oe&&!ne){var i={eventParam:{eName:an.userClosedBeforeAdVisible},action:"stopTiming",productType:n,demandSourceName:t};X.publish("SDKController.Analytics",[i])}switch(tt(n)){case le.close:J.ViewsManager.waitForAllViews().then(function(){nt(),on(null,e),Wn(!1)});break;case le.closeBanner:nt(),Wn(!1);break;case le.confirm:Fn(Ue.close),J.alert(it(n,t));break;case le.confirmNextFrame:Fn(Ue.nextFrame),J.alert(it(n,t));break;case le.nextFrame:Un({name:"moveToNextFrame"});break;case le.ignore:}},Xn=function(){var t="deviceScreenSize[width]",i="deviceScreenSize[height]",r=m.appInfo.orientation.portrait,a=m.appInfo.orientation.landscape,o=m.defaultOrientation,s=me.mobileSDKSettings[t],d=me.mobileSDKSettings[t],c=new v.Deferred;return v.when(J.OrientationService.oldGetOrientation()).then(function(e){var n=j.getDisplayedAdType();!n||o[n]!==a&&o[n]!==r||(e=o[n]),e===a&&(s=Math.max(me.mobileSDKSettings[t],me.mobileSDKSettings[i]),d=Math.min(me.mobileSDKSettings[t],me.mobileSDKSettings[i])),e===r&&(s=Math.min(me.mobileSDKSettings[t],me.mobileSDKSettings[i]),d=Math.max(me.mobileSDKSettings[t],me.mobileSDKSettings[i])),me.mobileSDKSettings.deviceOs===m.deviceOs.android&&(s/=me.mobileSDKSettings.deviceScreenScale,d/=me.mobileSDKSettings.deviceScreenScale),c.resolve({width:s,height:d,orientation:e,scrollTop:v(window).scrollTop()})}),c.promise()},$n=function(){var n,t=new v.Deferred;return Te?t.resolve():n=X.subscribe(te+".viewableChange",function(e){e&&z.isDefined(e.isViewable)&&e.isViewable&&(J.log("SDKController | viewableChange(screenVisible) to:"+e.isViewable,J.LogLevels.info),X.unsubscribe(n),t.resolve())}),t.promise()},Yn=function(e){if(e.productType!==m.BN||e.isInAppBidding)J.isBannerAndLoadWhileShowSupported(e.productType)&&j.set(e),k.onAdUnitLoaded(e,En,kn);else{R.onBannerViewLoaded(function(){j.set(e)},kn)}},Zn=function(){J.callSDKFunction("removeCloseEventHandler",J.ViewsManager.getDisplayWebViewParams(!1))};function et(){J.NativeLifeCycleEventsService.startNotify(D.AndroidEvents.onDestroy)}function nt(){J.NativeLifeCycleEventsService.stopNotify(D.AndroidEvents.onDestroy)}function tt(e){var n=j.getDisplayedAdDemandName();if(e)return(n?je[e][n]:je[e])||We[e]}function it(e,n){var t=J[e];return t&&t.getConfirmCloseMsg&&t.getConfirmCloseMsg(n)||fe}var rt=function(){Ce=v("#ssaNavigatorCloseButton"),Ie=v("#ssaDialogBox"),we=v("#ssaDialogConfirmBtn"),Pe=v("#ssaDialogCancelBtn"),ye=v("#ssaViewWrap"),On()},at=function(){return!0},ot=function(e){J.log(e,J.LogLevels.error)},st=function(e){var n,t={};return z.isString(e)?(n=e.split(/\?(.+)/),t.name=n[0],t.parameters=e.split(/parameters=(.+)/)[1],t):null},dt=function(){return me.mobileSDKSettings.deviceOs===m.deviceOs.android?"supersonicads":"SSAPublisher"},ct=function(n){v.each(me.applicationSettings,function(e){e.match(/^custom/)&&-1===v.inArray(e,n)&&delete me.applicationSettings[e]})},lt=function(){var n={};return v.each(me.applicationSettings,function(e){e.match(/^custom/)&&(n[e]=me.applicationSettings[e])}),n},ut=function(e){var n=me.mobileSDKSettings.protocol+"//"+me.mobileSDKSettings.domain+"/l/?type={{logType}}&count={{count}}&applicationKey={{applicationKey}}&applicationUserId={{applicationUserId}}&SDKVersion={{SDKVersion}}&deviceOs={{deviceOs}}&deviceOSVersion={{deviceOSVersion}}&{{customQueryString}}",t=new Image,i={},r={logType:"",count:1,applicationKey:me.applicationSettings.applicationKey,applicationUserId:me.applicationSettings.applicationUserId,SDKVersion:me.mobileSDKSettings.SDKVersion,deviceOs:me.mobileSDKSettings.deviceOs,deviceOSVersion:me.mobileSDKSettings.deviceOSVersion,customQueryString:""};e=v.extend({"deviceIds[OpenUDID]":me.mobileSDKSettings["deviceIds[OpenUDID]"],"deviceIds[IFA]":me.mobileSDKSettings["deviceIds[IFA]"],"deviceIds[IDFV]":me.mobileSDKSettings["deviceIds[IDFV]"],"deviceIds[SERIAL]":me.mobileSDKSettings["deviceIds[SERIAL]"],"deviceIds[AndroidID]":me.mobileSDKSettings["deviceIds[AndroidID]"],"deviceIds[IMEI]":me.mobileSDKSettings["deviceIds[IMEI]"]},r,e),v.each(e,function(e,n){z.isDefined(r[e])||(i[e]=n)}),v.isEmptyObject(i)||(e.customQueryString+=z.serialize(i)),t.src=z.renderTemplate(n,e)},ft=function(e){var t="";return z.isDefined(e)||(e=me),v.each(e,function(e,n){return!e.match(/^deviceIds/)||!z.isDefined(n)||null===n||(t=n,!1)}),t},gt=function(){var e=me.mobileSDKSettings;if(e.deviceScreenScale)try{var n=parseInt(e["deviceScreenSize[width]"])/(e.deviceOs!==m.deviceOs.ios?e.deviceScreenScale:1),t=parseInt(e["deviceScreenSize[height]"])/(e.deviceOs!==m.deviceOs.ios?e.deviceScreenScale:1);e.deviceHeightDP=parseInt(t),e.deviceWidthDP=parseInt(n)}catch(e){J.log("SDKController | Failed to parse screen DP",J.LogLevels.error)}},pt=function(){var n=new v.Deferred,t=!1,i=me.mobileSDKSettings;return ui()?n.resolve():J.CampaignsFilter.checkIfAppInstallOnDevice(["com.google.market","com.android.vending"]).then(function(e){v.each(e,function(e,n){n.isInstalled&&(t=!0)}),i.gpi=t,n.resolve()},function(){i.gpi=t,n.reject("Unable to check if Google play services is installed on the device")}),n.promise()},vt=function(){var e,n,i,r=[],a=new v.Deferred;return e=X.subscribe(te+".parseDeviceStatus",function(e,n){X.clearHandlers(r),J.log(b+"parseDeviceStatus received");var t=o(e.appOrientation);t.patch&&(De.trackEvent(an.patchOrientation,{},{generalMessage:decodeURIComponent(e.appOrientation)}),e.appOrientation=t.appOrientation),(i=E.parseConfiguration(e,ge,me.mobileSDKSettings)).didSucceed?(J.callSDKFunction(n),V.init(me.controllerConfig.appOrientation,me.mobileSDKSettings),me.mobileSDKSettings.appOrientation=V.getOrientation(),me.mobileSDKSettings.displaySizeWidth=me.mobileSDKSettings["deviceScreenSize[width]"],me.mobileSDKSettings.displaySizeHeight=me.mobileSDKSettings["deviceScreenSize[height]"],gt(),G=I.create(me.mobileSDKSettings),J.AdvertisingIdService.decideOnAdvertisingId(me.mobileSDKSettings,me.controllerConfig),a.resolve()):a.reject(i.errMsg)}),r.push(e),n=X.subscribe(te+".getDeviceStatusFailed",function(e){X.clearHandlers(r),ot(e),a.reject(de.device)}),r.push(n),J.callSDKFunction("getDeviceStatus",{},"parseDeviceStatus","getDeviceStatusFailed"),a.promise()},mt=function(){me.mobileSDKSettings.deviceOs!==m.deviceOs.ios&&J.callSDKFunction("setStoreSearchKeys",{searchKeys:Be[me.mobileSDKSettings.deviceOs]})},bt=function(e){return z.isDefined(me[e])&&null!==me[e]||z.isDefined(me.applicationSettings[e])&&null!==me.applicationSettings[e]||z.isDefined(me.mobileSDKSettings[e])&&null!==me.mobileSDKSettings[e]||z.isDefined(me.controllerConfig[e])&&null!==me.controllerConfig[e]||z.isDefined(me.configMapping[e])&&null!==me.configMapping[e]()},ht=function(e){return z.isDefined(be[e])},St=function(e){var n;return z.isDefined(me[e])?n=me[e]:z.isDefined(me.applicationSettings[e])?n=me.applicationSettings[e]:z.isDefined(me.mobileSDKSettings[e])?n=me.mobileSDKSettings[e]:z.isDefined(me.controllerConfig[e])?n=me.controllerConfig[e]:z.isDefined(me.configMapping[e])?n=me.configMapping[e]():"customParam"===e&&(n=lt()),n},yt=function(){var e,n,t=[],o=new v.Deferred;return e=X.subscribe(te+".parseCachedFilesMap",function(e,n){var t,i,r,a={};(r=sn(["path"],e,"parseCachedFileMap")).didSucceed?(t=decodeURIComponent(e.path).split("/"),""!==e.path?a[i=t[t.length-1]]=z.isDefined(e[i])?e[i]:e:a=e,J.log("SDKController | successfully received files map:"+JSON.stringify(e),J.LogLevels.info),delete e.path,Pt(a).then(function(e){J.log("SDKController | Finished purging cache on controller init, calling init with sorted:"+JSON.stringify(Q.cachePriorityArray),J.LogLevels.verbose),J.log("SDKController | The file map after:"+JSON.stringify(e),J.LogLevels.verbose);var n=J.Cache.init(e,Q.cachePriorityArray);return J.AdsAssetsManager.init(J.Cache,me.controllerConfig.cacheConfig),n}).then(function(){J.log("SDKController | Cache module initiated",J.LogLevels.info),J.callSDKFunction(n),o.resolve()}).fail(function(e){e="SDKController | Cache module failed to initiated",J.log(e,J.LogLevels.error),o.reject(e)})):o.reject(r.errMsg)}),t.push(e),n=X.subscribe(te+".getCachedFilesMapFailed",function(e){J.log("SDKController | failed to receive files map:"+e,J.LogLevels.error),o.reject(de.filemap)}),t.push(n),J.callSDKFunction("getCachedFilesMap",{path:""},"parseCachedFilesMap","getCachedFilesMapFailed"),o.promise()},At=function(n,t,i){t=t||{preloadNextInBG:!0},k.unloadAdView(n),Y.removeAdById(J.AdUtils.getAdId(n),n);var r=qt(n),a=!1;r&&p.Utils.isFunction(r.prepareAdToEngageEnd)&&r.prepareAdToEngageEnd(n).then(function(){a=r.getNextAd(!t.preloadNextInBG,n.inventoryId)}),J.log("engageEnd on controller with :"+n.engaged,J.LogLevels.verbose),p.PubSub.publish("SDKController.engageEnd",[n,function(){n.engaged&&k.unloadProductFromContainer(n);var e=!t.preloadNextInBG;r&&p.Utils.isFunction(r.attemptToPreloadAd)&&a&&r.attemptToPreloadAd(e,n.inventoryId),i&&i(),H.getState()===ce.play&&H.handleOnEngageEnd(n)}])},Ct=function(){var e=Ve.controller;return me.mobileSDKSettings.deviceOs===m.deviceOs.android&&10==E.getDeviceApiLevel()&&(e=Ve.device),e},Dt=function(e){return It(e),wt(e),e&&e.applicationKey&&(me.applicationSettings.applicationKey=e.applicationKey),E.parseConfiguration(e,pe,me.applicationSettings)},It=function(e){var n,t=ve.length;for(n=0;n<t;n++)z.isDefined(e[ve[n]])||(me.applicationSettings[ve[n]]=null)},wt=function(e){var n,t=[];for(n in e)e.hasOwnProperty(n)&&n.match(/^custom/)&&t.push(n);ct(t)};function Pt(a){var e,r,n,o=[],t=new v.Deferred,s=[],d=["temp","files","assets","libs","graphicAssets"],i=function(){var n=new v.Deferred,t=0;function i(){var e;(e=new v.Deferred,0<s.length&&v.each(s,function(e,n){Q.cachePriorityArray&&Q.cachePriorityArray[n]&&delete Q.cachePriorityArray[n],delete a[n]}),"0"!==Q.controllerVersion?(Q.controllerVersion=me.v,J.setGlobalAppData(Q).then(function(){e.resolve()},function(){e.reject("NewController: Save app global data failed")})):e.resolve(),e.promise()).then(function(){n.resolve(a)},function(e){n.reject(e)}),X.clearHandlers(o)}return e=X.subscribe(te+".deleteFolderSuccess",function(){J.log("NewController: A new controller version detected. Folder deleted successfully",J.LogLevels.verbose),++t>=s.length&&i()}),r=X.subscribe(te+".deleteFolderFailed",function(e){if(X.clearHandlers(o),p.Utils.isDefined(e.errCode)&&1==e.errCode)J.log("NewController: The folder requested for deletion was not found. Continue...",J.LogLevels.verbose),++t>=s.length&&i();else{X.clearHandlers(o),n.reject("NewController: Purge cache for new controller version failed.")}}),function(){var e=m.cacheAdsDirectory,n="purgeCampaignsCache",t="purgeGlobalsCache",i=me.mobileSDKSettings;if(i.hasOwnProperty(n)&&!1===i[n])for(var r in a)r!==e&&-1===r.indexOf("RewardedVideo")&&-1===r.indexOf("Interstitial")||d.push(r);i.hasOwnProperty(t)&&!1===i[t]&&d.push("globals")}(),o.push(e),o.push(r),v.each(a,function(e,n){-1===d.indexOf(e)&&s.push(e)}),J.log(s+JSON.stringify(s),J.LogLevels.verbose),0<s.length?v.each(s,function(e,n){J.deleteFolder(n)}):i(),n.promise()};return function(){if(J.isLegacy(ue.userData)){J.log("NewController: Old controller version. UserData is not supported. Will purge anyway",J.LogLevels.verbose);var e=new v.Deferred;return e.resolve({controllerVersion:"0"}),e}return J.getGlobalAppData()}().then(function(e){J.log("SDKController | getGlobalAppData: "+JSON.stringify(e),J.LogLevels.verbose),n=(Q=e).controllerVersion,z.isDefined(n)&&n!==me.v||!z.isDefined(n)?(J.log("NewController: A new controller version detected. Purging cache... old: "+n+"new: "+me.v,J.LogLevels.verbose),Je=!0,i().then(function(e){t.resolve(e)},function(){t.reject()})):(J.log("NewController: Controller version did not change. Saved version: "+n+" Current version: "+me.v,J.LogLevels.verbose),t.resolve(a))},function(){J.log("SDKController | getGlobalAppData: failed! ",J.LogLevels.verbose),t.reject("getGlobalAppData: failed! ")}),t.promise()}function Tt(n){return function(e){Un({data:e,id:n},!0)}}function Ot(){return me.controllerConfig&&void 0!==me.controllerConfig.abTest?me.controllerConfig.abTest:-4}function Ft(e){_e||J.getApplicationInfo(e).then(null,function(){var e=v.Deferred();return e.resolve(J.getConfig()),e.promise()}).always(function(e){var n=Lt(e);rn.init(n),_e=!0})}function Lt(e){var n=-1;try{n=parseInt(E.getDeviceApiLevel())}catch(e){J.log("getEventicsBaseData | Error converting deviceApiLevel to Integer "+e,J.LogLevels.verbose)}return{sdkVersion:e.mobileSDKSettings.SDKVersion,controllerVersion:e.v,controllerbn:e.controllerbn,bundleId:e.mobileSDKSettings.bundleId,connectionType:e.mobileSDKSettings.connectionType,applicationKey:e.applicationSettings.applicationKey,deviceId:Jt(e.mobileSDKSettings),applicationUserId:e.applicationSettings.applicationUserId,deviceOs:e.mobileSDKSettings.deviceOs,deviceOsVersion:E.getDeviceOsVersion(),deviceApiLevel:n,deviceOEM:e.mobileSDKSettings.deviceOEM,deviceModel:e.mobileSDKSettings.deviceModel,appOrientation:V.getOrientation(),env:Si.getEnv(),lat:"true"===e.mobileSDKSettings.isLimitAdTrackingEnabled,abTest:Ot(),usertype:e.userType,platformABGroup:J.getSDKDataByKey(m.abTests.controllerConfigGroup),mediationType:e.controllerConfig.mediationType,appVersion:e.mobileSDKSettings.appVersion,SDKpluginType:e.applicationSettings.SDKPluginType}}function xt(e,n){var t,i=[],r=new v.Deferred,a=n.length;for(t=0;t<a;t++)i.push(Nt(e,n[t]));return v.when.apply(null,i).always(function(){J.deleteFolder(e),r.resolve(0)}),r.promise()}function Nt(r,a){var o=new v.Deferred,e=function(e){var n={timingValue:(new Date).getTime()-void 0,success:e},t=n.success?an.cdnABTestSuccess:an.cdnABTestFail,i={eNameStart:an.cdnABTestSuccess,timingValue:n.timingValue,rvnomoreoffersreason:r,generalMessage:a};De.trackTimingStop(t,i),o.resolve()};return De.trackTimingStart(an.cdnABTestSuccess),J.cacheAsset(r,a).then(e.bind(null,!0),e.bind(null,!1)),o.promise()}function Ut(){try{var e=Ge,t=function(e,n){return Math.floor(Math.random()*(n-e+1)+e)},n=(a=d.getExtConfig()).Interstitial&&a.Interstitial.abtest&&a.Interstitial.abtest[3e3]&&a.Interstitial.abtest[3e3].cdnPercent?a.Interstitial.abtest[3e3].cdnPercent:0;if(0<n&&t(0,100)<n&&me&&me.controllerConfig&&"CN"===me.controllerConfig.country){var i=e.cdns,r=function(){if(0!==i.length){var e=t(0,i.length-1),n=i[e];i.splice(e,1),xt(n.cdnName,n.assets).then(r)}};r()}}catch(e){J.log("_manageCdnABTest | catch: "+e,J.LogLevels.verbose),De.trackEvent(an.cdnABTestException,null,{generalMessage:e})}var a}function Mt(i){var r=new v.Deferred,e=function(e){var n=e?an.latencyTestSuccess:an.latencyTestFail,t={eNameStart:an.latencyTestSuccess,generalMessage:i.url};De.trackTimingStop(n,t),r.resolve()};return De.trackTimingStart(an.latencyTestSuccess),v.ajax({url:i.url,type:i.method?i.method:"GET",cache:!0,timeout:6e4}).then(e.bind(null,!0),e.bind(null,!1)),r.promise()}function Vt(){try{var e=He,t=function(e,n){return Math.floor(Math.random()*(n-e+1)+e)},n=(a=d.getExtConfig()).Interstitial&&a.Interstitial.abtest&&a.Interstitial.abtest[5e3]&&a.Interstitial.abtest[5e3].latencyTestPercent?a.Interstitial.abtest[5e3].latencyTestPercent:0;if(0<n&&t(0,100)<n){var i=e,r=function(){if(0!==i.length){var e=t(0,i.length-1),n=i[e];i.splice(e,1),Mt(n).then(r)}};r()}}catch(e){J.log("_manageLatencyABTest | catch: "+e,J.LogLevels.verbose),De.trackEvent(an.latencyTestException,null,{generalMessage:e})}var a;return p.Utils.returnResolvedPromise()}function Et(){if($&&"rejected"!==$.state())return p.Utils.returnResolvedPromise();var e="prod"===J.getEnv()?Qe:ze,n=J.getBaseCdnUrl()+e;return $=v.ajax({url:n,type:"GET",dataType:"jsonp",cache:!0,jsonpCallback:"getExtConfig",timeout:2e4}).then(function(e,n,t){J.log(b+"MicroJob | Got Application configuration"),d.setConfig(e);var i=e&&e.general&&e.general.eventProb||0;$e=Xe<i;var r=e&&e.general&&e.general.pullingDeviceDataInterval;J.DeviceDataService.startPullingDataWithInterval(r)},function(e,n,t){var i=b+"MicroJob | Failed to receive configuration from server "+t;J.log(i,J.LogLevels.verbose),De.trackEvent(an.getExternalApplicationConfigurationError,{generalMessage:i})}).then(Vt).then(Ut),p.Utils.returnResolvedPromise()}function kt(e){var n;J.isLegacy(J.featureMap.MOAT)||J.isLegacy(J.featureMap.OMID)&&((n=e)&&n.moat&&n.moat===m.moat.disabled||(J.MOATService.initWithOptions(),p.PubSub.subscribe("SDKController.MOATStartTracking",function(){J.MOATService.createAdTracker(),J.MOATService.startTracking()}),p.PubSub.subscribe("SDKController.MOATStopTracking",function(){J.MOATService.stopTracking()})))}function Bt(n){if(!J.isLegacy(ue.MOAT)){var e="deviceVolumeSuccess";X.subscribe(te+"."+e,function(e){J.log("Device volume received: "+(e?JSON.stringify(e):"empty")),n&&e&&n.call(null,{deviceVolume:e.deviceVolume||"0"})}),J.callSDKFunction("getDeviceVolume",{},e,e)}}function Rt(){var t,i,r=new v.Deferred;return t=X.subscribe(te+".getDebugParamsSuccess",function(e){J.log(b+"getDebugParamsSuccess "+JSON.stringify(e));try{var n={};me.mobileSDKSettings.deviceOs===m.deviceOs.android?n=z.parseJSON(decodeURIComponent(e.SDK5DebugParams)):"object"==typeof e.SDK5DebugParams&&(n=e.SDK5DebugParams),r.resolve(n)}catch(e){J.log("getSDKDebugParams | getDebugParamsSuccess | parseJSONFailed |"+e,J.LogLevels.verbose),r.reject("failed to parse received SDK5 params")}X.clearHandlers([t,i])}),i=X.subscribe(te+".getDebugParamsFailed",function(e){var n="failed to get debug param";J.log("getSDKDebugParams | getDebugParamsFailed | "+n,J.LogLevels.verbose),r.reject(n),X.clearHandlers([t,i])}),J.callSDKFunction("getUserData",{key:"SDK5DebugParams"},"getDebugParamsSuccess","getDebugParamsFailed"),r.promise()}function Kt(n){var t=new v.Deferred;return Rt().then(function(e){return p.Utils.returnResolvedPromise(v.extend(n,e))}).always(function(e){t.resolve(e||n)}),t.promise()}function jt(e){var n="false";!0===e&&(n="true"),J.callSDKFunction("setAllowFileAccessFromFileURLs",{allowFileAccess:n})}function Wt(){return me.mobileSDKSettings&&me.mobileSDKSettings.bundleId&&-1!==m.testAppBundleIds.indexOf(me.mobileSDKSettings.bundleId)}function Gt(e){J.log("setCloseButtonState params "+JSON.stringify(e),J.LogLevels.verbose),e&&e.state&&e.productType&&(e.demandSourceName?je[e.productType][e.demandSourceName]=le[e.state]:je[e.productType]=le[e.state])}function Ht(){if(!qe){var e=J.getApiData(s.deviceDataRequestObject);e&&0<Object.keys(e).length&&(qe={os:e.deviceOs,osv:e.deviceOSVersion,apilvl:E.getDeviceApiLevel(),sdkv:e.SDKVersion,webviewType:me.mobileSDKSettings.webviewType})}return qe||{}}function _t(){var e;return me.controllerConfig&&!0===me.controllerConfig.isSecured?e=m.protocol.https:me.mobileSDKSettings.deviceOs===m.deviceOs.android?e=m.protocol.http:me.mobileSDKSettings.deviceOs===m.deviceOs.ios&&(me.mobileSDKSettings.deviceOSVersion&&0<=z.versionCompare(me.mobileSDKSettings.deviceOSVersion,"10")?me.mobileSDKSettings.allowArbitraryLoadsInWebContent?(e=m.protocol.http,q=!0):me.mobileSDKSettings.allowArbitraryLoads?e=m.protocol.http:(e=m.protocol.https,q=!0):e=me.mobileSDKSettings.allowArbitraryLoads?m.protocol.http:m.protocol.https),e}function qt(e){if(e&&e.productType){var n=J[e.productType];return e.demandSourceName&&n&&(n=n[e.demandSourceName]),n}}function Jt(e){return gi()?Qt(e):e["deviceIds[AID]"]}function Qt(e){return 0<=z.versionCompare(e.deviceOSVersion,"10")&&"true"===e.isLimitAdTrackingEnabled?e["deviceIds[IDFV]"]:e["deviceIds[IFA]"]}function zt(){var e=J.Cache.getCacheByType({cacheBase:"assets"}),n=me.mobileSDKSettings.jQueryUrls;e&&-1<J.Cache.getFileIndexInCache(e.cache,n[0])?J.log(b+"jQuery file already cache"):(J.log(b+"Start save jQuery to cache"),J.cacheAsset("assets",n).then(function(){J.log(b+"jQuery file saved successfully")},function(){J.log(b+"jQuery file cache failed")}))}function Xt(){var e=me.mobileSDKSettings.controllerPathFolder+me.v,n=J.Cache.getCacheByType({cacheBase:e});n&&-1<J.Cache.getFileIndexInCache(n.cache,me.mobileSDKSettings.controllerJSUrl)?J.log(b+"controller js file already cache"):Yt(e,me.mobileSDKSettings.controllerJSUrl)}function $t(){var e=me.mobileSDKSettings.controllerPathFolder+me.v,n=J.Cache.getCacheByType({cacheBase:e}),t=me.mobileSDKSettings.rootPath+Se,i=me.mobileSDKSettings.cacheFolderPath+"/"+he;n&&-1<J.Cache.getFileIndexInCache(n.cache,t)?Zt(i):Yt(e,t).then(function(){J.log("updateControllerCssToCache - cache css file succeeded",J.LogLevels.verbose),Zt(i)},function(){J.log("updateControllerCssToCache - cache css file failed",J.LogLevels.verbose),Zt(t)})}function Yt(e,n){return J.log(b+"Start saving file to cache, url: "+n),J.cacheAsset(e,n).then(function(){J.log(b+"File save success | "+n)},function(e){return J.log(b+"File save fail | "+n+" "+e),e})}function Zt(e){var n=v("head");0<v("#ssaMobileControllerCss").length||n.prepend('<link rel="stylesheet" id="ssaMobileControllerCss" type="text/css" />'),v("#ssaMobileControllerCss").attr("href",e)}function ei(){zt(),Xt(),$t(),me.mobileSDKSettings.deviceOs===m.deviceOs.android&&J.AndroidNomediaFileHandler.updateNomediaFileToCache()}function ni(e){if(!J.HTTPService.getIsNativeEngineExist())return!1;return J.HTTPService.GETRequest(e,{allowNative:!0,background:!0,retries:3}),!0}function ti(e){J.PixelTrackingService.firePixel(e)}function ii(e,n,t,i){var r,a,o=new v.Deferred,s=[];if(!z.isString(e)||!z.isString(n))return z.returnRejectedPromise("missing or corrupted params");r=X.subscribe(te+".postAdEventNotificationSuccess",function(e){J.log("postAdEventNotificationSuccess"+JSON.stringify(e)),X.clearHandlers(s),o.resolve()}),s.push(r),a=X.subscribe(te+".postAdEventNotificationFailed",function(e){var n=e.errMsg?e.errMsg:"unknown reason";J.log("error calling postAdEventNotificationFailed: "+n,J.LogLevels.error),X.clearHandlers(s),o.reject(n)}),s.push(a);var d={eventName:e,dsName:t,productType:n,extData:i||{}};return J.log("Controller - Notifies SDK on Event: "+d.eventName+" in Product: "+d.productType),J.callSDKFunction("postAdEventNotification",d,"postAdEventNotificationSuccess","postAdEventNotificationFailed"),o.promise()}function ri(e){var n,t=v("#ssaDialogBox");switch(e){case"template4":n={dialogText:{maxFontPixels:29,maxHeight:87,parentContainer:t},buttonText:{maxFontPixels:24,maxHeight:43,maxWidth:ai(e).maxDialogBtnTextWidth,parentContainer:we}};break;default:n={dialogText:{maxFontPixels:24,maxHeight:87,parentContainer:t},buttonText:{maxFontPixels:20,maxHeight:44,maxWidth:ai(e).maxDialogBtnTextWidth,parentContainer:we}}}return n}function ai(e){return m.templateStyle[e]?m.templateStyle[e]:m.templateStyle.defaultTemplate}function oi(){var t="",e=v("#ssaDialogBox"),n=e[0]&&e[0].classList;return v.each(n,function(e,n){n.match(/template.*/)&&(t=n)}),t}function si(e,n,t,i){p.PubSub.publish(te+"."+e,[n,t,i])}function di(){for(;0<nativeQueue.length;){var e=nativeQueue.shift();si(e.name,e.parameters,e.successCallback,e.errorCallback)}}function ci(e){return J.SDKLimitations.getLimitData(e)}function li(e){J.OMIDService.isSupported(e)&&J.OMIDService.init(U)}function ui(){return J.CompatibilityService.isFeatureSupportedInNativeSDK(F.limitAppFiltering)||J.CompatibilityService.isFeatureSupportedInNativeSDK(F.noPackagesInstallationPolling)}function fi(){J.SKOverlayManager.init()}function gi(){return vi()===m.deviceOs.ios}function pi(){return vi()===m.deviceOs.android}function vi(){return me.mobileSDKSettings.deviceOs}function mi(n){var t=j.get();Y.getAdsByProductType(n).forEach(function(e){e!==t&&(k.unloadAdView(e),J.log("remove from load creative "+J.AdUtils.getAdId(e)),Y.removeAdById(J.AdUtils.getAdId(e),n))})}function bi(n){var e=j.get(),t=Y.getAds(n);if(e){var i=k.getDisplayedAdView(e);J.log("Removing all current "+n.productType+" frames"),i&&i.hasClass&&i.hasClass(h.getAdUnitClassObj(n).class)&&j.isDisplayed()&&(on(),Wn())}t.forEach(k.unloadAdView),t.forEach(function(e){J.log("remove from load creative "+J.AdUtils.getAdId(e)),Y.removeAdById(J.AdUtils.getAdId(e),n)})}function hi(e){if(e){J.getSegmentationAllocator().addControllerSourceSegment(e.controllerSourceStrategy);var n=e.controllerSourceCode;p.Utils.isDefined(n)&&rn.updateBaseData({controllerSource:n})}}window.onerror=function(e,n,t,i,r){try{if(!r||!r.message)return;var a={url:n,lineNo:t,colNo:i,error:r&&r.message.substring(0,500)||""};_e&&$e&&De.trackEvent(an.controllerException,{generalMessage:e},{rvnomoreoffersreason:JSON.stringify(a)}),J.log(b+"onError handler. Exception:"+JSON.stringify(a))}catch(e){}};var Si={adUnitGlobals:r,libsManager:e,adUnitUrl:a,LogLevels:{none:0,error:1,info:2,verbose:3},featureMap:ue,debugMsg:t.debugMsg,decideUrlProtocolAccordingToHTTPSCompliance:_t,instancesManager:c,blacklistService:u,jQuery:function(){return v},api:function(){return _t()+"//"+me.mobileSDKSettings.domain},apiWithCdn:function(){return me.mobileSDKSettings.protocol+"//"+me.mobileSDKSettings.serviceCdn},getBaseCdnUrl:function(){return me.mobileSDKSettings.protocol+"//"+me.mobileSDKSettings.cdn},init:function(e,n){return J=this,v=window.jQuery,Z||(v.extend(me.mobileSDKSettings,e.mobileSDKSettings),v.extend(me.controllerConfig,e.controllerConfig),U=new(yi("../Environment/EnvironmentManager"))({controllerVersion:me.mobileSDKSettings.controllerVersion,schema:me.mobileSDKSettings.protocol,cdnDomain:me.mobileSDKSettings.cdn,scdnDomain:me.mobileSDKSettings.scdn,environment:me.mobileSDKSettings.env,deviceOs:me.mobileSDKSettings.deviceOs,cdnService:me.mobileSDKSettings.serviceCdn,stagingCdnDomain:me.mobileSDKSettings.domain,domain:me.mobileSDKSettings.domain}),me.mobileSDKSettings.overrideDebug&&(me.mobileSDKSettings.debug=me.mobileSDKSettings.defaultDebug),J.APIConfigurations.init(),E=new f(me,v,p.Utils,m),V=J.AppOrientationManager,M=new g(t,m,V),Y=new(yi("./LoadedCreatives"))(J),mn(n),bn(),un(),dn(),pn(),hn(),Sn(),cn(),ln(),kt(me.controllerConfig),hi(me.controllerConfig.controllerSourceData),J.log(b+"Controller initiated"),_.setNativeConfiguration(C.native[me.mobileSDKSettings.deviceOs]),li(me.controllerConfig),v.when(vt(),yt()).then(function(){r.setProtocol(_t()),window.queueValidMessages={},di(),fi()},function(e){try{De.trackEvent(an.initFailed,{},{generalMessage:decodeURIComponent(e)})}catch(e){}J.callSDKFunction("initController",{stage:"failed",errMsg:e})}).then(Et).then(function(){v.when(ei(),pt()).always(function(){var e={};ui()||(e.gpi=me.mobileSDKSettings.gpi),W.updateToken(e)})}).fail(function(e){e?J.log(b+e):J.log(b+"failed promise on get app config")}),Z=!0),Z},getConfigurationHelper:function(){return E},getAPIRequiredData:function(){var e=J.APIConfigurations.getCommonRequiredData(),n=J.getApiData(e),t=new v.Deferred;return n&&n!=={}?p.Utils.isDefined(n.errMsg)?t.reject(n.errMsg):t.resolve(n):t.reject("Failed to get required parameters"),t.promise()},isIOS:gi,isAndroid:pi,getDeviceOs:vi,getApiData:function(e){var n,t={};for(n in e)if(e.hasOwnProperty(n)){if(1===e[n]&&!bt(n)&&!ht(n)){t={errMsg:de.missing+n};break}bt(n)?t[n]=St(n):"customParams"===n?v.extend(t,lt()):ht(n)&&(t[n]=be[n]())}return t},getSDKDataByKey:function(e){return St(e)},isAppsInstalledInfoRestricted:ui,runFunction:function(e,n,t){var i=st(e);if(queueValidMessages[i.name])nativeCommunicator.runFunction(e,n,t);else{if("acknowledgeMessage"!==i.name||!window.shouldReportReady){var r,a=!0;r=z.parseJSON(i.parameters);try{z.isDefined(i.name)&&si(i.name,r,n,t)}catch(e){J.log("error running function:"+i.name+", error:"+e,J.LogLevels.error),a=!1}return a}nativeCommunicator.runFunction(e,n,t)}},callSDKFunction:function(e,n,t,i){N.callSDKFunction(e,n,t,i)},callSDKFunctionWithCallback:function(e,n,t,i){N.callSDKFunctionWithCallback(e,n,t,i)},callSDKService:function(e,n,t,i,r){N.callSDKService(e,n,t,i,r)},getApplicationInfo:function(r,e){var t,i,a=v.Deferred(),o=function(e,n){X.clearHandlers([t,i]),e?a.resolve(me):a.reject(de.appInfo,n)};if(t=X.subscribe(te+".parseApplicationInfo",function(e,n,t){var i;z.isDefined(e.productType)&&e.productType!==r.productType&&e.demandSourceName!==r.demandSourceName?J.log(b+"parseApplicationInfo | info sent for the wrong product"):(J.log(b+"parseApplicationInfo: "+JSON.stringify(e)),delete e.productType,delete e.demandSourceName,(i=Dt(e)).didSucceed?(z.isDefined(n)&&J.callSDKFunction(n),o(!0)):(z.isDefined(t)&&J.callSDKFunction(t,{errMsg:i.errMsg}),o(!1,i.errMsg)))}),i=X.subscribe(te+".getApplicationInfoFailed",function(e){ot(e),o(!1,"Failed retrieving application info")}),z.isDefined(e)&&e){var n=Dt(e);n.didSucceed?o(!0):(J.log(n.errMsg,J.LogLevels.error),o(!1,n.errMsg))}else J.callSDKFunction("getApplicationInfo",r,"parseApplicationInfo","getApplicationInfoFailed");return a.promise()},setCloseButtonState:Gt,getEnv:function(){m.environment.production;return me.mobileSDKSettings.debug&&0<parseInt(me.mobileSDKSettings.debug)&&me.mobileSDKSettings.domain!==m.domainUrls.prod?me.mobileSDKSettings.domain===m.domainUrls.local?m.environment.develop:m.environment.stage:m.environment.production},getProtocol:function(){return me.mobileSDKSettings.protocol},isLegacy:function(e){var n=-1;try{var t="android"===me.mobileSDKSettings.deviceOs?e.android:e.ios;n=z.versionCompare(me.mobileSDKSettings.SDKVersion,t)}catch(e){J.log(e,J.LogLevels.error)}return n<0},cacheAdUnitAssets:function(n,e){var t,i=e.assets,r=e.lastUpdateTime,a=i.length,o=new v.Deferred,s=[],d=0;for(0===a&&o.resolve(0),t=0;t<a;t++)s.push(J.cacheAsset(n,i[t],r));return v.when.apply(null,s).always(function(){var e=arguments;for(t in e)J.log(b+"path: "+n+" res: "+e[t],3),e[t]&&d++;o.resolve(d)}),o.promise()},cacheAsset:function(n,t,e,i){var r,a,o,s=[],d=new v.Deferred;if(z.isString(t)&&(t=[t]),"device"===me.applicationSettings.preCache){var c,l={path:z.isString(n)?n:n.toString(),overrideExistingFile:i},u=-1,f=function(e){d.reject(e),X.clearHandlers(s)},g=function(e){++u>=t.length?f(e||"Index error in array assets url"):(c=t[u],l.file=q?z.changeUrlProtocol(c,m.protocol.https):c,J.log(b+"saveFile | "+l.file+" path: "+decodeURIComponent(l.path)),J.callSDKFunction("saveFile",l,"preCacheFileSuccess","preCacheFileFailed"))};z.isDefined(e)&&(l.lastUpdateTime=e.toString()),r=X.subscribe(te+".assetCached",function(e){if(!sn(["path","file"],e,"preCacheFileSuccess").didSucceed)return J.log("error calling assetCached "+JSON.stringify(e),J.LogLevels.error),void f("error calling assetCached");decodeURIComponent(e.path)===n&&c.match(e.file)&&(X.clearHandlers(s),J.log(b+"saveFile | success: "+decodeURIComponent(e.path)+"/"+e.file),d.resolve(!0))}),a=X.subscribe(te+".assetCachedFailed",function(e){decodeURIComponent(e.path)===n&&c.match(e.file)&&(J.log(b+"saveFile | fail "+decodeURIComponent(e.path)+"/"+e.file),g("failed saved file"))}),o=X.subscribe(te+".preCacheFileFailed",function(e){decodeURIComponent(e.path)===n&&c.match(e.file)&&(J.log(e.errMsg+": "+decodeURIComponent(e.path)+"/"+e.file,J.LogLevels.error),g(e.errMsg))}),s.push(r),s.push(a),s.push(o),g()}else d.resolve(!0);return d.promise()},deleteFolder:function(e){z.isString(e)||e.toString(),J.callSDKFunction("deleteFolder",{path:e},"deleteFolderSuccess","deleteFolderFailed")},deleteAsset:function(n,t){var e,i,r=new v.Deferred,a=[];return z.isString(n)||n.toString(),z.isString(t)||t.toString(),e=X.subscribe(te+".deleteFileSuccess",function(e){if(!sn(["path","file"],e,"deleteFileSuccess").didSucceed)return J.log("error calling deleteFileSuccess "+JSON.stringify(e),J.LogLevels.error),r.reject("failed to delete file: "+e.file),void X.clearHandlers(a);decodeURIComponent(e.path)===n&&t.match(e.file)&&(X.clearHandlers(a),J.log("successfully deleted file: "+decodeURIComponent(e.path)+"/"+e.file),r.resolve())}),a.push(e),i=X.subscribe(te+".deleteFileFailed",function(e){if(!sn(["path","file"],e,"deleteFileFailed").didSucceed)return J.log("error calling deleteFileFailed "+JSON.stringify(e),J.LogLevels.error),r.reject("failed to delete file: "+e.file),void X.clearHandlers(a);decodeURIComponent(e.path)===n&&t.match(e.file)&&(X.clearHandlers(a),J.log("failed to delete file: "+e.file),r.reject("failed to delete file: "+e.file))}),a.push(i),J.callSDKFunction("deleteFile",{path:n,file:t},"deleteFileSuccess","deleteFileFailed"),r.promise()},setBackButtonState:function(e){var n=e?Ct():Ve.none;J.callSDKFunction("setBackButtonState",{state:n})},addAdToLoadedCreatives:function(e){return Y.addAd(e)},isContainerLoaded:function(e){return k.isContainerLoaded(e)},getContainerCreationHandler:function(e){return k.getContainerCreationHandler(e)},loadAdUnitUrl:function(e,n,t,i){k.createAndLoadView(e,n,t,i),Y.addAd(e)},displayAdView:function(e){k.displayAdView(e,En,kn,Bn)},updateAdUnitUrl:function(e,n,t,i){k.updateFrameUrl(e,n,t,i),Y.addAd(e)},onAdLoaded:function(e){J.log(b+"onAdLoaded | "+JSON.stringify(e));var n=function(){J.log(b+"ad loaded mismatch",J.LogLevels.error),Fe<Le&&(X.publish("SDKController.AdLoadError",[e]),Fe++)};if(e&&e.productType)if(Y.getAdById(J.AdUtils.getAdId(e),e))Yn(e);else{var t={eventParam:{eName:an.mismatchAdLoadError},action:"fireEvent",productType:e.productType};e.demandSourceName&&(t.demandSourceName=e.demandSourceName),X.publish("SDKController.Analytics",[t]),J.log(b+"onAdLoaded | mismatch from not being in loadedcreatives"),n()}else n()},removeAdUnit:function(e){if(j.isAdDisplayed(e)){var n=qt(e);Mn();var t=!(!n||!z.isFunction(n.getNextAd))&&n.getNextAd(!0,e.inventoryId);Wn(!1,t)}else{var i=Y.getAdById(J.AdUtils.getAdId(e),e);i.engaged=!1,At(i,{preloadNextInBG:!0})}},removeAdUnitFromExternal:function(e){Y.removeAdById(J.AdUtils.getAdId(e),e),p.PubSub.publish("SDKController.engageEnd",[e])},unloadAdViewsByProduct:bi,unloadAdViewsByProductExceptDisplayedView:mi,isRootFolder:function(e){return gi()?"SSAPublisher"===e:"supersonicads"===e},getCurrentDisplayedAd:function(){return j.get()},setCurrentDisplayedAd:function(e){return j.set(e)},getCurrentDisplayedAdType:function(){return j.getDisplayedAdType()},isAdDisplayed:function(e){return j.isAdDisplayed(e)},getGlobalAppData:function(){var n,t,i,r,a=new v.Deferred;return n=X.subscribe(te+".parseGlobalData",function(e){if(r="string"==typeof e.ssaGlobalAppData?z.parseJSON(decodeURIComponent(e.ssaGlobalAppData)):e.ssaGlobalAppData,J.log("Full global app data is: "+JSON.stringify(r)),!r)return a.reject("Invalid Global Data response"),void X.clearHandlers([n,t]);a.resolve(r),X.clearHandlers([n,t])}),t=X.subscribe(te+".getGlobalDataFailed",function(e){i=sn(["errMsg"],e,"getGlobalDataFailed").didSucceed?e.errMsg:sn(["errMsg"],e,"getGlobalDataFailed").errMsg,a.reject(i),X.clearHandlers([n,t])}),J.callSDKFunction("getUserData",{key:"ssaGlobalAppData"},"parseGlobalData","getGlobalDataFailed"),a.promise()},setCachePriorityArrayKey:function(n,t){return t?J.getGlobalAppData().then(function(e){return e.cachePriorityArray=e.cachePriorityArray||{},e.cachePriorityArray[n.cacheBase]=t,J.setGlobalAppData(e)}):p.Utils.returnResolvedPromise()},setGlobalAppData:function(e){var n,t,i,r=new v.Deferred;return n=X.subscribe(te+".setGlobalDataSuccess",function(){r.resolve(),X.clearHandlers([n,t])}),t=X.subscribe(te+".setGlobalDataFailed",function(e){i=sn(["errMsg"],e,"setGlobalDataFailed").didSucceed?e.errMsg:sn(["errMsg"],e,"setGlobalDataFailed").errMsg,r.reject(i),X.clearHandlers([n,t])}),J.callSDKFunction("setUserData",{key:"ssaGlobalAppData",value:JSON.stringify(e)},"setGlobalDataSuccess","setGlobalDataFailed"),r.promise()},getUserData:function(n,t){var i,r,a,o,s=new v.Deferred;return z.isDefined(t)&&!z.isDefined(n)?s.reject("Missing info to retrieve user data."):(i=X.subscribe(te+".parseUserData",function(e){return sn(["ssaUserData"],e,"parseUserData").didSucceed?(o="string"==typeof e.ssaUserData?z.parseJSON(decodeURIComponent(e.ssaUserData)):e.ssaUserData,J.log("Full user data is: "+JSON.stringify(o)),o?(z.isDefined(n)&&(o=o[n]||{},z.isDefined(t)&&(o=o[t]||{})),J.log("Get user data response: "+JSON.stringify(o)+" for appKey "+n+" and userId "+t),s.resolve(o)):s.reject("Invalid User Data response"),void X.clearHandlers([i,r])):(a=sn(["errMsg"],e,"parseUserData").errMsg,s.reject(a),void X.clearHandlers([i,r]))}),r=X.subscribe(te+".getUserDataFailed",function(e){a=sn(["errMsg"],e,"getUserDataFailed").didSucceed?e.errMsg:sn(["errMsg"],e,"getUserDataFailed").errMsg,s.reject(a),X.clearHandlers([i,r])}),J.callSDKFunction("getUserData",{key:"ssaUserData"},"parseUserData","getUserDataFailed")),s.promise()},setUserData:function(n,t,i){var r,a,o,s,d=new v.Deferred;return z.isDefined(n)&&z.isDefined(t)?v.when(J.getUserData()).then(function(e){s=e,z.isDefined(s[n])||(s[n]={}),z.isDefined(s[n][t])||(s[n][t]={}),i==={}?s[n][t]={}:v.extend(s[n][t],i),r=X.subscribe(te+".setUserDataSuccess",function(){d.resolve(),X.clearHandlers([r,a])}),a=X.subscribe(te+".setUserDataFailed",function(e){o=sn(["errMsg"],e,"setUserDataFailed").didSucceed?e.errMsg:sn(["errMsg"],e,"setUserDataFailed").errMsg,d.reject(o),X.clearHandlers([r,a])}),J.callSDKFunction("setUserData",{key:"ssaUserData",value:JSON.stringify(s)},"setUserDataSuccess","setUserDataFailed")},function(e){d.reject(e)}):d.reject("Missing info to set user data."),d.promise()},getConfig:function(){return me},getApplicationExternalConfig:function(){return d},isSupportedOsVersion:function(e){return null===E.getDeviceApiLevel().match(ke[e][me.mobileSDKSettings.deviceOs])},isLimitedDeviceModel:function(){if(!me.controllerConfig||-1===m.applicationsLimitations.indexOf(me.controllerConfig.applicationKey))return!1;var e=decodeURIComponent(me.mobileSDKSettings.deviceModel);return-1!==m.deviceLimitations.indexOf(e)},checkRequiredCallbackParams:function(e,n,t,i){return sn(e,n,t,i)},alert:function(e){var n,t=v("#ssaDialogText"),i=v(".dialogBox"),r=oi(),a=ri(r),o=ai(r),s=!1,d=v("#ssaDialogConfirmBtnText"),c=v("#ssaDialogCancelBtnText"),l=v("#ssaDialogBtns");Un({name:"dialogBoxAboutToOpen"}),i.removeAttr("style"),i.css("display","block"),(!Te||e&&e.alwaysClose)&&(k.hideLoader(),wn(),s=!0),Te||k.displayContainer(e);var u=h.getDisplayedAdFrame();if(u&&p.Msg.postMessage("hideFrame","*",u[0].contentWindow),l.removeClass("singleBtn"),"object"==typeof e&&(Pe.removeClass("hidden").removeAttr("style"),we.removeClass("hidden").removeAttr("style"),z.isDefined(e.close)?(n=e.close,d.text(e.yes),c.text(e.no),we.textWidth()>o.minDialogBtnWidth||Pe.textWidth()>o.minDialogBtnWidth?(Pe.css({width:o.maxDialogBtnWidth+"px",left:"20px"}),we.css({width:o.maxDialogBtnWidth+"px",right:"20px"})):(Pe.css({width:o.baseDialogBtnWidth+"px",left:"55px"}),we.css({width:o.baseDialogBtnWidth+"px",right:"55px"})),(we.textWidth()>o.maxDialogBtnTextWidth||Pe.textWidth()>o.maxDialogBtnTextWidth||-1!==v.inArray(" ",e.yes)||-1!==v.inArray(" ",e.no))&&(d.textfill2(a.buttonText),a.buttonText.parentContainer=Pe,c.textfill2(a.buttonText))):z.isDefined(e.message)?(n=e.message,z.isDefined(e.yes)&&d.text(e.yes),z.isDefined(e.no)&&c.text(e.no)):n=JSON.stringify(e),s)){l.addClass("singleBtn"),Pe.addClass("hidden");var f=we[0].offsetWidth/2;we.css("margin-left",-1*f+"px")}t.text(n),t.textfill2(a.dialogText),i.css("visibility","visible");var g=v("#ssaDialogBoxOverlay");g.fadeIn(100),g.bind("click",function(e){e.preventDefault()}),Ie.fadeIn(300)},log:t.log,logEvent:function(e,n){ut(e)},openUrl:function(e,n){Tn(e,n)},postAdUnitEvent:function(e,n){Un(e,n)},initEventics:Ft,initBannerExternalService:function(){R.init(),K.init()},getFormattedDeviceData:Ht,shouldExtendApiDataWithDebugData:Wt,extendApiDataWithDebugParams:Kt,getSDKDebugParams:Rt,getNotchService:function(){return G},getTokenService:function(){return W},setAllowFileAccessFromFileURLs:jt,getDeviceId:function(){return Jt(J.getConfig().mobileSDKSettings)},getSDKLimitationData:ci,addExternalAdViewIdAndSetStatus:function(e){R.addExternalAdViewIdAndSetStatus(e)},getExternalContainer:function(){return R},getAdViewContainer:function(e){return k.getAdViewByAd(e)},onAdVisible:Kn,saveFileToCache:Yt,getSegmentationAllocator:function(){return x},environmentConfiguration:function(){return U},getLoadedCreatives:function(){return Y},isBannerNoneLWS:xn,isBannerAndLoadWhileShowSupported:function(e){return e===m.BN&&J.CompatibilityService.isFeatureSupportedInNativeSDK(F.bannerMultipleInstances)}};return J=Si,Si}e.exports=function(e){var n=yi("../../components/Constants.js"),t=yi("../Cache.js"),i=yi("../InterstitialFactory.js"),r=yi("../OfferWall/OfferWall.js"),a=yi("../RewardedAdFactory.js"),o=yi("../BannerFactory.js"),s=yi("../../components/HTTPService.js"),d=yi("../../components/AdUtils"),c=yi("../../components/DemandUtils.js"),l=yi("../../components/SupplyConfigurations.js"),u=yi("../../components/HybridService.js"),f=yi("../../components/storeKit/StoreKitService.js"),g=yi("../../components/ViewsManager.js"),p=yi("../../components/PixelTrackingService.js"),v=yi("../../components/OpenURLService.js"),m=yi("../../components/MOATService.js"),b=yi("../../components/OMIDService.js"),h=yi("../../components/DeviceDataService.js"),S=yi("../../components/RingerSwitchService.js"),y=yi("../../components/OrientationService.js"),A=yi("../../components/GDPRservice.js"),C=yi("../../components/orientation/AppOrientationManager.js"),D=yi("../../components/PermissionService"),I=yi("./SDKLimitations"),w=yi("../../components/APIConfigurations.js"),P=yi("../../components/NativeLifeCycleEventsService.js"),T=yi("../../components/LastSeenCampaignService"),O=yi("../../components/AndroidNomediaFileHandler.js"),F=yi("../../components/ImpressionsCounterService.js"),L=yi("../DemandSource/FetchDemand/FetchDirect"),x=yi("../../components/ExtraOffers"),N=yi("../../components/CampaignsFilter.js"),U=yi("../../components/AdvertisingIdService.js"),M=yi("../../components/SKAdImpression/SKAdImpressionService"),V=yi("../../components/FeatureCompatibilityService"),E=yi("../Cache/AdsAssetsNativeCommunicator.js"),k=yi("../Cache/AdsAssetsManager.js"),B=yi("../../components/SKOverlay/SKOverlayManager.js"),R=yi("../../components/AppUserIdService.js"),K=yi("./InstancesTimers.js"),j=yi("../../components/EventsManager"),W=new G(e,window.jQuery,n);return W.Cache=new t(e,W),W.SDKLimitations=new I(W),W.OfferWall=new r(e,W),W.InterstitialFactory=new i(e,W),W.RewardedAdFactory=new a(e,W),W.BannerFactory=new o(e,W),W.HTTPService=new s(e,W),W.AdUtils=new d(e,W,window.jQuery),W.DemandUtils=new c(e,W,n),W.SupplyConfigurations=new l(W,n,window.jQuery),W.HybridService=new u(e,W),W.StoreKitService=new f(e,W,n),W.ViewsManager=new g(e),W.PixelTrackingService=new p(W),W.OpenURLService=new v(W),W.MOATService=new m(e,W),W.OMIDService=new b(e,W,window.jQuery),W.DeviceDataService=new h(e,W),W.RingerSwitchService=new S(e,W),W.OrientationService=new y(e,W,n),W.GDPRService=new A(e,W,n),W.AppOrientationManager=new C(e,W,n),W.PermissionService=new D(e,W),W.APIConfigurations=new w(W),W.NativeLifeCycleEventsService=new P(e,W,n),W.LastSeenCampaignService=new T(W,n),W.AndroidNomediaFileHandler=new O(W),W.ImpressionsCounterService=new F(n),W.FetchDirectService=new L(window.jQuery.ajax),W.ExtraOffers=new x(n,W.FetchDirectService,W.environmentConfiguration),W.CampaignsFilter=new N(e,W,n),W.AdvertisingIdService=new U(e,W,n),W.SKAdImpressionService=new M(e,W,n),W.CompatibilityService=new V(SuperSonicGlobalConfig.controllerConfig),W.AdsAssetsNativeCommunicator=new E(e,W),W.AdsAssetsManager=new k(e,W,W.AdsAssetsNativeCommunicator),W.SKOverlayManager=new B(e,W,n),W.AppUserIdService=new R(e,W,n),W.InstancesTimers=new K,W.EventsManager=new j(W),W}},{"../../components/APIConfigurations.js":1,"../../components/AdOrientationManager":2,"../../components/AdUtils":3,"../../components/AdvertisingIdService.js":4,"../../components/AndroidNomediaFileHandler.js":7,"../../components/AppUserIdService.js":9,"../../components/BlacklistService":10,"../../components/CampaignsFilter.js":11,"../../components/Constants.js":12,"../../components/DemandUtils.js":13,"../../components/DeviceDataService.js":15,"../../components/DisplayedAdManager.js":16,"../../components/EventsManager":17,"../../components/ExternalConfig":18,"../../components/ExtraOffers":19,"../../components/FeatureCompatibilityService":20,"../../components/FrameHelper.js":24,"../../components/GDPRservice.js":26,"../../components/HTTPService.js":27,"../../components/HybridService.js":28,"../../components/IframeManager":29,"../../components/ImpressionsCounterService.js":30,"../../components/LastSeenCampaignService":32,"../../components/Logger.js":33,"../../components/MOATService.js":34,"../../components/NativeAPIAdapter.js":37,"../../components/NativeLifeCycleEventsConstants.js":38,"../../components/NativeLifeCycleEventsService.js":39,"../../components/NotchFactory.js":40,"../../components/OMIDService.js":43,"../../components/OpenURLService.js":45,"../../components/OrientationService.js":47,"../../components/PermissionService":49,"../../components/PixelTrackingService.js":51,"../../components/RingerSwitchService.js":54,"../../components/SKAdImpression/SKAdImpressionService":55,"../../components/SKOverlay/SKOverlayManager.js":58,"../../components/SupplyConfigurations.js":59,"../../components/ViewsManager.js":62,"../../components/containers/AdViewsManager.js":64,"../../components/containers/BackgroundController":65,"../../components/containers/BannerExternalAdViewService":66,"../../components/containers/BannerExternalContainer.js":67,"../../components/containers/NavigationModeView":73,"../../components/containers/WPADUtils":74,"../../components/containers/WebView":75,"../../components/containers/WebViewManager.js":76,"../../components/orientation/AppOrientationManager.js":78,"../../components/storeKit/StoreKitService.js":86,"../../components/token/TokenService.js":88,"../../constants/SDKFeatureNames":89,"../../modules/SDKController/EventCategories":143,"../../patches/PatchAppOrientation":168,"../../presenter/uiConfig.js":173,"../AdUnitManager/AdUnitGlobals.js":94,"../AdUnitManager/LibsManager.js":97,"../AdUnitUrl.js":98,"../BannerFactory.js":101,"../Cache.js":102,"../Cache/AdsAssetsManager.js":104,"../Cache/AdsAssetsNativeCommunicator.js":105,"../DemandSource/FetchDemand/FetchDirect":114,"../Environment/EnvironmentManager":121,"../InterstitialFactory.js":127,"../OfferWall/OfferWall.js":130,"../ProductRouter.js":135,"../RewardedAdFactory.js":136,"../SDKInterface.js":156,"../UserSegmentation/SegmentationAllocator.js":158,"../UserSegmentation/SegmentationManager":160,"./ConfigurationHelper.js":142,"./InstancesTimers.js":144,"./LoadedCreatives":145,"./MessageHandler":147,"./SDKLimitations":149,"./instancesManager.js":151,"./mainConfig.js":152,"./nativeConfigHandler.js":153,"./sessionConfig":154,"./videoStateHandler.js":155}],149:[function(e,n,t){n.exports=function(t){var i=" is not supported";return{getLimitData:function(e){var n={errMsg:"",didSucceed:!0};return t.isSupportedOsVersion(e)?t.isLimitedDeviceModel()&&(n.errMsg="Device"+i,n.didSucceed=!1):(n.errMsg="Operating system version "+t.getApiData({deviceOSVersion:1}).deviceOSVersion+i,n.didSucceed=!1),n}}}},{}],150:[function(e,n,t){n.exports=function(s,n,d){var c={v:function(e){return e.match(/^[0-9]+?[.]?[0-9]+?[.]?[0-9]+$/)},appOrientation:function(e){var n=e;return"portrait"===(n=n.toLowerCase())||"landscape"===n||"none"===n},connectionType:function(e){var n=decodeURIComponent(e);return"wifi"===(n=n.toLowerCase())||n.match(/^mobile\[.+\]$/)||"3g"===n||"none"===n},iphoneAppOnIpadDevice:function(e){var n=parseInt(e);return 0===n||1===n},deviceOs:function(e){return e&&""!==e},SDKVersion:function(e){return e&&""!==e},deviceOSVersion:function(e){return e&&""!==e},deviceApiLevel:function(e){return e&&""!==e},bundleId:function(e){return e&&""!==e},"deviceIds[OpenUDID]":function(e){return s.isDefined(e)},"deviceIds[IFA]":function(e){return s.isDefined(e)},"deviceIds[SERIAL]":function(e){return s.isDefined(e)},"deviceIds[AndroidID]":function(e){return s.isDefined(e)},"deviceIds[IMEI]":function(e){return s.isDefined(e)},"deviceIds[AID]":function(e){return s.isDefined(e)},deviceScreenScale:function(){return!0},"deviceScreenSize[width]":function(){return!0},"deviceScreenSize[height]":function(){return!0},diskFreeSize:function(e){var n=parseInt(e);return!isNaN(n)&&0<=n},showDeliveryLimitationsLog:function(){return!0},country:function(e){return e&&""!==e},debug:function(e){return s.isDefined(n[e])},disableCache:function(e){var n=parseInt(e);return 0===n||1===n},disableSession:function(e){var n=parseInt(e);return 0===n||1===n},applicationKey:function(e){return e&&""!==e},applicationUserId:function(e){return e&&""!==e},applicationUserGender:function(e){return"unknown"===e||"female"===e||"females"===e||"male"===e||"males"===e||"both"===e},applicationUserAgeGroup:function(e){var n=parseInt(e);return 0<=n&&n<=9},applicationUserCreationDate:function(e){return e.match(/^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$/)},maxVideoLength:function(e){var n=parseInt(e);return!isNaN(n)&&0<=n},itemCount:function(e){var n=parseInt(e);return!isNaN(n)&&0<n},minimumOfferCommission:function(e){var n=parseFloat(e);return!isNaN(n)&&0<=n},demoCampaigns:function(e){var n=parseInt(e);return 0===n||1===n},numOfCampaigns:function(e){var n=parseInt(e);return!isNaN(n)&&0<=n},campaignId:function(e){var n=parseInt(e);return!isNaN(n)&&0<n},pageSize:function(e){var n=parseInt(e);return!isNaN(n)&&0<=n},landingId:function(e){var n=parseInt(e);return!isNaN(n)&&0<n},page:function(e){var n=parseInt(e);return!isNaN(n)&&0<n},admin:function(e){var n=parseInt(e);return 0===n||1===n},useClientSideCallbacks:function(e){var n=e.toString();return"true"===n||"false"===n},unLocked:function(e){var n=e.toString();return"true"===n||"false"===n},isLimitAdTrackingEnabled:function(e){return s.isDefined(e)},placementId:function(e){var n=parseInt(e);return!isNaN(n)&&0<=n},allowArbitraryLoads:function(e){var n=e.toString();return"true"===n||"false"===n},allowArbitraryLoadsInWebContent:function(e){var n=e.toString();return"true"===n||"false"===n}};return function(e,n){var t,i,r,a=!0,o=null;for(t in e){if(s.isDefined(c[t])&&!1===c[t](e[t])){o=d.invalid+t,a=!1;break}r=e[i=t],n[i]=r}return{didSucceed:a,errMsg:o}}}},{}],151:[function(e,n,t){n.exports=function(c,f){var r,a=!1,g={},p={};g[f.RV]=[],g[f.IS]=[],g[f.BN]=[],p[f.RV]={},p[f.IS]={},p[f.BN]={};var v=e("../DemandSource/DemandEntityBuilder.js"),o=e("./ManualLoadInstancesBuilder.js");function m(e,n){for(var t=0;t<e.length;t++)if(e[t].demandSourceName===n)return t;return-1}function s(e,n){if(n&&0<n.length)for(var t=n,i=0;i<t.length;i++)t[i].instancesOrderList=[],t[i].instancesUninitializedList=[],g[e].push(t[i])}return{init:function(e,n){var t,i;a||(e&&((i=e.instancesMap)&&(i[f.sspProductNames.RewardedVideo]&&s(f.RV,i[f.sspProductNames.RewardedVideo]),i[f.sspProductNames.Interstitial]&&s(f.IS,i[f.sspProductNames.Interstitial]),i[f.sspProductNames.Banner]&&s(f.BN,i[f.sspProductNames.Banner])),(t=e.waterfallMap)&&(p[f.RV]=t[f.sspProductNames.RewardedVideo]||{},p[f.IS]=t[f.sspProductNames.Interstitial]||{},p[f.BN]=t[f.sspProductNames.Banner]||{})),r=new o(e,f),a=!0)},getManualLoadInstancesBuilder:function(){return r},createUninitializedDemandInstance:function(e,n,t){var i=g[e];if(i){for(var r,a=0;a<i.length;a++){var o=i[a],s=o&&o.instances;if(!s)break;var d=m(i[a].instancesUninitializedList,n);if(-1<d?r=i[a].instancesUninitializedList[d]:-1<s.indexOf(n)&&(r=new v({productType:e},{demandSourceName:n,demandGroupName:o.demandGroupName,demandType:f.demandSourceType.instance,isInAppBidding:t,integrationType:f.integrationType.automatic,waterfallPosition:p[e][n]}),i[a].instancesUninitializedList.push(r)),r)break}return r||(r=new v({productType:e},{demandSourceName:n,isInAppBidding:t,integrationType:f.integrationType.automatic,waterfallPosition:p[e][n]})),r}},initiateDemandInstance:function(e,n,t,i){var r,a,o,s,d,c,l,u=(o=new v({productType:r=e},{demandSourceName:a=n,demandGroupName:a,demandType:f.demandSourceType.demandSource,waterfallPosition:p[r][a]}),(s=g[r])&&s.forEach(function(e){var n=e.instances;if(n&&-1<n.indexOf(a)){var t=m(e.instancesUninitializedList,a);-1<t?o=e.instancesUninitializedList[t]:-1<(t=m(e.instancesOrderList,a))&&(o=e.instancesOrderList[t])}}),o);!function(e){var n=g[e.productType];if(n)for(var t=0;t<n.length;t++){var i=n[t],r=i&&i.instances;if(!r)break;var a=r.indexOf(e.demandSourceName);if(-1<a){var o=m(i.instancesUninitializedList,e.demandSourceName);if(-1<o&&i.instancesUninitializedList.splice(o,1),-1===m(i.instancesOrderList,e.demandSourceName))if(i.instanceOrderByActivation)i.instancesOrderList.push(e);else{var s=Math.min(i.instancesOrderList.length,a);i.instancesOrderList.splice(s,0,e)}break}}}(u),u.demandType===f.demandSourceType.instance?(u.initiationCallback=t,u.pendingInitiationCallback=i,d=n,c=!0,(l=g[e])&&l.forEach(function(e){var n=e.instances;if(n&&-1<n.indexOf(d)){var t=e.instanceOrderByActivation;c=e.instancesOrderList[0].demandSourceName===d&&(t||n[0]===d)}}),c?u.initiationCallback():u.pendingInitiationCallback()):t()},exhaustedDemandSource:function(e,n){if((!n.demandType||n.demandType===f.demandSourceType.instance)&&e&&n.demandGroupName&&n.demandSourceName&&g[e])for(var t=g[e],i=0;i<t.length;i++)if(t[i].demandGroupName&&t[i].demandGroupName===n.demandGroupName){var r=t[i].instances,a=t[i].instancesOrderList,o=m(a,n.demandSourceName);return void(0<=o&&(r.push(r.shift(n.demandSourceName)),a.splice(o,1),s=t[i],d=e,s&&s.instancesOrderList&&0<s.instancesOrderList.length&&c.Utils.isFunction(s.instancesOrderList[0].initiationCallback)&&(s.instancesOrderList[0].alreadyDispatchedInitiationCallback||(d===f.IS&&(s.instancesOrderList[0].alreadyDispatchedInitiationCallback=!0),s.instancesOrderList[0].initiationCallback()))))}var s,d}}}},{"../DemandSource/DemandEntityBuilder.js":111,"./ManualLoadInstancesBuilder.js":146}],152:[function(e,n,t){n.exports=function(){return{deviceDataRequestObject:{deviceOs:1,SDKVersion:1,deviceOSVersion:1,deviceApiLevel:0}}}},{}],153:[function(i,e,n){function t(e,n){var t=i("../../components/Constants.js");return e.subscribe(t.CB+".nativeConfigSuccess",function(e){n.log("nativeConfig update successfully.",n.LogLevels.error)}),e.subscribe(t.CB+".nativeConfigFailed",function(e){n.log("nativeConfig failed to update.",n.LogLevels.error)}),{setNativeConfiguration:function(e){e&&n.callSDKFunction("setNativeConfiguration",e,"nativeConfigSuccess","nativeConfigFailed")}}}var r;e.exports=function(e,n){return r||(r=new t(e,n)),r}},{"../../components/Constants.js":12}],154:[function(e,n,t){n.exports=function(){return{native:{ios:{supportViewControllerFromAdapter:!0,allowOrientationFromAppDelegate:!0}}}}},{}],155:[function(s,e,n){function t(e,n){var t=s("../../components/Constants.js"),i=t.videoStates,r=t.BC,a=i.none,o=n.isLegacy(n.featureMap.MDS[t.RV]);return r=o?t.BC:t.RV,e.subscribe("SDKController.AdStarted",function(){n.log("VideoStateHandler | AdStarted",n.LogLevels.verbose),a=i.play,n.callSDKFunction("onVideoStatusChanged",{status:"started",productType:r})}),e.subscribe("SDKController.AdPlaying",function(){n.log("VideoStateHandler | AdPlaying",n.LogLevels.verbose),a=i.play,n.callSDKFunction("onVideoStatusChanged",{status:"playing",productType:r})}),e.subscribe("SDKController.AdPaused",function(){n.log("VideoStateHandler | AdPaused",n.LogLevels.verbose),a=i.stop,n.callSDKFunction("onVideoStatusChanged",{status:"paused",productType:r})}),e.subscribe("SDKController.AdVideoEnded",function(){n.log("VideoStateHandler | AdVideoEnded",n.LogLevels.verbose),a=i.stop,n.callSDKFunction("onVideoStatusChanged",{status:"ended",productType:r})}),{handleOnEngageEnd:function(){n.log("VideoStateHandler | handleOnEngageEnd onVideoStatusChanged stopped from engaged end",n.LogLevels.verbose),a=i.none,n.callSDKFunction("onVideoStatusChanged",{status:"stopped",productType:r})},getState:function(){return a}}}var i;e.exports=function(e,n){return i||(i=new t(e,n)),i}},{"../../components/Constants.js":12}],156:[function(e,n,t){var o=e("./iOSSDKInterface.js"),s=e("./iOSSDKInterface_WK.js"),d=e("./androidSDKInterface.js");n.exports=function(e,n,t,i){"use strict";var r,a="undefined";switch(i=t.isLegacy(n.featureCompatibilityMap.messageSecurity)?null:i,e.deviceOs){case n.deviceOs.android:r=new d(i,t,a);break;case n.deviceOs.ios:r="wk"===e.webviewType?new s(a):new o(a);break;default:r=new o(a)}return r}},{"./androidSDKInterface.js":164,"./iOSSDKInterface.js":165,"./iOSSDKInterface_WK.js":166}],157:[function(p,e,n){function v(i){var r,a,o={},s={},t=!1,d=function(n,e){var t=null;o=r.Utils,(s=r.PubSub).init(),o.isDefined(n.mobileSDKSettings)&&(t=(a=r.SDKController).init(n,e)),i.when(t).then(function(){n.products&&i.each(n.products,function(e){o.isDefined(e.init)&&e.init(n[e])})},function(){console.log("Failed to initiate controller")})},e={init:function(e,n){return r=this,d(e,n),t=!0},log:function(e,n){a&&a.log&&a.log(e,n||a.LogLevels.error)}};return e}e.exports=function(e,n,t,i){var r=p("../components/Utils.js"),a=p("../components/PubSub.js"),o=p("../components/Msg.js"),s=p("./AdAssets.js"),d=p("./VastUtils.js"),c=n.Eventics,l=new v(e),u={};l.Utils=new r(l,n,t,i),l.PubSub=new a(l),l.Msg=new o,l.AdAssets=new s,l.VastUtils=new d(l.AdAssets);var f,g=["KuduEventicsProvider"];return f=n.productionDebug||n.SuperSonicGlobalConfig&&n.SuperSonicGlobalConfig.mobileSDKSettings&&"www.supersonicads.com"!==n.SuperSonicGlobalConfig.mobileSDKSettings.domain?(g.push("QAEventicsProvider"),1):Math.random(),n.SuperSonicGlobalConfig&&n.SuperSonicGlobalConfig.mobileSDKSettings&&n.SuperSonicGlobalConfig.mobileSDKSettings.protocol&&(u.isSecured="https:"===n.SuperSonicGlobalConfig.mobileSDKSettings.protocol),l.Eventics=c(f),l.Eventics.setProvidersHandlers(g),l.Eventics.setProvidersConfig(u),l.PubSub.subscribe("updateEventsBaseData",function(e){e&&"object"!=typeof e||l.Eventics.updateBaseData(e)}),l}},{"../components/Msg.js":35,"../components/PubSub.js":52,"../components/Utils.js":60,"./AdAssets.js":91,"./VastUtils.js":162}],158:[function(e,n,t){n.exports=function(t){var i=e("./SegmentsRepository");function r(e,n){t.addSegment(e,n)}return{addCellularNetworkTypeSegment:function(e){var n,t=i.cellularNetworkType;-1===e?n=t.cellularNetworkTypeUnknown:"notReachable"===e?n=t.cellularNetworkTypeNotReachable:"wifi"===e?n=t.cellularNetworkTypeWifi:-1!==["CTRadioAccessTechnologyGPRS","CTRadioAccessTechnologyEdge","CTRadioAccessTechnologyCDMA1x"].indexOf(e)?n=t.cellularNetworkType2G:-1!==["CTRadioAccessTechnologyWCDMA","CTRadioAccessTechnologyHSDPA","CTRadioAccessTechnologyHSUPA","CTRadioAccessTechnologyCDMAEVDORev0","CTRadioAccessTechnologyCDMAEVDORevA","CTRadioAccessTechnologyCDMAEVDORevB","CTRadioAccessTechnologyeHRPD"].indexOf(e)?n=t.cellularNetworkType3G:"CTRadioAccessTechnologyLTE"===e&&(n=t.cellularNetworkType4G),r(n,t)},addIsSDCardAvailableSegment:function(e){var n,t=i.isSDCardAvailable;-1===e?n=t.isSDCardAvailableUnknown:"true"===e?n=t.isSDCardAvailableTrue:"false"===e&&(n=t.isSDCardAvailableFalse),r(n,t)},addTotalDeviceRAMSegment:function(e){var n=i.totalDeviceRAM,t=-1===e?e:parseInt(e)/1073741824;r(-1===e?n.totalDeviceRAMUnknown:t<1?n.totalDeviceRAMUnder1GB:t<2?n.totalDeviceRAMUnder2GB:t<3?n.totalDeviceRAMUnder3GB:t<4?n.totalDeviceRAMUnder4GB:t<6?n.totalDeviceRAMUnder6GB:t<8?n.totalDeviceRAMUnder8GB:t<12?n.totalDeviceRAMUnder12GB:n.totalDeviceRAM12GBAndAbove,n)},addIsChargingSegment:function(e){var n,t=i.isCharging;-1===e?n=t.isChargingUnknown:"true"===e?n=t.isChargingTrue:"false"===e&&(n=t.isChargingFalse),r(n,t)},addAirplaneModeSegment:function(e){var n,t=i.airplaneMode;-1===e?n=t.airplaneModeUnknown:"true"===e?n=t.airplaneModeTrue:"false"===e&&(n=t.airplaneModeFalse),r(n,t)},addChargingTypeSegment:function(e){var n=i.chargingType;r(-1===e?n.chargingTypeUnknown:"1"===e?n.chargingTypeAC:"2"===e?n.chargingTypeUSB:"4"===e?n.chargingTypeWireless:n.chargingTypeNone,n)},addStayOnWhenPluggedInSegment:function(e){var n,t=i.stayOnWhenPluggedIn;-1===e?n=t.stayOnWhenPluggedInUnknown:"true"===e?n=t.stayOnWhenPluggedInTrue:"false"===e&&(n=t.stayOnWhenPluggedInFalse),r(n,t)},addBatteryLevelSegment:function(e){var n,t=i.batteryLevel;void 0===e||e<0||(e<=20?n=t.batteryLowestFifth:e<=40?n=t.batterySecondFifth:e<=60?n=t.batteryThirdFifth:e<=80?n=t.batteryFourthFifth:e<=100&&(n=t.batteryHighestFifth)),r(n,t)},addAdLevelCacheSegment:function(e){r(e,i.adLevelCache)},addControllerSourceSegment:function(e){var n=i.controllerSourceStrategy;switch(e){case 0:r(n.fetchFromServerNoFallback,n);break;case 1:r(n.fetchFromServerWithLocalFallback,n);break;case 2:r(n.fetchForNextSessionLoadFromLocal,n)}}}}},{"./SegmentsRepository":161}],159:[function(e,n,t){n.exports={events:{receivedFromAdunit:{addSegment:"SDKController.addSegment",getSegments:"SDKController.getSegments",clearSegmentFromGroup:"SDKController.clearSegmentFromGroup"},sendToAdunit:{updateUserSegments:"updateUserSegments"}}}},{}],160:[function(d,e,n){e.exports=function(e,t){var i="SegmentationManager | ",n=d("./SegmentationConstants"),r=d("./SegmentsRepository"),c=[];function a(e,n){(function(e,n){if(isNaN(e)||(r=e,-1!==c.indexOf(r))||(t=e,!l(i=n)||!function(e,n){for(var t=Object.keys(n),i=0;i<t.length;i++){var r=n[t[i]];if(e===r)return!0}return!1}(t,i)))return!1;for(var t,i,r,a=Object.keys(n),o=0;o<a.length;o++)for(var s=n[a[o]],d=0;d<c.length;d++)if(c[d]===s)return c[d]=e,!0;return c.push(e),!0})(e,n)&&s()}function l(e){return e&&"object"==typeof e}function o(e){if(l(e))for(var n=Object.keys(e),t=0;t<c.length;t++)for(var i=0;i<n.length;i++){var r=e[n[i]];if(c[t]===r)return c.splice(t,1),void s()}}function s(){e.PubSub.publish("updateEventsBaseData",[{segments:c.toString()}]),t.postAdUnitEvent({name:n.events.sendToAdunit.updateUserSegments,segments:c},!0)}return{init:function(){e.PubSub.subscribe(n.events.receivedFromAdunit.addSegment,function(e){a(e.segment,e.segmentGroup)}),e.PubSub.subscribe(n.events.receivedFromAdunit.getSegments,function(e){if(t.log(i+" controller - getSegments received"),e.getSegmentsCallback){var n=e.getSegmentsCallback;t.log(i+"send back to adunit "+n+" with data: "+JSON.stringify(c)),t.postAdUnitEvent({name:n,segments:c},!0)}}),e.PubSub.subscribe(n.events.receivedFromAdunit.clearSegmentFromGroup,function(e){o(e.segmentGroup)})},addSegment:a,getUserSegmentsObjectsAsArray:function(){return c},clearSegmentFromGroup:o,segmentsRepository:r}}},{"./SegmentationConstants":159,"./SegmentsRepository":161}],161:[function(e,n,t){n.exports={batteryLevel:{batteryLowestFifth:101,batterySecondFifth:102,batteryThirdFifth:103,batteryFourthFifth:104,batteryHighestFifth:105},cellularNetworkType:{cellularNetworkTypeWifi:117,cellularNetworkType2G:118,cellularNetworkType3G:119,cellularNetworkType4G:120,cellularNetworkTypeNotReachable:121,cellularNetworkTypeUnknown:122},isCharging:{isChargingTrue:123,isChargingFalse:124,isChargingUnknown:125},airplaneMode:{airplaneModeTrue:126,airplaneModeFalse:127,airplaneModeUnknown:128},stayOnWhenPluggedIn:{stayOnWhenPluggedInTrue:129,stayOnWhenPluggedInFalse:130,stayOnWhenPluggedInUnknown:131},chargingType:{chargingTypeAC:132,chargingTypeUSB:133,chargingTypeWireless:134,chargingTypeNone:135,chargingTypeUnknown:136},totalDeviceRAM:{totalDeviceRAMUnder1GB:137,totalDeviceRAMUnder2GB:138,totalDeviceRAMUnder3GB:139,totalDeviceRAMUnder4GB:140,totalDeviceRAMUnder6GB:141,totalDeviceRAMUnder8GB:142,totalDeviceRAMUnder12GB:143,totalDeviceRAM12GBAndAbove:144,totalDeviceRAMUnknown:145},isSDCardAvailable:{isSDCardAvailableTrue:146,isSDCardAvailableFalse:147,isSDCardAvailableUnknown:148},adLevelCache:{adLevelCacheTimeoutControl:154,adLevelCacheTimeoutFiveMinutes:155,adLevelCacheTimeoutThirtySeconds:156},controllerSourceStrategy:{fetchFromServerNoFallback:151,fetchFromServerWithLocalFallback:152,fetchForNextSessionLoadFromLocal:153}}},{}],162:[function(e,n,t){n.exports=function(n){function t(e){if(e)return!e.controllerSpace||e.controllerSpace.viewCount}function i(e,n){return e&&(e.controllerSpace||(e.controllerSpace={}),e.controllerSpace.viewCount=n),e}function r(e){return!!e&&(0<n.extractVastSource(e).length||e.ext&&e.ext.videoData&&!0===e.ext.videoData.isVast)}return{getVastViewCount:t,setVastViewCount:i,setMaxVastCount:function(e){e&&r(e)&&"number"==typeof e.ext.vastExhaustIndex&&0<e.ext.vastExhaustIndex&&i(e,e.ext.vastExhaustIndex)},isVastCampaign:r,isThereVastCampaign:function(e){if(!e||!jQuery.isArray(e))return!1;for(var n=!1,t=0;t<e.length;t++)if(r(e[t])){n=!0;break}return n},areAllCampaignTypesAreVast:function(e){if(!e||!jQuery.isArray(e)||0===e.length)return!1;for(var n=!0,t=0;t<e.length;t++)if(!r(e[t])){n=!1;break}return n},incrementVastViewCount:function(e){return e&&r(e)?(e.controllerSpace||(e.controllerSpace={}),e.controllerSpace.viewCount=e.controllerSpace.viewCount?e.controllerSpace.viewCount+1:1,e.controllerSpace.viewCount):-1},isVastCanPlayAgain:function(e){return!!e&&r(e)&&e.ext.vastExhaustIndex&&t(e)<e.ext.vastExhaustIndex},getVastViewCountForEvent:function(e){return"number"==typeof e?e:-1}}}},{}],163:[function(r,e,n){(function(e){"use strict";var n=r("./SonicCore.js"),t=r("./SDKController/SDKController.js");var i=e.SonicCore=e.SSA_CORE=new n(e.jQuery,e,document,"undefined");i.SDKController=new t(i,"undefined"),"function"==typeof sonicAsyncInit&&sonicAsyncInit()})(window)},{"./SDKController/SDKController.js":148,"./SonicCore.js":157}],164:[function(e,n,t){function i(i,t,n){function r(e,n){var t=i.hashMessage(e,n);Android.messageHandler(e,JSON.stringify(n),t)}function a(e,n){Android[e](JSON.stringify(n))}function o(e,n){return void 0!==e&&e[n]}var s={postMessage:function(n,e){if(o(window.Android,i?"messageHandler":n))try{i?r(n,e):a(n,e)}catch(e){t.log("Error running function "+n+" error:"+JSON.stringify(e),t.LogLevels.error)}else t.log("Error calling SDK function "+n,t.LogLevels.error)}},e={postMessage:function(e){typeof e.eventName!==n&&typeof e.prefix!==n&&typeof e.parameters!==n&&("function"==typeof s[e.eventName]?s[e.eventName](e.parameters):s.postMessage(e.eventName,e.parameters))},acknowledgeMessage:function(){return!0}};return e}n.exports=i},{}],165:[function(e,n,t){function i(n){var i=function(e,n,t){var i,r=e+"://"+n+"?";jQuery.each(t,function(e,n){"object"==typeof n&&(t[e]=JSON.stringify(n))}),i=r+jQuery.param(t),a(i)},t=function(e){var n=document.createElement("IFRAME");n.setAttribute("src",e),document.documentElement.appendChild(n),n.parentNode.removeChild(n),n=null},a=function(e){0===o.length?(o.push("1"),t(e)):o.push(e)},r={postMessage:function(e,n,t){i(e,n,t)}},o=[],e={postMessage:function(e){typeof e.eventName!==n&&typeof e.prefix!==n&&typeof e.parameters!==n&&("function"==typeof r[e.eventName]?r[e.eventName](e.parameters):r.postMessage(e.prefix,e.eventName,e.parameters))},acknowledgeMessage:function(){if(0!==o.length){var e=o.shift();"1"===e&&0!==o.length&&(e=o.shift()),void 0!==e&&"1"!==e&&t(e)}}};return e}n.exports=i},{}],166:[function(e,n,t){function i(n){var i=function(e,n,t){var i,r=e+"://"+n+"?";jQuery.each(t,function(e,n){"object"==typeof n&&(t[e]=JSON.stringify(n))}),i=r+jQuery.param(t),a(i)},t=function(e){void 0!==window.webkit.messageHandlers&&void 0!==window.webkit.messageHandlers.supersonicMainMsgHandler&&window.webkit.messageHandlers.supersonicMainMsgHandler.postMessage(e)},a=function(e){0===o.length?(o.push("1"),t(e)):o.push(e)},r={postMessage:function(e,n,t){i(e,n,t)}},o=[],e={postMessage:function(e){typeof e.eventName!==n&&typeof e.prefix!==n&&typeof e.parameters!==n&&("function"==typeof r[e.eventName]?r[e.eventName](e.parameters):r.postMessage(e.prefix,e.eventName,e.parameters))},acknowledgeMessage:function(){if(0!==o.length){var e=o.shift();"1"===e&&0!==o.length&&(e=o.shift()),void 0!==e&&"1"!==e&&t(e)}}};return e}n.exports=i},{}],167:[function(e,n,t){n.exports=function(t,n,i,r){var e=!1,a=!1,o=!1,s=!0,d=r.CB+".enterBackground",c=r.CB+".enterForeground",l=r.CB+".deviceStatusChanged",u="prdTaskManager | ";return{init:function(){e||(t.PubSub.subscribe(r.taskManager+".Engaged",function(e){!t.Utils.isDefined(e.duringEngage)||e.productType!==i&&e.productType!==r.BC||(a=e.duringEngage,n.log(u+"duringEngage "+a))}),t.PubSub.subscribe(d,function(){n.log(u+d),o=!0}),t.PubSub.subscribe(c,function(){n.log(u+c),o=!1}),t.PubSub.subscribe(l,function(e){t.Utils.isDefined(e.connectionType)&&(s="none"!==e.connectionType&&"notReachable"!==e.connectionType)}),e=!0)},canEngage:function(){return!a&&s},isConnected:function(){return s},setConnection:function(e){s=e},canInitCallToApi:function(){var e=new jQuery.Deferred;return o?t.PubSub.subscribeOnce(c,function(){e.resolve()}):e.resolve(),e.promise()},getStatusMsg:function(){return"product TM - duringEngage:"+a+" appInBackground:"+o+" isConnected:"+s},getStatus:function(){return{duringEngage:a,appInBackground:o,isConnected:s}},publish:function(e,n){t.PubSub.publish(r.taskManager+"."+e,n)}}}},{}],168:[function(e,n,t){n.exports=function(e){return e&&"unknown"!==e?{appOrientation:e}:{appOrientation:"none",patch:!0}}},{}],169:[function(e,n,t){n.exports=function(n,t,i){var r="ios"===t.getConfig().mobileSDKSettings.deviceOs&&i&&"M"===i.integrationType;return r&&(t.log("PATCH | LoadAfterLoad | create listener for instance: "+JSON.stringify(i)),n.PubSub.subscribe("freeSDK5StateToAllowLoadAfterLoad",function(e){var n;n=e,t.log("PATCH | LoadAfterLoad | subscribe called for: "+JSON.stringify(i)+" , with params:"+JSON.stringify(n)),n&&i&&i.demandGroupName===n.demandGroupName&&i.productType===n.productType&&i.demandSourceName!==n.demandSourceName&&(t.log("PATCH | LoadAfterLoad | perform callSDKFunction with: "+JSON.stringify(e)),t.callSDKFunction("loadInterstitialFail",{demandSourceName:i.demandSourceName}))})),{onShowSuccess:function(e){r&&n.PubSub.publish("freeSDK5StateToAllowLoadAfterLoad",[{productType:e.productType,demandGroupName:e.demandGroupName,demandSourceName:e.demandSourceName}])}}}},{}],170:[function(e,n,t){n.exports=function(n,t){var i=e("../constants/SDKFeatureNames");return{shouldBlock:function(e){return(!t||!t.isFeatureSupportedInNativeSDK(i.storeKitDismissVCOnFinishCallback))&&0<=n.versionCompare(e,"13.2")}}}},{"../constants/SDKFeatureNames":89}],171:[function(e,n,t){n.exports=function(e,t,r){function i(){var e=decodeURIComponent(t.deviceModel);return-1!==r.iphoneXDeviceModels.indexOf(e)}function n(){var e=t.deviceWidthDP,n=t.deviceHeightDP;return i()&&function(e,n){var t=r.iphoneXDeviceResolution;for(var i in t)if(t.hasOwnProperty(i)&&t[i].width&&t[i].height&&(e===t[i].width&&n===t[i].height||e===t[i].height&&n===t[i].width))return!0;return!1}(e,n)}return{hasNotch:i,onEngageEnd:function(){n()},onSetConfig:function(e){return i()&&(n=e).settings&&n.settings.standaloneView;var n},className:"PatchesIphoneX"}}},{}],172:[function(e,n,t){n.exports=function(n){var t={android:/^\b[1][0-9]\b|\b[2][0]\b/,ios:/^[8|9]/},i=["6abeab6d","6863f09d","499b4845","4cbeec05","70fc4915"].concat(["6c982dc5","6c97f43d"]);return{shouldFail:function(e){return!(!e.controllerConfig||-1===i.indexOf(e.controllerConfig.applicationKey))&&null!==n.getDeviceApiLevel().match(t[e.mobileSDKSettings.deviceOs])}}}},{}],173:[function(e,n,t){n.exports={templates:{mainDefaultTemplate:'<div id="ssaLoaderWrap" class="hidden">                <div id="spin" class="container">                    <div class="spinner">                        <div class="bar1"></div>                        <div class="bar2"></div>                        <div class="bar3"></div>                        <div class="bar4"></div>                        <div class="bar5"></div>                        <div class="bar6"></div>                        <div class="bar7"></div>                        <div class="bar8"></div>                        <div class="bar9"></div>                        <div class="bar10"></div>                        <div class="bar11"></div>                        <div class="bar12"></div>                    </div>                </div>            </div>',defaultDialogBoxTemplate:'<div id="ssaDialogBoxOverlay"></div>            <div id="ssaDialogBox" class="dialogBox">            <div id="ssaDialogBoxTextContainer">            <div><p id="ssaDialogText">Are you sure you want to quit the offer?</p></div>            </div>        <footer id="ssaDialogBtns">            <a id="ssaDialogCancelBtn" class="dialogBtn"><span id="ssaDialogCancelBtnText">Cancel</span></a>            <a id="ssaDialogConfirmBtn1"" class="dialogBtn"><span id="ssaDialogConfirmBtnText">OK</span></a>        </footer>        </div>',defaultNavigationTemplate:'            <div id="ssaNavigator" class="defaultNavigation">                <ul class="ssaList">                    <li><div data-edge="top|left" id="ssaNavigatorBackButton" class="ssaNavigationBtn ssaControllerButton ssaBackButton"><div class="innerWrapper"></div></div></li>                    <li><div data-edge="top|right" id="ssaNavigatorCloseButton" class="ssaNavigationBtn ssaControllerButton ssaCloseButton"><div class="innerWrapper"></div></div></li>                </ul>            </div>',loaderOWTemplate:'<div class="loaderOW hidden">        <div class="header">        </div>        <div class="progressbarWrap">            <div class="progressbar"></div>        </div>        <div class="offers">        <div class="shine"></div>        </div>    </div>',loaderOWOfferTemplate:'<div class="offer">        <div class="offerWrap">        <div class="offerImg"></div>        <div class="offerDetails">        <div>        <span class="offerText">Loading Info...</span>        </div>        <div class="offerEarn">        <div class="badge"></div>        <div class="callToAction">Loading...</div>        </div>        </div>        <div class="offerBtn"></div>        </div>        </div>'},style:{forceCloseProperties:{androidNeutral:{width:25,height:25,position:"top-right"},androidInterstitial:{width:0,height:0,position:"top-right"},androidNavigation:{width:25,height:25,position:"top-right"},iosNeutral:{width:24,height:24,position:"top-right"},iosNavigation:{width:50,height:50,position:"top-right"},disable:{width:0,height:0,position:"top-right"}},backgroundColors:{transparent:"transparent",black:"#000000",darkGrey:"#1A1A1A",semiTransparent:"rgba(0,0,0,0.7)"},iconBGConfig:{},defaultControlFrames:[{width:28,height:28,position:"top-right"},{width:30,height:30,position:"top-left"}]},settings:{}}},{}]},{},[163]);